(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    424653,      10464]
NotebookOptionsPosition[    367531,       9541]
NotebookOutlinePosition[    380879,       9812]
CellTagsIndexPosition[    380836,       9809]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"<<", "SpinorHelicity6D`"}]], "Input",
 CellChangeTimes->{{3.7948285286770144`*^9, 3.7948285346708364`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"c9f005c4-d775-4fa9-af20-ce595bb2d6e0"],

Cell[CellGroupData[{

Cell[BoxData["\<\"===============SpinorHelicity6D================\"\>"], \
"Print",
 CellChangeTimes->{3.7948285558317823`*^9, 3.794898862700775*^9, 
  3.794917550511091*^9, 3.795178411849126*^9, 3.7966495863239822`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"025bb99b-9bee-4c64-bb27-86c0a23d54df"],

Cell[BoxData["\<\"Authors: Manuel Accettulli Huber (QMUL)\"\>"], "Print",
 CellChangeTimes->{3.7948285558317823`*^9, 3.794898862700775*^9, 
  3.794917550511091*^9, 3.795178411849126*^9, 3.7966495863370132`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"b3293617-540b-4c92-9a05-3c40c73c6e9c"],

Cell[BoxData["\<\"         Stefano De Angelis (QMUL)\"\>"], "Print",
 CellChangeTimes->{3.7948285558317823`*^9, 3.794898862700775*^9, 
  3.794917550511091*^9, 3.795178411849126*^9, 3.7966495863509097`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"be590b0f-b140-47c9-977a-fd099c7c794a"],

Cell[BoxData["\<\"Please report any bug to:\"\>"], "Print",
 CellChangeTimes->{3.7948285558317823`*^9, 3.794898862700775*^9, 
  3.794917550511091*^9, 3.795178411849126*^9, 3.796649586355897*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"503b646a-5027-4006-b242-667aef39d647"],

Cell[BoxData["\<\"m.accettullihuber@qmul.ac.uk\"\>"], "Print",
 CellChangeTimes->{3.7948285558317823`*^9, 3.794898862700775*^9, 
  3.794917550511091*^9, 3.795178411849126*^9, 3.796649586362881*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"050bba33-9efd-4094-9007-2480215f03d4"],

Cell[BoxData["\<\"s.deangelis@qmul.ac.uk\"\>"], "Print",
 CellChangeTimes->{3.7948285558317823`*^9, 3.794898862700775*^9, 
  3.794917550511091*^9, 3.795178411849126*^9, 3.796649586367865*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"398ee240-04c0-41ae-8ab3-9cd7e7cb08dc"],

Cell[BoxData["\<\"Version 1.2 , last update 16/04/2020\"\>"], "Print",
 CellChangeTimes->{3.7948285558317823`*^9, 3.794898862700775*^9, 
  3.794917550511091*^9, 3.795178411849126*^9, 3.7966495863729057`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"6e6aaf64-71c0-4a27-88ea-04e5e3280caa"],

Cell[BoxData["\<\"===============================================\"\>"], \
"Print",
 CellChangeTimes->{3.7948285558317823`*^9, 3.794898862700775*^9, 
  3.794917550511091*^9, 3.795178411849126*^9, 3.796649586380868*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"876d833c-4c27-4d71-8c4a-3176c7c4f128"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rodolfo\[CloseCurlyQuote]s version", "Subsection",
 CellChangeTimes->{{3.7948285913571067`*^9, 
  3.794828603916712*^9}},ExpressionUUID->"0312b910-d947-4d4d-83b0-\
74f25682eab6"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", " ", 
   RowBox[{"Rules", " ", "for", " ", "Schouten", " ", "simplification"}], " ",
    "*)"}], "\n", 
  RowBox[{"SchoutenRules", " ", "=", "\n", "    ", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"k_.", " ", 
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"a_", ",", "c_"}], "]"}], " ", 
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"b_", ",", "d_"}], "]"}]}], " ", "-", " ", 
         RowBox[{"k_.", " ", 
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"a_", ",", "d_"}], "]"}], " ", 
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"b_", ",", "c_"}], "]"}]}]}], " ", ":>", " ", 
        RowBox[{"k", " ", 
         RowBox[{"SpinorAngleBracket", "[", 
          RowBox[{"a", ",", "b"}], "]"}], " ", 
         RowBox[{"SpinorAngleBracket", "[", 
          RowBox[{"c", ",", "d"}], "]"}]}]}], ",", "\n", "     ", 
       RowBox[{
        RowBox[{
         RowBox[{"k_.", " ", 
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], " ", 
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"c_", ",", "d_"}], "]"}]}], " ", "+", " ", 
         RowBox[{"k_.", " ", 
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"a_", ",", "d_"}], "]"}], " ", 
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"b_", ",", "c_"}], "]"}]}]}], " ", ":>", " ", 
        RowBox[{"k", " ", 
         RowBox[{"SpinorAngleBracket", "[", 
          RowBox[{"a", ",", "c"}], "]"}], " ", 
         RowBox[{"SpinorAngleBracket", "[", 
          RowBox[{"b", ",", "d"}], "]"}]}]}], ",", "\n", "     ", 
       RowBox[{
        RowBox[{
         RowBox[{"k_.", " ", 
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"a_", ",", "c_"}], "]"}], " ", 
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"b_", ",", "d_"}], "]"}]}], " ", "-", " ", 
         RowBox[{"k_.", " ", 
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], " ", 
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"c_", ",", "d_"}], "]"}]}]}], " ", ":>", " ", 
        RowBox[{"k", " ", 
         RowBox[{"SpinorAngleBracket", "[", 
          RowBox[{"a", ",", "d"}], "]"}], " ", 
         RowBox[{"SpinorAngleBracket", "[", 
          RowBox[{"b", ",", "c"}], "]"}]}]}], ",", "\n", "     ", 
       RowBox[{
        RowBox[{
         RowBox[{"k_.", " ", 
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"a_", ",", "c_"}], "]"}], " ", 
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"b_", ",", "d_"}], "]"}]}], " ", "-", " ", 
         RowBox[{"k_.", " ", 
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"a_", ",", "d_"}], "]"}], " ", 
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"b_", ",", "c_"}], "]"}]}]}], " ", ":>", " ", 
        RowBox[{"k", " ", 
         RowBox[{"SpinorSquareBracket", "[", 
          RowBox[{"a", ",", "b"}], "]"}], " ", 
         RowBox[{"SpinorSquareBracket", "[", 
          RowBox[{"c", ",", "d"}], "]"}]}]}], ",", "\n", "     ", 
       RowBox[{
        RowBox[{
         RowBox[{"k_.", " ", 
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], " ", 
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"c_", ",", "d_"}], "]"}]}], " ", "+", " ", 
         RowBox[{"k_.", " ", 
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"a_", ",", "d_"}], "]"}], " ", 
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"b_", ",", "c_"}], "]"}]}]}], " ", ":>", " ", 
        RowBox[{"k", " ", 
         RowBox[{"SpinorSquareBracket", "[", 
          RowBox[{"a", ",", "c"}], "]"}], " ", 
         RowBox[{"SpinorSquareBracket", "[", 
          RowBox[{"b", ",", "d"}], "]"}]}]}], ",", "\n", "     ", 
       RowBox[{
        RowBox[{
         RowBox[{"k_.", " ", 
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"a_", ",", "c_"}], "]"}], " ", 
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"b_", ",", "d_"}], "]"}]}], " ", "-", " ", 
         RowBox[{"k_.", " ", 
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], " ", 
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"c_", ",", "d_"}], "]"}]}]}], " ", ":>", " ", 
        RowBox[{"k", " ", 
         RowBox[{"SpinorSquareBracket", "[", 
          RowBox[{"a", ",", "d"}], "]"}], " ", 
         RowBox[{"SpinorSquareBracket", "[", 
          RowBox[{"b", ",", "c"}], "]"}]}]}]}], "}"}], "\n", "\n", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Generates", " ", "all", " ", "possibile", " ", "Schouten", " ", 
       "identities", " ", "associated", " ", "with", " ", "a", " ", "given", 
       " ", "set", " ", "of", " ", 
       RowBox[{"momenta", "."}]}], " ", "*)"}], "\n", 
     RowBox[{"SchoutenIdentities", "[", "momenta_List", "]"}]}], " ", ":=", 
    "\n", "    ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], " ", 
         "\[Function]", "\n", "        ", 
         RowBox[{"Sequence", "@@", "\n", "            ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"SpinorAngleBracket", "[", 
                RowBox[{"a", ",", "b"}], "]"}], " ", 
               RowBox[{"SpinorAngleBracket", "[", 
                RowBox[{"c", ",", "d"}], "]"}]}], " ", "+", " ", 
              RowBox[{
               RowBox[{"SpinorAngleBracket", "[", 
                RowBox[{"b", ",", "c"}], "]"}], " ", 
               RowBox[{"SpinorAngleBracket", "[", 
                RowBox[{"a", ",", "d"}], "]"}]}], " ", "+", " ", 
              RowBox[{
               RowBox[{"SpinorAngleBracket", "[", 
                RowBox[{"c", ",", "a"}], "]"}], " ", 
               RowBox[{"SpinorAngleBracket", "[", 
                RowBox[{"b", ",", "d"}], "]"}]}]}], " ", "==", " ", "0"}], 
            ",", "\n", "             ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"SpinorSquareBracket", "[", 
                RowBox[{"a", ",", "b"}], "]"}], " ", 
               RowBox[{"SpinorSquareBracket", "[", 
                RowBox[{"c", ",", "d"}], "]"}]}], " ", "+", " ", 
              RowBox[{
               RowBox[{"SpinorSquareBracket", "[", 
                RowBox[{"b", ",", "c"}], "]"}], " ", 
               RowBox[{"SpinorSquareBracket", "[", 
                RowBox[{"a", ",", "d"}], "]"}]}], " ", "+", " ", 
              RowBox[{
               RowBox[{"SpinorSquareBracket", "[", 
                RowBox[{"c", ",", "a"}], "]"}], " ", 
               RowBox[{"SpinorSquareBracket", "[", 
                RowBox[{"b", ",", "d"}], "]"}]}]}], " ", "==", " ", "0"}]}], 
           "}"}]}]}], ")"}], "@@@", "\n", "        ", 
       RowBox[{"Subsets", "[", 
        RowBox[{"momenta", ",", 
         RowBox[{"{", "4", "}"}]}], "]"}]}], "\n", "\n", 
      RowBox[{"(*", " ", "SchoutenSimplify", "*)"}], "\n", 
      RowBox[{"SchoutenSimplify", "[", "expr_", "]"}]}], " ", ":=", "\n", 
     "    ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"expr", ",", "\n", "        ", 
       RowBox[{"Assumptions", " ", "->", " ", 
        RowBox[{"SchoutenIdentities", "[", 
         RowBox[{"Momenta", "[", "expr", "]"}], "]"}]}], ",", "\n", 
       "        ", 
       RowBox[{"TransformationFunctions", " ", "->", " ", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", " ", 
          RowBox[{"(", 
           RowBox[{"e", " ", "\[Function]", " ", 
            RowBox[{"e", " ", "/.", " ", "SchoutenRules"}]}], ")"}]}], 
         "}"}]}]}], "]"}]}]}]}], "*)"}]], "Input",ExpressionUUID->"282b5dc0-\
6a84-4bd0-af0e-8ede5dfff594"]
}, Closed]],

Cell[CellGroupData[{

Cell["Experimenting with Mathematica\[CloseCurlyQuote]s Simplify", "Section",
 CellChangeTimes->{{3.7948297233445835`*^9, 
  3.794829735300384*^9}},ExpressionUUID->"dd159330-80fa-4396-ac91-\
74327bcf79b7"],

Cell[CellGroupData[{

Cell["Simple expressions with Plus and Times", "Subsection",
 CellChangeTimes->{{3.794830812923887*^9, 
  3.7948308268833947`*^9}},ExpressionUUID->"00e4c930-16fc-4255-a7a0-\
bb871eb2d05f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"a", "+", "b", "+", "c", "+", "d"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{
     RowBox[{"a", "+", "b"}], "\[Equal]", "c"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.79482973873028*^9, 3.794829781211028*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"96ac19fb-0abe-4662-a943-f81b92d7c1fd"],

Cell[BoxData[
 RowBox[{"a", "+", "b", "+", "c", "+", "d"}]], "Output",
 CellChangeTimes->{{3.7948297587455564`*^9, 3.794829782353527*^9}, 
   3.7948988761833334`*^9, 3.794917562172758*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"30bb8b0f-5397-4a31-83d9-9ed7a7167be7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "The", " ", "simplification", " ", "does", " ", "not", " ", "occur", " ", 
   "because", " ", "for", " ", "Mathematica", " ", "it", " ", "is", " ", 
   "not", " ", "a", " ", "simplification", " ", "at", " ", 
   RowBox[{"all", "!"}], " ", "Compare", " ", "the", " ", "fullforms", " ", 
   "and", " ", "remember", " ", "that", " ", "the", " ", "default", " ", 
   "ComplexityFunction", " ", "is", " ", "essentially", " ", "a", " ", 
   "LeafCount", " ", "with", " ", "some", " ", "additional", " ", "penalty", 
   " ", "for", " ", "huge", " ", "integers"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7948298989354005`*^9, 3.794829973798485*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"54e40088-523a-476d-ad62-56ff1b78e85e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LeafCount", "[", 
  RowBox[{"a", "+", "b", "+", "c", "+", "d"}], "]"}]], "Input",
 CellChangeTimes->{{3.7948297848511486`*^9, 3.794829790078264*^9}, {
  3.7948298515125046`*^9, 3.794829856984645*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"467b6a36-688c-4f34-838e-a9682f673ced"],

Cell[BoxData["5"], "Output",
 CellChangeTimes->{3.7948298580215607`*^9, 3.794898876447626*^9, 
  3.7949175626339445`*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"d0bd747d-6641-4b0d-afda-b7daa82c37d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LeafCount", "[", 
  RowBox[{
   RowBox[{"2", "*", "c"}], "+", "d"}], "]"}]], "Input",
 CellChangeTimes->{{3.7948298590873733`*^9, 3.7948298678084917`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"3de82312-12ac-45ce-8bef-bde5e7721840"],

Cell[BoxData["5"], "Output",
 CellChangeTimes->{3.7948298682305775`*^9, 3.7948988765074663`*^9, 
  3.794917562758599*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"0b1e6f13-d79c-41c9-b1e0-5e989768e5a1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"a", "+", "b", "+", "c", "+", "d"}], "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.794829886186588*^9, 3.794829891497307*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"4e207f9b-5784-4e9b-a378-69a6ec543006"],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"Plus", "[", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{3.7948298919161263`*^9, 3.7948988765623198`*^9, 
  3.7949175628593626`*^9},
 CellLabel->
  "Out[6]//FullForm=",ExpressionUUID->"6d1c1d24-34a0-4ac1-89f3-e8867bc5919d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"2", "*", "c"}], "+", "d"}], "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.794829986822604*^9, 3.7948299933351293`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"82cb7217-0866-403d-8fe8-9be4ece544b9"],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"Plus", "[", 
    RowBox[{
     RowBox[{"Times", "[", 
      RowBox[{"2", ",", "c"}], "]"}], ",", "d"}], "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{3.7948299936953692`*^9, 3.7948988766231585`*^9, 
  3.794917562963049*^9},
 CellLabel->
  "Out[7]//FullForm=",ExpressionUUID->"11879f72-c221-4dd9-b93d-b0e5ca65d877"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LeafCount", "[", 
  RowBox[{"a", "+", 
   RowBox[{"2", "*", "b"}], "+", "c", "+", "d", "+", "e"}], "]"}]], "Input",
 CellChangeTimes->{{3.7948297848511486`*^9, 3.794829790078264*^9}, {
  3.7948298515125046`*^9, 3.794829856984645*^9}, {3.7948300183706236`*^9, 
  3.794830048115892*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"fab4eb30-8fa6-4372-a589-22cd5e4ebcfe"],

Cell[BoxData["8"], "Output",
 CellChangeTimes->{
  3.7948298580215607`*^9, {3.7948300192955236`*^9, 3.7948300487863*^9}, 
   3.7948988766839943`*^9, 3.7949175630638123`*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"a42e5109-74d1-45ba-a8da-3c9fcda42650"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LeafCount", "[", 
  RowBox[{"b", "+", 
   RowBox[{"2", "*", "c"}], "+", "d", "+", "e"}], "]"}]], "Input",
 CellChangeTimes->{{3.7948298590873733`*^9, 3.7948298678084917`*^9}, {
  3.794830022094777*^9, 3.794830022250581*^9}, {3.794830060386197*^9, 
  3.794830060550724*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"73069d4d-d741-4ff9-a287-576dced88dab"],

Cell[BoxData["7"], "Output",
 CellChangeTimes->{3.7948298682305775`*^9, 3.7948300227233925`*^9, 
  3.7948300612421975`*^9, 3.7948988767498198`*^9, 3.794917563159523*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"191a0dfc-8907-47f2-a007-6917ec6d249d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TreeForm", "[", 
  RowBox[{"a", "+", 
   RowBox[{"2", "*", "b"}], "+", "c", "+", "d", "+", "e"}], "]"}]], "Input",
 CellChangeTimes->{{3.794830415919694*^9, 3.794830426936027*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"871e8b3b-b355-434e-b3a6-916e871be755"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[{{1.2649110640673518`, 1.2649110640673518`}, {0., 
    0.6324555320336759}, {0.6324555320336759, 0.6324555320336759}, {
    0.31622776601683794`, 0.}, {0.9486832980505138, 0.}, {1.2649110640673518`,
     0.6324555320336759}, {1.8973665961010275`, 0.6324555320336759}, {
    2.5298221281347035`, 0.6324555320336759}}, {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 3}, {1, 6}, {1, 7}, {1, 8}, {3, 4}, {3, 5}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Plus", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"a", "+", 
           RowBox[{"2", " ", "b"}], "+", "c", "+", "d", "+", "e"}], HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`a + 
         2 $CellContext`b + $CellContext`c + $CellContext`d + $CellContext`e],
         "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["a",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox["a", HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`a], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Times", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox[
         RowBox[{"2", " ", "b"}], HoldForm]],
       Annotation[#, 
        HoldForm[2 $CellContext`b], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["b",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox["b", HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`b], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["c",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["c", HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`c], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["d",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["d", HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`d], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["e",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["e", HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`e], "Tooltip"]& ]}}],
   Annotation[#, 
    VertexCoordinateRules -> {{1.2649110640673518`, 1.2649110640673518`}, {0.,
      0.6324555320336759}, {0.6324555320336759, 0.6324555320336759}, {
     0.31622776601683794`, 0.}, {0.9486832980505138, 0.}, {
     1.2649110640673518`, 0.6324555320336759}, {1.8973665961010275`, 
     0.6324555320336759}, {2.5298221281347035`, 0.6324555320336759}}]& ],
  AspectRatio->NCache[Rational[2, 3]^Rational[1, 2], 0.816496580927726],
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.794830427972841*^9, 3.7948988768595667`*^9, 
  3.794917563271225*^9},
 CellLabel->
  "Out[10]//TreeForm=",ExpressionUUID->"d32c5f6a-e222-4ac2-91d0-a9f8dc2a3c8b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Level", "[", 
  RowBox[{
   RowBox[{"a", "+", 
    RowBox[{"2", "*", "b"}], "+", "c", "+", "d", "+", "e"}], ",", "1"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7948309787234993`*^9, 3.79483097921406*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"46e34731-0e24-41f5-980d-2bff28180fee"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"a", ",", 
   RowBox[{"2", " ", "b"}], ",", "c", ",", "d", ",", "e"}], "}"}]], "Output",
 CellChangeTimes->{3.7948309796716366`*^9, 3.7948988769811993`*^9, 
  3.7949175635240617`*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"7fd34084-eb7d-4292-b9fd-022bc86a8426"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Level", "[", 
  RowBox[{
   RowBox[{"a", "+", 
    RowBox[{"2", "*", "b"}], "+", "c", "+", "d", "+", "e"}], ",", "2"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7948310006018815`*^9, 3.794831001216755*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"d79dea88-8a2c-4ba2-8f02-03d88146d687"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"a", ",", "2", ",", "b", ",", 
   RowBox[{"2", " ", "b"}], ",", "c", ",", "d", ",", "e"}], "}"}]], "Output",
 CellChangeTimes->{3.794831001746591*^9, 3.7948988770569973`*^9, 
  3.7949175636278257`*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"635ef88f-d91b-49c5-ab26-d7be38e1465b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Level", "[", 
  RowBox[{
   RowBox[{"a", "+", 
    RowBox[{"2", "*", "b"}], "+", "c", "+", "d", "+", "e"}], ",", "3"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.794831016489605*^9, 3.794831017200696*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"818541f7-f935-459f-ac9a-d960af92d311"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"a", ",", "2", ",", "b", ",", 
   RowBox[{"2", " ", "b"}], ",", "c", ",", "d", ",", "e"}], "}"}]], "Output",
 CellChangeTimes->{3.7948310177026343`*^9, 3.7948988771198287`*^9, 
  3.7949175637266097`*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"27e06069-f3cb-42c0-a853-bc1b71d4fff0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Level", "[", 
  RowBox[{
   RowBox[{"a", "+", 
    RowBox[{"2", "*", "b"}], "+", "c", "+", "d", "+", "e"}], ",", 
   RowBox[{"-", "1"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7948304496353188`*^9, 3.7948304715867863`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"4a18599e-d82b-4d9e-aa79-6fc9b01d3b98"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"a", ",", "2", ",", "b", ",", 
   RowBox[{"2", " ", "b"}], ",", "c", ",", "d", ",", "e"}], "}"}]], "Output",
 CellChangeTimes->{3.79483047202663*^9, 3.7948988771836586`*^9, 
  3.794917563847278*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"50915e58-6a75-4b00-85d3-dce1a70d4c55"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Level", "[", 
  RowBox[{
   RowBox[{"a", "+", 
    RowBox[{"2", "*", "b"}], "+", "c", "+", "d", "+", "e"}], ",", 
   RowBox[{"-", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.794830505726265*^9, 3.7948305061535296`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"a772fbda-03dd-4a0b-b63a-32479bfd83e8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", " ", "b"}], "}"}]], "Output",
 CellChangeTimes->{3.7948305066817913`*^9, 3.7948988772594566`*^9, 
  3.7949175639449835`*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"453035a2-8a5f-4e29-bdeb-6a13854cc43e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Level", "[", 
  RowBox[{
   RowBox[{"a", "+", 
    RowBox[{"2", "*", "b"}], "+", "c", "+", "d", "+", "e"}], ",", 
   RowBox[{"-", "3"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7948305171877303`*^9, 3.7948305176390133`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"49471b9c-f61a-449f-b4aa-e434e60d5364"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.7948305181166587`*^9, 3.794898877399081*^9, 
  3.7949175640432253`*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"0db548d5-752d-4e7a-96d9-3bb988515044"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Count", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"a", "+", 
     RowBox[{"2", "*", "b"}], "+", "c", "+", "d", "+", "e"}], "//", 
    "FullForm"}], ",", "_Plus"}], "]"}]], "Input",
 CellChangeTimes->{{3.7948308685017605`*^9, 3.794830873308914*^9}, {
  3.794831079561579*^9, 3.794831137364631*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"44b3902f-05ed-44f4-8614-650ed27f6c25"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.7948310818095884`*^9, 3.7948311228746552`*^9}, 
   3.7948988774649057`*^9, 3.794917564143512*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"c62e4c44-6725-416a-982c-c3c070d629c5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Count", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"a", "+", 
     RowBox[{"2", "*", "b"}], "+", "c", "+", 
     RowBox[{"3", "*", 
      RowBox[{"(", 
       RowBox[{"d", "+", "e"}], ")"}]}]}], "//", "FullForm"}], ",", "_Plus", 
   ",", "Infinity"}], "]"}]], "Input",
 CellChangeTimes->{{3.794831158946046*^9, 3.7948311735315886`*^9}, {
  3.7948312276073785`*^9, 3.794831299193762*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"68bed83f-5591-4ea0-815c-7501d038cae7"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{{3.794831162242447*^9, 3.794831174498748*^9}, {
   3.794831251818822*^9, 3.79483130417067*^9}, 3.7948988775217533`*^9, 
   3.794917564234818*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"8ce23fa0-9370-4161-a88e-b7d4ed57746e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"a", "+", 
   RowBox[{"2", "*", "b"}], "+", "c", "+", 
   RowBox[{"3", "*", 
    RowBox[{"(", 
     RowBox[{"d", "+", "e"}], ")"}]}]}], "//", "TreeForm"}]], "Input",
 CellChangeTimes->{{3.7948312153677073`*^9, 3.794831217813636*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"ced9757f-c5a8-4127-af2a-f8ea314a598b"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[{{1.1677484162422844`, 2.335496832484569}, {0., 
    1.5569978883230458`}, {0.778498944161523, 1.5569978883230458`}, {
    0.3892494720807615, 0.7784989441615229}, {1.1677484162422844`, 
    0.7784989441615229}, {1.556997888323046, 1.5569978883230458`}, {
    2.335496832484569, 1.5569978883230458`}, {1.9462473604038075`, 
    0.7784989441615229}, {2.7247463045653304`, 0.7784989441615229}, {
    2.335496832484569, 0.}, {3.113995776646092, 0.}}, {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 3}, {1, 6}, {1, 7}, {3, 4}, {3, 5}, {7, 8}, {7, 
       9}, {9, 10}, {9, 11}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Plus", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"a", "+", 
           RowBox[{"2", " ", "b"}], "+", "c", "+", 
           RowBox[{"3", " ", 
             RowBox[{"(", 
               RowBox[{"d", "+", "e"}], ")"}]}]}], HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`a + 2 $CellContext`b + $CellContext`c + 
         3 ($CellContext`d + $CellContext`e)], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["a",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox["a", HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`a], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Times", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox[
         RowBox[{"2", " ", "b"}], HoldForm]],
       Annotation[#, 
        HoldForm[2 $CellContext`b], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["b",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox["b", HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`b], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["c",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["c", HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`c], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Times", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox[
         RowBox[{"3", " ", 
           RowBox[{"(", 
             RowBox[{"d", "+", "e"}], ")"}]}], HoldForm]],
       Annotation[#, 
        HoldForm[3 ($CellContext`d + $CellContext`e)], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["3",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["3", HoldForm]],
       Annotation[#, 
        HoldForm[3], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Plus", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox[
         RowBox[{"d", "+", "e"}], HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`d + $CellContext`e], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["d",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox["d", HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`d], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["e",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox["e", HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`e], "Tooltip"]& ]}}],
   Annotation[#, 
    VertexCoordinateRules -> {{1.1677484162422844`, 2.335496832484569}, {0., 
     1.5569978883230458`}, {0.778498944161523, 1.5569978883230458`}, {
     0.3892494720807615, 0.7784989441615229}, {1.1677484162422844`, 
     0.7784989441615229}, {1.556997888323046, 1.5569978883230458`}, {
     2.335496832484569, 1.5569978883230458`}, {1.9462473604038075`, 
     0.7784989441615229}, {2.7247463045653304`, 0.7784989441615229}, {
     2.335496832484569, 0.}, {3.113995776646092, 0.}}]& ],
  AspectRatio->NCache[Rational[2, 3]^Rational[1, 2], 0.816496580927726],
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.7948312185461073`*^9, 3.7948988775975513`*^9, 
  3.794917564342009*^9},
 CellLabel->
  "Out[19]//TreeForm=",ExpressionUUID->"2e07c522-a799-4859-becc-dbed3427aff4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Count", "[", 
  RowBox[{
   RowBox[{"a", "+", 
    RowBox[{"2", "*", "b"}], "+", "c", "+", 
    RowBox[{"3", "*", 
     RowBox[{"(", 
      RowBox[{"d", "+", 
       RowBox[{"e", "*", 
        RowBox[{"(", 
         RowBox[{"f", "+", "h"}], ")"}]}]}], ")"}]}]}], ",", "_Plus", ",", 
   "Infinity"}], "]"}]], "Input",
 CellChangeTimes->{{3.794831367074685*^9, 3.7948313705407925`*^9}, {
  3.7948315151040134`*^9, 3.794831519604169*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"9a855d25-d0c0-4d8d-82ca-188b15b98f77"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{{3.7948314931258173`*^9, 3.794831520720256*^9}, 
   3.794898877649412*^9, 3.794917564524522*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"00bcdbd5-f542-4333-a8ac-cab2b5e19a15"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"a", "+", 
   RowBox[{"2", "*", "b"}], "+", "c", "+", 
   RowBox[{"3", "*", 
    RowBox[{"(", 
     RowBox[{"d", "+", 
      RowBox[{"e", "*", 
       RowBox[{"(", 
        RowBox[{"f", "+", "h"}], ")"}]}]}], ")"}]}]}], "//", 
  "TreeForm"}]], "Input",
 CellChangeTimes->{{3.7948315055210133`*^9, 3.794831507343047*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"6a234be6-174e-4b49-93b3-81aa2f54d448"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[{{1.2104198771788934`, 4.034732923929645}, {0., 
    3.227786339143716}, {0.806946584785929, 3.227786339143716}, {
    0.4034732923929645, 2.420839754357787}, {1.2104198771788934`, 
    2.420839754357787}, {1.613893169571858, 3.227786339143716}, {
    2.420839754357787, 3.227786339143716}, {2.0173664619648224`, 
    2.420839754357787}, {2.8243130467507513`, 2.420839754357787}, {
    2.420839754357787, 1.613893169571858}, {3.227786339143716, 
    1.613893169571858}, {2.8243130467507513`, 0.806946584785929}, {
    3.6312596315366803`, 0.806946584785929}, {3.227786339143716, 0.}, {
    4.034732923929645, 0.}}, {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 3}, {1, 6}, {1, 7}, {3, 4}, {3, 5}, {7, 8}, {7, 
       9}, {9, 10}, {9, 11}, {11, 12}, {11, 13}, {13, 14}, {13, 15}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Plus", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"a", "+", 
           RowBox[{"2", " ", "b"}], "+", "c", "+", 
           RowBox[{"3", " ", 
             RowBox[{"(", 
               RowBox[{"d", "+", 
                 RowBox[{"e", " ", 
                   RowBox[{"(", 
                    RowBox[{"f", "+", "h"}], ")"}]}]}], ")"}]}]}], HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`a + 2 $CellContext`b + $CellContext`c + 
         3 ($CellContext`d + $CellContext`e ($CellContext`f + \
$CellContext`h))], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["a",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox["a", HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`a], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Times", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox[
         RowBox[{"2", " ", "b"}], HoldForm]],
       Annotation[#, 
        HoldForm[2 $CellContext`b], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["b",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox["b", HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`b], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["c",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["c", HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`c], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Times", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox[
         RowBox[{"3", " ", 
           RowBox[{"(", 
             RowBox[{"d", "+", 
               RowBox[{"e", " ", 
                 RowBox[{"(", 
                   RowBox[{"f", "+", "h"}], ")"}]}]}], ")"}]}], HoldForm]],
       Annotation[#, 
        HoldForm[
        3 ($CellContext`d + $CellContext`e ($CellContext`f + \
$CellContext`h))], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["3",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["3", HoldForm]],
       Annotation[#, 
        HoldForm[3], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Plus", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox[
         RowBox[{"d", "+", 
           RowBox[{"e", " ", 
             RowBox[{"(", 
               RowBox[{"f", "+", "h"}], ")"}]}]}], HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`d + $CellContext`e ($CellContext`f + \
$CellContext`h)], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["d",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox["d", HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`d], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Times", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox[
         RowBox[{"e", " ", 
           RowBox[{"(", 
             RowBox[{"f", "+", "h"}], ")"}]}], HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`e ($CellContext`f + $CellContext`h)], 
        "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["e",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox["e", HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`e], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Plus", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox[
         RowBox[{"f", "+", "h"}], HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`f + $CellContext`h], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["f",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox["f", HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`f], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["h",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 15],
        TagBox["h", HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`h], "Tooltip"]& ]}}],
   Annotation[#, 
    VertexCoordinateRules -> {{1.2104198771788934`, 4.034732923929645}, {0., 
     3.227786339143716}, {0.806946584785929, 3.227786339143716}, {
     0.4034732923929645, 2.420839754357787}, {1.2104198771788934`, 
     2.420839754357787}, {1.613893169571858, 3.227786339143716}, {
     2.420839754357787, 3.227786339143716}, {2.0173664619648224`, 
     2.420839754357787}, {2.8243130467507513`, 2.420839754357787}, {
     2.420839754357787, 1.613893169571858}, {3.227786339143716, 
     1.613893169571858}, {2.8243130467507513`, 0.806946584785929}, {
     3.6312596315366803`, 0.806946584785929}, {3.227786339143716, 0.}, {
     4.034732923929645, 0.}}]& ],
  AspectRatio->1,
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.7948315077189693`*^9, 3.7948988777381744`*^9, 
  3.794917564651191*^9},
 CellLabel->
  "Out[21]//TreeForm=",ExpressionUUID->"15319bb7-a792-4df1-90ae-210e87b3fd1d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Count", "[", 
   RowBox[{
    RowBox[{"a", "+", 
     RowBox[{"2", "*", "b"}], "+", "c", "+", 
     RowBox[{"3", "*", 
      RowBox[{"(", 
       RowBox[{"d", "+", 
        RowBox[{"e", "*", 
         RowBox[{"(", 
          RowBox[{"f", "+", "h"}], ")"}]}]}], ")"}]}]}], ",", "_Plus", ",", 
    "Infinity"}], "]"}], "//", "RepeatedTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Count", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "+", 
      RowBox[{"2", "*", "b"}], "+", "c", "+", 
      RowBox[{"3", "*", 
       RowBox[{"(", 
        RowBox[{"d", "+", 
         RowBox[{"e", "*", 
          RowBox[{"(", 
           RowBox[{"f", "+", "h"}], ")"}]}]}], ")"}]}]}], "//", "FullForm"}], 
    ",", "_Plus", ",", "Infinity"}], "]"}], "//", 
  "RepeatedTiming"}]}], "Input",
 CellChangeTimes->{{3.7948316322188115`*^9, 3.79483166157499*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"9e23837e-d869-44c1-8c45-71f86ca9acc4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.683984375`3.*^-6", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{{3.79483164627995*^9, 3.794831677715025*^9}, 
   3.794898877779065*^9, 3.7949175647409425`*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"61873b16-60df-4e1c-9623-a85036853884"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.800390625`1.*^-6", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{{3.79483164627995*^9, 3.794831677715025*^9}, 
   3.794898877779065*^9, 3.794917564745962*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"15c087e8-0a19-4d67-b9ac-0970918292d5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Testing", " ", "the", " ", "speed", " ", "of", " ", "FullForm"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7948316820148764`*^9, 3.7948316923122053`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"8ddf70d8-4175-42d8-9cce-4c8526f7bf27"],

Cell[BoxData[
 RowBox[{
  RowBox[{"test", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"a", "[", "x", "]"}], "+", 
   RowBox[{"x", "*", 
    RowBox[{"b", "[", "x", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7948318906403823`*^9, 3.7948319118414145`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"de9d88b6-ae87-449a-bfb0-b8a302f42128"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Count", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Nest", "[", 
      RowBox[{"test", ",", "x", ",", "8"}], "]"}], "//", "FullForm"}], ",", 
    "_Plus", ",", "Infinity"}], "]"}], "//", "RepeatedTiming"}]], "Input",
 CellChangeTimes->{{3.7948316934867983`*^9, 3.794831758626964*^9}, {
  3.7948318135125723`*^9, 3.7948318591813345`*^9}, {3.794831958935317*^9, 
  3.7948319735389843`*^9}, {3.794832077618923*^9, 3.7948320781828613`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"5c478056-711e-4cd4-b6dd-fa3a86899275"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0011457803921568629`1.", ",", "3280"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7948317645188656`*^9, {3.7948319624036493`*^9, 3.794832038783382*^9}, {
   3.7948320801625214`*^9, 3.7948321069385853`*^9}, 3.7948988789000664`*^9, 
   3.7949175659298697`*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"fc68fa99-4e90-44b8-8c7d-452539c79def"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Count", "[", 
   RowBox[{
    RowBox[{"Nest", "[", 
     RowBox[{"test", ",", "x", ",", "8"}], "]"}], ",", "_Plus", ",", 
    "Infinity"}], "]"}], "//", "RepeatedTiming"}]], "Input",
 CellChangeTimes->{
  3.794831985932386*^9, {3.7948320829987745`*^9, 3.7948320832504616`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"056cdca3-a616-48f7-9ec9-b14385ca8412"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0012713464102564102`1.", ",", "3279"}], "}"}]], "Output",
 CellChangeTimes->{{3.794831987952964*^9, 3.7948320409146795`*^9}, {
   3.7948320849897537`*^9, 3.7948321183732805`*^9}, 3.794898879991149*^9, 
   3.794917567172579*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"dc8e2212-97dc-4966-aec2-ffedb5eb6122"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Nest", "[", 
    RowBox[{"test", ",", "x", ",", "8"}], "]"}], "//", "LeafCount"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.7948321303208065`*^9, 3.7948321343896313`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"1c6d0206-d5ce-4055-8962-fd1e650e682c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.000376`", ",", "19681"}], "}"}]], "Output",
 CellChangeTimes->{{3.794832134810771*^9, 3.79483215276584*^9}, 
   3.7948988800858955`*^9, 3.7949175673400855`*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"f2d8c345-4d78-4bb3-b0d4-863dc2b436af"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "It", " ", "seems", " ", "that", " ", "there", " ", "ia", " ", "almost", 
   " ", "no", " ", "speed", " ", "difference", " ", "and", " ", "when", " ", 
   "there", " ", "is", " ", "using", " ", "FullForm", " ", "is", " ", 
   "actually", " ", "faster"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7948320468344393`*^9, 3.7948320743152847`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"e2cdfdf1-0753-4b88-a336-6f3eb65f52b8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Playing with powers", "Subsection",
 CellChangeTimes->{{3.802172167878934*^9, 
  3.8021721718224373`*^9}},ExpressionUUID->"bba6d464-632b-47b2-b5db-\
f2e64527cc5b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LeafCount", "[", 
  RowBox[{
   RowBox[{"a", "^", "7"}], "*", 
   RowBox[{"b", "^", "5"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8021728599791813`*^9, 3.8021728632264814`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"a4eb1ce2-1b02-4d52-a9b5-7775dbc45683"],

Cell[BoxData["7"], "Output",
 CellChangeTimes->{3.802172863707191*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"8794b5a1-bbb3-4b9a-b955-cf6631a930e5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"a", "^", "7"}], "*", 
    RowBox[{"b", "^", "5"}]}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "^", "3"}], "*", 
      RowBox[{"b", "^", "3"}]}], "\[Equal]", "1"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8021721879322987`*^9, 3.8021724022717714`*^9}, {
  3.802172774711252*^9, 3.802172793489032*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"96f406db-8fbd-42a4-ac69-769647ff082c"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["a", "4"], " ", 
  SuperscriptBox["b", "2"]}]], "Output",
 CellChangeTimes->{{3.8021722794704432`*^9, 3.8021723008352957`*^9}, 
   3.8021723682238393`*^9, {3.8021724028342924`*^9, 3.802172412154332*^9}, 
   3.80217279406748*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"90a278dd-6abd-4288-9bc3-07d16680180d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LeafCount", "[", 
  RowBox[{
   RowBox[{"a", "^", "4"}], "*", 
   RowBox[{"b", "^", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8021728685342846`*^9, 3.802172877505281*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"93ab5669-8e24-418c-be8e-64ef471e7e3a"],

Cell[BoxData["7"], "Output",
 CellChangeTimes->{3.8021728784118547`*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"d132eafb-26ed-4075-8040-443b3ff3ffab"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "So", " ", "even", " ", "if", " ", "from", " ", "a", " ", "leafcount", " ", 
   "perspective", " ", "the", " ", "initial", " ", "and", " ", "final", " ", 
   "expression", " ", "are", " ", "the", " ", "same", " ", "Mathematica", " ",
    "is", " ", "mart", " ", "enough", " ", "to", " ", "regognize", " ", 
   "that", " ", "smaller", " ", "powers", " ", "are", " ", "better"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.8021728008333826`*^9, 
  3.802172834320842*^9}},ExpressionUUID->"4361c1a6-4531-4b5c-8525-\
e3748177c501"]
}, Open  ]],

Cell[CellGroupData[{

Cell["My first complexity function", "Subsection",
 CellChangeTimes->{{3.794830854732902*^9, 
  3.7948308604885197`*^9}},ExpressionUUID->"3e5f4474-a1c5-4579-9876-\
3bfd8d9b5458"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"First", " ", "lesson", " ", "from", " ", 
    RowBox[{"above", ":", " ", 
     RowBox[{
     "I", " ", "like", " ", "Times", " ", "better", " ", "than", " ", 
      "Plus"}]}]}], ",", " ", 
   RowBox[{"but", " ", "Mathematica", " ", "does", " ", 
    RowBox[{"not", ".", " ", "So"}], " ", "lets", " ", "try", " ", "and", " ",
     "see", " ", "what", " ", "happens", " ", "if", " ", "we", " ", "make", 
    " ", "the", " ", "Plus", " ", "more", " ", "expensive"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7948300966943474`*^9, 3.7948301419173594`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"286ba32a-d2d6-4ae3-9687-29dadb68e4cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MyComplexityFunction", "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "complexity", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Take", " ", 
       RowBox[{"Mathematica", "'"}], "s", " ", "LeafCount", " ", "as", " ", 
       "a", " ", "reference", " ", "and", " ", "add", " ", "penalties", " ", 
       "for", " ", "every", " ", "Plus", " ", "in", " ", "the", " ", 
       RowBox[{"expression", ".", " ", "Assign"}], " ", "weight", " ", "2", 
       " ", "to", " ", "Plus", " ", "instead", " ", "of", " ", 
       RowBox[{"one", "."}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"complexity", "=", 
       RowBox[{"LeafCount", "[", "exp", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"complexity", "=", 
       RowBox[{"complexity", "+", 
        RowBox[{"Count", "[", 
         RowBox[{
          RowBox[{"exp", "//", "FullForm"}], ",", "_Plus", ",", "Infinity"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "complexity", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.794830145059383*^9, 3.794830156834752*^9}, {
  3.7948306697169437`*^9, 3.7948307261645064`*^9}, {3.794831534826007*^9, 
  3.7948316146210995`*^9}, {3.7948321626932096`*^9, 3.7948322048786*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"b994bc98-17d9-4af7-94ed-22be0e168cfd"]
}, Closed]],

Cell[CellGroupData[{

Cell["Test", "Subsection",
 CellChangeTimes->{{3.7948322261328135`*^9, 
  3.7948322267629204`*^9}},ExpressionUUID->"f8b10ff4-fa41-49b0-a7e2-\
815151889684"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"a", "+", "b", "+", "c", "+", "d"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{
     RowBox[{"a", "+", "b"}], "\[Equal]", "c"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.79482973873028*^9, 3.794829781211028*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"fff8cfc3-dc1d-40f4-9223-d77717593367"],

Cell[BoxData[
 RowBox[{"a", "+", "b", "+", "c", "+", "d"}]], "Output",
 CellChangeTimes->{{3.7948297587455564`*^9, 3.794829782353527*^9}, 
   3.7948322665999174`*^9, 3.7948988802205677`*^9, 3.794917567594412*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"b5020ab1-8468-4392-970a-6802993778ff"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"a", "+", "b", "+", "c", "+", "d"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{
     RowBox[{"a", "+", "b"}], "\[Equal]", "c"}]}], ",", 
   RowBox[{"ComplexityFunction", "\[Rule]", "MyComplexityFunction"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.79482973873028*^9, 3.794829781211028*^9}, {
  3.7948322427062035`*^9, 3.794832254452283*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"35f9ca89-726a-475c-9886-135f0c6e9f84"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "c"}], "+", "d"}]], "Output",
 CellChangeTimes->{{3.7948297587455564`*^9, 3.794829782353527*^9}, {
   3.79483225527194*^9, 3.794832268511183*^9}, 3.794898880301319*^9, 
   3.79491756768824*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"96c1598d-91e6-4b07-ba17-aa9462902bd8"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Look at spinors", "Subsection",
 CellChangeTimes->{{3.794832484608184*^9, 
  3.794832487296301*^9}},ExpressionUUID->"a6330caa-c8ca-4a13-8816-\
456d24fdc6b1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{"1","2"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], 
   TemplateBox[{"2","3"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}], "//", "LeafCount"}]], "Input",
 CellChangeTimes->{{3.7948324923239098`*^9, 3.7948325066156344`*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"0cbdb6ad-e48e-430b-a03c-46e45581e7b6"],

Cell[BoxData["7"], "Output",
 CellChangeTimes->{{3.7948324993081617`*^9, 3.794832507039766*^9}, 
   3.7948988803791103`*^9, 3.7949175677730155`*^9},
 CellLabel->"Out[34]=",ExpressionUUID->"3ef253a3-54f6-4465-890d-c4fd14b2b5aa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{"1","2"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], 
   TemplateBox[{"2","3"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}], "//", "TreeForm"}]], "Input",
 CellChangeTimes->{{3.794832515476146*^9, 3.7948325165567417`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"bbc7aaab-355c-430b-a921-e11cb54530be"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[{{1.2247448713915892`, 1.6329931618554523`}, {
    0.4082482904638631, 0.8164965809277261}, {0., 0.}, {0.8164965809277261, 
    0.}, {2.041241452319315, 0.8164965809277261}, {1.6329931618554523`, 0.}, {
    2.4494897427831783`, 0.}}, {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 5}, {2, 3}, {2, 4}, {5, 6}, {5, 7}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Times", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.021621621621621623`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{
           
           TemplateBox[{"1", "2"}, "SpinorAngleBracket", 
            DisplayFunction -> (RowBox[{"\[LeftAngleBracket]", 
               RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
             InterpretationFunction -> (RowBox[{"Spinoranglebracket", "[", 
               RowBox[{#, ",", #2}], "]"}]& )], " ", 
           
           TemplateBox[{"2", "3"}, "SpinorSquareBracket", 
            DisplayFunction -> (RowBox[{"[", 
               RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ), 
            InterpretationFunction -> (RowBox[{"Spinorsquarebracket", "[", 
               RowBox[{#, ",", #2}], "]"}]& )]}], HoldForm]],
       Annotation[#, 
        HoldForm[
        SpinorHelicity6D`SpinorAngleBracket[1, 2] 
         SpinorHelicity6D`SpinorSquareBracket[2, 3]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SpinorAngleBracket", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.021621621621621623`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox[
         TemplateBox[{"1", "2"}, "SpinorAngleBracket", 
          DisplayFunction -> (RowBox[{"\[LeftAngleBracket]", 
             RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ), 
          InterpretationFunction -> (RowBox[{"Spinoranglebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], HoldForm]],
       Annotation[#, 
        HoldForm[
         SpinorHelicity6D`SpinorAngleBracket[1, 2]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["1",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.021621621621621623`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox["1", HoldForm]],
       Annotation[#, 
        HoldForm[1], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.021621621621621623`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SpinorSquareBracket", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.021621621621621623`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox[
         TemplateBox[{"2", "3"}, "SpinorSquareBracket", 
          DisplayFunction -> (RowBox[{"[", 
             RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ), 
          InterpretationFunction -> (RowBox[{"Spinorsquarebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], HoldForm]],
       Annotation[#, 
        HoldForm[
         SpinorHelicity6D`SpinorSquareBracket[2, 3]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.021621621621621623`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["3",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.021621621621621623`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["3", HoldForm]],
       Annotation[#, 
        HoldForm[3], "Tooltip"]& ]}}],
   Annotation[#, 
    VertexCoordinateRules -> {{1.2247448713915892`, 1.6329931618554523`}, {
     0.4082482904638631, 0.8164965809277261}, {0., 0.}, {0.8164965809277261, 
     0.}, {2.041241452319315, 0.8164965809277261}, {1.6329931618554523`, 
     0.}, {2.4494897427831783`, 0.}}]& ],
  AspectRatio->NCache[Rational[6, 37]^Rational[1, 2], 0.4026936331284146],
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.794832516986831*^9, 3.7948988804569035`*^9, 
  3.79491756786734*^9},
 CellLabel->
  "Out[35]//TreeForm=",ExpressionUUID->"ff772fea-1d79-4994-9740-ea6308ce4a6c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    TemplateBox[{"p1","p2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], 
    TemplateBox[{"p2","p3"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], "//", "ToChain"}], "//", 
  "LeafCount"}]], "Input",
 CellChangeTimes->{{3.7948325422228003`*^9, 3.794832551878229*^9}, {
  3.794833156402939*^9, 3.7948331619125786`*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"86d15a9d-992d-45ca-a701-c77a907d0c07"],

Cell[BoxData["7"], "Output",
 CellChangeTimes->{{3.794832545470929*^9, 3.7948325522912226`*^9}, 
   3.794833162569111*^9, 3.794898880529708*^9, 3.7949175679411087`*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"78cca8ed-62e3-4002-a9ad-dcf87d27b717"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    TemplateBox[{"p1","p2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], 
    TemplateBox[{"p2","p3"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], "//", "ToChain"}], "//", 
  "TreeForm"}]], "Input",
 CellChangeTimes->{{3.7948325612977858`*^9, 3.7948325634551024`*^9}, {
  3.794833164689618*^9, 3.7948331692645245`*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"2717d5cd-0e0a-48ea-ae03-23dc1940c26a"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[{{1.224744871391589, 1.224744871391589}, {0., 
    0.6123724356957945}, {0.6123724356957945, 0.6123724356957945}, {
    1.224744871391589, 0.6123724356957945}, {1.224744871391589, 0.}, {
    1.8371173070873836`, 0.6123724356957945}, {2.449489742783178, 
    0.6123724356957945}}, {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 3}, {1, 4}, {1, 6}, {1, 7}, {4, 5}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Chain", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.0380952380952381],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         TemplateBox[{"p1", 
           RowBox[{"{", "p2", "}"}], "p3"}, "AngleSquareChain", 
          DisplayFunction -> (
           RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ), 
          InterpretationFunction -> (
           RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
             "$square", "]"}]& )], HoldForm]],
       Annotation[#, 
        HoldForm[
         SpinorHelicity6D`Chain[
         SpinorHelicity6D`$angle, $CellContext`p1, {$CellContext`p2}, \
$CellContext`p3, SpinorHelicity6D`$square]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["$angle",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.0380952380952381],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox["$angle", HoldForm]],
       Annotation[#, 
        HoldForm[SpinorHelicity6D`$angle], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["p1",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.0380952380952381],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox["p1", HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`p1], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.0380952380952381],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox[
         RowBox[{"{", "p2", "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{$CellContext`p2}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["p2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.0380952380952381],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox["p2", HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`p2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["p3",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.0380952380952381],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["p3", HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`p3], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["$square",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.0380952380952381],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["$square", HoldForm]],
       Annotation[#, 
        HoldForm[SpinorHelicity6D`$square], "Tooltip"]& ]}}],
   Annotation[#, 
    VertexCoordinateRules -> {{1.224744871391589, 1.224744871391589}, {0., 
     0.6123724356957945}, {0.6123724356957945, 0.6123724356957945}, {
     1.224744871391589, 0.6123724356957945}, {1.224744871391589, 0.}, {
     1.8371173070873836`, 0.6123724356957945}, {2.449489742783178, 
     0.6123724356957945}}]& ],
  AspectRatio->NCache[Rational[2, 7]^Rational[1, 2], 0.5345224838248488],
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.7948325639282446`*^9, 3.7948331699603586`*^9, 
  3.7948988806134834`*^9, 3.79491756802991*^9},
 CellLabel->
  "Out[37]//TreeForm=",ExpressionUUID->"d7c559ba-c80e-48a1-a1f0-0541b954f8cd"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Assume", " ", "you", " ", "have", " ", "conserved", " ", "external", " ", 
   "momenta", " ", "and", " ", "you", " ", "want", " ", "to", " ", "simplify",
    " ", "the", " ", 
   RowBox[{"following", ":"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7948331724175367`*^9, 3.7948332038754387`*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"e672bc3a-8ad3-41eb-812b-32414c532b3e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"exp", "=", 
  RowBox[{
   RowBox[{
    TemplateBox[{"p1","p3"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], 
    TemplateBox[{"p3","p2"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], "-", 
   RowBox[{
    TemplateBox[{"p1","p4"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], 
    TemplateBox[{"p4","p2"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}]}]}]], "Input",
 CellChangeTimes->{{3.7948332136022873`*^9, 3.7948332574050007`*^9}, {
  3.794833382454263*^9, 3.7948333832168117`*^9}, {3.7948339405326934`*^9, 
  3.794833964752047*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"e884777a-2045-4694-ba78-52722f8c019c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    TemplateBox[{"p1","p3"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], " ", 
   TemplateBox[{"p2","p3"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
  RowBox[{
   TemplateBox[{"p1","p4"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], " ", 
   TemplateBox[{"p2","p4"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}]}]], "Output",
 CellChangeTimes->{
  3.794833258621314*^9, 3.794833385470894*^9, {3.794833941386014*^9, 
   3.794833965420395*^9}, 3.7948988806952653`*^9, 3.7949175681715193`*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"0ea76670-fe58-44b3-b80d-b44941108c2d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"exp", "//", "ToChain"}]], "Input",
 CellChangeTimes->{{3.79483326113844*^9, 3.7948332640148153`*^9}, {
  3.794833386689691*^9, 3.794833387467358*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"9670a141-b2c8-411c-9324-2374af3b4719"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", "p3", "}"}],"p2"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "-", 
  TemplateBox[{"p1",RowBox[{"{", "p4", "}"}],"p2"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{
  3.7948332643845167`*^9, 3.7948333885068636`*^9, {3.794833942966926*^9, 
   3.794833967494542*^9}, 3.79489888077206*^9, 3.794917568265275*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"145fd30c-9018-4102-af02-296b63ba3e81"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "We", " ", "want", " ", "to", " ", "apply", " ", "momentum", " ", 
   "conservation", " ", "to", " ", "the", " ", "chains"}], "*)"}]], "Input",
 CellChangeTimes->{{3.794833363881654*^9, 3.7948333755228696`*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"34e96c8a-dc2b-40d9-a03a-42e573246685"],

Cell[BoxData[
 RowBox[{"DeclareMom", "[", 
  RowBox[{"p1", ",", "p2", ",", "p3", ",", "p4"}], "]"}]], "Input",
 CellChangeTimes->{{3.794833909742528*^9, 3.7948339174379597`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"6db5fd3d-28b4-47d3-8819-7a42015455a3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"exp", ",", 
   RowBox[{"TransformationFunctions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Automatic", ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p4", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p3"}], "-", "p1", "-", "p2"}]}], "}"}]}], "}"}]}],
         "]"}]}]}], "}"}]}], ",", 
   RowBox[{"ComplexityFunction", "\[Rule]", "MyComplexityFunction"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.794833377249462*^9, 3.7948333935485177`*^9}, {
  3.794833535888779*^9, 3.794833622519597*^9}, {3.7948339220065536`*^9, 
  3.79483392868568*^9}, {3.7948340079547095`*^9, 3.79483404312502*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"442dd80a-d554-4848-a26c-c46c0cbdb0ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    TemplateBox[{"p1","p3"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], " ", 
   TemplateBox[{"p2","p3"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
  RowBox[{
   TemplateBox[{"p1","p4"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], " ", 
   TemplateBox[{"p2","p4"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}]}]], "Output",
 CellChangeTimes->{
  3.794833623394912*^9, 3.7948339301657286`*^9, {3.794834032580312*^9, 
   3.7948340440273275`*^9}, 3.7948988808717933`*^9, 3.7949175685874076`*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"4640ab44-5dab-427f-8ba8-6df64244a0c4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ChainSimplify", "[", 
  RowBox[{
   RowBox[{"exp", "//", "ToChain"}], ",", 
   RowBox[{"{", 
    RowBox[{"MomCon", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"p4", "\[Rule]", 
       RowBox[{
        RowBox[{"-", "p3"}], "-", "p1", "-", "p2"}]}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7948338686145535`*^9, 3.794833895656533*^9}, {
  3.7948339956568503`*^9, 3.7948339978876877`*^9}, {3.794834118896138*^9, 
  3.7948341233877826`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"3ea09cac-c535-4831-8431-3bc993d40eaf"],

Cell[BoxData[
 RowBox[{"2", " ", 
  TemplateBox[{"p1",RowBox[{"{", "p3", "}"}],"p2"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{{3.7948338701537256`*^9, 3.794833896172798*^9}, {
   3.7948339325508614`*^9, 3.7948339982808948`*^9}, 3.7948340723272142`*^9, 
   3.794834123729672*^9, 3.794898880948588*^9, 3.7949175686761713`*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"86e5977f-4fb0-4435-b079-9dbb481c736e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "LeafCount"}]], "Input",
 CellChangeTimes->{{3.7948340737096014`*^9, 3.794834076260312*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"f1d78a1f-b53d-490b-afd5-d1b8210da1b8"],

Cell[BoxData["9"], "Output",
 CellChangeTimes->{3.794834076579586*^9, 3.794898881020396*^9, 
  3.7949175687669334`*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"398a81ce-8c04-4c26-813b-ec69fdfb201e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"exp", "//", "LeafCount"}]], "Input",
 CellChangeTimes->{{3.794834079945528*^9, 3.7948340833358293`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"6aaa5a30-e6d6-4ea3-810b-9bbff4b4c419"],

Cell[BoxData["16"], "Output",
 CellChangeTimes->{3.79483408370387*^9, 3.7948988811181345`*^9, 
  3.794917568852572*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"9a2e0dea-0b34-4c93-9e84-0841f13c3173"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "Chains", " ", "are", " ", "far", " ", "more", " ", "expensive", " ", 
    "than", " ", "brackets"}], ",", " ", 
   RowBox[{
   "so", " ", "we", " ", "have", " ", "to", " ", "depenalise", " ", 
    "them"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7948336270541935`*^9, 3.794833664641354*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"f176be48-070c-472d-8c78-f40562d35635"]
}, Closed]],

Cell[CellGroupData[{

Cell["Second complexity function", "Subsection",
 CellChangeTimes->{{3.7948336692660074`*^9, 
  3.7948336741976347`*^9}},ExpressionUUID->"ebb39658-64d6-4c97-a25b-\
813c188781a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MyComplexityFunction", "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"complexity", ",", "fullexp"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Take", " ", 
       RowBox[{"Mathematica", "'"}], "s", " ", "LeafCount", " ", "as", " ", 
       "a", " ", "reference", " ", "and", " ", "add", " ", "penalties", " ", 
       "for", " ", "every", " ", "Plus", " ", "in", " ", "the", " ", 
       RowBox[{"expression", "."}]}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Assign", " ", "weight", " ", "2", " ", "to", " ", "Plus", " ", 
       "instead", " ", "of", " ", 
       RowBox[{"one", "."}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Chains", " ", "get", " ", "a", " ", "bonus"}], " ", "-", 
       "3"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fullexp", "=", 
       RowBox[{"exp", "//", "FullForm"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"complexity", "=", 
       RowBox[{
        RowBox[{"LeafCount", "[", "exp", "]"}], "+", 
        RowBox[{"Count", "[", 
         RowBox[{"fullexp", ",", "_Plus", ",", "Infinity"}], "]"}], "-", 
        RowBox[{"3", "*", 
         RowBox[{"Count", "[", 
          RowBox[{"fullexp", ",", "_Chain", ",", "Infinity"}], "]"}]}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "complexity", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.794833524358009*^9, 3.79483352990008*^9}, {
  3.794833685124942*^9, 3.7948338259642906`*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"93983415-669e-4b44-99e3-d57339b58d41"],

Cell[BoxData[
 RowBox[{"DeclareMom", "[", 
  RowBox[{"p1", ",", "p2", ",", "p3", ",", "p4"}], "]"}]], "Input",
 CellLabel->"In[49]:=",ExpressionUUID->"88009d24-723a-4d43-807a-06b873ad3322"],

Cell[BoxData[
 RowBox[{"KillMasses", "[", 
  RowBox[{"{", 
   RowBox[{"p1", ",", "p2", ",", "p3", ",", "p4"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.7948342006665525`*^9, 3.79483420734696*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"337d791a-bdc7-42e4-a0bb-538bde17b260"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"exp", "//", "ToChain"}], ",", 
   RowBox[{"TransformationFunctions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Automatic", ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p4", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p3"}], "-", "p1", "-", "p2"}]}], "}"}]}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainToSpinor", "[", "e", "]"}]}]}], "}"}]}], ",", 
   RowBox[{"ComplexityFunction", "\[Rule]", "MyComplexityFunction"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.7948340546114397`*^9, {3.7948341073366528`*^9, 3.794834181995391*^9}, {
   3.794834253382019*^9, 3.794834272175599*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"3cbb542e-bde6-4f70-935e-724aca68c331"],

Cell[BoxData[
 RowBox[{"2", " ", 
  TemplateBox[{"p1",RowBox[{"{", "p3", "}"}],"p2"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{
  3.794833838087232*^9, 3.7948340561823316`*^9, {3.794834108637062*^9, 
   3.7948342435815845`*^9}, 3.794834275573783*^9, 3.7948988812657394`*^9, 
   3.794917569142499*^9},
 CellLabel->"Out[51]=",ExpressionUUID->"e520297e-3c2d-4870-a8e3-448888368819"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "MyComplexityFunction"}]], "Input",
 CellChangeTimes->{{3.79483428425476*^9, 3.794834288272998*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"437a4056-35c5-437b-837b-00f14d03a3fe"],

Cell[BoxData["6"], "Output",
 CellChangeTimes->{3.7948342887191095`*^9, 3.794898881341537*^9, 
  3.7949175692505064`*^9},
 CellLabel->"Out[52]=",ExpressionUUID->"3ffc0496-9e4c-4591-8310-ad4ac3e7093c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%%", "//", "ChainToSpinor"}], "//", 
  "MyComplexityFunction"}]], "Input",
 CellChangeTimes->{{3.7948342948209076`*^9, 3.7948343053762074`*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"492245b6-0b60-401e-bd4a-6effec043d60"],

Cell[BoxData["8"], "Output",
 CellChangeTimes->{3.7948343058507853`*^9, 3.7948988814133806`*^9, 
  3.7949175693368263`*^9},
 CellLabel->"Out[53]=",ExpressionUUID->"86fd0357-1d6c-4b83-a950-3328de125d37"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "But", " ", "I", " ", "like", " ", "my", " ", "expressions", " ", "split", 
   " ", "up", " ", "into", " ", "spinors", " ", "so", " ", "let", " ", "us", 
   " ", "try", " ", "weighting", " ", "the", " ", "chains", " ", "just", " ", 
   "slightly", " ", "more", " ", "that", " ", "the", " ", "angle", " ", "and",
    " ", "square", " ", "brackets"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7948343642676*^9, 3.7948344102818794`*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"454db8df-990b-450a-879d-ffddf4506940"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MyComplexityFunction", "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"complexity", ",", "fullexp"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Take", " ", 
       RowBox[{"Mathematica", "'"}], "s", " ", "LeafCount", " ", "as", " ", 
       "a", " ", "reference", " ", "and", " ", "add", " ", "penalties", " ", 
       "for", " ", "every", " ", "Plus", " ", "in", " ", "the", " ", 
       RowBox[{"expression", "."}]}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Assign", " ", "weight", " ", "2", " ", "to", " ", "Plus", " ", 
       "instead", " ", "of", " ", 
       RowBox[{"one", "."}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Chains", " ", "get", " ", "a", " ", "bonus"}], " ", "-", 
       "2"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fullexp", "=", 
       RowBox[{"exp", "//", "FullForm"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"complexity", "=", 
       RowBox[{
        RowBox[{"LeafCount", "[", "exp", "]"}], "+", 
        RowBox[{"Count", "[", 
         RowBox[{"fullexp", ",", "_Plus", ",", "Infinity"}], "]"}], "-", 
        RowBox[{"2", "*", 
         RowBox[{"Count", "[", 
          RowBox[{"fullexp", ",", "_Chain", ",", "Infinity"}], "]"}]}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "complexity", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7948344147760572`*^9, 3.7948344211603947`*^9}, {
  3.7948345078570995`*^9, 3.794834530732627*^9}, {3.7948345740241146`*^9, 
  3.794834574855351*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"4da96940-34eb-4b77-b240-17dc04ab9fd8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"exp", "//", "ToChain"}], ",", 
   RowBox[{"TransformationFunctions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Automatic", ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p4", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p3"}], "-", "p1", "-", "p2"}]}], "}"}]}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainToSpinor", "[", "e", "]"}]}]}], "}"}]}], ",", 
   RowBox[{"ComplexityFunction", "\[Rule]", "MyComplexityFunction"}]}], 
  "]"}]], "Input",
 CellLabel->"In[56]:=",ExpressionUUID->"e3b26ab3-2a6b-46fd-be46-062fbc8c8f39"],

Cell[BoxData[
 RowBox[{"2", " ", 
  TemplateBox[{"p1",RowBox[{"{", "p3", "}"}],"p2"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{
  3.794834434458729*^9, {3.7948345102530093`*^9, 3.7948345338091383`*^9}, 
   3.7948345764422555`*^9, 3.794898881517067*^9, 3.7949175696126156`*^9},
 CellLabel->"Out[56]=",ExpressionUUID->"83040038-adab-4be5-84f9-491dd7500a61"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "MyComplexityFunction"}]], "Input",
 CellChangeTimes->{{3.794834439727594*^9, 3.794834443263024*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"27a4df50-97f4-4e2e-978a-d9db446566e6"],

Cell[BoxData["7"], "Output",
 CellChangeTimes->{3.7948344438332834`*^9, 3.794834535949165*^9, 
  3.7948345776353106`*^9, 3.794898881591867*^9, 3.7949175696934395`*^9},
 CellLabel->"Out[57]=",ExpressionUUID->"c939702f-0b0a-4b69-a4dd-50a5bb86c107"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%%", "//", "ChainToSpinor"}], "//", 
  "MyComplexityFunction"}]], "Input",
 CellChangeTimes->{{3.794834445948348*^9, 3.7948344527885723`*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"e7d34b8e-a909-4ac5-814f-e0582a4641be"],

Cell[BoxData["8"], "Output",
 CellChangeTimes->{3.7948344531812363`*^9, 3.794834537687829*^9, 
  3.7948345786659727`*^9, 3.794898881661681*^9, 3.794917569784197*^9},
 CellLabel->"Out[58]=",ExpressionUUID->"eb574039-8f66-449d-9575-d6fc39259c9f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "The", " ", "problem", " ", "is", " ", "that", " ", "the", " ", "a", " ", 
   "single", " ", "chain", " ", "will", " ", "always", " ", "be", " ", 
   "favoured", " ", "with", " ", "respect", " ", "to", " ", "a", " ", 
   "multiple", " ", 
   RowBox[{"brackets", ".", " ", "And"}], " ", "if", " ", "they", " ", 
   "would", " ", "not", " ", "be", " ", "favoured", " ", "you", " ", "would", 
   " ", "not", " ", "get", " ", "the", " ", "replacement", " ", "in", " ", 
   "the", " ", "first", " ", "place"}], "*)"}]], "Input",
 CellChangeTimes->{{3.794834569397515*^9, 3.7948346486224194`*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"b484cfcd-4c7a-4d01-a74c-bf054a8e2469"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Let", "'"}], "s", " ", "see", " ", "if", " ", "it", " ", "still", 
   " ", "works", " ", "even", " ", "if", " ", "we", " ", "do", " ", "not", 
   " ", "apply", " ", "only", " ", "the", " ", "right", " ", "momentum", " ", 
   "conservation", " ", "but", " ", "give", " ", "him", " ", "multiple", " ", 
   "options"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7948347192936697`*^9, 3.7948347623801384`*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"03b16a68-ae64-4fef-a7f9-44010c215196"],

Cell[CellGroupData[{

Cell[BoxData["exp"], "Input",
 CellChangeTimes->{{3.7948347727678747`*^9, 3.7948347731926727`*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"6f0b48c3-f3eb-4d3f-aa76-e6200eb90094"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    TemplateBox[{"p1","p3"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], " ", 
   TemplateBox[{"p2","p3"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
  RowBox[{
   TemplateBox[{"p1","p4"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], " ", 
   TemplateBox[{"p2","p4"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.7948347736163206`*^9, 3.7948988817654033`*^9, 
  3.794917569975684*^9},
 CellLabel->"Out[61]=",ExpressionUUID->"e44a3537-87f5-47c9-8b2e-0c6d6e5c4d8c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"exp", "//", "ToChain"}], ",", 
   RowBox[{"TransformationFunctions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Automatic", ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p4", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p3"}], "-", "p1", "-", "p2"}]}], "}"}]}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p3", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p4"}], "-", "p1", "-", "p2"}]}], "}"}]}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p2", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p3"}], "-", "p1", "-", "p4"}]}], "}"}]}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p1", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p3"}], "-", "p4", "-", "p2"}]}], "}"}]}], "}"}]}],
         "]"}]}]}], "}"}]}], ",", 
   RowBox[{"ComplexityFunction", "\[Rule]", "MyComplexityFunction"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7948347823379245`*^9, 3.7948348220171947`*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"5e06e864-3c0c-4013-ab04-9417ecd97f61"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "2"}], " ", 
  TemplateBox[{"p1",RowBox[{"{", "p4", "}"}],"p2"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{3.794834823782395*^9, 3.794898881849179*^9, 
  3.7949175700694337`*^9},
 CellLabel->"Out[62]=",ExpressionUUID->"a9439168-f535-4aa3-8aa2-d028ac3519bd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "ChainToSpinor"}]], "Input",
 CellChangeTimes->{{3.794834837857173*^9, 3.794834841943099*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"bfb01a80-a7f1-4365-bec5-0f56481cbece"],

Cell[BoxData[
 RowBox[{"2", " ", 
  TemplateBox[{"p1","p4"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], " ", 
  TemplateBox[{"p2","p4"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )]}]], "Output",
 CellChangeTimes->{3.794834843565708*^9, 3.7948988819309597`*^9, 
  3.7949175701581974`*^9},
 CellLabel->"Out[63]=",ExpressionUUID->"118497bf-1245-453e-8a2d-ce34487821e5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "What", " ", "if", " ", "conversion", " ", "to", " ", "spinors", " ", 
   "supersimplifies", " ", 
   RowBox[{"everything", "?"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.794834862348437*^9, 3.794834878073145*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"0440ded2-b37a-4907-b94f-9ef8da565350"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"exp", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       TemplateBox[{"p1","p3"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}], " ", 
      TemplateBox[{"p2","p3"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
     RowBox[{
      TemplateBox[{"p1","p4"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"p2","p4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     TemplateBox[{"p1","p4"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], 
     TemplateBox[{"p4","p2"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.79483488636576*^9, 3.7948349236691065`*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"471b4f96-5ec7-448d-a908-0a7e40bc4ab9"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      TemplateBox[{"p1","p3"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], " ", 
     TemplateBox[{"p2","p3"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
    RowBox[{
     TemplateBox[{"p1","p4"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], " ", 
     TemplateBox[{"p2","p4"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}]}], 
   RowBox[{
    TemplateBox[{"p1","p4"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"p2","p4"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}]]}]], "Output",
 CellChangeTimes->{3.794834926405879*^9, 3.7948988820286984`*^9, 
  3.7949175703142996`*^9},
 CellLabel->"Out[65]=",ExpressionUUID->"33826614-6d2e-4937-9be1-aac701d4fb26"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"exp", "//", "ToChain"}], ",", 
   RowBox[{"TransformationFunctions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Automatic", ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p4", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p3"}], "-", "p1", "-", "p2"}]}], "}"}]}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p3", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p4"}], "-", "p1", "-", "p2"}]}], "}"}]}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p2", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p3"}], "-", "p1", "-", "p4"}]}], "}"}]}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p1", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p3"}], "-", "p4", "-", "p2"}]}], "}"}]}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainToSpinor", "[", "e", "]"}]}]}], "}"}]}], ",", 
   RowBox[{"ComplexityFunction", "\[Rule]", "MyComplexityFunction"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.794834938212979*^9, 3.7948349567252417`*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"6f37de32-7ed5-426a-9ca8-87c994ee8584"],

Cell[BoxData[
 RowBox[{"-", "2"}]], "Output",
 CellChangeTimes->{3.7948349587553616`*^9, 3.794898882142394*^9, 
  3.794917570408098*^9},
 CellLabel->"Out[66]=",ExpressionUUID->"dba60305-be33-497c-a711-956ed40d86a3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"It", " ", 
   RowBox[{"fu", "--"}], "ing", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"works", "!!"}], "!!"}], "!"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7948349721518*^9, 3.7948349991883802`*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"2ffda866-7eaf-43f4-95b1-05f94799ee12"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"exp", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       TemplateBox[{"p1","p3"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}], " ", 
      TemplateBox[{"p2","p3"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
     RowBox[{
      TemplateBox[{"p1","p4"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"p2","p4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     TemplateBox[{"p1","p3"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], 
     TemplateBox[{"p3","p2"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.794835013166479*^9, 3.7948350158902473`*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"ad10e5a6-299e-40ef-ad00-b100fa0c59c3"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      TemplateBox[{"p1","p3"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], " ", 
     TemplateBox[{"p2","p3"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
    RowBox[{
     TemplateBox[{"p1","p4"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], " ", 
     TemplateBox[{"p2","p4"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}]}], 
   RowBox[{
    TemplateBox[{"p1","p3"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"p2","p3"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}]]}]], "Output",
 CellChangeTimes->{3.794835016681785*^9, 3.7948988822391367`*^9, 
  3.7949175706364775`*^9},
 CellLabel->"Out[68]=",ExpressionUUID->"92c84951-af05-4f2b-9d4f-08594604fc53"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"exp", "//", "ToChain"}], ",", 
   RowBox[{"TransformationFunctions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Automatic", ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p4", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p3"}], "-", "p1", "-", "p2"}]}], "}"}]}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p3", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p4"}], "-", "p1", "-", "p2"}]}], "}"}]}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p2", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p3"}], "-", "p1", "-", "p4"}]}], "}"}]}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p1", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p3"}], "-", "p4", "-", "p2"}]}], "}"}]}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainToSpinor", "[", "e", "]"}]}]}], "}"}]}], ",", 
   RowBox[{"ComplexityFunction", "\[Rule]", "MyComplexityFunction"}]}], 
  "]"}]], "Input",
 CellLabel->"In[69]:=",ExpressionUUID->"6457b33e-f4e6-4596-8ca4-fe1d3dfab268"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{3.794835045850504*^9, 3.79489888231796*^9, 
  3.794917570720445*^9},
 CellLabel->"Out[69]=",ExpressionUUID->"39d1a75e-e643-483d-9768-53db813b3237"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"exp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        TemplateBox[{"p1","p3"},
         "SpinorAngleBracket",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
            RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
         InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
            RowBox[{#, ",", #2}], "]"}]& )]}], " ", 
       TemplateBox[{"p2","p3"},
        "SpinorSquareBracket",
        DisplayFunction->(RowBox[{"[", 
           RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
        InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
      RowBox[{
       TemplateBox[{"p1","p4"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], " ", 
       TemplateBox[{"p2","p4"},
        "SpinorSquareBracket",
        DisplayFunction->(RowBox[{"[", 
           RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
        InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      TemplateBox[{"p1","p3"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], 
      TemplateBox[{"p3","p2"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], ")"}]}], "+", 
   RowBox[{
    TemplateBox[{"p1","p2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], 
    TemplateBox[{"p3","p4"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
   RowBox[{
    TemplateBox[{"p1","p2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], 
    TemplateBox[{"p2","p4"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}]}]}]], "Input",
 CellChangeTimes->{{3.794835282504982*^9, 3.794835333999653*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"b381028e-1fa7-4969-99be-ca2f11ad055a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{"p1","p2"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], " ", 
   TemplateBox[{"p2","p4"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      TemplateBox[{"p1","p3"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], " ", 
     TemplateBox[{"p2","p3"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
    RowBox[{
     TemplateBox[{"p1","p4"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], " ", 
     TemplateBox[{"p2","p4"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}]}], 
   RowBox[{
    TemplateBox[{"p1","p3"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"p2","p3"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}]], "+", 
  RowBox[{
   TemplateBox[{"p1","p2"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], " ", 
   TemplateBox[{"p3","p4"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.7948353024165897`*^9, 3.794835335645603*^9, 
  3.7948988824007034`*^9, 3.7949175708122044`*^9},
 CellLabel->"Out[70]=",ExpressionUUID->"30d98447-2483-414e-b689-03dc74980bba"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"exp", "//", "ToChain"}], ",", 
   RowBox[{"TransformationFunctions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Automatic", ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p4", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p3"}], "-", "p1", "-", "p2"}]}], "}"}]}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p3", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p4"}], "-", "p1", "-", "p2"}]}], "}"}]}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p2", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p3"}], "-", "p1", "-", "p4"}]}], "}"}]}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p1", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p3"}], "-", "p4", "-", "p2"}]}], "}"}]}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainToSpinor", "[", "e", "]"}]}]}], "}"}]}], ",", 
   RowBox[{"ComplexityFunction", "\[Rule]", "MyComplexityFunction"}]}], 
  "]"}]], "Input",
 CellLabel->"In[71]:=",ExpressionUUID->"59606b13-c4e4-44a1-a1b7-e367a58f13a8"],

Cell[BoxData[
 RowBox[{"2", "+", 
  TemplateBox[{"p1",RowBox[{"{", "p2", "}"}],"p4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "+", 
  RowBox[{
   TemplateBox[{"p1","p2"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], " ", 
   TemplateBox[{"p3","p4"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}]}]], "Output",
 CellChangeTimes->{{3.7948353118046494`*^9, 3.7948353385999575`*^9}, 
   3.794898882479494*^9, 3.7949175709019775`*^9},
 CellLabel->"Out[71]=",ExpressionUUID->"93219c26-ebf1-410e-b41f-07fa666f6904"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"exp", ",", 
   RowBox[{"TransformationFunctions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Automatic", ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ToChain", "[", "e", "]"}]}], ",", " ", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p4", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p3"}], "-", "p1", "-", "p2"}]}], "}"}]}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p3", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p4"}], "-", "p1", "-", "p2"}]}], "}"}]}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p2", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p3"}], "-", "p1", "-", "p4"}]}], "}"}]}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p1", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p3"}], "-", "p4", "-", "p2"}]}], "}"}]}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainToSpinor", "[", "e", "]"}]}]}], "}"}]}], ",", 
   RowBox[{"ComplexityFunction", "\[Rule]", "MyComplexityFunction"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7948355627748623`*^9, 3.794835582830015*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"e86e3f48-89f1-4a65-afa5-0c917b6a87ed"],

Cell[BoxData[
 RowBox[{"2", "+", 
  TemplateBox[{"p1",RowBox[{"{", "p2", "}"}],"p4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "+", 
  RowBox[{
   TemplateBox[{"p1","p2"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], " ", 
   TemplateBox[{"p3","p4"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.794835584270269*^9, 3.7948988825592794`*^9, 
  3.79491757099743*^9},
 CellLabel->"Out[72]=",ExpressionUUID->"77f3858d-57d4-4ab1-ba33-8be86b42a209"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"exp", "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.794835509671913*^9, 3.794835512900898*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"1193336c-d8d9-4724-88ac-b08f3916684f"],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   RowBox[{
    TemplateBox[{"p1","p4"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"p2","p4"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], 
   RowBox[{
    TemplateBox[{"p1","p3"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"p2","p3"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}]], "+", 
  RowBox[{
   TemplateBox[{"p1","p2"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], " ", 
   RowBox[{"(", 
    RowBox[{
     TemplateBox[{"p2","p4"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "+", 
     TemplateBox[{"p3","p4"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.794835513320262*^9, 3.794835591861888*^9, 
  3.7948988826261005`*^9, 3.7949175710907354`*^9},
 CellLabel->"Out[73]=",ExpressionUUID->"a46ab131-7558-4904-b29c-fabede502ad4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"%", "//", "ToChain"}], ",", 
   RowBox[{"TransformationFunctions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Automatic", ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p4", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p3"}], "-", "p1", "-", "p2"}]}], "}"}]}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p3", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p4"}], "-", "p1", "-", "p2"}]}], "}"}]}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p2", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p3"}], "-", "p1", "-", "p4"}]}], "}"}]}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p1", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p3"}], "-", "p4", "-", "p2"}]}], "}"}]}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainToSpinor", "[", "e", "]"}]}]}], "}"}]}], ",", 
   RowBox[{"ComplexityFunction", "\[Rule]", "MyComplexityFunction"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{3.794835531363705*^9},
 CellLabel->"In[74]:=",ExpressionUUID->"df5910af-2f4b-4316-8e13-1e697c133bfe"],

Cell[BoxData[
 RowBox[{"2", "+", 
  TemplateBox[{"p1",RowBox[{"{", "p2", "}"}],"p4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "+", 
  RowBox[{
   TemplateBox[{"p1","p2"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], " ", 
   TemplateBox[{"p3","p4"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.7948355361512003`*^9, 3.7948355943208838`*^9, 
  3.7948988827048903`*^9, 3.794917571178042*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"a5117860-7c0a-4ee6-9ba5-fbe0ce03e07b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"exp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        TemplateBox[{"p1","p3"},
         "SpinorAngleBracket",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
            RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
         InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
            RowBox[{#, ",", #2}], "]"}]& )]}], " ", 
       TemplateBox[{"p2","p3"},
        "SpinorSquareBracket",
        DisplayFunction->(RowBox[{"[", 
           RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
        InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
      RowBox[{
       TemplateBox[{"p1","p4"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], " ", 
       TemplateBox[{"p2","p4"},
        "SpinorSquareBracket",
        DisplayFunction->(RowBox[{"[", 
           RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
        InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      TemplateBox[{"p1","p3"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], 
      TemplateBox[{"p3","p2"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        TemplateBox[{"p3","p1"},
         "SpinorAngleBracket",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
            RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
         InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
            RowBox[{#, ",", #2}], "]"}]& )]}], " ", 
       TemplateBox[{"p4","p1"},
        "SpinorSquareBracket",
        DisplayFunction->(RowBox[{"[", 
           RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
        InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
      RowBox[{
       TemplateBox[{"p3","p2"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], " ", 
       TemplateBox[{"p4","p2"},
        "SpinorSquareBracket",
        DisplayFunction->(RowBox[{"[", 
           RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
        InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      TemplateBox[{"p3","p1"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], 
      TemplateBox[{"p1","p4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.794898951818033*^9, 3.7948989939433603`*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"8d8b6b9d-63f9-4064-b86e-440cb1c7ebb8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       TemplateBox[{"p1","p3"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}], " ", 
      TemplateBox[{"p2","p3"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
     RowBox[{
      TemplateBox[{"p1","p4"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"p2","p4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}]}], 
    RowBox[{
     TemplateBox[{"p1","p3"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], " ", 
     TemplateBox[{"p2","p3"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}]]}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      TemplateBox[{"p1","p3"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], " ", 
     TemplateBox[{"p1","p4"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
    RowBox[{
     TemplateBox[{"p2","p3"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], " ", 
     TemplateBox[{"p2","p4"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}]}], 
   RowBox[{
    TemplateBox[{"p1","p3"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"p1","p4"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}]]}]], "Output",
 CellChangeTimes->{3.7948989948658934`*^9, 3.794917571276811*^9},
 CellLabel->"Out[75]=",ExpressionUUID->"6dac733b-1251-4b25-8573-c0fdd62caa00"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"exp", ",", 
   RowBox[{"TransformationFunctions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Automatic", ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p4", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p3"}], "-", "p1", "-", "p2"}]}], "}"}]}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p3", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p4"}], "-", "p1", "-", "p2"}]}], "}"}]}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p2", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p3"}], "-", "p1", "-", "p4"}]}], "}"}]}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"p1", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "p3"}], "-", "p4", "-", "p2"}]}], "}"}]}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"e", "\[Function]", 
       RowBox[{"ChainToSpinor", "[", "e", "]"}]}], ",", 
      RowBox[{"e", " ", "\[Function]", " ", 
       RowBox[{"ToChain", "[", "e", "]"}]}]}], "}"}]}], ",", 
   RowBox[{"ComplexityFunction", "\[Rule]", "MyComplexityFunction"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7948990173976264`*^9, 3.794899017812558*^9}, {
  3.7948991963851485`*^9, 3.7948992062556944`*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"4d089848-ba07-4ea5-ad62-a2f9c1c83857"],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{3.794899018901602*^9, 3.794899207340791*^9, 
  3.7949175713725224`*^9},
 CellLabel->"Out[76]=",ExpressionUUID->"51db4325-2db3-41d4-af0f-f6ff60718ff9"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Most up to date complexity function", "Subsection",
 CellChangeTimes->{{3.794834676688437*^9, 
  3.794834698356505*^9}},ExpressionUUID->"6297f114-cdad-41e3-abb0-\
bb426814590c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MyComplexityFunction", "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"complexity", ",", "fullexp"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Take", " ", 
       RowBox[{"Mathematica", "'"}], "s", " ", "LeafCount", " ", "as", " ", 
       "a", " ", "reference", " ", "and", " ", "add", " ", "penalties", " ", 
       "for", " ", "every", " ", "Plus", " ", "in", " ", "the", " ", 
       RowBox[{"expression", "."}]}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Assign", " ", "weight", " ", "2", " ", "to", " ", "Plus", " ", 
       "instead", " ", "of", " ", 
       RowBox[{"one", "."}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Chains", " ", "get", " ", "a", " ", "bonus"}], " ", "-", 
       "2"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fullexp", "=", 
       RowBox[{"exp", "//", "FullForm"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"complexity", "=", 
       RowBox[{
        RowBox[{"LeafCount", "[", "exp", "]"}], "+", 
        RowBox[{"Count", "[", 
         RowBox[{"fullexp", ",", "_Plus", ",", "Infinity"}], "]"}], "-", 
        RowBox[{"2", "*", 
         RowBox[{"Count", "[", 
          RowBox[{"fullexp", ",", "_Chain", ",", "Infinity"}], "]"}]}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "complexity", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.794833524358009*^9, 3.79483352990008*^9}, {
  3.794833685124942*^9, 3.7948338259642906`*^9}, {3.79483514025838*^9, 
  3.7948351436577015`*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"551abd8e-c2ba-46ed-9c50-f8534dd82ab8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["SpinorSimplify", "Subsection",
 CellChangeTimes->{{3.794899361354848*^9, 
  3.794899366669632*^9}},ExpressionUUID->"c269fc68-70a2-44c5-8f76-\
de033f01c940"],

Cell["\<\
(*Notice that we set ReduceComplete to False, might be relevant later on. \
Also we still have to take scalar products and S4 into account*)\
\>", "Text",
 CellChangeTimes->{
  3.794907198909938*^9, {3.794907279681918*^9, 3.79490729468773*^9}},
 FontColor->RGBColor[
  0, 0, 1],ExpressionUUID->"3b98d28b-e340-47d1-b800-f803fea4afa4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SpinorSimplify", "[", 
    RowBox[{"exp_", ",", "MomConservation_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "momcon", ",", "mom", ",", "momlist", ",", "transformationfunctions", 
       ",", "locexp"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "First", " ", "we", " ", "build", " ", "all", " ", "the", " ", 
       "replacements", " ", "which", " ", "are", " ", "given", " ", "by", " ",
        "momentum", " ", 
       RowBox[{"conservation", "."}]}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Exract", " ", "all", " ", "the", " ", "momenta", " ", "present", " ", 
       "in", " ", "the", " ", "relations"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"momlist", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mom", "[", "x_", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"momlist", ",", "x"}], "]"}], ",", "x", ",", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"momlist", ",", "x"}], "]"}], ";", "x"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"momcon", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"{", "MomConservation", "}"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"A_", "/;", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"MomList", ",", "A"}], "]"}]}], "\[RuleDelayed]", 
            RowBox[{"mom", "[", "A", "]"}]}], ",", 
           RowBox[{"Rule", "\[Rule]", "Equal"}], ",", 
           RowBox[{"RuleDelayed", "\[Rule]", "Equal"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Generate", " ", "Chainsimplify", " ", "with", " ", "each", " ", 
        "single", " ", "momentum", " ", "conservation", " ", "relation", " ", 
        RowBox[{"applied", "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"transformationfunctions", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"transformationfunctions", "=", 
         RowBox[{"{", 
          RowBox[{"transformationfunctions", ",", 
           RowBox[{"Solve", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "momcon"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "momlist"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"transformationfunctions", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"j", "=", "i"}], "}"}], ",", 
           RowBox[{"e", " ", "\[Function]", 
            RowBox[{"ChainSimplify", "[", 
             RowBox[{"e", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"MomCon", "\[Rule]", 
                 RowBox[{"{", "j", "}"}]}], ",", 
                RowBox[{"ReduceComplete", "\[Rule]", "False"}]}], "}"}]}], 
             "]"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Flatten", "[", "transformationfunctions", "]"}]}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Now", " ", "add", " ", "the", " ", "functions", " ", "which", " ", 
        "transform", " ", "backa", " ", "and", " ", "forth", " ", "among", 
        " ", "Chains", " ", "and", " ", "spinor", " ", "brackets", " ", "as", 
        " ", "well", " ", "as", " ", "the", " ", "automatic", " ", 
        "functions"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"transformationfunctions", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Automatic", ",", 
          RowBox[{"e", " ", "\[Function]", " ", 
           RowBox[{"ToChain", "[", "e", "]"}]}], ",", 
          RowBox[{"e", " ", "\[Function]", " ", 
           RowBox[{"ChainToSpinor", "[", "e", "]"}]}], ",", 
          "transformationfunctions"}], "}"}], "//", "Flatten"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Now", " ", "apply", " ", "the", " ", "simplification", " ", "using", 
        " ", "the", " ", "custom", " ", "ComplexityFunction"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"locexp", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"exp", ",", 
         RowBox[{"ComplexityFunction", "\[Rule]", "MyComplexityFunction"}], 
         ",", 
         RowBox[{
         "TransformationFunctions", "\[Rule]", "transformationfunctions"}], 
         ",", 
         RowBox[{"Trig", "\[Rule]", "False"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "locexp", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.794899370708829*^9, 3.7948994205432653`*^9}, {
   3.7948995033287287`*^9, 3.7948995570191135`*^9}, {3.794899610118097*^9, 
   3.794899699994702*^9}, {3.7948997838683643`*^9, 3.794899844058318*^9}, {
   3.7948999026965313`*^9, 3.794899952057505*^9}, {3.794900360662902*^9, 
   3.794900363752631*^9}, {3.794900394263033*^9, 3.7949004220407333`*^9}, {
   3.79490075118358*^9, 3.794900788134098*^9}, 3.794905359728526*^9, {
   3.794905396507148*^9, 3.7949054151064415`*^9}, {3.794905454420247*^9, 
   3.794905587945136*^9}, {3.794905646458642*^9, 3.7949059421417675`*^9}, {
   3.794905985883774*^9, 3.7949060037090845`*^9}, {3.794906106991843*^9, 
   3.794906247514983*^9}, {3.794906281173918*^9, 3.794906351265482*^9}, {
   3.794906384508526*^9, 3.7949064764785614`*^9}, {3.7949065255143766`*^9, 
   3.794906655999401*^9}, {3.7949071599720955`*^9, 3.7949071847218904`*^9}, {
   3.794907242998023*^9, 3.794907248594055*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"d12e89f2-9bc9-413f-8316-89a30d896afd"],

Cell[CellGroupData[{

Cell[BoxData["MomList"], "Input",
 CellChangeTimes->{{3.794900314501371*^9, 3.7949003156931343`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"99c6aef7-d244-4dfd-b4ef-f9433736c888"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.7949003160482335`*^9, 3.7949175716558056`*^9, 
  3.7951570384811974`*^9, 3.7951784218446136`*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"bd4fb959-5ee6-4974-8b08-09e82e9576d9"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"DeclareMom", "[", 
  RowBox[{"l1", ",", "l2"}], "]"}]], "Input",
 CellChangeTimes->{{3.7949008030282683`*^9, 3.7949008072559547`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"d45e5d41-efb3-4c9e-8423-6d223b8e5074"],

Cell[CellGroupData[{

Cell[BoxData["exp"], "Input",
 CellChangeTimes->{{3.7949066633317533`*^9, 3.794906663680846*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"83f33728-2769-4fc2-98fd-4402697eb61b"],

Cell[BoxData["exp"], "Output",
 CellChangeTimes->{3.7949066642872353`*^9, 3.7949175718153377`*^9, 
  3.795157038603902*^9, 3.7951784219283905`*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"5568104a-f546-4b5b-a3f5-3c821629b3d1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpinorSimplify", "[", 
  RowBox[{"exp", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p1", "+", "p2", "+", "p3", "+", "p4"}], "\[Rule]", "0"}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.794905958878008*^9, {3.7949066798007407`*^9, 3.7949066896005297`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"40c4d349-5ab9-4415-861b-597b5e290883"],

Cell[BoxData["exp"], "Output",
 CellChangeTimes->{
  3.7949059602074413`*^9, 3.794906006416849*^9, 3.7949062561847897`*^9, 
   3.7949063100686674`*^9, 3.794906355088214*^9, 3.794906480123811*^9, {
   3.794906647182973*^9, 3.794906690115153*^9}, 3.7949072551894073`*^9, 
   3.794917571912077*^9, 3.7951570386926312`*^9, 3.7951784219862022`*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"0da9c3d0-88b3-4e4d-a684-d8d7c28ad2a2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpinorSimplify", "[", 
  RowBox[{"exp", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"l1", "+", "l2", "+", "p1", "+", "p2"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"l1", "+", "l2"}], "\[Rule]", 
      RowBox[{"p3", "+", "p4"}]}], ",", 
     RowBox[{
      RowBox[{"p1", "+", "p2", "+", "p3", "+", "p4"}], "\[Rule]", "0"}]}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.794899959709038*^9, 3.7948999670393763`*^9}, {
  3.794900304341528*^9, 3.7949003092982893`*^9}, {3.7949004462310295`*^9, 
  3.794900470750437*^9}, {3.794906785991666*^9, 3.794906798671782*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"d8f7adf9-a759-4520-b917-ca073a8cf4f5"],

Cell[BoxData["exp"], "Output",
 CellChangeTimes->{
  3.7949003099156218`*^9, 3.794900367256216*^9, {3.794900408478987*^9, 
   3.7949004243186235`*^9}, 3.794900472189597*^9, {3.7949007947813063`*^9, 
   3.7949008094670353`*^9}, 3.7949060114114943`*^9, {3.794906779884039*^9, 
   3.794906799627231*^9}, 3.794907256162803*^9, 3.7949175720058613`*^9, 
   3.795157038766477*^9, 3.795178422051053*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"c4fe37ef-17e4-4116-a26a-83cd86b506dc"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["SchoutenSimplify, to be fixed...", "Subsection",
 CellChangeTimes->{{3.7949176012173934`*^9, 3.794917606120383*^9}, {
  3.802168931083971*^9, 
  3.802168934622504*^9}},ExpressionUUID->"5147d733-e51f-47b2-9b16-\
638b7b55c01c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"exp", "=", 
  RowBox[{
   RowBox[{
    TemplateBox[{"p1","p2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], 
    TemplateBox[{"p3","p4"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
   RowBox[{
    TemplateBox[{"p1","p3"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], 
    TemplateBox[{"p4","p2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}]}]}]], "Input",
 CellChangeTimes->{{3.7949176365935326`*^9, 3.7949176758000493`*^9}, {
  3.794917749709675*^9, 3.7949177616859035`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"eaf8f1cc-5026-4e5e-a08f-42d741cf16f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    TemplateBox[{"p1","p3"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], " ", 
   TemplateBox[{"p2","p4"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
  RowBox[{
   TemplateBox[{"p1","p2"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], " ", 
   TemplateBox[{"p3","p4"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}]}]], "Output",
 CellChangeTimes->{
  3.794917676397771*^9, {3.794917751470582*^9, 3.7949177620818434`*^9}, 
   3.795157048491457*^9, 3.79517843783086*^9, 3.7966496105773177`*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"8ac7ca90-332e-4d90-a7e6-70fef3f5c387"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"exp", "//", "SchoutenSimplify"}]], "Input",
 CellChangeTimes->{{3.7949177634523964`*^9, 3.7949177647470455`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"3d3d420a-16ca-4b79-bf5a-1cfffd146e5d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   TemplateBox[{"p1","p4"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}], " ", 
  TemplateBox[{"p2","p3"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )]}]], "Output",
 CellChangeTimes->{3.7949177656606617`*^9, 3.795157048792652*^9, 
  3.795178438071211*^9, 3.796649610762847*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"a06ccc58-2799-4033-a2d2-2f7ced9c41a4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"exp", ",", 
   RowBox[{"TransformationFunctions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Automatic", ",", 
      RowBox[{"e", " ", "\[Function]", " ", 
       RowBox[{"e", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"SpinorAngleBracket", "[", 
            RowBox[{"x_", ",", "y_"}], "]"}], "*", 
           RowBox[{"SpinorAngleBracket", "[", 
            RowBox[{"z_", ",", "k_"}], "]"}]}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"SpinorAngleBracket", "[", 
              RowBox[{"x", ",", "z"}], "]"}]}], 
            RowBox[{"SpinorAngleBracket", "[", 
             RowBox[{"k", ",", "y"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"SpinorAngleBracket", "[", 
             RowBox[{"x", ",", "k"}], "]"}], 
            RowBox[{"SpinorAngleBracket", "[", 
             RowBox[{"y", ",", "z"}], "]"}]}]}]}], "}"}]}]}], ",", 
      RowBox[{"e", " ", "\[Function]", " ", 
       RowBox[{"e", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"SpinorSquareBracket", "[", 
            RowBox[{"x_", ",", "y_"}], "]"}], "*", 
           RowBox[{"SpinorSquareBracket", "[", 
            RowBox[{"z_", ",", "k_"}], "]"}]}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"SpinorSquareBracket", "[", 
              RowBox[{"x", ",", "z"}], "]"}]}], 
            RowBox[{"SpinorSquareBracket", "[", 
             RowBox[{"k", ",", "y"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"SpinorSquareBracket", "[", 
             RowBox[{"x", ",", "k"}], "]"}], 
            RowBox[{"SpinorSquareBracket", "[", 
             RowBox[{"y", ",", "z"}], "]"}]}]}]}], "}"}]}]}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7949177711747665`*^9, 3.7949178072470317`*^9}, {
  3.794917850833106*^9, 3.794917855050674*^9}, {3.7949178962011733`*^9, 
  3.7949179510395694`*^9}, {3.794918301043067*^9, 3.7949183255371356`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"eec92a9c-18e1-41dd-a5f6-c576ee4f6d24"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   TemplateBox[{"p1","p4"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}], " ", 
  TemplateBox[{"p2","p3"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )]}]], "Output",
 CellChangeTimes->{3.7949179535117006`*^9, 3.7949183984793005`*^9, 
  3.7951570489252625`*^9, 3.7951784381789265`*^9, 3.7966496108376093`*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"cd476551-ca80-4862-bbf0-612f92ce36a9"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "It", " ", "seems", " ", "incredibly", " ", "easy", " ", "to", " ", 
    "implement", " ", "despite", " ", "what", " ", "Rodolfo", " ", "did"}], 
   "..."}], "*)"}]], "Input",
 CellChangeTimes->{{3.7949184028571277`*^9, 3.7949184178517466`*^9}, {
  3.7949191232604713`*^9, 3.794919127649382*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"f4de8f87-d466-4855-84ed-d05a8b6158b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SchoutenSimplify2", "[", "exp_", "]"}], ":=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"exp", ",", 
    RowBox[{"TransformationFunctions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Automatic", ",", 
       RowBox[{"e", " ", "\[Function]", " ", 
        RowBox[{"e", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"SpinorAngleBracket", "[", 
             RowBox[{"x_", ",", "y_"}], "]"}], "*", 
            RowBox[{"SpinorAngleBracket", "[", 
             RowBox[{"z_", ",", "k_"}], "]"}]}], "\[RuleDelayed]", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"SpinorAngleBracket", "[", 
               RowBox[{"x", ",", "z"}], "]"}]}], 
             RowBox[{"SpinorAngleBracket", "[", 
              RowBox[{"k", ",", "y"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"SpinorAngleBracket", "[", 
              RowBox[{"x", ",", "k"}], "]"}], 
             RowBox[{"SpinorAngleBracket", "[", 
              RowBox[{"y", ",", "z"}], "]"}]}]}]}], "}"}]}]}], ",", 
       RowBox[{"e", " ", "\[Function]", " ", 
        RowBox[{"e", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"SpinorSquareBracket", "[", 
             RowBox[{"x_", ",", "y_"}], "]"}], "*", 
            RowBox[{"SpinorSquareBracket", "[", 
             RowBox[{"z_", ",", "k_"}], "]"}]}], "\[RuleDelayed]", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"SpinorSquareBracket", "[", 
               RowBox[{"x", ",", "z"}], "]"}]}], 
             RowBox[{"SpinorSquareBracket", "[", 
              RowBox[{"k", ",", "y"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"SpinorSquareBracket", "[", 
              RowBox[{"x", ",", "k"}], "]"}], 
             RowBox[{"SpinorSquareBracket", "[", 
              RowBox[{"y", ",", "z"}], "]"}]}]}]}], "}"}]}]}]}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7949191532358437`*^9, 3.794919185872587*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"3a5eb517-3bb2-4ee0-8abe-09d644bc8b3f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"exp", "//", "SchoutenSimplify2"}]], "Input",
 CellChangeTimes->{{3.7949191919182014`*^9, 3.7949191979502325`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"2cfb7f59-0cf3-49d1-87d8-2d58ae9a4acd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   TemplateBox[{"p1","p4"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}], " ", 
  TemplateBox[{"p2","p3"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )]}]], "Output",
 CellChangeTimes->{3.7949191983601923`*^9, 3.79515704913673*^9, 
  3.7951784383574123`*^9, 3.7966496109852753`*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"6b5a26c9-990c-4f81-bccc-d64ef282ea8f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"exp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       TemplateBox[{"p1","p2"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], 
       TemplateBox[{"p3","p4"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
      RowBox[{
       TemplateBox[{"p1","p3"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], 
       TemplateBox[{"p4","p2"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}]}], ")"}], "*", 
    TemplateBox[{"p1","p2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], "//", "Expand"}]}]], "Input",
 CellChangeTimes->{{3.7951570757395415`*^9, 3.795157088656032*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"cc19e3db-c51b-44fd-9ea6-766d7aa0b239"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    TemplateBox[{"p1","p2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], " ", 
   TemplateBox[{"p1","p3"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], " ", 
   TemplateBox[{"p2","p4"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
  RowBox[{
   SuperscriptBox[
    TemplateBox[{"p1","p2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
   TemplateBox[{"p3","p4"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.795157088962206*^9, 3.7951578520796204`*^9, 
  3.795178438459174*^9, 3.796649611064098*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"5b6ca763-cbbb-4cf0-b699-61cd769d8b86"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"exp", "//", "SchoutenSimplify2"}]], "Input",
 CellChangeTimes->{{3.7951570935160275`*^9, 3.7951570972490478`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"8a2f8ec5-f171-4fef-9e71-7b2b16657151"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   TemplateBox[{"p1","p2"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}], " ", 
  TemplateBox[{"p1","p4"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], " ", 
  TemplateBox[{"p2","p3"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )]}]], "Output",
 CellChangeTimes->{3.7951570977686625`*^9, 3.795157852802668*^9, 
  3.795178438551928*^9, 3.7966496111428547`*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"f396d16c-b774-4992-bb13-c33facba00b6"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "This", " ", "does", " ", "actually", " ", "not", " ", "work", " ", "with",
     " ", "powers"}], "..."}], "*)"}]], "Input",
 CellChangeTimes->{{3.8021688776439667`*^9, 
  3.802168891099964*^9}},ExpressionUUID->"b9adc175-e604-47dc-a197-\
da9080e301ee"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    SuperscriptBox[
     TemplateBox[{"1", "4"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
    SuperscriptBox[
     TemplateBox[{"2", "3"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "2"]}], "+", 
   RowBox[{
    TemplateBox[{"1", "3"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"1", "4"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"2", "3"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"2", "4"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
   RowBox[{
    SuperscriptBox[
     TemplateBox[{"1", "3"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
    SuperscriptBox[
     TemplateBox[{"2", "4"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "2"]}], "+", 
   RowBox[{
    TemplateBox[{"1", "2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"1", "4"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"2", "3"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"3", "4"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
   RowBox[{
    TemplateBox[{"1", "2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"1", "3"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"2", "4"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"3", "4"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
   RowBox[{
    SuperscriptBox[
     TemplateBox[{"1", "2"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
    SuperscriptBox[
     TemplateBox[{"3", "4"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "2"]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "SchoutenSimplify2"}], "\[IndentingNewLine]", 
 RowBox[{"%%", "//", "SchoutenSimplify"}]}], "Input",
 CellChangeTimes->{{3.8021689083737183`*^9, 3.8021689203986073`*^9}, {
  3.802169643276658*^9, 3.8021696595272274`*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"5eb92c23-ad41-433e-8230-1df3db210720"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    TemplateBox[{"1", "4"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
   SuperscriptBox[
    TemplateBox[{"2", "3"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "2"]}], "+", 
  RowBox[{
   SuperscriptBox[
    TemplateBox[{"1", "3"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
   SuperscriptBox[
    TemplateBox[{"2", "4"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "2"]}], "+", 
  RowBox[{
   TemplateBox[{"1", "2"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], " ", 
   TemplateBox[{"1", "3"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], " ", 
   TemplateBox[{"2", "4"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], " ", 
   TemplateBox[{"3", "4"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
  RowBox[{
   SuperscriptBox[
    TemplateBox[{"1", "2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
   SuperscriptBox[
    TemplateBox[{"3", "4"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "2"]}], "+", 
  RowBox[{
   TemplateBox[{"1", "4"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], " ", 
   TemplateBox[{"2", "3"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      TemplateBox[{"1", "3"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"2", "4"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
     RowBox[{
      TemplateBox[{"1", "2"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"3", "4"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.8021689210278997`*^9, {3.802169644327877*^9, 3.8021696601166444`*^9}},
 CellLabel->"Out[93]=",ExpressionUUID->"77406d18-878c-4505-b9dc-45dd15480c5e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"3", " ", 
   SuperscriptBox[
    TemplateBox[{"1", "3"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
   SuperscriptBox[
    TemplateBox[{"2", "4"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "2"]}], "-", 
  RowBox[{
   TemplateBox[{"1", "2"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], " ", 
   TemplateBox[{"1", "3"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], " ", 
   TemplateBox[{"2", "4"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], " ", 
   TemplateBox[{"3", "4"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
  RowBox[{
   SuperscriptBox[
    TemplateBox[{"1", "2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
   SuperscriptBox[
    TemplateBox[{"3", "4"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "2"]}]}]], "Output",
 CellChangeTimes->{
  3.8021689210278997`*^9, {3.802169644327877*^9, 3.802169660129615*^9}},
 CellLabel->"Out[94]=",ExpressionUUID->"81964a5c-8435-4227-913c-9de538314f1c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["SpinorSimplify with Schouten", "Subsection",
 CellChangeTimes->{{3.794919534421492*^9, 3.794919543468498*^9}, {
  3.7965674058352957`*^9, 3.796567408910059*^9}, {3.7965679350279455`*^9, 
  3.7965679381366415`*^9}},ExpressionUUID->"b1ac8d8b-b261-4698-8a01-\
a1bb1daa2f85"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Wrong", " ", "version"}], "*)"}]], "Input",
 CellChangeTimes->{{3.796567855863472*^9, 3.7965678619273186`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"624d1545-ba8e-49f5-a2b7-01b3230a84d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SpinorSimplify", "[", 
    RowBox[{"exp_", ",", 
     RowBox[{"MomConservation_:", 
      RowBox[{"{", "}"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "momcon", ",", "mom", ",", "momlist", ",", "transformationfunctions", 
       ",", "locexp", ",", "schouten"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MomConservation", "===", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"locexp", "=", 
          RowBox[{"SchoutenSimplify", "[", "exp", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "locexp", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "First", " ", "we", " ", "build", " ", "all", " ", "the", " ", 
          "replacements", " ", "which", " ", "are", " ", "given", " ", "by", 
          " ", "momentum", " ", 
          RowBox[{"conservation", "."}]}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Exract", " ", "all", " ", "the", " ", "momenta", " ", "present", 
          " ", "in", " ", "the", " ", "relations"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"momlist", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mom", "[", "x_", "]"}], ":=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"momlist", ",", "x"}], "]"}], ",", "x", ",", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"momlist", ",", "x"}], "]"}], ";", "x"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"momcon", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"{", "MomConservation", "}"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"A_", "/;", 
                RowBox[{"MemberQ", "[", 
                 RowBox[{"MomList", ",", "A"}], "]"}]}], "\[RuleDelayed]", 
               RowBox[{"mom", "[", "A", "]"}]}], ",", 
              RowBox[{"Rule", "\[Rule]", "Equal"}], ",", 
              RowBox[{"RuleDelayed", "\[Rule]", "Equal"}]}], "}"}]}], "]"}]}],
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Generate", " ", "Chainsimplify", " ", "with", " ", "each", " ", 
           "single", " ", "momentum", " ", "conservation", " ", "relation", 
           " ", 
           RowBox[{"applied", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"transformationfunctions", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"transformationfunctions", "=", 
            RowBox[{"{", 
             RowBox[{"transformationfunctions", ",", 
              RowBox[{"Solve", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "momcon"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "momlist"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"transformationfunctions", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"j", "=", "i"}], "}"}], ",", 
              RowBox[{"e", " ", "\[Function]", 
               RowBox[{"ChainSimplify", "[", 
                RowBox[{"e", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"MomCon", "\[Rule]", 
                    RowBox[{"{", "j", "}"}]}], ",", 
                   RowBox[{"ReduceComplete", "\[Rule]", "False"}]}], "}"}]}], 
                "]"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Flatten", "[", "transformationfunctions", "]"}]}], 
             "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Schouten", " ", "identities"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"schouten", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"e", " ", "\[Function]", " ", 
             RowBox[{"e", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"SpinorAngleBracket", "[", 
                  RowBox[{"x_", ",", "y_"}], "]"}], "*", 
                 RowBox[{"SpinorAngleBracket", "[", 
                  RowBox[{"z_", ",", "k_"}], "]"}]}], "\[RuleDelayed]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"SpinorAngleBracket", "[", 
                    RowBox[{"x", ",", "z"}], "]"}]}], 
                  RowBox[{"SpinorAngleBracket", "[", 
                   RowBox[{"k", ",", "y"}], "]"}]}], "-", 
                 RowBox[{
                  RowBox[{"SpinorAngleBracket", "[", 
                   RowBox[{"x", ",", "k"}], "]"}], 
                  RowBox[{"SpinorAngleBracket", "[", 
                   RowBox[{"y", ",", "z"}], "]"}]}]}]}], "}"}]}]}], ",", 
            RowBox[{"e", " ", "\[Function]", " ", 
             RowBox[{"e", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"SpinorSquareBracket", "[", 
                  RowBox[{"x_", ",", "y_"}], "]"}], "*", 
                 RowBox[{"SpinorSquareBracket", "[", 
                  RowBox[{"z_", ",", "k_"}], "]"}]}], "\[RuleDelayed]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"SpinorSquareBracket", "[", 
                    RowBox[{"x", ",", "z"}], "]"}]}], 
                  RowBox[{"SpinorSquareBracket", "[", 
                   RowBox[{"k", ",", "y"}], "]"}]}], "-", 
                 RowBox[{
                  RowBox[{"SpinorSquareBracket", "[", 
                   RowBox[{"x", ",", "k"}], "]"}], 
                  RowBox[{"SpinorSquareBracket", "[", 
                   RowBox[{"y", ",", "z"}], "]"}]}]}]}], "}"}]}]}]}], "}"}]}],
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Now", " ", "add", " ", "the", " ", "functions", " ", "which", " ", 
           "transform", " ", "backa", " ", "and", " ", "forth", " ", "among", 
           " ", "Chains", " ", "and", " ", "spinor", " ", "brackets", " ", 
           "as", " ", "well", " ", "as", " ", "the", " ", "automatic", " ", 
           "functions", " ", "and", " ", "Schouten", " ", "identities"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"transformationfunctions", "=", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Automatic", ",", 
             RowBox[{"e", " ", "\[Function]", " ", 
              RowBox[{"ToChain", "[", "e", "]"}]}], ",", 
             RowBox[{"e", " ", "\[Function]", " ", 
              RowBox[{"ChainToSpinor", "[", "e", "]"}]}], ",", "schouten", 
             ",", "transformationfunctions"}], "}"}], "//", "Flatten"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Now", " ", "apply", " ", "the", " ", "simplification", " ", 
           "using", " ", "the", " ", "custom", " ", "ComplexityFunction"}], 
          "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"locexp", "=", 
          RowBox[{"Simplify", "[", 
           RowBox[{"exp", ",", 
            RowBox[{"ComplexityFunction", "\[Rule]", "MyComplexityFunction"}],
             ",", 
            RowBox[{
            "TransformationFunctions", "\[Rule]", "transformationfunctions"}],
             ",", 
            RowBox[{"Trig", "\[Rule]", "False"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "locexp", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.794899370708829*^9, 3.7948994205432653`*^9}, {
   3.7948995033287287`*^9, 3.7948995570191135`*^9}, {3.794899610118097*^9, 
   3.794899699994702*^9}, {3.7948997838683643`*^9, 3.794899844058318*^9}, {
   3.7948999026965313`*^9, 3.794899952057505*^9}, {3.794900360662902*^9, 
   3.794900363752631*^9}, {3.794900394263033*^9, 3.7949004220407333`*^9}, {
   3.79490075118358*^9, 3.794900788134098*^9}, 3.794905359728526*^9, {
   3.794905396507148*^9, 3.7949054151064415`*^9}, {3.794905454420247*^9, 
   3.794905587945136*^9}, {3.794905646458642*^9, 3.7949059421417675`*^9}, {
   3.794905985883774*^9, 3.7949060037090845`*^9}, {3.794906106991843*^9, 
   3.794906247514983*^9}, {3.794906281173918*^9, 3.794906351265482*^9}, {
   3.794906384508526*^9, 3.7949064764785614`*^9}, {3.7949065255143766`*^9, 
   3.794906655999401*^9}, {3.7949071599720955`*^9, 3.7949071847218904`*^9}, {
   3.794907242998023*^9, 3.794907248594055*^9}, {3.79491966750747*^9, 
   3.7949196700078473`*^9}, {3.794919751914111*^9, 3.7949198358446302`*^9}, {
   3.7949233430410852`*^9, 3.794923350860222*^9}, {3.795157904780651*^9, 
   3.7951579406068196`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"10762453-2fc2-4350-88da-ca2365841a0f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Corrected", " ", "version"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7965678327263575`*^9, 3.7965678385886993`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"481f4fb8-ac45-4d51-a76f-ebde35334b7c"],

Cell[BoxData[
 RowBox[{"Clear", "[", "SpinorSimplify", "]"}]], "Input",
 CellChangeTimes->{{3.796567846301084*^9, 3.796567850989498*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"7a62805f-cbcb-43ed-8af6-47146db2558b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SpinorSimplify", "[", 
    RowBox[{"exp_", ",", 
     RowBox[{"MomConservation_:", 
      RowBox[{"{", "}"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "momcon", ",", "mom", ",", "momlist", ",", "transformationfunctions", 
       ",", "locexp", ",", "schouten"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MomConservation", "===", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"transformationfunctions", "=", 
          RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "First", " ", "we", " ", "build", " ", "all", " ", "the", " ", 
          "replacements", " ", "which", " ", "are", " ", "given", " ", "by", 
          " ", "momentum", " ", 
          RowBox[{"conservation", "."}]}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Exract", " ", "all", " ", "the", " ", "momenta", " ", "present", 
          " ", "in", " ", "the", " ", "relations"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"momlist", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mom", "[", "x_", "]"}], ":=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"momlist", ",", "x"}], "]"}], ",", "x", ",", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"momlist", ",", "x"}], "]"}], ";", "x"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"momcon", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"{", "MomConservation", "}"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"A_", "/;", 
                RowBox[{"MemberQ", "[", 
                 RowBox[{"MomList", ",", "A"}], "]"}]}], "\[RuleDelayed]", 
               RowBox[{"mom", "[", "A", "]"}]}], ",", 
              RowBox[{"Rule", "\[Rule]", "Equal"}], ",", 
              RowBox[{"RuleDelayed", "\[Rule]", "Equal"}]}], "}"}]}], "]"}]}],
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Generate", " ", "Chainsimplify", " ", "with", " ", "each", " ", 
           "single", " ", "momentum", " ", "conservation", " ", "relation", 
           " ", 
           RowBox[{"applied", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"transformationfunctions", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"transformationfunctions", "=", 
            RowBox[{"{", 
             RowBox[{"transformationfunctions", ",", 
              RowBox[{"Solve", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "momcon"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "momlist"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"transformationfunctions", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"j", "=", "i"}], "}"}], ",", 
              RowBox[{"e", " ", "\[Function]", 
               RowBox[{"ChainSimplify", "[", 
                RowBox[{"e", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"MomCon", "\[Rule]", 
                    RowBox[{"{", "j", "}"}]}], ",", 
                   RowBox[{"ReduceComplete", "\[Rule]", "False"}]}], "}"}]}], 
                "]"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Flatten", "[", "transformationfunctions", "]"}]}], 
             "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Schouten", " ", "identities"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"schouten", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"e", " ", "\[Function]", " ", 
          RowBox[{"e", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"SpinorAngleBracket", "[", 
               RowBox[{"x_", ",", "y_"}], "]"}], "*", 
              RowBox[{"SpinorAngleBracket", "[", 
               RowBox[{"z_", ",", "k_"}], "]"}]}], "\[RuleDelayed]", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"SpinorAngleBracket", "[", 
                 RowBox[{"x", ",", "z"}], "]"}]}], 
               RowBox[{"SpinorAngleBracket", "[", 
                RowBox[{"k", ",", "y"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"SpinorAngleBracket", "[", 
                RowBox[{"x", ",", "k"}], "]"}], 
               RowBox[{"SpinorAngleBracket", "[", 
                RowBox[{"y", ",", "z"}], "]"}]}]}]}], "}"}]}]}], ",", 
         RowBox[{"e", " ", "\[Function]", " ", 
          RowBox[{"e", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"SpinorSquareBracket", "[", 
               RowBox[{"x_", ",", "y_"}], "]"}], "*", 
              RowBox[{"SpinorSquareBracket", "[", 
               RowBox[{"z_", ",", "k_"}], "]"}]}], "\[RuleDelayed]", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"SpinorSquareBracket", "[", 
                 RowBox[{"x", ",", "z"}], "]"}]}], 
               RowBox[{"SpinorSquareBracket", "[", 
                RowBox[{"k", ",", "y"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"SpinorSquareBracket", "[", 
                RowBox[{"x", ",", "k"}], "]"}], 
               RowBox[{"SpinorSquareBracket", "[", 
                RowBox[{"y", ",", "z"}], "]"}]}]}]}], "}"}]}]}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Now", " ", "add", " ", "the", " ", "functions", " ", "which", " ", 
        "transform", " ", "back", " ", "and", " ", "forth", " ", "among", " ",
         "Chains", " ", "and", " ", "spinor", " ", "brackets", " ", "as", " ",
         "well", " ", "as", " ", "the", " ", "automatic", " ", "functions", 
        " ", "and", " ", "Schouten", " ", "identities"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"transformationfunctions", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Automatic", ",", 
          RowBox[{"e", " ", "\[Function]", " ", 
           RowBox[{"ToChain", "[", "e", "]"}]}], ",", 
          RowBox[{"e", " ", "\[Function]", " ", 
           RowBox[{"ChainToSpinor", "[", "e", "]"}]}], ",", "schouten", ",", 
          "transformationfunctions"}], "}"}], "//", "Flatten"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Now", " ", "apply", " ", "the", " ", "simplification", " ", "using", 
        " ", "the", " ", "custom", " ", "ComplexityFunction"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"locexp", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"exp", ",", 
         RowBox[{"ComplexityFunction", "\[Rule]", "MyComplexityFunction"}], 
         ",", 
         RowBox[{
         "TransformationFunctions", "\[Rule]", "transformationfunctions"}], 
         ",", 
         RowBox[{"Trig", "\[Rule]", "False"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "locexp", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.794899370708829*^9, 3.7948994205432653`*^9}, {
   3.7948995033287287`*^9, 3.7948995570191135`*^9}, {3.794899610118097*^9, 
   3.794899699994702*^9}, {3.7948997838683643`*^9, 3.794899844058318*^9}, {
   3.7948999026965313`*^9, 3.794899952057505*^9}, {3.794900360662902*^9, 
   3.794900363752631*^9}, {3.794900394263033*^9, 3.7949004220407333`*^9}, {
   3.79490075118358*^9, 3.794900788134098*^9}, 3.794905359728526*^9, {
   3.794905396507148*^9, 3.7949054151064415`*^9}, {3.794905454420247*^9, 
   3.794905587945136*^9}, {3.794905646458642*^9, 3.7949059421417675`*^9}, {
   3.794905985883774*^9, 3.7949060037090845`*^9}, {3.794906106991843*^9, 
   3.794906247514983*^9}, {3.794906281173918*^9, 3.794906351265482*^9}, {
   3.794906384508526*^9, 3.7949064764785614`*^9}, {3.7949065255143766`*^9, 
   3.794906655999401*^9}, {3.7949071599720955`*^9, 3.7949071847218904`*^9}, {
   3.794907242998023*^9, 3.794907248594055*^9}, {3.79491966750747*^9, 
   3.7949196700078473`*^9}, {3.794919751914111*^9, 3.7949198358446302`*^9}, {
   3.7949233430410852`*^9, 3.794923350860222*^9}, {3.795157904780651*^9, 
   3.7951579406068196`*^9}, {3.7965672966490955`*^9, 
   3.7965673041071787`*^9}, {3.796567364302303*^9, 3.7965673655808744`*^9}, 
   3.7965673986983714`*^9, 3.7965674581374655`*^9, {3.7965675215769606`*^9, 
   3.7965675487104397`*^9}, {3.796567662403577*^9, 3.796567667380276*^9}, 
   3.796567711198168*^9, {3.7965678158763456`*^9, 3.7965678163222017`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"e4fb8f84-b143-4de4-bdea-7ce82c9a2958"]
}, Closed]],

Cell[CellGroupData[{

Cell["Something to sort out.", "Subsection",
 CellChangeTimes->{{3.796567080445387*^9, 3.796567084423809*^9}, {
  3.7965678818400497`*^9, 3.7965678835176053`*^9}, {3.7965681512301097`*^9, 
  3.796568151370679*^9}},ExpressionUUID->"82898712-2008-4294-8b5e-\
7e9dfb53cabd"],

Cell[CellGroupData[{

Cell["First problem. Sorted", "Subsubsection",
 CellChangeTimes->{{3.7965681566465783`*^9, 
  3.7965681623892884`*^9}},ExpressionUUID->"15661c0f-a46d-4be7-bcad-\
3326ab9ab298"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    TemplateBox[{"1","2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], 
    TemplateBox[{"3","4"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
   RowBox[{
    TemplateBox[{"1","3"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], 
    TemplateBox[{"4","2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}]}], "//", 
  "SpinorSimplify"}]], "Input",
 CellLabel->"In[57]:=",ExpressionUUID->"2888f3d4-faaf-4fba-9ca0-fb50b40d68f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   TemplateBox[{"1","4"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}], " ", 
  TemplateBox[{"2","3"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )]}]], "Output",
 CellChangeTimes->{3.7965671146470165`*^9},
 CellLabel->"Out[57]=",ExpressionUUID->"74d13cdd-c885-4a18-ba15-f97c5d218bf3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"DeclareMom", "[", 
  RowBox[{"p1", ",", "p2", ",", "p3"}], "]"}]], "Input",
 CellChangeTimes->{{3.796562810636307*^9, 3.796562815069263*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"2c50b942-a6be-44e6-b4d0-b6476b30a527"],

Cell[BoxData[
 RowBox[{"KillMasses", "[", 
  RowBox[{"p1", ",", "p2", ",", "p3"}], "]"}]], "Input",
 CellChangeTimes->{{3.7965628391105804`*^9, 3.796562849123396*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"b7903970-d8ef-4b2a-bcd3-80acf70919c8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test", "=", 
  FractionBox[
   TemplateBox[{"p1","p2"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], 
   TemplateBox[{"p1",RowBox[{"{", "p2", "}"}],"p3"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]]}]], "Input",
 CellChangeTimes->{{3.796562788244491*^9, 3.796562819147259*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"572fbf0e-6831-4681-9606-e834a198c1ce"],

Cell[BoxData[
 FractionBox[
  TemplateBox[{"p1","p2"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], 
  TemplateBox[{"p1",RowBox[{"{", "p2", "}"}],"p3"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )]]], "Output",
 CellChangeTimes->{3.79656281983995*^9, 3.7965628513224134`*^9, 
  3.796567089558075*^9},
 CellLabel->"Out[55]=",ExpressionUUID->"02b38cea-1ede-4502-b997-a36d59b9a6b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test", "//", "SpinorSimplify"}]], "Input",
 CellChangeTimes->{{3.7965671568885946`*^9, 3.7965671615062604`*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"d21f7c4e-4df7-48f7-8382-c2306e99ca2c"],

Cell[BoxData[
 FractionBox[
  TemplateBox[{"p1","p2"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], 
  TemplateBox[{"p1",RowBox[{"{", "p2", "}"}],"p3"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )]]], "Output",
 CellChangeTimes->{3.796567161880254*^9},
 CellLabel->"Out[58]=",ExpressionUUID->"6d1e2477-5d09-4749-853a-d1ec2630f94b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "It", " ", "does", " ", "not", " ", "simplify", " ", "despite", " ", "the",
     " ", "single", " ", "operation", " ", "needed"}], "..."}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.796567260240369*^9, 
  3.796567276340395*^9}},ExpressionUUID->"98fab10c-ffec-4db5-8a9d-\
d6b4f9a6bdb6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"test", ",", 
   RowBox[{"ComplexityFunction", "\[Rule]", "MyComplexityFunction"}], ",", 
   RowBox[{"TransformationFunctions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Automatic", ",", 
      RowBox[{"e", " ", "\[Function]", " ", 
       RowBox[{"ChainToSpinor", "[", "e", "]"}]}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7965671679730206`*^9, 3.7965672065668755`*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"bd48552e-8d93-469b-a944-496ba3e94209"],

Cell[BoxData[
 FractionBox["1", 
  TemplateBox[{"p2","p3"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )]]], "Output",
 CellChangeTimes->{3.7965672097124634`*^9},
 CellLabel->"Out[59]=",ExpressionUUID->"576f7889-dd14-410d-a8ef-f23102a5c4cf"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", "SpinorSimplify", "]"}]], "Input",
 CellChangeTimes->{{3.7965676814556046`*^9, 3.7965676890183973`*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"f51bec6b-0ff9-4c69-817c-01654ab2778a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SpinorSimplify", "[", 
    RowBox[{"exp_", ",", 
     RowBox[{"MomConservation_:", 
      RowBox[{"{", "}"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "momcon", ",", "mom", ",", "momlist", ",", "transformationfunctions", 
       ",", "locexp", ",", "schouten"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MomConservation", "===", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"transformationfunctions", "=", 
          RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "First", " ", "we", " ", "build", " ", "all", " ", "the", " ", 
          "replacements", " ", "which", " ", "are", " ", "given", " ", "by", 
          " ", "momentum", " ", 
          RowBox[{"conservation", "."}]}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Exract", " ", "all", " ", "the", " ", "momenta", " ", "present", 
          " ", "in", " ", "the", " ", "relations"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"momlist", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mom", "[", "x_", "]"}], ":=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"momlist", ",", "x"}], "]"}], ",", "x", ",", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"momlist", ",", "x"}], "]"}], ";", "x"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"momcon", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"{", "MomConservation", "}"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"A_", "/;", 
                RowBox[{"MemberQ", "[", 
                 RowBox[{"MomList", ",", "A"}], "]"}]}], "\[RuleDelayed]", 
               RowBox[{"mom", "[", "A", "]"}]}], ",", 
              RowBox[{"Rule", "\[Rule]", "Equal"}], ",", 
              RowBox[{"RuleDelayed", "\[Rule]", "Equal"}]}], "}"}]}], "]"}]}],
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Generate", " ", "Chainsimplify", " ", "with", " ", "each", " ", 
           "single", " ", "momentum", " ", "conservation", " ", "relation", 
           " ", 
           RowBox[{"applied", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"transformationfunctions", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"transformationfunctions", "=", 
            RowBox[{"{", 
             RowBox[{"transformationfunctions", ",", 
              RowBox[{"Solve", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "momcon"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "momlist"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"transformationfunctions", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"j", "=", "i"}], "}"}], ",", 
              RowBox[{"e", " ", "\[Function]", 
               RowBox[{"ChainSimplify", "[", 
                RowBox[{"e", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"MomCon", "\[Rule]", 
                    RowBox[{"{", "j", "}"}]}], ",", 
                   RowBox[{"ReduceComplete", "\[Rule]", "False"}]}], "}"}]}], 
                "]"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Flatten", "[", "transformationfunctions", "]"}]}], 
             "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Schouten", " ", "identities"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"schouten", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"e", " ", "\[Function]", " ", 
          RowBox[{"e", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"SpinorAngleBracket", "[", 
               RowBox[{"x_", ",", "y_"}], "]"}], "*", 
              RowBox[{"SpinorAngleBracket", "[", 
               RowBox[{"z_", ",", "k_"}], "]"}]}], "\[RuleDelayed]", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"SpinorAngleBracket", "[", 
                 RowBox[{"x", ",", "z"}], "]"}]}], 
               RowBox[{"SpinorAngleBracket", "[", 
                RowBox[{"k", ",", "y"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"SpinorAngleBracket", "[", 
                RowBox[{"x", ",", "k"}], "]"}], 
               RowBox[{"SpinorAngleBracket", "[", 
                RowBox[{"y", ",", "z"}], "]"}]}]}]}], "}"}]}]}], ",", 
         RowBox[{"e", " ", "\[Function]", " ", 
          RowBox[{"e", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"SpinorSquareBracket", "[", 
               RowBox[{"x_", ",", "y_"}], "]"}], "*", 
              RowBox[{"SpinorSquareBracket", "[", 
               RowBox[{"z_", ",", "k_"}], "]"}]}], "\[RuleDelayed]", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"SpinorSquareBracket", "[", 
                 RowBox[{"x", ",", "z"}], "]"}]}], 
               RowBox[{"SpinorSquareBracket", "[", 
                RowBox[{"k", ",", "y"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"SpinorSquareBracket", "[", 
                RowBox[{"x", ",", "k"}], "]"}], 
               RowBox[{"SpinorSquareBracket", "[", 
                RowBox[{"y", ",", "z"}], "]"}]}]}]}], "}"}]}]}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Now", " ", "add", " ", "the", " ", "functions", " ", "which", " ", 
        "transform", " ", "back", " ", "and", " ", "forth", " ", "among", " ",
         "Chains", " ", "and", " ", "spinor", " ", "brackets", " ", "as", " ",
         "well", " ", "as", " ", "the", " ", "automatic", " ", "functions", 
        " ", "and", " ", "Schouten", " ", "identities"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"transformationfunctions", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Automatic", ",", 
          RowBox[{"e", " ", "\[Function]", " ", 
           RowBox[{"ToChain", "[", "e", "]"}]}], ",", 
          RowBox[{"e", " ", "\[Function]", " ", 
           RowBox[{"ChainToSpinor", "[", "e", "]"}]}], ",", "schouten", ",", 
          "transformationfunctions"}], "}"}], "//", "Flatten"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Now", " ", "apply", " ", "the", " ", "simplification", " ", "using", 
        " ", "the", " ", "custom", " ", "ComplexityFunction"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"locexp", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"exp", ",", 
         RowBox[{"ComplexityFunction", "\[Rule]", "MyComplexityFunction"}], 
         ",", 
         RowBox[{
         "TransformationFunctions", "\[Rule]", "transformationfunctions"}], 
         ",", 
         RowBox[{"Trig", "\[Rule]", "False"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "locexp", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.794899370708829*^9, 3.7948994205432653`*^9}, {
   3.7948995033287287`*^9, 3.7948995570191135`*^9}, {3.794899610118097*^9, 
   3.794899699994702*^9}, {3.7948997838683643`*^9, 3.794899844058318*^9}, {
   3.7948999026965313`*^9, 3.794899952057505*^9}, {3.794900360662902*^9, 
   3.794900363752631*^9}, {3.794900394263033*^9, 3.7949004220407333`*^9}, {
   3.79490075118358*^9, 3.794900788134098*^9}, 3.794905359728526*^9, {
   3.794905396507148*^9, 3.7949054151064415`*^9}, {3.794905454420247*^9, 
   3.794905587945136*^9}, {3.794905646458642*^9, 3.7949059421417675`*^9}, {
   3.794905985883774*^9, 3.7949060037090845`*^9}, {3.794906106991843*^9, 
   3.794906247514983*^9}, {3.794906281173918*^9, 3.794906351265482*^9}, {
   3.794906384508526*^9, 3.7949064764785614`*^9}, {3.7949065255143766`*^9, 
   3.794906655999401*^9}, {3.7949071599720955`*^9, 3.7949071847218904`*^9}, {
   3.794907242998023*^9, 3.794907248594055*^9}, {3.79491966750747*^9, 
   3.7949196700078473`*^9}, {3.794919751914111*^9, 3.7949198358446302`*^9}, {
   3.7949233430410852`*^9, 3.794923350860222*^9}, {3.795157904780651*^9, 
   3.7951579406068196`*^9}, {3.7965672966490955`*^9, 
   3.7965673041071787`*^9}, {3.796567364302303*^9, 3.7965673655808744`*^9}, 
   3.7965673986983714`*^9, 3.7965674581374655`*^9, {3.7965675215769606`*^9, 
   3.7965675487104397`*^9}, {3.796567662403577*^9, 3.796567667380276*^9}, 
   3.796567711198168*^9, {3.7965678158763456`*^9, 
   3.7965678163222017`*^9}},ExpressionUUID->"ea49d77f-dd7e-4feb-9768-\
784ac0cb260a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test", "//", "SpinorSimplify"}]], "Input",
 CellChangeTimes->{{3.7965673082810264`*^9, 3.7965673128398423`*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"c234bbd8-dcbd-4dda-8b83-622f9c2399f9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Automatic", ",", 
   RowBox[{"Function", "[", 
    RowBox[{"e", ",", 
     RowBox[{"ToChain", "[", "e", "]"}]}], "]"}], ",", 
   RowBox[{"Function", "[", 
    RowBox[{"e", ",", 
     RowBox[{"ChainToSpinor", "[", "e", "]"}]}], "]"}], ",", 
   RowBox[{"Function", "[", 
    RowBox[{"e", ",", 
     RowBox[{"e", "/.", "\[VeryThinSpace]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         TemplateBox[{"x_","y_"},
          "SpinorAngleBracket",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
             RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
          InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], " ", 
         TemplateBox[{"z_","k_"},
          "SpinorAngleBracket",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
             RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
          InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           TemplateBox[{"x","z"},
            "SpinorAngleBracket",
            DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
               RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
            InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
               RowBox[{#, ",", #2}], "]"}]& )]}], " ", 
          TemplateBox[{"k","y"},
           "SpinorAngleBracket",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
           InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )]}], "-", 
         RowBox[{
          TemplateBox[{"x","k"},
           "SpinorAngleBracket",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
           InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )], " ", 
          TemplateBox[{"y","z"},
           "SpinorAngleBracket",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
           InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )]}]}]}], "}"}]}]}], "]"}], ",", 
   RowBox[{"Function", "[", 
    RowBox[{"e", ",", 
     RowBox[{"e", "/.", "\[VeryThinSpace]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         TemplateBox[{"x_","y_"},
          "SpinorSquareBracket",
          DisplayFunction->(RowBox[{"[", 
             RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
          InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], " ", 
         TemplateBox[{"z_","k_"},
          "SpinorSquareBracket",
          DisplayFunction->(RowBox[{"[", 
             RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
          InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           TemplateBox[{"x","z"},
            "SpinorSquareBracket",
            DisplayFunction->(RowBox[{"[", 
               RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
            InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
               RowBox[{#, ",", #2}], "]"}]& )]}], " ", 
          TemplateBox[{"k","y"},
           "SpinorSquareBracket",
           DisplayFunction->(RowBox[{"[", 
              RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
           InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )]}], "-", 
         RowBox[{
          TemplateBox[{"x","k"},
           "SpinorSquareBracket",
           DisplayFunction->(RowBox[{"[", 
              RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
           InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )], " ", 
          TemplateBox[{"y","z"},
           "SpinorSquareBracket",
           DisplayFunction->(RowBox[{"[", 
              RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
           InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )]}]}]}], "}"}]}]}], "]"}]}], 
  "}"}]], "Print",
 CellChangeTimes->{
  3.7965673708487864`*^9, 3.79656756055277*^9, {3.796567649217807*^9, 
   3.7965676941048393`*^9}},
 CellLabel->
  "During evaluation of \
In[79]:=",ExpressionUUID->"a1eb4cf2-cdf3-439e-b9bf-e59bae24e564"],

Cell[BoxData[
 FractionBox["1", 
  TemplateBox[{"p2","p3"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )]]], "Output",
 CellChangeTimes->{{3.7965673131230326`*^9, 3.796567317920244*^9}, 
   3.7965673708657036`*^9, 3.7965675605617113`*^9, {3.7965676492277784`*^9, 
   3.796567694112816*^9}},
 CellLabel->"Out[79]=",ExpressionUUID->"72ebf14c-6ee4-4258-a95e-0cedb7164000"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpinorSimplify", "[", 
  RowBox[{"test", ",", 
   RowBox[{"p1", "\[Rule]", 
    RowBox[{
     RowBox[{"-", "p2"}], "-", "p3", "-", "p4"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7965675732378874`*^9, 3.796567631464219*^9}, {
  3.7965677312645383`*^9, 3.7965677338775015`*^9}, {3.796567772449458*^9, 
  3.796567786917804*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"5a548a5b-7cc6-4e38-804e-d3044e53bc2e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Automatic", ",", 
   RowBox[{"Function", "[", 
    RowBox[{"e", ",", 
     RowBox[{"ToChain", "[", "e", "]"}]}], "]"}], ",", 
   RowBox[{"Function", "[", 
    RowBox[{"e", ",", 
     RowBox[{"ChainToSpinor", "[", "e", "]"}]}], "]"}], ",", 
   RowBox[{"Function", "[", 
    RowBox[{"e", ",", 
     RowBox[{"e", "/.", "\[VeryThinSpace]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         TemplateBox[{"x_","y_"},
          "SpinorAngleBracket",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
             RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
          InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], " ", 
         TemplateBox[{"z_","k_"},
          "SpinorAngleBracket",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
             RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
          InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           TemplateBox[{"x","z"},
            "SpinorAngleBracket",
            DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
               RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
            InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
               RowBox[{#, ",", #2}], "]"}]& )]}], " ", 
          TemplateBox[{"k","y"},
           "SpinorAngleBracket",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
           InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )]}], "-", 
         RowBox[{
          TemplateBox[{"x","k"},
           "SpinorAngleBracket",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
           InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )], " ", 
          TemplateBox[{"y","z"},
           "SpinorAngleBracket",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
           InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )]}]}]}], "}"}]}]}], "]"}], ",", 
   RowBox[{"Function", "[", 
    RowBox[{"e", ",", 
     RowBox[{"e", "/.", "\[VeryThinSpace]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         TemplateBox[{"x_","y_"},
          "SpinorSquareBracket",
          DisplayFunction->(RowBox[{"[", 
             RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
          InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], " ", 
         TemplateBox[{"z_","k_"},
          "SpinorSquareBracket",
          DisplayFunction->(RowBox[{"[", 
             RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
          InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           TemplateBox[{"x","z"},
            "SpinorSquareBracket",
            DisplayFunction->(RowBox[{"[", 
               RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
            InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
               RowBox[{#, ",", #2}], "]"}]& )]}], " ", 
          TemplateBox[{"k","y"},
           "SpinorSquareBracket",
           DisplayFunction->(RowBox[{"[", 
              RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
           InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )]}], "-", 
         RowBox[{
          TemplateBox[{"x","k"},
           "SpinorSquareBracket",
           DisplayFunction->(RowBox[{"[", 
              RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
           InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )], " ", 
          TemplateBox[{"y","z"},
           "SpinorSquareBracket",
           DisplayFunction->(RowBox[{"[", 
              RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
           InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )]}]}]}], "}"}]}]}], "]"}], ",", 
   RowBox[{"Function", "[", 
    RowBox[{"e$", ",", 
     RowBox[{"ChainSimplify", "[", 
      RowBox[{"e$", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MomCon", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"p1", "\[Rule]", 
            RowBox[{
             RowBox[{"-", "p2"}], "-", "p3", "-", "p4"}]}], "}"}]}], ",", 
         RowBox[{"ReduceComplete", "\[Rule]", "False"}]}], "}"}]}], "]"}]}], 
    "]"}], ",", 
   RowBox[{"Function", "[", 
    RowBox[{"e$", ",", 
     RowBox[{"ChainSimplify", "[", 
      RowBox[{"e$", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MomCon", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"p2", "\[Rule]", 
            RowBox[{
             RowBox[{"-", "p1"}], "-", "p3", "-", "p4"}]}], "}"}]}], ",", 
         RowBox[{"ReduceComplete", "\[Rule]", "False"}]}], "}"}]}], "]"}]}], 
    "]"}], ",", 
   RowBox[{"Function", "[", 
    RowBox[{"e$", ",", 
     RowBox[{"ChainSimplify", "[", 
      RowBox[{"e$", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MomCon", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"p3", "\[Rule]", 
            RowBox[{
             RowBox[{"-", "p1"}], "-", "p2", "-", "p4"}]}], "}"}]}], ",", 
         RowBox[{"ReduceComplete", "\[Rule]", "False"}]}], "}"}]}], "]"}]}], 
    "]"}]}], "}"}]], "Print",
 CellChangeTimes->{{3.796567695369416*^9, 3.7965677344559855`*^9}, {
  3.7965677733949156`*^9, 3.796567787575029*^9}},
 CellLabel->
  "During evaluation of \
In[86]:=",ExpressionUUID->"3cf133e2-4f86-4c75-8252-20379a3232bf"],

Cell[BoxData[
 FractionBox["1", 
  TemplateBox[{"p2","p3"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )]]], "Output",
 CellChangeTimes->{{3.796567607775569*^9, 3.796567632202284*^9}, {
  3.79656767330439*^9, 3.796567734464962*^9}, {3.7965677736013618`*^9, 
  3.7965677875899415`*^9}},
 CellLabel->"Out[86]=",ExpressionUUID->"e02b9b72-6a4b-4922-991c-19a1f434eef1"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Second problem", "Subsubsection",
 CellChangeTimes->{{3.7965681677060747`*^9, 
  3.7965681702233486`*^9}},ExpressionUUID->"ae2bafb6-4e67-4ed4-9488-\
4b62abd66f1e"],

Cell[BoxData[
 RowBox[{"Clear", "[", "SpinorSimplify", "]"}]], "Input",
 CellChangeTimes->{{3.796567846301084*^9, 3.796567850989498*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"988fa6e7-dcd5-4963-9541-4114f2dc0254"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SpinorSimplify", "[", 
    RowBox[{"exp_", ",", 
     RowBox[{"MomConservation_:", 
      RowBox[{"{", "}"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "momcon", ",", "mom", ",", "momlist", ",", "transformationfunctions", 
       ",", "locexp", ",", "schouten"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MomConservation", "===", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"transformationfunctions", "=", 
          RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "First", " ", "we", " ", "build", " ", "all", " ", "the", " ", 
          "replacements", " ", "which", " ", "are", " ", "given", " ", "by", 
          " ", "momentum", " ", 
          RowBox[{"conservation", "."}]}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Exract", " ", "all", " ", "the", " ", "momenta", " ", "present", 
          " ", "in", " ", "the", " ", "relations"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"momlist", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mom", "[", "x_", "]"}], ":=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"momlist", ",", "x"}], "]"}], ",", "x", ",", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"momlist", ",", "x"}], "]"}], ";", "x"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"momcon", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"{", "MomConservation", "}"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"A_", "/;", 
                RowBox[{"MemberQ", "[", 
                 RowBox[{"MomList", ",", "A"}], "]"}]}], "\[RuleDelayed]", 
               RowBox[{"mom", "[", "A", "]"}]}], ",", 
              RowBox[{"Rule", "\[Rule]", "Equal"}], ",", 
              RowBox[{"RuleDelayed", "\[Rule]", "Equal"}]}], "}"}]}], "]"}]}],
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Generate", " ", "Chainsimplify", " ", "with", " ", "each", " ", 
           "single", " ", "momentum", " ", "conservation", " ", "relation", 
           " ", 
           RowBox[{"applied", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"transformationfunctions", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"transformationfunctions", "=", 
            RowBox[{"{", 
             RowBox[{"transformationfunctions", ",", 
              RowBox[{"Solve", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "momcon"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "momlist"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"transformationfunctions", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"j", "=", "i"}], "}"}], ",", 
              RowBox[{"e", " ", "\[Function]", 
               RowBox[{"ChainSimplify", "[", 
                RowBox[{"e", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"MomCon", "\[Rule]", 
                    RowBox[{"{", "j", "}"}]}], ",", 
                   RowBox[{"ReduceComplete", "\[Rule]", "False"}]}], "}"}]}], 
                "]"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Flatten", "[", "transformationfunctions", "]"}]}], 
             "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Schouten", " ", "identities"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"schouten", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"e", " ", "\[Function]", " ", 
          RowBox[{"e", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"SpinorAngleBracket", "[", 
               RowBox[{"x_", ",", "y_"}], "]"}], "*", 
              RowBox[{"SpinorAngleBracket", "[", 
               RowBox[{"z_", ",", "k_"}], "]"}]}], "\[RuleDelayed]", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"SpinorAngleBracket", "[", 
                 RowBox[{"x", ",", "z"}], "]"}]}], 
               RowBox[{"SpinorAngleBracket", "[", 
                RowBox[{"k", ",", "y"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"SpinorAngleBracket", "[", 
                RowBox[{"x", ",", "k"}], "]"}], 
               RowBox[{"SpinorAngleBracket", "[", 
                RowBox[{"y", ",", "z"}], "]"}]}]}]}], "}"}]}]}], ",", 
         RowBox[{"e", " ", "\[Function]", " ", 
          RowBox[{"e", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"SpinorSquareBracket", "[", 
               RowBox[{"x_", ",", "y_"}], "]"}], "*", 
              RowBox[{"SpinorSquareBracket", "[", 
               RowBox[{"z_", ",", "k_"}], "]"}]}], "\[RuleDelayed]", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"SpinorSquareBracket", "[", 
                 RowBox[{"x", ",", "z"}], "]"}]}], 
               RowBox[{"SpinorSquareBracket", "[", 
                RowBox[{"k", ",", "y"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"SpinorSquareBracket", "[", 
                RowBox[{"x", ",", "k"}], "]"}], 
               RowBox[{"SpinorSquareBracket", "[", 
                RowBox[{"y", ",", "z"}], "]"}]}]}]}], "}"}]}]}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Now", " ", "add", " ", "the", " ", "functions", " ", "which", " ", 
        "transform", " ", "back", " ", "and", " ", "forth", " ", "among", " ",
         "Chains", " ", "and", " ", "spinor", " ", "brackets", " ", "as", " ",
         "well", " ", "as", " ", "the", " ", "automatic", " ", "functions", 
        " ", "and", " ", "Schouten", " ", "identities"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"transformationfunctions", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Automatic", ",", 
          RowBox[{"e", " ", "\[Function]", " ", 
           RowBox[{"ToChain", "[", "e", "]"}]}], ",", 
          RowBox[{"e", " ", "\[Function]", " ", 
           RowBox[{"ChainToSpinor", "[", "e", "]"}]}], ",", "schouten", ",", 
          "transformationfunctions"}], "}"}], "//", "Flatten"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "transformationfunctions", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Now", " ", "apply", " ", "the", " ", "simplification", " ", "using", 
        " ", "the", " ", "custom", " ", "ComplexityFunction"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"locexp", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"exp", ",", 
         RowBox[{"ComplexityFunction", "\[Rule]", "MyComplexityFunction"}], 
         ",", 
         RowBox[{
         "TransformationFunctions", "\[Rule]", "transformationfunctions"}], 
         ",", 
         RowBox[{"Trig", "\[Rule]", "False"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "locexp", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.794899370708829*^9, 3.7948994205432653`*^9}, {
   3.7948995033287287`*^9, 3.7948995570191135`*^9}, {3.794899610118097*^9, 
   3.794899699994702*^9}, {3.7948997838683643`*^9, 3.794899844058318*^9}, {
   3.7948999026965313`*^9, 3.794899952057505*^9}, {3.794900360662902*^9, 
   3.794900363752631*^9}, {3.794900394263033*^9, 3.7949004220407333`*^9}, {
   3.79490075118358*^9, 3.794900788134098*^9}, 3.794905359728526*^9, {
   3.794905396507148*^9, 3.7949054151064415`*^9}, {3.794905454420247*^9, 
   3.794905587945136*^9}, {3.794905646458642*^9, 3.7949059421417675`*^9}, {
   3.794905985883774*^9, 3.7949060037090845`*^9}, {3.794906106991843*^9, 
   3.794906247514983*^9}, {3.794906281173918*^9, 3.794906351265482*^9}, {
   3.794906384508526*^9, 3.7949064764785614`*^9}, {3.7949065255143766`*^9, 
   3.794906655999401*^9}, {3.7949071599720955`*^9, 3.7949071847218904`*^9}, {
   3.794907242998023*^9, 3.794907248594055*^9}, {3.79491966750747*^9, 
   3.7949196700078473`*^9}, {3.794919751914111*^9, 3.7949198358446302`*^9}, {
   3.7949233430410852`*^9, 3.794923350860222*^9}, {3.795157904780651*^9, 
   3.7951579406068196`*^9}, {3.7965672966490955`*^9, 
   3.7965673041071787`*^9}, {3.796567364302303*^9, 3.7965673655808744`*^9}, 
   3.7965673986983714`*^9, 3.7965674581374655`*^9, {3.7965675215769606`*^9, 
   3.7965675487104397`*^9}, {3.796567662403577*^9, 3.796567667380276*^9}, 
   3.796567711198168*^9, {3.7965678158763456`*^9, 3.7965678163222017`*^9}, {
   3.796568203660982*^9, 3.796568209711757*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"9fa254a4-d835-4cd1-a916-259e6eff20cc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test", "=", 
  FractionBox[
   TemplateBox[{"p1","p2"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], 
   TemplateBox[{"p1",RowBox[{"{", "p4", "}"}],"p3"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]]}]], "Input",
 CellChangeTimes->{{3.796568001889194*^9, 3.7965680125477057`*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"10a768bf-c9fe-4971-b099-e36004656cc4"],

Cell[BoxData[
 FractionBox[
  TemplateBox[{"p1","p2"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], 
  TemplateBox[{"p1",RowBox[{"{", "p4", "}"}],"p3"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )]]], "Output",
 CellChangeTimes->{
  3.79656801507994*^9, {3.7965681743383284`*^9, 3.7965682191545143`*^9}},
 CellLabel->
  "Out[109]=",ExpressionUUID->"04c433cd-7899-44fc-9749-02e55642502e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpinorSimplify", "[", 
  RowBox[{"test", ",", 
   RowBox[{"p1", "\[Rule]", 
    RowBox[{
     RowBox[{"-", "p2"}], "-", "p3", "-", "p4"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.796568017265152*^9, 3.79656802876038*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"80637ac0-56f4-4393-9819-056ec5c0a11a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Automatic", ",", 
   RowBox[{"Function", "[", 
    RowBox[{"e", ",", 
     RowBox[{"ToChain", "[", "e", "]"}]}], "]"}], ",", 
   RowBox[{"Function", "[", 
    RowBox[{"e", ",", 
     RowBox[{"ChainToSpinor", "[", "e", "]"}]}], "]"}], ",", 
   RowBox[{"Function", "[", 
    RowBox[{"e", ",", 
     RowBox[{"e", "/.", "\[VeryThinSpace]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         TemplateBox[{"x_","y_"},
          "SpinorAngleBracket",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
             RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
          InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], " ", 
         TemplateBox[{"z_","k_"},
          "SpinorAngleBracket",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
             RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
          InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           TemplateBox[{"x","z"},
            "SpinorAngleBracket",
            DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
               RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
            InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
               RowBox[{#, ",", #2}], "]"}]& )]}], " ", 
          TemplateBox[{"k","y"},
           "SpinorAngleBracket",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
           InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )]}], "-", 
         RowBox[{
          TemplateBox[{"x","k"},
           "SpinorAngleBracket",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
           InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )], " ", 
          TemplateBox[{"y","z"},
           "SpinorAngleBracket",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
           InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )]}]}]}], "}"}]}]}], "]"}], ",", 
   RowBox[{"Function", "[", 
    RowBox[{"e", ",", 
     RowBox[{"e", "/.", "\[VeryThinSpace]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         TemplateBox[{"x_","y_"},
          "SpinorSquareBracket",
          DisplayFunction->(RowBox[{"[", 
             RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
          InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], " ", 
         TemplateBox[{"z_","k_"},
          "SpinorSquareBracket",
          DisplayFunction->(RowBox[{"[", 
             RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
          InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           TemplateBox[{"x","z"},
            "SpinorSquareBracket",
            DisplayFunction->(RowBox[{"[", 
               RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
            InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
               RowBox[{#, ",", #2}], "]"}]& )]}], " ", 
          TemplateBox[{"k","y"},
           "SpinorSquareBracket",
           DisplayFunction->(RowBox[{"[", 
              RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
           InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )]}], "-", 
         RowBox[{
          TemplateBox[{"x","k"},
           "SpinorSquareBracket",
           DisplayFunction->(RowBox[{"[", 
              RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
           InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )], " ", 
          TemplateBox[{"y","z"},
           "SpinorSquareBracket",
           DisplayFunction->(RowBox[{"[", 
              RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
           InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )]}]}]}], "}"}]}]}], "]"}], ",", 
   RowBox[{"Function", "[", 
    RowBox[{"e$", ",", 
     RowBox[{"ChainSimplify", "[", 
      RowBox[{"e$", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MomCon", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"p1", "\[Rule]", 
            RowBox[{
             RowBox[{"-", "p2"}], "-", "p3", "-", "p4"}]}], "}"}]}], ",", 
         RowBox[{"ReduceComplete", "\[Rule]", "False"}]}], "}"}]}], "]"}]}], 
    "]"}], ",", 
   RowBox[{"Function", "[", 
    RowBox[{"e$", ",", 
     RowBox[{"ChainSimplify", "[", 
      RowBox[{"e$", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MomCon", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"p2", "\[Rule]", 
            RowBox[{
             RowBox[{"-", "p1"}], "-", "p3", "-", "p4"}]}], "}"}]}], ",", 
         RowBox[{"ReduceComplete", "\[Rule]", "False"}]}], "}"}]}], "]"}]}], 
    "]"}], ",", 
   RowBox[{"Function", "[", 
    RowBox[{"e$", ",", 
     RowBox[{"ChainSimplify", "[", 
      RowBox[{"e$", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MomCon", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"p3", "\[Rule]", 
            RowBox[{
             RowBox[{"-", "p1"}], "-", "p2", "-", "p4"}]}], "}"}]}], ",", 
         RowBox[{"ReduceComplete", "\[Rule]", "False"}]}], "}"}]}], "]"}]}], 
    "]"}], ",", 
   RowBox[{"Function", "[", 
    RowBox[{"e$", ",", 
     RowBox[{"ChainSimplify", "[", 
      RowBox[{"e$", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MomCon", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"p4", "\[Rule]", 
            RowBox[{
             RowBox[{"-", "p1"}], "-", "p2", "-", "p3"}]}], "}"}]}], ",", 
         RowBox[{"ReduceComplete", "\[Rule]", "False"}]}], "}"}]}], "]"}]}], 
    "]"}]}], "}"}]], "Print",
 CellChangeTimes->{3.7965682203892527`*^9},
 CellLabel->
  "During evaluation of \
In[110]:=",ExpressionUUID->"7101224d-6ffc-4e76-86e6-4f2bbe48436d"],

Cell[BoxData[
 FractionBox[
  TemplateBox[{"p1","p2"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], 
  TemplateBox[{"p1",RowBox[{"{", "p4", "}"}],"p3"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )]]], "Output",
 CellChangeTimes->{
  3.7965680294285936`*^9, 3.7965681124417233`*^9, {3.7965681941403713`*^9, 
   3.796568220399226*^9}},
 CellLabel->
  "Out[110]=",ExpressionUUID->"78336a20-2eb1-4540-951b-4b9814c8d4bf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"1", "/", "test"}]], "Input",
 CellChangeTimes->{{3.7965683162544055`*^9, 3.796568317632772*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"b3a5857d-7441-4507-a935-10876e705451"],

Cell[BoxData[
 FractionBox[
  TemplateBox[{"p1",RowBox[{"{", "p4", "}"}],"p3"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], 
  TemplateBox[{"p1","p2"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )]]], "Output",
 CellChangeTimes->{3.7965683184655333`*^9},
 CellLabel->
  "Out[112]=",ExpressionUUID->"5d7358fb-e0f3-47af-bb95-414093c09626"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"1", "/", "test"}], ",", 
   RowBox[{"ComplexityFunction", "\[Rule]", "MyComplexityFunction"}], ",", 
   RowBox[{"TransformationFunctions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Automatic", ",", 
      RowBox[{"e", " ", "\[Function]", " ", 
       RowBox[{"ChainSimplify", "[", 
        RowBox[{"e", ",", 
         RowBox[{"{", 
          RowBox[{"MomCon", "\[Rule]", 
           RowBox[{"p4", "\[Rule]", 
            RowBox[{
             RowBox[{"-", "p1"}], "-", "p2", "-", "p3"}]}]}], "}"}]}], 
        "]"}]}], ",", 
      RowBox[{"e", " ", "\[Function]", " ", 
       RowBox[{"ChainToSpinor", "[", "e", "]"}]}], ",", 
      RowBox[{"e", " ", "\[Function]", " ", 
       RowBox[{"ToChain", "[", "e", "]"}]}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.79656824826373*^9, 3.7965683223371487`*^9}, {
  3.7965683700317116`*^9, 3.7965683976040382`*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"f40cf9a8-36aa-4da1-86a4-5858d98adbe6"],

Cell[BoxData[
 FractionBox[
  TemplateBox[{"p1",RowBox[{"{", "p4", "}"}],"p3"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], 
  TemplateBox[{"p1","p2"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )]]], "Output",
 CellChangeTimes->{{3.7965683022807856`*^9, 3.796568323197879*^9}, 
   3.796568399976675*^9},
 CellLabel->
  "Out[116]=",ExpressionUUID->"e69c30b9-ddb4-49a6-a826-0c36495e67a6"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "It", " ", "seems", " ", "Mathematica", " ", "does", " ", "not", " ", 
    "want", " ", "to", " ", "apply", " ", "momentum", " ", "conservation", 
    " ", "and", " ", "then", " ", "break", " ", "the", " ", "chain", " ", 
    "to", " ", "spinors"}], ",", " ", 
   RowBox[{
    RowBox[{"why", "?", " ", "Maybe"}], " ", "because", " ", "a", " ", 
    "minus", " ", "appears", " ", "increasing", " ", "intermediate", " ", 
    "complexity", " ", "despite", " ", "the", " ", "overall", " ", 
    "complexity", " ", "would", " ", "decrease", " ", "in", " ", "the", " ", 
    RowBox[{"end", "."}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.796568475034042*^9, 
  3.796568557852748*^9}},ExpressionUUID->"02cde08a-0fa4-4898-9560-\
b47debfb49dc"],

Cell[CellGroupData[{

Cell[BoxData["MomList"], "Input",
 CellChangeTimes->{{3.7965683319604635`*^9, 3.7965683332061057`*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"8d40a4f0-453f-4e5e-bd2a-82da7a8d414a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"p1", ",", "p2", ",", "p3", ",", "p4"}], "}"}]], "Output",
 CellChangeTimes->{3.7965683335422015`*^9},
 CellLabel->
  "Out[114]=",ExpressionUUID->"209c0ae2-0c5f-4cde-8024-376bd082cdc0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"ChainSimplify", "[", 
   RowBox[{"test", ",", 
    RowBox[{"{", 
     RowBox[{"MomCon", "\[Rule]", 
      RowBox[{"p4", "\[Rule]", 
       RowBox[{
        RowBox[{"-", "p1"}], "-", "p2", "-", "p3"}]}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.796568338916887*^9, 3.796568354741542*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"03461895-20a9-4e4e-a596-ce8a33a70605"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   TemplateBox[{"p1","p2"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], 
   TemplateBox[{"p1",RowBox[{"{", "p2", "}"}],"p3"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]]}]], "Output",
 CellChangeTimes->{3.7965683557349205`*^9},
 CellLabel->
  "Out[115]=",ExpressionUUID->"36a5605d-0aab-47af-85ba-f8ef4eb52297"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Analogous", " ", "case", " ", "but", " ", "simpler"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7966526319765177`*^9, 3.7966526333270626`*^9}, {
  3.796652674174886*^9, 
  3.7966526966928835`*^9}},ExpressionUUID->"4b8a4a8c-2c5b-4794-b2b4-\
f86d0841da1b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"a", "+", "b"}], ")"}], "/", "c"}]}]], "Input",
 CellChangeTimes->{{3.7966496994446917`*^9, 3.796649700734099*^9}, {
  3.7966522180439973`*^9, 3.796652228096177*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"94d4c6fd-d9fe-49bf-850d-9014beee4da0"],

Cell[BoxData[
 FractionBox[
  RowBox[{"a", "+", "b"}], "c"]], "Output",
 CellChangeTimes->{3.796652229663083*^9},
 CellLabel->"Out[85]=",ExpressionUUID->"730cf66e-a009-4b64-abcd-297651e65a67"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"test", ",", 
   RowBox[{"TransformationFunctions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"exp", " ", "\[Function]", 
       RowBox[{"exp", "/.", 
        RowBox[{"{", 
         RowBox[{"c", "\[Rule]", 
          RowBox[{"d", "-", "e"}]}], "}"}]}]}], ",", 
      RowBox[{"exp", " ", "\[Function]", 
       RowBox[{"exp", "/.", 
        RowBox[{"{", 
         RowBox[{"e", "\[Rule]", 
          RowBox[{"d", "-", "a", "-", "b"}]}], "}"}]}]}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.796652230682203*^9, 3.7966522355616536`*^9}, {
  3.7966522689730997`*^9, 3.796652329702196*^9}, {3.7966525191222687`*^9, 
  3.796652597471984*^9}, {3.796652842726712*^9, 3.7966528449620523`*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"067bd39b-2b38-4675-832a-2589b908fe60"],

Cell[BoxData[
 FractionBox[
  RowBox[{"a", "+", "b"}], "c"]], "Output",
 CellChangeTimes->{3.7966526005209556`*^9, 3.79665284558569*^9},
 CellLabel->"Out[89]=",ExpressionUUID->"6458d00a-9ebb-44d7-840f-435e7ea0ae59"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"test", "/.", 
  RowBox[{"{", 
   RowBox[{"c", "\[Rule]", 
    RowBox[{"d", "-", "e"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{"e", "\[Rule]", 
    RowBox[{"d", "-", "a", "-", "b"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.796652816033848*^9, 3.7966528523487062`*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"6fd481eb-ce0d-4af7-a426-55c778a8702e"],

Cell[BoxData[
 FractionBox[
  RowBox[{"a", "+", "b"}], 
  RowBox[{"d", "-", "e"}]]], "Output",
 CellChangeTimes->{{3.796652834737324*^9, 3.7966528529423647`*^9}},
 CellLabel->"Out[90]=",ExpressionUUID->"9e5a6625-0183-4280-a57a-ee56b937f873"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.796652834737324*^9, 3.796652852959339*^9}},
 CellLabel->"Out[91]=",ExpressionUUID->"ee3b2289-6760-47c6-bf5f-0bbffb4be125"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Whenever", " ", "the", " ", "intermediate", " ", "expression", " ", "is", 
   " ", "more", " ", "complicated", " ", "the", " ", "simplification", " ", 
   "does", " ", "not", " ", 
   RowBox[{"happen", "."}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7966528705109625`*^9, 3.7966528813643827`*^9}, {
  3.7966532874548025`*^9, 
  3.7966532992022147`*^9}},ExpressionUUID->"cb1728e3-4d43-4bed-83ba-\
63f3f67f1980"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Trying a new complexity functions", "Subsubsection",
 CellChangeTimes->{{3.796708480366984*^9, 
  3.796708487288599*^9}},ExpressionUUID->"89382653-904b-4232-bf4f-\
bbbf1ff49a8b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ComplicatedComplexityFunction", "[", 
   RowBox[{"exp_", ",", "list_"}], "]"}], ":=", 
  RowBox[{"LeafCount", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{"exp", ",", 
     RowBox[{"TransformationFunctions", "\[Rule]", "list"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.796701914741384*^9, 3.7967019410699577`*^9}, {
  3.7967019793838725`*^9, 3.7967020149865603`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"25631f87-a44c-44e8-aa1a-6c77de88bace"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ComplicatedComplexityFunction", "[", 
    RowBox[{"exp_", ",", "list_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"loc1", ",", "count"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"count", "=", 
       RowBox[{"LeafCount", "[", 
        RowBox[{"loc1", "=", 
         RowBox[{"Simplify", "[", 
          RowBox[{"exp", ",", 
           RowBox[{"TransformationFunctions", "\[Rule]", "list"}]}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<input \>\"", ",", "exp"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<manipulated \>\"", ",", " ", "loc1"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<count \>\"", ",", "count"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "count", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7967021169307566`*^9, 3.7967021304954104`*^9}, {
  3.796702273844223*^9, 3.7967023570012274`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"848b327f-763f-4af8-9479-292086e8d72e"],

Cell[BoxData[
 RowBox[{"OptionValue", "[", 
  RowBox[{"Simplify", ",", "TransformationFunctions"}], "]"}]], "Input",
 CellChangeTimes->{{3.7967019616698413`*^9, 3.7967019731964254`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"9c307887-91c6-472d-874a-8d0621bed505"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"a", "+", "b"}], ")"}], "/", "c"}]}]], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"1d8a3416-813e-460a-9639-4857996ca91c"],

Cell[BoxData[
 FractionBox[
  RowBox[{"a", "+", "b"}], "c"]], "Output",
 CellChangeTimes->{3.7967020453833785`*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"85b7b809-fbbc-4824-9af6-c450d2f20141"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"test", ",", 
   RowBox[{"TransformationFunctions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"exp", " ", "\[Function]", 
       RowBox[{"exp", "/.", 
        RowBox[{"{", 
         RowBox[{"c", "\[Rule]", 
          RowBox[{"d", "-", "e"}]}], "}"}]}]}], ",", 
      RowBox[{"exp", " ", "\[Function]", 
       RowBox[{"exp", "/.", 
        RowBox[{"{", 
         RowBox[{"e", "\[Rule]", 
          RowBox[{"d", "-", "a", "-", "b"}]}], "}"}]}]}]}], "}"}]}], ",", 
   RowBox[{"ComplexityFunction", "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ComplicatedComplexityFunction", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"exp", " ", "\[Function]", 
           RowBox[{"exp", "/.", 
            RowBox[{"{", 
             RowBox[{"c", "\[Rule]", 
              RowBox[{"d", "-", "e"}]}], "}"}]}]}], ",", 
          RowBox[{"exp", " ", "\[Function]", 
           RowBox[{"exp", "/.", 
            RowBox[{"{", 
             RowBox[{"e", "\[Rule]", 
              RowBox[{"d", "-", "a", "-", "b"}]}], "}"}]}]}]}], "}"}]}], 
       "]"}], "&"}], ")"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.796702067558062*^9, 3.796702089012378*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"9b77f23b-2fca-4881-8e37-d1c671550239"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{"a", "+", "b"}], "c"]}],
  SequenceForm["input ", ($CellContext`a + $CellContext`b)/$CellContext`c],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360643444*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"399991aa-a087-4b7a-8354-33c6036bc633"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{"a", "+", "b"}], "c"]}],
  SequenceForm[
  "manipulated ", ($CellContext`a + $CellContext`b)/$CellContext`c],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360672367*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"09045f90-9829-40a7-817f-798a6f45e9cf"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "7"}],
  SequenceForm["count ", 7],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023606793776`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"f88bef3c-a965-4293-a2f6-40000595647d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{"a", "+", "b"}], "c"]}],
  SequenceForm["input ", ($CellContext`a + $CellContext`b)/$CellContext`c],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023606833344`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"25dd9601-d8a7-485a-8d35-1f842f6335ec"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{"a", "+", "b"}], "c"]}],
  SequenceForm[
  "manipulated ", ($CellContext`a + $CellContext`b)/$CellContext`c],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023606873255`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"9d163904-9ca3-48bd-9b51-4365cc93601a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "7"}],
  SequenceForm["count ", 7],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023606923113`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"fddd6213-473d-4e53-b1ca-dbce95a2b342"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{"a", "+", "b"}], 
    RowBox[{"d", "-", "e"}]]}],
  SequenceForm[
  "input ", ($CellContext`a + $CellContext`b)/($CellContext`d - \
$CellContext`e)],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023606953373`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"62332f07-2988-4425-aeed-eb96bf01cdfb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["manipulated ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360698329*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"35e2c58f-101a-4c82-b483-4bf3b5bf9341"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["count ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023607002892`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"d6cd3598-e467-4c55-b9d4-17d6d55afe4f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{"a", "+", "b"}], 
    RowBox[{"d", "-", "e"}]]}],
  SequenceForm[
  "input ", ($CellContext`a + $CellContext`b)/($CellContext`d - \
$CellContext`e)],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360704282*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"caebe98f-b63f-45c6-98d7-7d13360458fb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["manipulated ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023607083054`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"3e76c928-d700-48ee-bb1e-8e353b6457d9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["count ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023607102976`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"08a88ab2-8a70-40eb-9878-4e9ee886ac93"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["input ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360713292*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"5871b693-bd8d-4f48-9fd5-dd61d7e5e5ed"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["manipulated ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023607152834`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"bcdda24b-1b29-4cf5-9855-cef501005228"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["count ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360718276*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"aa40dc44-1b54-4f23-9366-6e0e94c28e5a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{"a", "+", "b"}], 
    RowBox[{"d", "-", "e"}]]}],
  SequenceForm[
  "input ", ($CellContext`a + $CellContext`b)/($CellContext`d - \
$CellContext`e)],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023607232676`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"94b6653c-16bb-4cc0-87db-e6007d261113"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["manipulated ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023607262545`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"e5c7f96e-971b-4075-99b0-e34185ae19bc"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["count ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023607282505`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"b0590065-7c29-476e-95cc-d2a81f6b1936"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", 
   RowBox[{"a", "+", "b"}]}],
  SequenceForm["input ", $CellContext`a + $CellContext`b],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023607312417`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"b774efb3-2f3f-4672-81b1-557dbd704b05"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", 
   RowBox[{"a", "+", "b"}]}],
  SequenceForm["manipulated ", $CellContext`a + $CellContext`b],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023607342005`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"72e3a5b8-361d-442e-a4b6-dab6568f4127"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["count ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023607371902`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"1275a135-62e5-4b84-8cd4-a4b3d57aac02"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", 
   RowBox[{"a", "+", "b"}]}],
  SequenceForm["input ", $CellContext`a + $CellContext`b],
  Editable->False]], "Print",
 CellChangeTimes->{3.79670236074022*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"b0791bed-3f97-4328-b2b7-390ce6ccf080"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", 
   RowBox[{"a", "+", "b"}]}],
  SequenceForm["manipulated ", $CellContext`a + $CellContext`b],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023607422123`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"4a43db4f-abd5-48a8-84ad-1d16f6ee14d9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["count ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023607451696`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"c2644720-9919-4c10-85ba-0cfabb07b779"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", 
   RowBox[{"a", "+", "b"}]}],
  SequenceForm["input ", $CellContext`a + $CellContext`b],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023607471642`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"eb3bd9f2-2c4b-427d-86da-ab0029999503"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", 
   RowBox[{"a", "+", "b"}]}],
  SequenceForm["manipulated ", $CellContext`a + $CellContext`b],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360750156*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"036ef042-1733-4b70-b992-0cfe8ae4853c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["count ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360755145*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"614930d3-911a-4661-bc24-1ec015de48c4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", "a"}],
  SequenceForm["input ", $CellContext`a],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023607571735`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"87281465-a76c-494f-894f-98a6133245dd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", "a"}],
  SequenceForm["manipulated ", $CellContext`a],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023607601633`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"b5ea054e-8d05-4994-b5e5-2dccaf63a127"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["count ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360762158*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"b5fe611c-8dc6-43e9-80ae-578435033065"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", "a"}],
  SequenceForm["input ", $CellContext`a],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023607651167`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"8019152d-f003-4cfc-bd56-177b4675069e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", "a"}],
  SequenceForm["manipulated ", $CellContext`a],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023607671447`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"046c13c6-54e7-417d-b3f2-eac63b0b70e4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["count ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023607701035`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"5c634da8-4946-42e7-bccd-6b2d1692f0f8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", "a"}],
  SequenceForm["input ", $CellContext`a],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023607731285`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"3801085f-c67d-47f4-b424-6471da9df8dd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", "a"}],
  SequenceForm["manipulated ", $CellContext`a],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360775123*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"9f9a1f9e-e05f-40dc-970b-554e76f7ae5b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["count ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023607771177`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"70f79702-2b2a-4f3a-9222-0ffec924cbd9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", "b"}],
  SequenceForm["input ", $CellContext`b],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023607791133`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"52ec75d1-a077-40ec-b500-57002ff9e4ac"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", "b"}],
  SequenceForm["manipulated ", $CellContext`b],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023607811074`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"b92eb398-2878-4696-a381-dcc4a86a8756"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["count ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360784067*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"e4cafeaf-8dbe-4aed-a4da-a40ad120573b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", "b"}],
  SequenceForm["input ", $CellContext`b],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360787097*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"ad3b8971-caf2-4bf8-bf50-423e2ba6979c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", "b"}],
  SequenceForm["manipulated ", $CellContext`b],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023607900863`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"19417433-b75b-458f-9d16-2dfbe91f6138"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["count ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023607920804`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"7ef83392-1436-4899-9cbf-d114982b7321"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", "b"}],
  SequenceForm["input ", $CellContext`b],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360794075*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"d2f8be91-e145-4470-a83e-b0f57be1bb18"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", "b"}],
  SequenceForm["manipulated ", $CellContext`b],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023607970667`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"36afb8a2-1396-4806-b0f0-0e9f83d03aea"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["count ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023608000593`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"96dae273-bb6c-491d-b1fe-324637d2b70a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", 
   RowBox[{"a", "+", "b"}]}],
  SequenceForm["input ", $CellContext`a + $CellContext`b],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360802017*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"79a62f73-ce37-4f88-802d-61898e01932a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", 
   RowBox[{"a", "+", "b"}]}],
  SequenceForm["manipulated ", $CellContext`a + $CellContext`b],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360805046*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"9b671ce3-dfdb-4925-acf4-53a21022f8dd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["count ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023608070445`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"3ee08132-18b2-4087-8ab0-12d39d4775e4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{"d", "-", "e"}]]}],
  SequenceForm["input ", ($CellContext`d - $CellContext`e)^(-1)],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023608099966`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"2228a3df-572a-4d40-8394-c8f8c7f949de"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{"a", "+", "b"}]]}],
  SequenceForm["manipulated ", ($CellContext`a + $CellContext`b)^(-1)],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360814985*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"98cec657-d096-4932-8b67-3f6b91705565"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "5"}],
  SequenceForm["count ", 5],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023608180094`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"1a691449-1d6c-44ab-ad56-8221914675f4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{"a", "+", "b"}]]}],
  SequenceForm["input ", ($CellContext`a + $CellContext`b)^(-1)],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023608219647`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"bd61ba0c-e1f3-4692-aa85-d1c80f591614"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{"a", "+", "b"}]]}],
  SequenceForm["manipulated ", ($CellContext`a + $CellContext`b)^(-1)],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023608259892`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"0d99d33a-6501-4d76-9aea-14463aa91730"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "5"}],
  SequenceForm["count ", 5],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360828946*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"443aa0bc-46f8-4ceb-b54a-3a1c77fcb996"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{"d", "-", "e"}]]}],
  SequenceForm["input ", ($CellContext`d - $CellContext`e)^(-1)],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360834963*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"b714a649-27ff-41b5-b79a-2860adbbba7f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{"a", "+", "b"}]]}],
  SequenceForm["manipulated ", ($CellContext`a + $CellContext`b)^(-1)],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023608379607`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"e59ac42e-13a6-464e-8f65-ed862b8be709"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "5"}],
  SequenceForm["count ", 5],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360840914*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"686416d4-28c3-4e33-8929-7e5fdc905370"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", 
   RowBox[{"d", "-", "e"}]}],
  SequenceForm["input ", $CellContext`d - $CellContext`e],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360844905*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"3113cf53-4d4d-482a-b752-3b8b39ab955a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", 
   RowBox[{"a", "+", "b"}]}],
  SequenceForm["manipulated ", $CellContext`a + $CellContext`b],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360847932*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"04b584a5-3d8d-4d9f-bc39-6bf8f7deb94a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["count ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360849922*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"dc14f128-0df7-40c5-bbd7-e9dd30a69cfd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", 
   RowBox[{"a", "+", "b"}]}],
  SequenceForm["input ", $CellContext`a + $CellContext`b],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360851919*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"addc42eb-1f0e-4216-a508-73f200b0aac5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", 
   RowBox[{"a", "+", "b"}]}],
  SequenceForm["manipulated ", $CellContext`a + $CellContext`b],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360854876*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"14d6ac51-0665-4cbc-9618-f12af20b07e0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["count ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.79670236085787*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"9feedd57-1f25-4186-b239-3a0216737d9d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", 
   RowBox[{"d", "-", "e"}]}],
  SequenceForm["input ", $CellContext`d - $CellContext`e],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360859895*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"05829bac-f170-4aed-aa83-bfaf6aba3f2a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", 
   RowBox[{"a", "+", "b"}]}],
  SequenceForm["manipulated ", $CellContext`a + $CellContext`b],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360862887*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"42b0fa3a-0557-4a7c-852f-37dbbf0ad6ba"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["count ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023608648844`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"e7276f4a-baf9-44ca-876c-0804f0c2a75d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", "d"}],
  SequenceForm["input ", $CellContext`d],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023608678837`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"f84de509-64b4-4387-bce3-f1b192b14e07"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", "d"}],
  SequenceForm["manipulated ", $CellContext`d],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360869872*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"83e18918-98f7-4c8a-9e59-70143f32776c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["count ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023608728623`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"454c34bd-3c73-49b1-b8ca-b2ad211c7869"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", "d"}],
  SequenceForm["input ", $CellContext`d],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360874856*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"4d1096d2-244c-4f2f-8cf1-e67eada027fe"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", "d"}],
  SequenceForm["manipulated ", $CellContext`d],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023608808093`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"3070416d-81fb-4ebf-8761-455739ed4a66"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["count ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360882836*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"35d73e8d-a488-4652-871e-5f9b7d0ed359"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", "d"}],
  SequenceForm["input ", $CellContext`d],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023608857965`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"f228e8e0-e325-4ec0-931d-be74d4362169"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", "d"}],
  SequenceForm["manipulated ", $CellContext`d],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360888821*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"704c764c-4252-4912-9c08-42267d5f46c5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["count ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360890815*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"9f581876-e965-4483-8169-4e107e5bf283"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "e"}]}],
  SequenceForm["input ", -$CellContext`e],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360894771*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"d141911c-59b6-4ae8-a1d5-e0575cd7fd6c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "e"}]}],
  SequenceForm["manipulated ", -$CellContext`e],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360896799*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"9d2eae31-5b8c-4d11-972e-308d097d92e4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["count ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023608997917`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"c0ee4de4-0675-4360-b51d-46923e1854dd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", 
   RowBox[{"a", "+", "b", "-", "d"}]}],
  SequenceForm["input ", $CellContext`a + $CellContext`b - $CellContext`d],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360901786*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"5bda8a89-b3ee-4637-bb8a-0fdac045ecb2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", 
   RowBox[{"a", "+", "b", "-", "d"}]}],
  SequenceForm[
  "manipulated ", $CellContext`a + $CellContext`b - $CellContext`d],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360904745*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"b8442ed9-92d7-412a-86a6-14f66eca670b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "6"}],
  SequenceForm["count ", 6],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360907737*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"ee4d2010-fe3f-48c8-ad9c-711debba4753"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "e"}]}],
  SequenceForm["input ", -$CellContext`e],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023609107285`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"625e7462-76a9-4fb2-a53b-f05f626fa0ab"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "e"}]}],
  SequenceForm["manipulated ", -$CellContext`e],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023609127235`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"d3a55ad0-f927-43fe-bcff-4c2b000fff18"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["count ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023609147177`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"f5947910-6aa3-4a0d-83b4-a07411e374fa"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "1"}]}],
  SequenceForm["input ", -1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023609177103`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"ea6f7341-18b1-4fd8-a846-a016ec7ca888"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "1"}]}],
  SequenceForm["manipulated ", -1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023609207077`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"6d04af10-4caa-4963-bfe1-e9a1f0bfd168"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["count ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023609267216`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"185cdd54-087d-4cad-9012-ea35b1bed9c2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "1"}]}],
  SequenceForm["input ", -1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023609287157`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"429bbaa2-88fd-491e-a351-824042ceea95"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "1"}]}],
  SequenceForm["manipulated ", -1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023609317102`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"2df2053d-d964-4aa4-ab06-4474a7a05c50"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["count ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023609346995`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"855734f2-9e89-4908-a27a-8769bff7e7d5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "1"}]}],
  SequenceForm["input ", -1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023609396496`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"b50efcdd-31fc-42b2-9525-e4e8a11b4018"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "1"}]}],
  SequenceForm["manipulated ", -1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023609426775`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"0fad95dd-790c-4714-a52d-ce395f3dc91c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["count ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023609446735`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"d7b838d9-cdfe-4861-92b4-bd65c24b15a4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", "e"}],
  SequenceForm["input ", $CellContext`e],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023609476647`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"b35c185e-d6bf-40a8-bb88-209d09d6dab0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", "e"}],
  SequenceForm["manipulated ", $CellContext`e],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023609496565`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"dbc3f411-e9da-4f47-89d7-bccedd2528ca"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["count ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023609536123`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"d310ae1c-cb8f-43af-859e-235e82a7e324"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"-", "a"}], "-", "b", "+", "d"}]}],
  SequenceForm["input ", -$CellContext`a - $CellContext`b + $CellContext`d],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023609566383`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"bd972736-c04a-44f9-bbe7-9361b678e5b4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"-", "a"}], "-", "b", "+", "d"}]}],
  SequenceForm[
  "manipulated ", -$CellContext`a - $CellContext`b + $CellContext`d],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023609596305`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"3f5e52fa-8c28-41b3-890e-4fdba57c5fa9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "8"}],
  SequenceForm["count ", 8],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360961625*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"a1dc50af-166d-45c1-bd51-1268b8527052"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", "e"}],
  SequenceForm["input ", $CellContext`e],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023609655824`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"61100082-d1f1-4c08-bf67-0ec84cc10a71"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", "e"}],
  SequenceForm["manipulated ", $CellContext`e],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023609686065`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"3f729898-e320-42ac-a9b2-13aa8c09df2b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["count ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360970601*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"f98d3956-3eca-4a53-ac61-e3cd73d7f1b4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "e"}]}],
  SequenceForm["input ", -$CellContext`e],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023609755535`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"a8634678-ae2a-4392-854e-bb1146576f4d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "e"}]}],
  SequenceForm["manipulated ", -$CellContext`e],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360978577*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"dbd41e10-9bfe-4dd4-babb-6768dbdd17dd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["count ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360980574*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"7a67d6cf-14d3-489d-8a98-c3e00332d36e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", 
   RowBox[{"d", "-", "e"}]}],
  SequenceForm["input ", $CellContext`d - $CellContext`e],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360983564*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"7a0793d1-bbb8-4fdb-a383-a54daece9f49"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", 
   RowBox[{"a", "+", "b"}]}],
  SequenceForm["manipulated ", $CellContext`a + $CellContext`b],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023609865246`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"ba65d6eb-a557-4508-9da4-9515e44068e3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["count ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023609895506`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"99ea9e7a-0ad3-449c-a5a7-13eec9cfa2e1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "1"}]}],
  SequenceForm["input ", -1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023609915423`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"af7e9adc-a30f-4822-8f3b-eb33fad7c239"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "1"}]}],
  SequenceForm["manipulated ", -1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023609945354`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"ed9eeaee-f859-4d86-803c-04bd830afa94"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["count ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702360997529*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"67832e04-297e-49a5-8e95-c522e0423c81"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "1"}]}],
  SequenceForm["input ", -1],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702361001486*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"6ab654fa-9292-4e85-adbb-fc066f131771"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "1"}]}],
  SequenceForm["manipulated ", -1],
  Editable->False]], "Print",
 CellChangeTimes->{3.79670236100451*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"96480f46-1fd2-40dc-b9d8-fc15efb2297d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["count ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702361006503*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"3b090cae-e49a-49b4-80b8-116f3546ffb4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "1"}]}],
  SequenceForm["input ", -1],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702361009495*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"c9b291ff-636b-4370-9a05-0f21630e04bb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "1"}]}],
  SequenceForm["manipulated ", -1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023610114956`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"5fe6e325-d292-4f3e-9056-7e7a368c5f75"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["count ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023610144825`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"41062322-65de-4581-accf-71c288a023c4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{"d", "-", "e"}]]}],
  SequenceForm["input ", ($CellContext`d - $CellContext`e)^(-1)],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702361017479*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"04112930-0fe8-4c7b-8598-6ecb9d3782c5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{"a", "+", "b"}]]}],
  SequenceForm["manipulated ", ($CellContext`a + $CellContext`b)^(-1)],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702361021432*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"07d3ae4e-6f9a-4ebb-878f-4b851615237b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "5"}],
  SequenceForm["count ", 5],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702361024457*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"8218a107-76fe-45d5-97d4-cf39a7371957"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"input \"\>", "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{"a", "+", "b"}], 
    RowBox[{"d", "-", "e"}]]}],
  SequenceForm[
  "input ", ($CellContext`a + $CellContext`b)/($CellContext`d - \
$CellContext`e)],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702361027452*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"0b0fc895-9ea0-4553-9ac2-9bb9035b7c25"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"manipulated \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["manipulated ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.796702361030441*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"0bfcb5b5-c776-4baa-ad62-be7e0e9bee1e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"count \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["count ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7967023610334373`*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"e9133f3a-16de-4ce1-8b18-d3106f878fb1"]
}, Open  ]],

Cell[BoxData[
 FractionBox[
  RowBox[{"a", "+", "b"}], 
  RowBox[{"d", "-", "e"}]]], "Output",
 CellChangeTimes->{3.7967020927473917`*^9, 3.7967023610363927`*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"40d71a81-6dbc-4d52-af12-f74d8a97d203"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Some tests to be carried out...", "Section",
 CellChangeTimes->{{3.7951783501852574`*^9, 3.795178352412285*^9}, {
  3.7951806326223707`*^9, 
  3.7951806374485197`*^9}},ExpressionUUID->"ca9dfa80-2c21-495b-bfb1-\
007ba6c2900e"],

Cell["R^3 helicity flip in a given channel", "Subsection",
 CellChangeTimes->{{3.795180642356388*^9, 
  3.7951806516694736`*^9}},ExpressionUUID->"cc9e1c87-4e09-4813-9862-\
71eebbfb3aad"],

Cell[CellGroupData[{

Cell["BCFW 4 pt", "Subsection",
 CellChangeTimes->{{3.7951786833840866`*^9, 
  3.7951786962047787`*^9}},ExpressionUUID->"f657f205-910e-4ef3-93ec-\
df4f6836e3fa"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"4", "pt"}], ",", " ", 
   RowBox[{"+", 
    RowBox[{"--", "+"}]}], ",", " ", 
   RowBox[{"with", " ", "1", " ", "and", " ", "4", " ", "shifted"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7951798212066793`*^9, 
  3.7951798346577377`*^9}},ExpressionUUID->"d0963e87-6a14-4d02-8103-\
71bbc8ade603"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bcfw", "=", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      TemplateBox[{"p1hat","Phat"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "^", "3"}], "*", 
     RowBox[{
      TemplateBox[{RowBox[{"-", "Phat"}],"p3"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "^", "3"}]}], 
    RowBox[{
     TemplateBox[{"p2","Phat"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], 
     TemplateBox[{"p1hat","p2"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], 
     RowBox[{"S4", "[", 
      RowBox[{"p1", ",", "p2"}], "]"}], 
     TemplateBox[{"p3","p4hat"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], 
     TemplateBox[{"p4hat",RowBox[{"-", "Phat"}]},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{
      TemplateBox[{"p2","Phat"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "^", "3"}], "*", 
     RowBox[{
      TemplateBox[{"p4hat",RowBox[{"-", "Phat"}]},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "^", "3"}]}], 
    RowBox[{
     TemplateBox[{"Phat","p1hat"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], 
     TemplateBox[{"p1hat","p2"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], 
     RowBox[{"S4", "[", 
      RowBox[{"p1", ",", "p2"}], "]"}], 
     TemplateBox[{RowBox[{"-", "Phat"}],"p3"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], 
     TemplateBox[{"p3","p4hat"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}]]}]}]], "Input",
 CellChangeTimes->{{3.7951798441064844`*^9, 3.795180082235501*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"54c24bba-204c-499e-8fe6-32ca97229026"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox[
     TemplateBox[{"p3","Phat"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "3"], " ", 
    SuperscriptBox[
     TemplateBox[{"p1hat","Phat"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "3"]}], 
   RowBox[{
    RowBox[{"S4", "[", 
     RowBox[{"p1", ",", "p2"}], "]"}], " ", 
    TemplateBox[{"p3","p4hat"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"p4hat","Phat"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"p1hat","p2"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"p2","Phat"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     TemplateBox[{"p2","Phat"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "3"], " ", 
    SuperscriptBox[
     TemplateBox[{"p4hat","Phat"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "3"]}], 
   RowBox[{
    RowBox[{"S4", "[", 
     RowBox[{"p1", ",", "p2"}], "]"}], " ", 
    TemplateBox[{"p1hat","p2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"p1hat","Phat"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"p3","p4hat"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"p3","Phat"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}]]}]], "Output",
 CellChangeTimes->{3.79518008460222*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"ef5b2587-dc00-450b-a6c9-fee3b58657db"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight", "[", "bcfw", "]"}]], "Input",
 CellChangeTimes->{{3.7951800882235384`*^9, 3.7951800920014124`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"22d32a70-569c-46f0-b59c-0fea03bd9b98"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p1hat", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p2", ",", 
     RowBox[{"-", "2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p3", ",", 
     RowBox[{"-", "2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p4hat", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.795180092610792*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"ede6b7bd-0e62-4b30-9f11-daa4ab2b438e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bcfw", "=", 
  RowBox[{"SpinorReplace", "[", 
   RowBox[{"bcfw", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       TemplateBox[{"p1hat"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
       RowBox[{
        TemplateBox[{"p1"},
         "SpinorUndotPureL",
         DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "+", 
        RowBox[{"z", "*", 
         TemplateBox[{"p4"},
          "SpinorUndotPureL",
          DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
          
          InterpretationFunction->(
           RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", 
             "]"}]& )]}]}]}], ",", 
      RowBox[{
       TemplateBox[{"p4hat"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
       TemplateBox[{"p4"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
      ",", 
      RowBox[{
       TemplateBox[{"p1hat"},
        "SpinorDotPureL",
        DisplayFunction->(RowBox[{
           OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
       TemplateBox[{"p1"},
        "SpinorDotPureL",
        DisplayFunction->(RowBox[{
           OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], ",", 
      RowBox[{
       TemplateBox[{"p4hat"},
        "SpinorDotPureL",
        DisplayFunction->(RowBox[{
           OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
       RowBox[{
        TemplateBox[{"p4"},
         "SpinorDotPureL",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "-", 
        RowBox[{"z", "*", 
         TemplateBox[{"p1"},
          "SpinorDotPureL",
          DisplayFunction->(RowBox[{
             OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
          
          InterpretationFunction->(
           RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", 
             "]"}]& )]}]}]}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.795180101975754*^9, 3.795180204614208*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"a25d4959-dba0-4d27-8f2d-da8d2c8cb530"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox[
     TemplateBox[{"p3","Phat"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "3"], " ", 
    SuperscriptBox[
     TemplateBox[{"p1","Phat"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "3"]}], 
   RowBox[{
    RowBox[{"S4", "[", 
     RowBox[{"p1", ",", "p2"}], "]"}], " ", 
    TemplateBox[{"p3","p4"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"p4","Phat"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"p1","p2"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"p2","Phat"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     TemplateBox[{"p2","Phat"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "3"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "z"}], " ", 
        TemplateBox[{"p1","Phat"},
         "SpinorSquareBracket",
         DisplayFunction->(RowBox[{"[", 
            RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
         InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
            RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
       TemplateBox[{"p4","Phat"},
        "SpinorSquareBracket",
        DisplayFunction->(RowBox[{"[", 
           RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
        InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}], ")"}], "3"]}], 
   RowBox[{
    RowBox[{"S4", "[", 
     RowBox[{"p1", ",", "p2"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      TemplateBox[{"p1","p2"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "-", 
      RowBox[{"z", " ", 
       TemplateBox[{"p2","p4"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      TemplateBox[{"p1","Phat"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "+", 
      RowBox[{"z", " ", 
       TemplateBox[{"p4","Phat"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"z", " ", 
       TemplateBox[{"p1","p3"},
        "SpinorSquareBracket",
        DisplayFunction->(RowBox[{"[", 
           RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
        InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
      TemplateBox[{"p3","p4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], ")"}], " ", 
    TemplateBox[{"p3","Phat"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}]]}]], "Output",
 CellChangeTimes->{3.795180207995164*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"22110703-9265-4911-a636-6a1cfa3b34f3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"DeclareMom", "[", 
  RowBox[{"Phat", ",", "P"}], "]"}]], "Input",
 CellChangeTimes->{{3.7951804029058523`*^9, 3.795180408725281*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"f9641e7e-8748-4c4c-96c6-136e04a1d6e8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpinorSimplify", "[", 
  RowBox[{"bcfw", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Phat", "\[Rule]", 
      RowBox[{"p1", "+", "p2", "+", 
       RowBox[{"z", "*", "P"}]}]}], ",", 
     RowBox[{"Phat", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "p3"}], "-", "p4", "+", 
       RowBox[{"z", "*", "P"}]}]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.795180269167517*^9, 3.795180291258475*^9}, {
  3.7951803579580746`*^9, 3.7951803880415883`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"9148e494-322e-41f8-a126-d0cc935d53d7"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   FractionBox[
    SuperscriptBox[
     TemplateBox[{"p3",RowBox[{"{", "Phat", "}"}],"p1"},
      "AngleSquareChain",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
         "$square", "]"}]& )], "3"], 
    RowBox[{
     TemplateBox[{"p4",RowBox[{"{", "Phat", "}"}],"p2"},
      "AngleSquareChain",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
         "$square", "]"}]& )], " ", 
     TemplateBox[{"p3","p4"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], " ", 
     TemplateBox[{"p1","p2"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}]], "+", 
   FractionBox[
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "z"}], " ", 
        TemplateBox[{"p2",RowBox[{"{", "Phat", "}"}],"p1"},
         "AngleSquareChain",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
            "$square", "]"}]& )]}], "+", 
       TemplateBox[{"p2",RowBox[{"{", "Phat", "}"}],"p4"},
        "AngleSquareChain",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
        InterpretationFunction->(
         RowBox[{
          "Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
           "]"}]& )]}], ")"}], "3"], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       TemplateBox[{"p1","p2"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "-", 
       RowBox[{"z", " ", 
        TemplateBox[{"p2","p4"},
         "SpinorAngleBracket",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
            RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
         InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
            RowBox[{#, ",", #2}], "]"}]& )]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       TemplateBox[{"p1","Phat"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "+", 
       RowBox[{"z", " ", 
        TemplateBox[{"p4","Phat"},
         "SpinorAngleBracket",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
            RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
         InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
            RowBox[{#, ",", #2}], "]"}]& )]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"z", " ", 
        TemplateBox[{"p1","p3"},
         "SpinorSquareBracket",
         DisplayFunction->(RowBox[{"[", 
            RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
         InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
            RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
       TemplateBox[{"p3","p4"},
        "SpinorSquareBracket",
        DisplayFunction->(RowBox[{"[", 
           RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
        InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}], ")"}], " ", 
     TemplateBox[{"p3","Phat"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}]]}], 
  RowBox[{"S4", "[", 
   RowBox[{"p1", ",", "p2"}], "]"}]]], "Output",
 CellChangeTimes->{{3.795180391425541*^9, 3.7951804152009106`*^9}},
 CellLabel->"Out[35]=",ExpressionUUID->"ce2416fc-c102-4e1d-992e-5839df45f185"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Graviton bending in EH", "Subsection",
 CellChangeTimes->{{3.7951783587503457`*^9, 
  3.795178367289505*^9}},ExpressionUUID->"c5bdf1d3-b865-4153-a7d7-\
2c7c41e66124"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Scalar", " ", "EH", " ", "amplitude", " ", "with", " ", "one", " ", 
   "positive", " ", "and", " ", "one", " ", "negative", " ", "graviton"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7921564352848225`*^9, 3.7921564592048903`*^9}, {
  3.7922376417124653`*^9, 3.7922376534181805`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"5b570cb0-302e-4a05-b8dc-e018a51d15a5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A4mp", "[", 
   RowBox[{"p1_", ",", "p2_", ",", "p3_", ",", "p4_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Kappa]", "/", "2"}], ")"}], "^", "2"}]}], "*", 
   RowBox[{
    RowBox[{
     TemplateBox[{"p3",RowBox[{"{", "p1", "}"}],"p4"},
      "AngleSquareChain",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
         "$square", "]"}]& )], "^", "4"}], "/", 
    RowBox[{
     RowBox[{"S4", "[", 
      RowBox[{"p1", ",", "p2"}], "]"}], "^", "2"}]}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"I", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"mp", "[", 
         RowBox[{"p3", "+", "p1"}], "]"}], "-", 
        RowBox[{"m", "^", "2"}]}], ")"}]}], "+", 
     RowBox[{"I", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"mp", "[", 
         RowBox[{"p3", "+", "p2"}], "]"}], "-", 
        RowBox[{"m", "^", "2"}]}], ")"}]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{3.7922376386107187`*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"41d4f0d5-319a-4e4c-91b8-f9528652b982"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Scalar", " ", "EH", " ", "with", " ", "two", " ", 
   RowBox[{"positive", "/", "negative"}], " ", "gravitons"}], "*)"}]], "Input",
 CellChangeTimes->{{3.794892856031072*^9, 3.7948928743560557`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"2e73a0b5-fea0-43bd-96ee-8bb40c3291c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A4pp", "[", 
   RowBox[{"p1_", ",", "p2_", ",", "p3_", ",", "p4_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Kappa]", "/", "2"}], ")"}], "^", "2"}]}], "*", 
   RowBox[{"m", "^", "4"}], "*", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"I", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"mp", "[", 
         RowBox[{"p3", "+", "p1"}], "]"}], "-", 
        RowBox[{"m", "^", "2"}]}], ")"}]}], "+", 
     RowBox[{"I", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"mp", "[", 
         RowBox[{"p3", "+", "p2"}], "]"}], "-", 
        RowBox[{"m", "^", "2"}]}], ")"}]}]}], ")"}], "*", 
   RowBox[{
    RowBox[{
     TemplateBox[{"p3","p4"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "^", "2"}], "/", 
    RowBox[{
     TemplateBox[{"p3","p4"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "^", "2"}]}]}]}]], "Input",
 CellChangeTimes->{{3.789395093686539*^9, 3.7893951908936253`*^9}, {
  3.7893953964370484`*^9, 3.7893954030095067`*^9}, {3.790507917935467*^9, 
  3.7905079219138265`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"8d72aaa2-7ac1-4b08-99f8-7b2140d4fd14"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A4mm", "[", 
   RowBox[{"p1_", ",", "p2_", ",", "p3_", ",", "p4_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Kappa]", "/", "2"}], ")"}], "^", "2"}]}], "*", 
   RowBox[{"m", "^", "4"}], "*", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"I", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"mp", "[", 
         RowBox[{"p3", "+", "p1"}], "]"}], "-", 
        RowBox[{"m", "^", "2"}]}], ")"}]}], "+", 
     RowBox[{"I", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"mp", "[", 
         RowBox[{"p3", "+", "p2"}], "]"}], "-", 
        RowBox[{"m", "^", "2"}]}], ")"}]}]}], ")"}], "*", 
   RowBox[{
    RowBox[{
     TemplateBox[{"p3","p4"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "^", "2"}], "/", 
    RowBox[{
     TemplateBox[{"p3","p4"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "^", "2"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7893951952879267`*^9, 3.789395218509785*^9}, {
  3.7893954070247326`*^9, 3.789395410560279*^9}, {3.7905079259490347`*^9, 
  3.790507929066697*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"a5bd9e7e-7d86-4538-87e9-4e2609d48c32"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"grEH", "=", 
  RowBox[{
   RowBox[{"A4mp", "[", 
    RowBox[{"p1", ",", "p2", ",", "l1", ",", "l2"}], "]"}], "*", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "I"}], "*", "s"}], ")"}], 
   RowBox[{"(", 
    RowBox[{"I", "*", 
     FractionBox[
      RowBox[{
       TemplateBox[{RowBox[{"-", "l2"}],"p3"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "^", "4"}], 
      RowBox[{
       TemplateBox[{RowBox[{"-", "l2"}],RowBox[{"-", "l1"}]},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], 
       TemplateBox[{RowBox[{"-", "l1"}],"p3"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], 
       TemplateBox[{"p3","p4"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], 
       TemplateBox[{"p4",RowBox[{"-", "l2"}]},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}]]}], ")"}], 
   RowBox[{"(", 
    RowBox[{"I", "*", 
     FractionBox[
      RowBox[{
       TemplateBox[{RowBox[{"-", "l2"}],"p3"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "^", "4"}], 
      RowBox[{
       TemplateBox[{RowBox[{"-", "l2"}],RowBox[{"-", "l1"}]},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], 
       TemplateBox[{RowBox[{"-", "l1"}],"p4"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], 
       TemplateBox[{"p4","p3"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], 
       TemplateBox[{"p3",RowBox[{"-", "l2"}]},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}]]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.794718814769932*^9, 3.7947188934755754`*^9}, 
   3.794719003408721*^9, 3.7947192069296646`*^9, {3.794719372143155*^9, 
   3.794719550117364*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"37a314ae-9d16-4e38-9e15-d26e60175c98"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", "s", " ", 
   SuperscriptBox["\[Kappa]", "2"], " ", 
   SuperscriptBox[
    TemplateBox[{"l1",RowBox[{"{", "p1", "}"}],"l2"},
     "AngleSquareChain",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["\[ImaginaryI]", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["m", "2"]}], "+", 
       TemplateBox[{
        TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
          InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
         RowBox[{
           
           TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )], 
           "+", 
           
           TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]}]},
        "ScalarProduct",
        DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
        InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
       "+", 
       TemplateBox[{
        TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
          InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
         RowBox[{
           
           TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )], 
           "+", 
           
           TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]}]},
        "ScalarProduct",
        DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
        InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )]}]], 
     "+", 
     FractionBox["\[ImaginaryI]", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["m", "2"]}], "+", 
       TemplateBox[{
        TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
          InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
         RowBox[{
           
           TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )], 
           "+", 
           
           TemplateBox[{"p2"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]}]},
        "ScalarProduct",
        DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
        InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
       "+", 
       TemplateBox[{
        TemplateBox[{"p2"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
          InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
         RowBox[{
           
           TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )], 
           "+", 
           
           TemplateBox[{"p2"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]}]},
        "ScalarProduct",
        DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
        InterpretationFunction->(
         RowBox[{"mp", "[", #, ",", #2, "]"}]& )]}]]}], ")"}], " ", 
   SuperscriptBox[
    TemplateBox[{"l2","p3"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "7"]}], 
  RowBox[{"4", " ", 
   SuperscriptBox[
    RowBox[{"S4", "[", 
     RowBox[{"p1", ",", "p2"}], "]"}], "2"], " ", 
   SuperscriptBox[
    TemplateBox[{"l1","l2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
   TemplateBox[{"l1","p3"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], " ", 
   TemplateBox[{"l1","p4"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], " ", 
   TemplateBox[{"l2","p4"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], " ", 
   SuperscriptBox[
    TemplateBox[{"p3","p4"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "2"]}]]], "Output",
 CellChangeTimes->{
  3.7947188953754997`*^9, {3.7947195542842646`*^9, 3.7947195776198797`*^9}, 
   3.7951784556332383`*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"41af4940-db4c-43f1-a875-0cea8afa9f34"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pref", "=", 
  FractionBox["1", 
   SuperscriptBox[
    TemplateBox[{"p4",RowBox[{"{", "p2", "}"}],"p3"},
     "AngleSquareChain",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "4"]]}]], "Input",
 CellChangeTimes->{{3.7947189791635447`*^9, 3.7947189939659243`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"2fbb0461-6d34-4957-9485-4032448c7568"],

Cell[BoxData[
 FractionBox["1", 
  SuperscriptBox[
   TemplateBox[{"p4",RowBox[{"{", "p2", "}"}],"p3"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )], "4"]]], "Output",
 CellChangeTimes->{{3.7947189804520464`*^9, 3.794718994489523*^9}, 
   3.7951784607475605`*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"20c31cfc-fc65-4bfc-8227-a69a9a98142b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"KillMasses", "[", 
  RowBox[{"{", 
   RowBox[{"l1", ",", "l2", ",", "p3", ",", "p4"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.7951784768155994`*^9, 3.795178486853699*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"aeb4659f-8063-4371-86f4-5c21f60894a0"],

Cell[BoxData[
 RowBox[{"DeclareMom", "[", 
  RowBox[{"p1", ",", "p2", ",", "p3", ",", "p4", ",", "l1", ",", "l2"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.79517849119613*^9, 3.7951784985204973`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"9c25b5a9-6a10-45a0-8bd8-12114e4bbac1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpinorSimplify", "[", 
  RowBox[{"grEH", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"p1", "+", "p2", "+", "p3", "+", "p4"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"l2", "+", "l1", "+", "p3", "+", "p4"}], "\[Rule]", "0"}]}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7951785022315664`*^9, 3.7951785915277634`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"49e6787d-a91f-4aa5-85f1-84173dee1732"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"s", " ", 
    SuperscriptBox["\[Kappa]", "2"], " ", 
    SuperscriptBox[
     TemplateBox[{"l1",RowBox[{"{", "p1", "}"}],"l2"},
      "AngleSquareChain",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
         "$square", "]"}]& )], "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["m", "2"]}], "+", 
        RowBox[{"2", " ", 
         TemplateBox[{
          TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
           TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
          "ScalarProduct",
          DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
          InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )]}],
         "+", 
        TemplateBox[{
         TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
          TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
         "ScalarProduct",
         DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
         InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )]}]],
       "+", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["m", "2"]}], "+", 
        RowBox[{"2", " ", 
         TemplateBox[{
          TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
           TemplateBox[{"p2"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
          "ScalarProduct",
          DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
          InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )]}],
         "+", 
        TemplateBox[{
         TemplateBox[{"p2"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
          TemplateBox[{"p2"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
         "ScalarProduct",
         DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
         InterpretationFunction->(
          RowBox[{"mp", "[", #, ",", #2, "]"}]& )]}]]}], ")"}], " ", 
    SuperscriptBox[
     TemplateBox[{"l2","p3"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "7"]}], 
   RowBox[{"4", " ", 
    SuperscriptBox[
     RowBox[{"S4", "[", 
      RowBox[{"p1", ",", "p2"}], "]"}], "2"], " ", 
    SuperscriptBox[
     TemplateBox[{"l1","l2"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
    TemplateBox[{"l1","p3"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"l1","p4"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"l2","p4"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    SuperscriptBox[
     TemplateBox[{"p3","p4"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "2"]}]]}]], "Output",
 CellChangeTimes->{{3.795178506302722*^9, 3.7951785299105663`*^9}, 
   3.795178592646765*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"bb5b3caf-3726-49c6-afa3-76a8fe9d7a6d"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["More power!!!", "Section",
 CellChangeTimes->{{3.796562670729025*^9, 
  3.7965626755538397`*^9}},ExpressionUUID->"b38239cf-b1d6-4b6b-b1ad-\
cf72701aa082"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "We", " ", "want", " ", "SpinorSimplify", " ", "to", " ", "simplify", " ", 
   "expressions", " ", "where", " ", "it", " ", "is", " ", "required", " ", 
   "to", " ", "multiply", " ", "by", " ", "1"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7965626790614233`*^9, 
  3.796562722823781*^9}},ExpressionUUID->"e4145d55-d431-44eb-adfa-\
ef02824a2e4a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    TemplateBox[{"1","2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], 
    TemplateBox[{"3","4"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
   RowBox[{
    TemplateBox[{"1","3"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], 
    TemplateBox[{"4","2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}]}], "//", 
  "SpinorSimplify"}]], "Input",
 CellChangeTimes->{{3.796562733004552*^9, 3.7965627548946376`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"56352eb4-c9b8-4a9b-a011-dd620b9c7824"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   TemplateBox[{"1","4"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}], " ", 
  TemplateBox[{"2","3"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )]}]], "Output",
 CellChangeTimes->{3.7965627553010683`*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"3ca43bac-cd9c-4835-a6db-6db369b53f6e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"DeclareMom", "[", 
  RowBox[{"p1", ",", "p2", ",", "p3", ",", "p4"}], "]"}]], "Input",
 CellChangeTimes->{{3.796562810636307*^9, 3.796562815069263*^9}, {
  3.796567995253933*^9, 3.7965679960448647`*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"aa678f2d-1d51-4de9-8345-5b09048d2afb"],

Cell[BoxData[
 RowBox[{"KillMasses", "[", 
  RowBox[{"p1", ",", "p2", ",", "p3", ",", "p4"}], "]"}]], "Input",
 CellChangeTimes->{{3.7965628391105804`*^9, 3.796562849123396*^9}, {
  3.7965679986937895`*^9, 3.7965679991405964`*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"9b79fd8b-d30f-4209-8e20-e99c0fb5952d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test", "=", 
  FractionBox[
   TemplateBox[{"p1","p2"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], 
   TemplateBox[{"p1",RowBox[{"{", "p2", "}"}],"p3"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]]}]], "Input",
 CellChangeTimes->{{3.796562788244491*^9, 3.796562819147259*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"f75334f3-0446-4d7e-bf36-f2eadadd941f"],

Cell[BoxData[
 FractionBox[
  TemplateBox[{"p1","p2"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], 
  TemplateBox[{"p1",RowBox[{"{", "p2", "}"}],"p3"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )]]], "Output",
 CellChangeTimes->{3.79656281983995*^9, 3.7965628513224134`*^9, 
  3.7965679183365*^9},
 CellLabel->"Out[89]=",ExpressionUUID->"39dceef7-c790-4376-8e68-4cf1ebe50ce8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test", "//", "SpinorSimplify"}]], "Input",
 CellChangeTimes->{{3.796562852566107*^9, 3.7965628582696934`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"eebdc9b0-adc2-4bf0-b595-299976a3f8e4"],

Cell[BoxData[
 FractionBox["1", 
  TemplateBox[{"p2","p3"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )]]], "Output",
 CellChangeTimes->{
  3.7965628585668693`*^9, {3.796567919442588*^9, 3.7965679447229786`*^9}},
 CellLabel->"Out[96]=",ExpressionUUID->"d13b8120-0abc-48de-855f-cd0592cbd0a1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test", "=", 
  FractionBox[
   TemplateBox[{"p1","p2"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], 
   TemplateBox[{"p1",RowBox[{"{", "p4", "}"}],"p3"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]]}]], "Input",
 CellChangeTimes->{{3.796568001889194*^9, 3.7965680125477057`*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"d98989d0-fecd-4682-b171-340b60dae922"],

Cell[BoxData[
 FractionBox[
  TemplateBox[{"p1","p2"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], 
  TemplateBox[{"p1",RowBox[{"{", "p4", "}"}],"p3"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )]]], "Output",
 CellChangeTimes->{3.79656801507994*^9},
 CellLabel->"Out[99]=",ExpressionUUID->"060ab4b9-9d6a-41e4-bcdd-0d7ba1451e3a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpinorSimplify", "[", 
  RowBox[{"test", ",", 
   RowBox[{"p1", "\[Rule]", 
    RowBox[{
     RowBox[{"-", "p2"}], "-", "p3", "-", "p4"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.796568017265152*^9, 3.79656802876038*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"70237a01-639c-4252-83c1-336f5ed9b3d8"],

Cell[BoxData[
 FractionBox[
  TemplateBox[{"p1","p2"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], 
  TemplateBox[{"p1",RowBox[{"{", "p4", "}"}],"p3"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )]]], "Output",
 CellChangeTimes->{3.7965680294285936`*^9, 3.7965681124417233`*^9},
 CellLabel->
  "Out[101]=",ExpressionUUID->"f49c2298-61e6-4073-b45b-047c65637679"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{774.9, 576.6},
WindowMargins->{{120.6, Automatic}, {Automatic, 0}},
InputAliases->{"intt" -> RowBox[{"\[Integral]", 
     RowBox[{"\[SelectionPlaceholder]", 
       RowBox[{"\[DifferentialD]", "\[Placeholder]"}]}]}], "dintt" -> RowBox[{
     SubsuperscriptBox[
     "\[Integral]", "\[SelectionPlaceholder]", "\[Placeholder]"], 
     RowBox[{"\[Placeholder]", 
       RowBox[{"\[DifferentialD]", "\[Placeholder]"}]}]}], "rintt" -> RowBox[{
     UnderscriptBox["\[Integral]", 
      RowBox[{"\[SelectionPlaceholder]", "\[Element]", "\[Placeholder]"}]], 
     "\[Placeholder]"}], "sumt" -> RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"\[SelectionPlaceholder]", "=", "\[Placeholder]"}], 
      "\[Placeholder]"], "\[Placeholder]"}], "prodt" -> RowBox[{
     UnderoverscriptBox["\[Product]", 
      RowBox[{"\[SelectionPlaceholder]", "=", "\[Placeholder]"}], 
      "\[Placeholder]"], "\[Placeholder]"}], "dt" -> RowBox[{
     SubscriptBox["\[PartialD]", "\[Placeholder]"], " ", 
     "\[SelectionPlaceholder]"}], "cbrt" -> 
  RadicalBox[
   "\[SelectionPlaceholder]", "3", SurdForm -> True, MultilineFunction -> 
    None], "surd" -> 
  RadicalBox[
   "\[SelectionPlaceholder]", "\[Placeholder]", SurdForm -> True, 
    MultilineFunction -> None], "ket" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "Ket"], "bra" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "Bra"], "braket" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[Placeholder]"}, "BraKet"], 
  "delay" -> TemplateBox[{"\[SelectionPlaceholder]"}, "SystemsModelDelay"], 
  "grad" -> RowBox[{
     SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], "\[Placeholder]"}], 
  "del." -> RowBox[{
     SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], ".", 
     "\[Placeholder]"}], "delx" -> RowBox[{
     SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], "\[Cross]", 
     "\[Placeholder]"}], "del2" -> RowBox[{
     SubsuperscriptBox["\[Del]", "\[SelectionPlaceholder]", 2], 
     "\[Placeholder]"}], "kd" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "KroneckerDeltaSeq"], "algs" -> 
  TemplateBox[{}, "Algebraics"], "bools" -> TemplateBox[{}, "Booleans"], 
  "comps" -> TemplateBox[{}, "Complexes"], "ints" -> 
  TemplateBox[{}, "Integers"], "pris" -> TemplateBox[{}, "Primes"], "rats" -> 
  TemplateBox[{}, "Rationals"], "reals" -> TemplateBox[{}, "Reals"], "dlim" -> 
  RowBox[{
     UnderscriptBox["\[Limit]", 
      RowBox[{"\[SelectionPlaceholder]", 
        UnderscriptBox["\[Rule]", 
         TemplateBox[{}, "Integers"]], "\[Infinity]"}]], "\[Placeholder]"}], 
  "dMlim" -> RowBox[{
     UnderscriptBox["\[MaxLimit]", 
      RowBox[{"\[SelectionPlaceholder]", 
        UnderscriptBox["\[Rule]", 
         TemplateBox[{}, "Integers"]], "\[Infinity]"}]], "\[Placeholder]"}], 
  "dmlim" -> RowBox[{
     UnderscriptBox["\[MinLimit]", 
      RowBox[{"\[SelectionPlaceholder]", 
        UnderscriptBox["\[Rule]", 
         TemplateBox[{}, "Integers"]], "\[Infinity]"}]], "\[Placeholder]"}], 
  "notation" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongLeftRightArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "notation>" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongRightArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "notation<" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongLeftArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "symb" -> RowBox[{"Symbolize", "[", 
     TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], "]"}], 
  "infixnotation" -> RowBox[{"InfixNotation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], ",", 
       "\[Placeholder]"}], "]"}], "addia" -> RowBox[{"AddInputAlias", "[", 
     RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "pattwraper" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "NotationPatternTag"], 
  "madeboxeswraper" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "NotationMadeBoxesTag"], "lu" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorLaUp", DisplayFunction -> (RowBox[{
       SuperscriptBox["\[Lambda]", #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinorundot", "[", #, "]", "[", "$lam", "]", "[", #2, "]", "[", 
       "Null", "]"}]& )], "ld" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorLaDown", DisplayFunction -> (RowBox[{
       SubscriptBox["\[Lambda]", #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinorundot", "[", #, "]", "[", "$lam", "]", "[", "Null", "]", 
       "[", #2, "]"}]& )], "muu" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorMuUp", DisplayFunction -> (RowBox[{
       SuperscriptBox["\[Mu]", #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinorundot", "[", #, "]", "[", "$mu", "]", "[", #2, "]", "[", 
       "Null", "]"}]& )], "mud" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorMuDown", DisplayFunction -> (RowBox[{
       SubscriptBox["\[Mu]", #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinorundot", "[", #, "]", "[", "$mu", "]", "[", "Null", "]", 
       "[", #2, "]"}]& )], "lp" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "SpinorUndotPureL", 
    DisplayFunction -> (RowBox[{"\[Lambda]", "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "mp" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "SpinorUndotPureM", 
    DisplayFunction -> (RowBox[{"\[Mu]", "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "Ld" -> 
  TemplateBox[{
    "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]"}, "SpinorUndot6D", DisplayFunction -> (RowBox[{
       SubscriptBox[
        SuperscriptBox["\[CapitalLambda]", #2], #3], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"SpinorUndot6D", "[", #, "]", "[", #2, "]", "[", "Null", "]", 
       "[", #3, "]"}]& )], "ltu" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorLatUp", DisplayFunction -> (RowBox[{
       SuperscriptBox[
        OverscriptBox["\[Lambda]", "~"], #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinordot", "[", #, "]", "[", "$lam", "]", "[", #2, "]", "[", 
       "Null", "]"}]& )], "ltd" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorLatDown", DisplayFunction -> (RowBox[{
       SubscriptBox[
        OverscriptBox["\[Lambda]", "~"], #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinordot", "[", #, "]", "[", "$lam", "]", "[", "Null", "]", 
       "[", #2, "]"}]& )], "mtu" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorMutUp", DisplayFunction -> (RowBox[{
       SuperscriptBox[
        OverscriptBox["\[Mu]", "~"], #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinordot", "[", #, "]", "[", "$mu", "]", "[", #2, "]", "[", 
       "Null", "]"}]& )], "mtd" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorMutDown", DisplayFunction -> (RowBox[{
       SubscriptBox[
        OverscriptBox["\[Mu]", "~"], #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinordot", "[", #, "]", "[", "$mu", "]", "[", "Null", "]", 
       "[", #2, "]"}]& )], "ltp" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "SpinorDotPureL", 
    DisplayFunction -> (RowBox[{
       OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "mtp" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "SpinorDotPureM", 
    DisplayFunction -> (RowBox[{
       OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "Ltd" -> 
  TemplateBox[{
    "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]"}, "SpinorDot6D", DisplayFunction -> (RowBox[{
       SubscriptBox[
        SubscriptBox[
         OverscriptBox["\[CapitalLambda]", "~"], #2], #3], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"SpinorDot6D", "[", #, "]", "[", #2, "]", "[", "Null", "]", 
       "[", #3, "]"}]& )], "lcup" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "levicivita2up", DisplayFunction -> (SuperscriptBox["\[Epsilon]", 
      RowBox[{#, #2}]]& ), 
    InterpretationFunction -> (
     RowBox[{"levicivita2up", "[", #, ",", #2, "]"}]& )], "lcd" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "levicivita2down", DisplayFunction -> (SubscriptBox["\[Epsilon]", 
      RowBox[{#, #2}]]& ), 
    InterpretationFunction -> (
     RowBox[{"levicivita2down", "[", #, ",", #2, "]"}]& )], "ab" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[Placeholder]"}, 
    "SpinorAngleBracket", DisplayFunction -> (RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ), 
    InterpretationFunction -> (RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], "sb" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[Placeholder]"}, 
    "SpinorSquareBracket", DisplayFunction -> (RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ), 
    InterpretationFunction -> (RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], "sai" -> 
  TemplateBox[{
    "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, "SquAngInvariant",
     DisplayFunction -> (RowBox[{"[", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "\[RightAngleBracket]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Squanginvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], "asi" -> 
  TemplateBox[{
    "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, "AngSquInvariant",
     DisplayFunction -> (RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], "aa" -> 
  TemplateBox[{
    "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, "AngAngInvariant",
     DisplayFunction -> (RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #5], ",", 
       SubscriptBox[#2, #6], ",", 
       SubscriptBox[#3, #7], ",", 
       SubscriptBox[#4, #8], "\[RightAngleBracket]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Anganginvariant", "[", #, ",", #2, ",", #3, ",", #4, "]", 
       "[", #5, ",", #6, ",", #7, ",", #8, "]"}]& )], "bb" -> 
  TemplateBox[{
    "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, "SquSquInvariant",
     DisplayFunction -> (RowBox[{"[", 
       SubscriptBox[#, #5], ",", 
       SubscriptBox[#2, #6], ",", 
       SubscriptBox[#3, #7], ",", 
       SubscriptBox[#4, #8], "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Squsquinvariant", "[", #, ",", #2, ",", #3, ",", #4, "]", 
       "[", #5, ",", #6, ",", #7, ",", #8, "]"}]& )], "fst" -> 
  TemplateBox[{
    "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]"}, "Fstrength", DisplayFunction -> (RowBox[{
       SubscriptBox[
        SuperscriptBox["F", 
         RowBox[{#2, #3}]], 
        RowBox[{#4, #5}]], "[", 
       SubscriptBox[#, 
        RowBox[{#6, #7}]], "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Fstrength[", #, "][", #2, ",", #3, "][", #4, ",", #5, "][", #6, 
       ",", #7, "]"}]& )], "md" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 4}, 
    "MDelta", DisplayFunction -> (RowBox[{
       SubscriptBox[
        SuperscriptBox["\[Delta]", #], #2]}]& ), 
    InterpretationFunction -> (
     RowBox[{"MDelta", "[", #3, "][", #, "][", #2, "]"}]& )]},
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"d6fc9801-05f9-4603-8209-5ee2b598182a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 209, 3, 28, "Input",ExpressionUUID->"c9f005c4-d775-4fa9-af20-ce595bb2d6e0"],
Cell[CellGroupData[{
Cell[814, 29, 324, 6, 22, "Print",ExpressionUUID->"025bb99b-9bee-4c64-bb27-86c0a23d54df"],
Cell[1141, 37, 314, 5, 22, "Print",ExpressionUUID->"b3293617-540b-4c92-9a05-3c40c73c6e9c"],
Cell[1458, 44, 309, 5, 22, "Print",ExpressionUUID->"be590b0f-b140-47c9-977a-fd099c7c794a"],
Cell[1770, 51, 298, 5, 22, "Print",ExpressionUUID->"503b646a-5027-4006-b242-667aef39d647"],
Cell[2071, 58, 301, 5, 22, "Print",ExpressionUUID->"050bba33-9efd-4094-9007-2480215f03d4"],
Cell[2375, 65, 295, 5, 22, "Print",ExpressionUUID->"398ee240-04c0-41ae-8ab3-9cd7e7cb08dc"],
Cell[2673, 72, 311, 5, 22, "Print",ExpressionUUID->"6e6aaf64-71c0-4a27-88ea-04e5e3280caa"],
Cell[2987, 79, 322, 6, 22, "Print",ExpressionUUID->"876d833c-4c27-4d71-8c4a-3176c7c4f128"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[3358, 91, 184, 3, 54, "Subsection",ExpressionUUID->"0312b910-d947-4d4d-83b0-74f25682eab6"],
Cell[3545, 96, 7997, 186, 770, "Input",ExpressionUUID->"282b5dc0-6a84-4bd0-af0e-8ede5dfff594"]
}, Closed]],
Cell[CellGroupData[{
Cell[11579, 287, 205, 3, 53, "Section",ExpressionUUID->"dd159330-80fa-4396-ac91-74327bcf79b7"],
Cell[CellGroupData[{
Cell[11809, 294, 188, 3, 54, "Subsection",ExpressionUUID->"00e4c930-16fc-4255-a7a0-bb871eb2d05f"],
Cell[CellGroupData[{
Cell[12022, 301, 369, 8, 28, "Input",ExpressionUUID->"96ac19fb-0abe-4662-a943-f81b92d7c1fd"],
Cell[12394, 311, 266, 4, 70, "Output",ExpressionUUID->"30bb8b0f-5397-4a31-83d9-9ed7a7167be7"]
}, Open  ]],
Cell[12675, 318, 763, 12, 86, "Input",ExpressionUUID->"54e40088-523a-476d-ad62-56ff1b78e85e"],
Cell[CellGroupData[{
Cell[13463, 334, 302, 5, 28, "Input",ExpressionUUID->"467b6a36-688c-4f34-838e-a9682f673ced"],
Cell[13768, 341, 199, 3, 70, "Output",ExpressionUUID->"d0bd747d-6641-4b0d-afda-b7daa82c37d9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14004, 349, 257, 5, 28, "Input",ExpressionUUID->"3de82312-12ac-45ce-8bef-bde5e7721840"],
Cell[14264, 356, 199, 3, 70, "Output",ExpressionUUID->"0b1e6f13-d79c-41c9-b1e0-5e989768e5a1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14500, 364, 244, 4, 28, "Input",ExpressionUUID->"4e207f9b-5784-4e9b-a378-69a6ec543006"],
Cell[14747, 370, 412, 12, 70, "Output",ExpressionUUID->"6d1c1d24-34a0-4ac1-89f3-e8867bc5919d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15196, 387, 250, 5, 28, "Input",ExpressionUUID->"82cb7217-0866-403d-8fe8-9be4ece544b9"],
Cell[15449, 394, 452, 14, 70, "Output",ExpressionUUID->"11879f72-c221-4dd9-b93d-b0e5ca65d877"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15938, 413, 387, 7, 28, "Input",ExpressionUUID->"fab4eb30-8fa6-4372-a589-22cd5e4ebcfe"],
Cell[16328, 422, 251, 4, 70, "Output",ExpressionUUID->"a42e5109-74d1-45ba-a8da-3c9fcda42650"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16616, 431, 375, 7, 28, "Input",ExpressionUUID->"73069d4d-d741-4ff9-a287-576dced88dab"],
Cell[16994, 440, 247, 3, 70, "Output",ExpressionUUID->"191a0dfc-8907-47f2-a007-6917ec6d249d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17278, 448, 283, 5, 28, "Input",ExpressionUUID->"871e8b3b-b355-434e-b3a6-916e871be755"],
Cell[17564, 455, 6466, 176, 70, "Output",ExpressionUUID->"d32c5f6a-e222-4ac2-91d0-a9f8dc2a3c8b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24067, 636, 309, 7, 28, "Input",ExpressionUUID->"46e34731-0e24-41f5-980d-2bff28180fee"],
Cell[24379, 645, 301, 6, 70, "Output",ExpressionUUID->"7fd34084-eb7d-4292-b9fd-022bc86a8426"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24717, 656, 310, 7, 28, "Input",ExpressionUUID->"d79dea88-8a2c-4ba2-8f02-03d88146d687"],
Cell[25030, 665, 319, 6, 70, "Output",ExpressionUUID->"635ef88f-d91b-49c5-ab26-d7be38e1465b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25386, 676, 308, 7, 28, "Input",ExpressionUUID->"818541f7-f935-459f-ac9a-d960af92d311"],
Cell[25697, 685, 321, 6, 70, "Output",ExpressionUUID->"27e06069-f3cb-42c0-a853-bc1b71d4fff0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26055, 696, 328, 7, 28, "Input",ExpressionUUID->"4a18599e-d82b-4d9e-aa79-6fc9b01d3b98"],
Cell[26386, 705, 316, 6, 70, "Output",ExpressionUUID->"50915e58-6a75-4b00-85d3-dce1a70d4c55"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26739, 716, 326, 7, 28, "Input",ExpressionUUID->"a772fbda-03dd-4a0b-b63a-32479bfd83e8"],
Cell[27068, 725, 247, 5, 70, "Output",ExpressionUUID->"453035a2-8a5f-4e29-bdeb-6a13854cc43e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27352, 735, 328, 7, 28, "Input",ExpressionUUID->"49471b9c-f61a-449f-b4aa-e434e60d5364"],
Cell[27683, 744, 217, 4, 70, "Output",ExpressionUUID->"0db548d5-752d-4e7a-96d9-3bb988515044"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27937, 753, 399, 9, 28, "Input",ExpressionUUID->"44b3902f-05ed-44f4-8614-650ed27f6c25"],
Cell[28339, 764, 227, 3, 70, "Output",ExpressionUUID->"c62e4c44-6725-416a-982c-c3c070d629c5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28603, 772, 488, 12, 28, "Input",ExpressionUUID->"68bed83f-5591-4ea0-815c-7501d038cae7"],
Cell[29094, 786, 272, 4, 70, "Output",ExpressionUUID->"8ce23fa0-9370-4161-a88e-b7d4ed57746e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29403, 795, 346, 8, 28, "Input",ExpressionUUID->"ced9757f-c5a8-4127-af2a-f8ea314a598b"],
Cell[29752, 805, 8846, 240, 70, "Output",ExpressionUUID->"2e07c522-a799-4859-becc-dbed3427aff4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38635, 1050, 538, 14, 28, "Input",ExpressionUUID->"9a855d25-d0c0-4d8d-82ca-188b15b98f77"],
Cell[39176, 1066, 223, 3, 70, "Output",ExpressionUUID->"00bcdbd5-f542-4333-a8ac-cab2b5e19a15"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39436, 1074, 433, 12, 28, "Input",ExpressionUUID->"6a234be6-174e-4b49-93b3-81aa2f54d448"],
Cell[39872, 1088, 12289, 336, 70, "Output",ExpressionUUID->"15319bb7-a792-4df1-90ae-210e87b3fd1d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52198, 1429, 967, 28, 48, "Input",ExpressionUUID->"9e23837e-d869-44c1-8c45-71f86ca9acc4"],
Cell[53168, 1459, 284, 5, 70, "Output",ExpressionUUID->"61873b16-60df-4e1c-9623-a85036853884"],
Cell[53455, 1466, 282, 5, 70, "Output",ExpressionUUID->"15c087e8-0a19-4d67-b9ac-0970918292d5"]
}, Open  ]],
Cell[53752, 1474, 276, 5, 28, "Input",ExpressionUUID->"8ddf70d8-4175-42d8-9cce-4c8526f7bf27"],
Cell[54031, 1481, 337, 8, 28, "Input",ExpressionUUID->"de9d88b6-ae87-449a-bfb0-b8a302f42128"],
Cell[CellGroupData[{
Cell[54393, 1493, 551, 11, 28, "Input",ExpressionUUID->"5c478056-711e-4cd4-b6dd-fa3a86899275"],
Cell[54947, 1506, 379, 7, 70, "Output",ExpressionUUID->"fc68fa99-4e90-44b8-8c7d-452539c79def"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55363, 1518, 391, 9, 28, "Input",ExpressionUUID->"056cdca3-a616-48f7-9ec9-b14385ca8412"],
Cell[55757, 1529, 348, 6, 70, "Output",ExpressionUUID->"dc8e2212-97dc-4966-aec2-ffedb5eb6122"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56142, 1540, 317, 7, 28, "Input",ExpressionUUID->"1c6d0206-d5ce-4055-8962-fd1e650e682c"],
Cell[56462, 1549, 281, 5, 70, "Output",ExpressionUUID->"f2d8c345-4d78-4bb3-b0d4-863dc2b436af"]
}, Open  ]],
Cell[56758, 1557, 464, 8, 48, "Input",ExpressionUUID->"e2cdfdf1-0753-4b88-a336-6f3eb65f52b8"]
}, Closed]],
Cell[CellGroupData[{
Cell[57259, 1570, 169, 3, 38, "Subsection",ExpressionUUID->"bba6d464-632b-47b2-b5db-f2e64527cc5b"],
Cell[CellGroupData[{
Cell[57453, 1577, 282, 6, 28, "Input",ExpressionUUID->"a4eb1ce2-1b02-4d52-a9b5-7775dbc45683"],
Cell[57738, 1585, 149, 2, 32, "Output",ExpressionUUID->"8794b5a1-bbb3-4b9a-b955-cf6631a930e5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57924, 1592, 508, 13, 28, "Input",ExpressionUUID->"96f406db-8fbd-42a4-ac69-769647ff082c"],
Cell[58435, 1607, 348, 7, 32, "Output",ExpressionUUID->"90a278dd-6abd-4288-9bc3-07d16680180d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58820, 1619, 280, 6, 28, "Input",ExpressionUUID->"93ab5669-8e24-418c-be8e-64ef471e7e3a"],
Cell[59103, 1627, 151, 2, 32, "Output",ExpressionUUID->"d132eafb-26ed-4075-8040-443b3ff3ffab"]
}, Open  ]],
Cell[59269, 1632, 569, 11, 67, "Input",ExpressionUUID->"4361c1a6-4531-4b5c-8525-e3748177c501"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59875, 1648, 178, 3, 54, "Subsection",ExpressionUUID->"3e5f4474-a1c5-4579-9876-3bfd8d9b5458"],
Cell[60056, 1653, 689, 14, 67, "Input",ExpressionUUID->"286ba32a-d2d6-4ae3-9687-29dadb68e4cc"],
Cell[60748, 1669, 1461, 29, 143, "Input",ExpressionUUID->"b994bc98-17d9-4af7-94ed-22be0e168cfd"]
}, Closed]],
Cell[CellGroupData[{
Cell[62246, 1703, 156, 3, 38, "Subsection",ExpressionUUID->"f8b10ff4-fa41-49b0-a7e2-815151889684"],
Cell[CellGroupData[{
Cell[62427, 1710, 370, 8, 28, "Input",ExpressionUUID->"fff8cfc3-dc1d-40f4-9223-d77717593367"],
Cell[62800, 1720, 291, 4, 70, "Output",ExpressionUUID->"b5020ab1-8468-4392-970a-6802993778ff"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63128, 1729, 500, 11, 28, "Input",ExpressionUUID->"35f9ca89-726a-475c-9886-135f0c6e9f84"],
Cell[63631, 1742, 316, 6, 70, "Output",ExpressionUUID->"96c1598d-91e6-4b07-ba17-aa9462902bd8"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[63996, 1754, 163, 3, 38, "Subsection",ExpressionUUID->"a6330caa-c8ca-4a13-8816-456d24fdc6b1"],
Cell[CellGroupData[{
Cell[64184, 1761, 746, 16, 28, "Input",ExpressionUUID->"0cbdb6ad-e48e-430b-a03c-46e45581e7b6"],
Cell[64933, 1779, 227, 3, 70, "Output",ExpressionUUID->"3ef253a3-54f6-4465-890d-c4fd14b2b5aa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65197, 1787, 743, 16, 28, "Input",ExpressionUUID->"bbc7aaab-355c-430b-a921-e11cb54530be"],
Cell[65943, 1805, 6922, 175, 70, "Output",ExpressionUUID->"ff772fea-1d79-4994-9740-ea6308ce4a6c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72902, 1985, 845, 19, 28, "Input",ExpressionUUID->"86d15a9d-992d-45ca-a701-c77a907d0c07"],
Cell[73750, 2006, 247, 3, 70, "Output",ExpressionUUID->"78cca8ed-62e3-4002-a9ad-dcf87d27b717"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74034, 2014, 846, 19, 28, "Input",ExpressionUUID->"2717d5cd-0e0a-48ea-ae03-23dc1940c26a"],
Cell[74883, 2035, 6220, 163, 70, "Output",ExpressionUUID->"d7c559ba-c80e-48a1-a1f0-0541b954f8cd"]
}, Open  ]],
Cell[81118, 2201, 419, 8, 48, "Input",ExpressionUUID->"e672bc3a-8ad3-41eb-812b-32414c532b3e"],
Cell[CellGroupData[{
Cell[81562, 2213, 1437, 32, 28, "Input",ExpressionUUID->"e884777a-2045-4694-ba78-52722f8c019c"],
Cell[83002, 2247, 1415, 32, 70, "Output",ExpressionUUID->"0ea76670-fe58-44b3-b80d-b44941108c2d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84454, 2284, 253, 4, 28, "Input",ExpressionUUID->"9670a141-b2c8-411c-9324-2374af3b4719"],
Cell[84710, 2290, 831, 17, 70, "Output",ExpressionUUID->"145fd30c-9018-4102-af02-296b63ba3e81"]
}, Open  ]],
Cell[85556, 2310, 333, 6, 28, "Input",ExpressionUUID->"34e96c8a-dc2b-40d9-a03a-42e573246685"],
Cell[85892, 2318, 257, 4, 28, "Input",ExpressionUUID->"6db5fd3d-28b4-47d3-8819-7a42015455a3"],
Cell[CellGroupData[{
Cell[86174, 2326, 910, 21, 67, "Input",ExpressionUUID->"442dd80a-d554-4848-a26c-c46c0cbdb0ba"],
Cell[87087, 2349, 1419, 32, 70, "Output",ExpressionUUID->"4640ab44-5dab-427f-8ba8-6df64244a0c4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88543, 2386, 561, 14, 28, "Input",ExpressionUUID->"3ea09cac-c535-4831-8431-3bc993d40eaf"],
Cell[89107, 2402, 616, 11, 70, "Output",ExpressionUUID->"86e5977f-4fb0-4435-b079-9dbb481c736e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89760, 2418, 205, 3, 28, "Input",ExpressionUUID->"f1d78a1f-b53d-490b-afd5-d1b8210da1b8"],
Cell[89968, 2423, 198, 3, 70, "Output",ExpressionUUID->"398a81ce-8c04-4c26-813b-ec69fdfb201e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90203, 2431, 207, 3, 28, "Input",ExpressionUUID->"6aaa5a30-e6d6-4ea3-810b-9bbff4b4c419"],
Cell[90413, 2436, 198, 3, 70, "Output",ExpressionUUID->"9a2e0dea-0b34-4c93-9e84-0841f13c3173"]
}, Open  ]],
Cell[90626, 2442, 430, 10, 28, "Input",ExpressionUUID->"f176be48-070c-472d-8c78-f40562d35635"]
}, Closed]],
Cell[CellGroupData[{
Cell[91093, 2457, 178, 3, 38, "Subsection",ExpressionUUID->"ebb39658-64d6-4c97-a25b-813c188781a7"],
Cell[91274, 2462, 1780, 41, 219, "Input",ExpressionUUID->"93983415-669e-4b44-99e3-d57339b58d41"],
Cell[93057, 2505, 189, 3, 28, "Input",ExpressionUUID->"88009d24-723a-4d43-807a-06b873ad3322"],
Cell[93249, 2510, 280, 5, 28, "Input",ExpressionUUID->"337d791a-bdc7-42e4-a0bb-538bde17b260"],
Cell[CellGroupData[{
Cell[93554, 2519, 964, 24, 67, "Input",ExpressionUUID->"3cbb542e-bde6-4f70-935e-724aca68c331"],
Cell[94521, 2545, 591, 12, 32, "Output",ExpressionUUID->"e520297e-3c2d-4870-a8e3-448888368819"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95149, 2562, 213, 3, 28, "Input",ExpressionUUID->"437a4056-35c5-437b-837b-00f14d03a3fe"],
Cell[95365, 2567, 200, 3, 32, "Output",ExpressionUUID->"3ffc0496-9e4c-4591-8310-ad4ac3e7093c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95602, 2575, 258, 5, 28, "Input",ExpressionUUID->"492245b6-0b60-401e-bd4a-6effec043d60"],
Cell[95863, 2582, 202, 3, 32, "Output",ExpressionUUID->"86fd0357-1d6c-4b83-a950-3328de125d37"]
}, Open  ]],
Cell[96080, 2588, 555, 9, 48, "Input",ExpressionUUID->"454db8df-990b-450a-879d-ffddf4506940"],
Cell[96638, 2599, 1836, 42, 219, "Input",ExpressionUUID->"4da96940-34eb-4b77-b240-17dc04ab9fd8"],
Cell[CellGroupData[{
Cell[98499, 2645, 819, 21, 67, "Input",ExpressionUUID->"e3b26ab3-2a6b-46fd-be46-062fbc8c8f39"],
Cell[99321, 2668, 567, 11, 32, "Output",ExpressionUUID->"83040038-adab-4be5-84f9-491dd7500a61"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99925, 2684, 214, 3, 28, "Input",ExpressionUUID->"27a4df50-97f4-4e2e-978a-d9db446566e6"],
Cell[100142, 2689, 246, 3, 32, "Output",ExpressionUUID->"c939702f-0b0a-4b69-a4dd-50a5bb86c107"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100425, 2697, 256, 5, 28, "Input",ExpressionUUID->"e7d34b8e-a909-4ac5-814f-e0582a4641be"],
Cell[100684, 2704, 244, 3, 32, "Output",ExpressionUUID->"eb574039-8f66-449d-9575-d6fc39259c9f"]
}, Open  ]],
Cell[100943, 2710, 713, 12, 67, "Input",ExpressionUUID->"b484cfcd-4c7a-4d01-a74c-bf054a8e2469"],
Cell[101659, 2724, 536, 9, 48, "Input",ExpressionUUID->"03b16a68-ae64-4fef-a7f9-44010c215196"],
Cell[CellGroupData[{
Cell[102220, 2737, 178, 2, 28, "Input",ExpressionUUID->"6f0b48c3-f3eb-4d3f-aa76-e6200eb90094"],
Cell[102401, 2741, 1343, 31, 32, "Output",ExpressionUUID->"e44a3537-87f5-47c9-8b2e-0c6d6e5c4d8c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103781, 2777, 1850, 50, 124, "Input",ExpressionUUID->"5e06e864-3c0c-4013-ab04-9417ecd97f61"],
Cell[105634, 2829, 507, 11, 32, "Output",ExpressionUUID->"a9439168-f535-4aa3-8aa2-d028ac3519bd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[106178, 2845, 207, 3, 28, "Input",ExpressionUUID->"bfb01a80-a7f1-4365-bec5-0f56481cbece"],
Cell[106388, 2850, 745, 16, 32, "Output",ExpressionUUID->"118497bf-1245-453e-8a2d-ce34487821e5"]
}, Open  ]],
Cell[107148, 2869, 338, 7, 28, "Input",ExpressionUUID->"0440ded2-b37a-4907-b94f-9ef8da565350"],
Cell[CellGroupData[{
Cell[107511, 2880, 2064, 47, 28, "Input",ExpressionUUID->"471b4f96-5ec7-448d-a908-0a7e40bc4ab9"],
Cell[109578, 2929, 1998, 46, 53, "Output",ExpressionUUID->"33826614-6d2e-4937-9be1-aac701d4fb26"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111613, 2980, 1940, 52, 124, "Input",ExpressionUUID->"6f37de32-7ed5-426a-9ca8-87c994ee8584"],
Cell[113556, 3034, 215, 4, 32, "Output",ExpressionUUID->"dba60305-be33-497c-a711-956ed40d86a3"]
}, Open  ]],
Cell[113786, 3041, 324, 8, 28, "Input",ExpressionUUID->"2ffda866-7eaf-43f4-95b1-05f94799ee12"],
Cell[CellGroupData[{
Cell[114135, 3053, 2065, 47, 28, "Input",ExpressionUUID->"ad10e5a6-299e-40ef-ad00-b100fa0c59c3"],
Cell[116203, 3102, 1998, 46, 53, "Output",ExpressionUUID->"92c84951-af05-4f2b-9d4f-08594604fc53"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118238, 3153, 1872, 51, 124, "Input",ExpressionUUID->"6457b33e-f4e6-4596-8ca4-fe1d3dfab268"],
Cell[120113, 3206, 195, 3, 32, "Output",ExpressionUUID->"39d1a75e-e643-483d-9768-53db813b3237"]
}, Open  ]],
Cell[CellGroupData[{
Cell[120345, 3214, 3252, 74, 28, "Input",ExpressionUUID->"b381028e-1fa7-4969-99be-ca2f11ad055a"],
Cell[123600, 3290, 3133, 72, 53, "Output",ExpressionUUID->"30d98447-2483-414e-b689-03dc74980bba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[126770, 3367, 1872, 51, 124, "Input",ExpressionUUID->"59606b13-c4e4-44a1-a1b7-e367a58f13a8"],
Cell[128645, 3420, 1076, 23, 32, "Output",ExpressionUUID->"93219c26-ebf1-410e-b41f-07fa666f6904"]
}, Open  ]],
Cell[CellGroupData[{
Cell[129758, 3448, 2000, 53, 124, "Input",ExpressionUUID->"e86e3f48-89f1-4a65-afa5-0c917b6a87ed"],
Cell[131761, 3503, 1046, 23, 32, "Output",ExpressionUUID->"77f3858d-57d4-4ab1-ba33-8be86b42a209"]
}, Open  ]],
Cell[CellGroupData[{
Cell[132844, 3531, 204, 3, 28, "Input",ExpressionUUID->"1193336c-d8d9-4724-88ac-b08f3916684f"],
Cell[133051, 3536, 2263, 52, 53, "Output",ExpressionUUID->"a46ab131-7558-4904-b29c-fabede502ad4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135351, 3593, 1912, 52, 124, "Input",ExpressionUUID->"df5910af-2f4b-4316-8e13-1e697c133bfe"],
Cell[137266, 3647, 1073, 23, 32, "Output",ExpressionUUID->"a5117860-7c0a-4ee6-9ba5-fbe0ce03e07b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138376, 3675, 4043, 92, 48, "Input",ExpressionUUID->"8d8b6b9d-63f9-4064-b86e-440cb1c7ebb8"],
Cell[142422, 3769, 3817, 88, 53, "Output",ExpressionUUID->"6dac733b-1251-4b25-8573-c0fdd62caa00"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146276, 3862, 2058, 54, 124, "Input",ExpressionUUID->"4d089848-ba07-4ea5-ad62-a2f9c1c83857"],
Cell[148337, 3918, 198, 3, 32, "Output",ExpressionUUID->"51db4325-2db3-41d4-af0f-f6ff60718ff9"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[148584, 3927, 183, 3, 38, "Subsection",ExpressionUUID->"6297f114-cdad-41e3-abb0-bb426814590c"],
Cell[148770, 3932, 1830, 42, 220, "Input",ExpressionUUID->"551abd8e-c2ba-46ed-9c50-f8534dd82ab8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150637, 3979, 162, 3, 54, "Subsection",ExpressionUUID->"c269fc68-70a2-44c5-8f76-de033f01c940"],
Cell[150802, 3984, 343, 7, 56, "Text",ExpressionUUID->"3b98d28b-e340-47d1-b800-f803fea4afa4"],
Cell[151148, 3993, 6142, 135, 618, "Input",ExpressionUUID->"d12e89f2-9bc9-413f-8316-89a30d896afd"],
Cell[CellGroupData[{
Cell[157315, 4132, 179, 2, 28, "Input",ExpressionUUID->"99c6aef7-d244-4dfd-b4ef-f9433736c888"],
Cell[157497, 4136, 242, 4, 32, "Output",ExpressionUUID->"bd4fb959-5ee6-4974-8b08-09e82e9576d9"]
}, Open  ]],
Cell[157754, 4143, 236, 4, 28, "Input",ExpressionUUID->"d45e5d41-efb3-4c9e-8423-6d223b8e5074"],
Cell[CellGroupData[{
Cell[158015, 4151, 175, 2, 28, "Input",ExpressionUUID->"83f33728-2769-4fc2-98fd-4402697eb61b"],
Cell[158193, 4155, 225, 3, 32, "Output",ExpressionUUID->"5568104a-f546-4b5b-a3f5-3c821629b3d1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[158455, 4163, 375, 9, 28, "Input",ExpressionUUID->"40c4d349-5ab9-4415-861b-597b5e290883"],
Cell[158833, 4174, 421, 6, 32, "Output",ExpressionUUID->"0da9c3d0-88b3-4e4d-a684-d8d7c28ad2a2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[159291, 4185, 706, 16, 28, "Input",ExpressionUUID->"d8f7adf9-a759-4520-b917-ca073a8cf4f5"],
Cell[160000, 4203, 473, 7, 32, "Output",ExpressionUUID->"c4fe37ef-17e4-4116-a26a-83cd86b506dc"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[160522, 4216, 231, 4, 38, "Subsection",ExpressionUUID->"5147d733-e51f-47b2-9b16-638b7b55c01c"],
Cell[CellGroupData[{
Cell[160778, 4224, 1455, 31, 28, "Input",ExpressionUUID->"eaf8f1cc-5026-4e5e-a08f-42d741cf16f8"],
Cell[162236, 4257, 1483, 32, 32, "Output",ExpressionUUID->"8ac7ca90-332e-4d90-a7e6-70fef3f5c387"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163756, 4294, 215, 3, 28, "Input",ExpressionUUID->"3d3d420a-16ca-4b79-bf5a-1cfffd146e5d"],
Cell[163974, 4299, 813, 17, 32, "Output",ExpressionUUID->"a06ccc58-2799-4033-a2d2-2f7ced9c41a4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[164824, 4321, 2170, 52, 201, "Input",ExpressionUUID->"eec92a9c-18e1-41dd-a5f6-c576ee4f6d24"],
Cell[166997, 4375, 843, 17, 32, "Output",ExpressionUUID->"cd476551-ca80-4862-bbf0-612f92ce36a9"]
}, Open  ]],
Cell[167855, 4395, 430, 9, 28, "Input",ExpressionUUID->"f4de8f87-d466-4855-84ed-d05a8b6158b7"],
Cell[168288, 4406, 2137, 52, 220, "Input",ExpressionUUID->"3a5eb517-3bb2-4ee0-8abe-09d644bc8b3f"],
Cell[CellGroupData[{
Cell[170450, 4462, 216, 3, 28, "Input",ExpressionUUID->"2cfb7f59-0cf3-49d1-87d8-2d58ae9a4acd"],
Cell[170669, 4467, 816, 17, 32, "Output",ExpressionUUID->"6b5a26c9-990c-4f81-bccc-d64ef282ea8f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[171522, 4489, 1847, 39, 28, "Input",ExpressionUUID->"cc19e3db-c51b-44fd-9ea6-766d7aa0b239"],
Cell[173372, 4530, 1753, 38, 32, "Output",ExpressionUUID->"5b6ca763-cbbb-4cf0-b699-61cd769d8b86"]
}, Open  ]],
Cell[CellGroupData[{
Cell[175162, 4573, 217, 3, 28, "Input",ExpressionUUID->"8a2f8ec5-f171-4fef-9e71-7b2b16657151"],
Cell[175382, 4578, 1100, 23, 32, "Output",ExpressionUUID->"f396d16c-b774-4992-bb13-c33facba00b6"]
}, Open  ]],
Cell[176497, 4604, 308, 8, 28, "Input",ExpressionUUID->"b9adc175-e604-47dc-a197-da9080e301ee"],
Cell[CellGroupData[{
Cell[176830, 4616, 5972, 128, 86, "Input",ExpressionUUID->"5eb92c23-ad41-433e-8230-1df3db210720"],
Cell[182805, 4746, 5222, 115, 52, "Output",ExpressionUUID->"77406d18-878c-4505-b9dc-45dd15480c5e"],
Cell[188030, 4863, 2687, 59, 32, "Output",ExpressionUUID->"81964a5c-8435-4227-913c-9de538314f1c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[190766, 4928, 277, 4, 54, "Subsection",ExpressionUUID->"b1ac8d8b-b261-4698-8a01-a1bb1daa2f85"],
Cell[191046, 4934, 231, 4, 28, "Input",ExpressionUUID->"624d1545-ba8e-49f5-a2b7-01b3230a84d0"],
Cell[191280, 4940, 9550, 205, 922, "Input",ExpressionUUID->"10762453-2fc2-4350-88da-ca2365841a0f"],
Cell[200833, 5147, 237, 4, 28, "Input",ExpressionUUID->"481f4fb8-ac45-4d51-a76f-ebde35334b7c"],
Cell[201073, 5153, 216, 3, 28, "Input",ExpressionUUID->"7a62805f-cbcb-43ed-8af6-47146db2558b"],
Cell[201292, 5158, 9557, 207, 922, "Input",ExpressionUUID->"e4fb8f84-b143-4de4-bdea-7ce82c9a2958"]
}, Closed]],
Cell[CellGroupData[{
Cell[210886, 5370, 271, 4, 38, "Subsection",ExpressionUUID->"82898712-2008-4294-8b5e-7e9dfb53cabd"],
Cell[CellGroupData[{
Cell[211182, 5378, 176, 3, 45, "Subsubsection",ExpressionUUID->"15661c0f-a46d-4be7-bcad-3326ab9ab298"],
Cell[CellGroupData[{
Cell[211383, 5385, 1342, 30, 28, "Input",ExpressionUUID->"2888f3d4-faaf-4fba-9ca0-fb50b40d68f4"],
Cell[212728, 5417, 741, 16, 32, "Output",ExpressionUUID->"74d13cdd-c885-4a18-ba15-f97c5d218bf3"]
}, Open  ]],
Cell[213484, 5436, 244, 4, 28, "Input",ExpressionUUID->"2c50b942-a6be-44e6-b4d0-b6476b30a527"],
Cell[213731, 5442, 246, 4, 28, "Input",ExpressionUUID->"b7903970-d8ef-4b2a-bcd3-80acf70919c8"],
Cell[CellGroupData[{
Cell[214002, 5450, 773, 16, 49, "Input",ExpressionUUID->"572fbf0e-6831-4681-9606-e834a198c1ce"],
Cell[214778, 5468, 760, 16, 53, "Output",ExpressionUUID->"02b38cea-1ede-4502-b997-a36d59b9a6b7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[215575, 5489, 215, 3, 28, "Input",ExpressionUUID->"d21f7c4e-4df7-48f7-8382-c2306e99ca2c"],
Cell[215793, 5494, 712, 15, 53, "Output",ExpressionUUID->"6d1e2477-5d09-4749-853a-d1ec2630f94b"]
}, Open  ]],
Cell[216520, 5512, 342, 9, 28, "Input",ExpressionUUID->"98fab10c-ffec-4db5-8a9d-d6b4f9a6bdb6"],
Cell[CellGroupData[{
Cell[216887, 5525, 518, 11, 48, "Input",ExpressionUUID->"bd48552e-8d93-469b-a944-496ba3e94209"],
Cell[217408, 5538, 410, 9, 52, "Output",ExpressionUUID->"576f7889-dd14-410d-a8ef-f23102a5c4cf"]
}, Open  ]],
Cell[217833, 5550, 220, 3, 28, "Input",ExpressionUUID->"f51bec6b-0ff9-4c69-817c-01654ab2778a"],
Cell[218056, 5555, 9539, 208, 922, "Input",ExpressionUUID->"ea49d77f-dd7e-4feb-9768-784ac0cb260a"],
Cell[CellGroupData[{
Cell[227620, 5767, 215, 3, 28, "Input",ExpressionUUID->"c234bbd8-dcbd-4dda-8b83-622f9c2399f9"],
Cell[227838, 5772, 4806, 107, 59, "Print",ExpressionUUID->"a1eb4cf2-cdf3-439e-b9bf-e59bae24e564"],
Cell[232647, 5881, 538, 11, 52, "Output",ExpressionUUID->"72ebf14c-6ee4-4258-a95e-0cedb7164000"]
}, Open  ]],
Cell[CellGroupData[{
Cell[233222, 5897, 432, 9, 28, "Input",ExpressionUUID->"5a548a5b-7cc6-4e38-804e-d3044e53bc2e"],
Cell[233657, 5908, 6134, 144, 113, "Print",ExpressionUUID->"3cf133e2-4f86-4c75-8252-20379a3232bf"],
Cell[239794, 6054, 533, 11, 52, "Output",ExpressionUUID->"e02b9b72-6a4b-4922-991c-19a1f434eef1"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[240376, 6071, 169, 3, 37, "Subsubsection",ExpressionUUID->"ae2bafb6-4e67-4ed4-9488-4b62abd66f1e"],
Cell[240548, 6076, 220, 4, 28, "Input",ExpressionUUID->"988fa6e7-dcd5-4963-9541-4114f2dc0254"],
Cell[240771, 6082, 9709, 211, 947, "Input",ExpressionUUID->"9fa254a4-d835-4cd1-a916-259e6eff20cc"],
Cell[CellGroupData[{
Cell[250505, 6297, 779, 17, 48, "Input",ExpressionUUID->"10a768bf-c9fe-4971-b099-e36004656cc4"],
Cell[251287, 6316, 768, 17, 51, "Output",ExpressionUUID->"04c433cd-7899-44fc-9749-02e55642502e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[252092, 6338, 331, 8, 28, "Input",ExpressionUUID->"80637ac0-56f4-4393-9819-056ec5c0a11a"],
Cell[252426, 6348, 6504, 156, 128, "Print",ExpressionUUID->"7101224d-6ffc-4e76-86e6-4f2bbe48436d"],
Cell[258933, 6506, 797, 18, 51, "Output",ExpressionUUID->"78336a20-2eb1-4540-951b-4b9814c8d4bf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[259767, 6529, 203, 4, 28, "Input",ExpressionUUID->"b3a5857d-7441-4507-a935-10876e705451"],
Cell[259973, 6535, 718, 16, 51, "Output",ExpressionUUID->"5d7358fb-e0f3-47af-bb95-414093c09626"]
}, Open  ]],
Cell[CellGroupData[{
Cell[260728, 6556, 1015, 24, 67, "Input",ExpressionUUID->"f40cf9a8-36aa-4da1-86a4-5858d98adbe6"],
Cell[261746, 6582, 768, 17, 51, "Output",ExpressionUUID->"e69c30b9-ddb4-49a6-a826-0c36495e67a6"]
}, Open  ]],
Cell[262529, 6602, 795, 16, 86, "Input",ExpressionUUID->"02cde08a-0fa4-4898-9560-b47debfb49dc"],
Cell[CellGroupData[{
Cell[263349, 6622, 186, 3, 28, "Input",ExpressionUUID->"8d40a4f0-453f-4e5e-bd2a-82da7a8d414a"],
Cell[263538, 6627, 224, 5, 32, "Output",ExpressionUUID->"209c0ae2-0c5f-4cde-8024-376bd082cdc0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[263799, 6637, 425, 12, 28, "Input",ExpressionUUID->"03461895-20a9-4e4e-a596-ce8a33a70605"],
Cell[264227, 6651, 748, 17, 51, "Output",ExpressionUUID->"36a5605d-0aab-47af-85ba-f8ef4eb52297"]
}, Open  ]],
Cell[264990, 6671, 297, 7, 28, "Input",ExpressionUUID->"4b8a4a8c-2c5b-4794-b2b4-f86d0841da1b"],
Cell[CellGroupData[{
Cell[265312, 6682, 322, 7, 28, "Input",ExpressionUUID->"94d4c6fd-d9fe-49bf-850d-9014beee4da0"],
Cell[265637, 6691, 192, 4, 48, "Output",ExpressionUUID->"730cf66e-a009-4b64-abcd-297651e65a67"]
}, Open  ]],
Cell[CellGroupData[{
Cell[265866, 6700, 842, 20, 48, "Input",ExpressionUUID->"067bd39b-2b38-4675-832a-2589b908fe60"],
Cell[266711, 6722, 215, 4, 48, "Output",ExpressionUUID->"6458d00a-9ebb-44d7-840f-435e7ea0ae59"]
}, Open  ]],
Cell[CellGroupData[{
Cell[266963, 6731, 419, 10, 48, "Input",ExpressionUUID->"6fd481eb-ce0d-4af7-a426-55c778a8702e"],
Cell[267385, 6743, 241, 5, 48, "Output",ExpressionUUID->"9e5a6625-0183-4280-a57a-ee56b937f873"],
Cell[267629, 6750, 173, 2, 32, "Output",ExpressionUUID->"ee3b2289-6760-47c6-bf5f-0bbffb4be125"]
}, Open  ]],
Cell[267817, 6755, 455, 10, 48, "Input",ExpressionUUID->"cb1728e3-4d43-4bed-83ba-63f3f67f1980"]
}, Open  ]],
Cell[CellGroupData[{
Cell[268309, 6770, 184, 3, 45, "Subsubsection",ExpressionUUID->"89382653-904b-4232-bf4f-bbbf1ff49a8b"],
Cell[268496, 6775, 496, 11, 48, "Input",ExpressionUUID->"25631f87-a44c-44e8-aa1a-6c77de88bace"],
Cell[268995, 6788, 1238, 30, 144, "Input",ExpressionUUID->"848b327f-763f-4af8-9479-292086e8d72e"],
Cell[270236, 6820, 264, 4, 28, "Input",ExpressionUUID->"9c307887-91c6-472d-874a-8d0621bed505"],
Cell[CellGroupData[{
Cell[270525, 6828, 202, 5, 28, "Input",ExpressionUUID->"1d8a3416-813e-460a-9639-4857996ca91c"],
Cell[270730, 6835, 193, 4, 48, "Output",ExpressionUUID->"85b7b809-fbbc-4824-9af6-c450d2f20141"]
}, Open  ]],
Cell[CellGroupData[{
Cell[270960, 6844, 1336, 35, 105, "Input",ExpressionUUID->"9b77f23b-2fca-4881-8e37-d1c671550239"],
Cell[CellGroupData[{
Cell[272321, 6883, 388, 10, 39, "Print",ExpressionUUID->"399991aa-a087-4b7a-8354-33c6036bc633"],
Cell[272712, 6895, 403, 11, 39, "Print",ExpressionUUID->"09045f90-9829-40a7-817f-798a6f45e9cf"],
Cell[273118, 6908, 296, 8, 22, "Print",ExpressionUUID->"f88bef3c-a965-4293-a2f6-40000595647d"],
Cell[273417, 6918, 390, 10, 39, "Print",ExpressionUUID->"25dd9601-d8a7-485a-8d35-1f842f6335ec"],
Cell[273810, 6930, 405, 11, 39, "Print",ExpressionUUID->"9d163904-9ca3-48bd-9b51-4365cc93601a"],
Cell[274218, 6943, 296, 8, 22, "Print",ExpressionUUID->"fddd6213-473d-4e53-b1ca-dbce95a2b342"],
Cell[274517, 6953, 439, 13, 39, "Print",ExpressionUUID->"62332f07-2988-4425-aeed-eb96bf01cdfb"],
Cell[274959, 6968, 306, 8, 22, "Print",ExpressionUUID->"35e2c58f-101a-4c82-b483-4bf3b5bf9341"],
Cell[275268, 6978, 296, 8, 22, "Print",ExpressionUUID->"d6cd3598-e467-4c55-b9d4-17d6d55afe4f"],
Cell[275567, 6988, 437, 13, 39, "Print",ExpressionUUID->"caebe98f-b63f-45c6-98d7-7d13360458fb"],
Cell[276007, 7003, 308, 8, 22, "Print",ExpressionUUID->"3e76c928-d700-48ee-bb1e-8e353b6457d9"],
Cell[276318, 7013, 296, 8, 22, "Print",ExpressionUUID->"08a88ab2-8a70-40eb-9878-4e9ee886ac93"],
Cell[276617, 7023, 294, 8, 22, "Print",ExpressionUUID->"5871b693-bd8d-4f48-9fd5-dd61d7e5e5ed"],
Cell[276914, 7033, 308, 8, 22, "Print",ExpressionUUID->"bcdda24b-1b29-4cf5-9855-cef501005228"],
Cell[277225, 7043, 294, 8, 22, "Print",ExpressionUUID->"aa40dc44-1b54-4f23-9366-6e0e94c28e5a"],
Cell[277522, 7053, 439, 13, 39, "Print",ExpressionUUID->"94b6653c-16bb-4cc0-87db-e6007d261113"],
Cell[277964, 7068, 308, 8, 22, "Print",ExpressionUUID->"e5c7f96e-971b-4075-99b0-e34185ae19bc"],
Cell[278275, 7078, 296, 8, 22, "Print",ExpressionUUID->"b0590065-7c29-476e-95cc-d2a81f6b1936"],
Cell[278574, 7088, 350, 9, 22, "Print",ExpressionUUID->"b774efb3-2f3f-4672-81b1-557dbd704b05"],
Cell[278927, 7099, 362, 9, 22, "Print",ExpressionUUID->"72e3a5b8-361d-442e-a4b6-dab6568f4127"],
Cell[279292, 7110, 296, 8, 22, "Print",ExpressionUUID->"1275a135-62e5-4b84-8cd4-a4b3d57aac02"],
Cell[279591, 7120, 347, 9, 22, "Print",ExpressionUUID->"b0791bed-3f97-4328-b2b7-390ce6ccf080"],
Cell[279941, 7131, 362, 9, 22, "Print",ExpressionUUID->"4a43db4f-abd5-48a8-84ad-1d16f6ee14d9"],
Cell[280306, 7142, 296, 8, 22, "Print",ExpressionUUID->"c2644720-9919-4c10-85ba-0cfabb07b779"],
Cell[280605, 7152, 350, 9, 22, "Print",ExpressionUUID->"eb3bd9f2-2c4b-427d-86da-ab0029999503"],
Cell[280958, 7163, 360, 9, 22, "Print",ExpressionUUID->"036ef042-1733-4b70-b992-0cfe8ae4853c"],
Cell[281321, 7174, 294, 8, 22, "Print",ExpressionUUID->"614930d3-911a-4661-bc24-1ec015de48c4"],
Cell[281618, 7184, 309, 8, 22, "Print",ExpressionUUID->"87281465-a76c-494f-894f-98a6133245dd"],
Cell[281930, 7194, 321, 8, 22, "Print",ExpressionUUID->"b5ea054e-8d05-4994-b5e5-2dccaf63a127"],
Cell[282254, 7204, 294, 8, 22, "Print",ExpressionUUID->"b5fe611c-8dc6-43e9-80ae-578435033065"],
Cell[282551, 7214, 309, 8, 22, "Print",ExpressionUUID->"8019152d-f003-4cfc-bd56-177b4675069e"],
Cell[282863, 7224, 321, 8, 22, "Print",ExpressionUUID->"046c13c6-54e7-417d-b3f2-eac63b0b70e4"],
Cell[283187, 7234, 296, 8, 22, "Print",ExpressionUUID->"5c634da8-4946-42e7-bccd-6b2d1692f0f8"],
Cell[283486, 7244, 309, 8, 22, "Print",ExpressionUUID->"3801085f-c67d-47f4-b424-6471da9df8dd"],
Cell[283798, 7254, 319, 8, 22, "Print",ExpressionUUID->"9f9a1f9e-e05f-40dc-970b-554e76f7ae5b"],
Cell[284120, 7264, 296, 8, 22, "Print",ExpressionUUID->"70f79702-2b2a-4f3a-9222-0ffec924cbd9"],
Cell[284419, 7274, 309, 8, 22, "Print",ExpressionUUID->"52ec75d1-a077-40ec-b500-57002ff9e4ac"],
Cell[284731, 7284, 321, 8, 22, "Print",ExpressionUUID->"b92eb398-2878-4696-a381-dcc4a86a8756"],
Cell[285055, 7294, 294, 8, 22, "Print",ExpressionUUID->"e4cafeaf-8dbe-4aed-a4da-a40ad120573b"],
Cell[285352, 7304, 307, 8, 22, "Print",ExpressionUUID->"ad3b8971-caf2-4bf8-bf50-423e2ba6979c"],
Cell[285662, 7314, 321, 8, 22, "Print",ExpressionUUID->"19417433-b75b-458f-9d16-2dfbe91f6138"],
Cell[285986, 7324, 296, 8, 22, "Print",ExpressionUUID->"7ef83392-1436-4899-9cbf-d114982b7321"],
Cell[286285, 7334, 307, 8, 22, "Print",ExpressionUUID->"d2f8be91-e145-4470-a83e-b0f57be1bb18"],
Cell[286595, 7344, 321, 8, 22, "Print",ExpressionUUID->"36afb8a2-1396-4806-b0f0-0e9f83d03aea"],
Cell[286919, 7354, 296, 8, 22, "Print",ExpressionUUID->"96dae273-bb6c-491d-b1fe-324637d2b70a"],
Cell[287218, 7364, 348, 9, 22, "Print",ExpressionUUID->"79a62f73-ce37-4f88-802d-61898e01932a"],
Cell[287569, 7375, 360, 9, 22, "Print",ExpressionUUID->"9b671ce3-dfdb-4925-acf4-53a21022f8dd"],
Cell[287932, 7386, 296, 8, 22, "Print",ExpressionUUID->"3ee08132-18b2-4087-8ab0-12d39d4775e4"],
Cell[288231, 7396, 380, 10, 38, "Print",ExpressionUUID->"2228a3df-572a-4d40-8394-c8f8c7f949de"],
Cell[288614, 7408, 390, 10, 38, "Print",ExpressionUUID->"98cec657-d096-4932-8b67-3f6b91705565"],
Cell[289007, 7420, 296, 8, 22, "Print",ExpressionUUID->"1a691449-1d6c-44ab-ad56-8221914675f4"],
Cell[289306, 7430, 380, 10, 38, "Print",ExpressionUUID->"bd61ba0c-e1f3-4692-aa85-d1c80f591614"],
Cell[289689, 7442, 392, 10, 38, "Print",ExpressionUUID->"0d99d33a-6501-4d76-9aea-14463aa91730"],
Cell[290084, 7454, 294, 8, 22, "Print",ExpressionUUID->"443aa0bc-46f8-4ceb-b54a-3a1c77fcb996"],
Cell[290381, 7464, 378, 10, 38, "Print",ExpressionUUID->"b714a649-27ff-41b5-b79a-2860adbbba7f"],
Cell[290762, 7476, 392, 10, 38, "Print",ExpressionUUID->"e59ac42e-13a6-464e-8f65-ed862b8be709"],
Cell[291157, 7488, 294, 8, 22, "Print",ExpressionUUID->"686416d4-28c3-4e33-8929-7e5fdc905370"],
Cell[291454, 7498, 348, 9, 22, "Print",ExpressionUUID->"3113cf53-4d4d-482a-b752-3b8b39ab955a"],
Cell[291805, 7509, 360, 9, 22, "Print",ExpressionUUID->"04b584a5-3d8d-4d9f-bc39-6bf8f7deb94a"],
Cell[292168, 7520, 294, 8, 22, "Print",ExpressionUUID->"dc14f128-0df7-40c5-bbd7-e9dd30a69cfd"],
Cell[292465, 7530, 348, 9, 22, "Print",ExpressionUUID->"addc42eb-1f0e-4216-a508-73f200b0aac5"],
Cell[292816, 7541, 360, 9, 22, "Print",ExpressionUUID->"14d6ac51-0665-4cbc-9618-f12af20b07e0"],
Cell[293179, 7552, 293, 8, 22, "Print",ExpressionUUID->"9feedd57-1f25-4186-b239-3a0216737d9d"],
Cell[293475, 7562, 348, 9, 22, "Print",ExpressionUUID->"05829bac-f170-4aed-aa83-bfaf6aba3f2a"],
Cell[293826, 7573, 360, 9, 22, "Print",ExpressionUUID->"42b0fa3a-0557-4a7c-852f-37dbbf0ad6ba"],
Cell[294189, 7584, 296, 8, 22, "Print",ExpressionUUID->"e7276f4a-baf9-44ca-876c-0804f0c2a75d"],
Cell[294488, 7594, 309, 8, 22, "Print",ExpressionUUID->"f84de509-64b4-4387-bce3-f1b192b14e07"],
Cell[294800, 7604, 319, 8, 22, "Print",ExpressionUUID->"83e18918-98f7-4c8a-9e59-70143f32776c"],
Cell[295122, 7614, 296, 8, 22, "Print",ExpressionUUID->"454c34bd-3c73-49b1-b8ca-b2ad211c7869"],
Cell[295421, 7624, 307, 8, 22, "Print",ExpressionUUID->"4d1096d2-244c-4f2f-8cf1-e67eada027fe"],
Cell[295731, 7634, 321, 8, 22, "Print",ExpressionUUID->"3070416d-81fb-4ebf-8761-455739ed4a66"],
Cell[296055, 7644, 294, 8, 22, "Print",ExpressionUUID->"35d73e8d-a488-4652-871e-5f9b7d0ed359"],
Cell[296352, 7654, 309, 8, 22, "Print",ExpressionUUID->"f228e8e0-e325-4ec0-931d-be74d4362169"],
Cell[296664, 7664, 319, 8, 22, "Print",ExpressionUUID->"704c764c-4252-4912-9c08-42267d5f46c5"],
Cell[296986, 7674, 294, 8, 22, "Print",ExpressionUUID->"9f581876-e965-4483-8169-4e107e5bf283"],
Cell[297283, 7684, 327, 9, 22, "Print",ExpressionUUID->"d141911c-59b6-4ae8-a1d5-e0575cd7fd6c"],
Cell[297613, 7695, 339, 9, 22, "Print",ExpressionUUID->"9d2eae31-5b8c-4d11-972e-308d097d92e4"],
Cell[297955, 7706, 296, 8, 22, "Print",ExpressionUUID->"c0ee4de4-0675-4360-b51d-46923e1854dd"],
Cell[298254, 7716, 375, 9, 22, "Print",ExpressionUUID->"5bda8a89-b3ee-4637-bb8a-0fdac045ecb2"],
Cell[298632, 7727, 390, 10, 22, "Print",ExpressionUUID->"b8442ed9-92d7-412a-86a6-14f66eca670b"],
Cell[299025, 7739, 294, 8, 22, "Print",ExpressionUUID->"ee4d2010-fe3f-48c8-ad9c-711debba4753"],
Cell[299322, 7749, 329, 9, 22, "Print",ExpressionUUID->"625e7462-76a9-4fb2-a53b-f05f626fa0ab"],
Cell[299654, 7760, 341, 9, 22, "Print",ExpressionUUID->"d3a55ad0-f927-43fe-bcff-4c2b000fff18"],
Cell[299998, 7771, 296, 8, 22, "Print",ExpressionUUID->"f5947910-6aa3-4a0d-83b4-a07411e374fa"],
Cell[300297, 7781, 316, 9, 22, "Print",ExpressionUUID->"ea6f7341-18b1-4fd8-a846-a016ec7ca888"],
Cell[300616, 7792, 328, 9, 22, "Print",ExpressionUUID->"6d04af10-4caa-4963-bfe1-e9a1f0bfd168"],
Cell[300947, 7803, 296, 8, 22, "Print",ExpressionUUID->"185cdd54-087d-4cad-9012-ea35b1bed9c2"],
Cell[301246, 7813, 316, 9, 22, "Print",ExpressionUUID->"429bbaa2-88fd-491e-a351-824042ceea95"],
Cell[301565, 7824, 328, 9, 22, "Print",ExpressionUUID->"2df2053d-d964-4aa4-ab06-4474a7a05c50"],
Cell[301896, 7835, 296, 8, 22, "Print",ExpressionUUID->"855734f2-9e89-4908-a27a-8769bff7e7d5"],
Cell[302195, 7845, 316, 9, 22, "Print",ExpressionUUID->"b50efcdd-31fc-42b2-9525-e4e8a11b4018"],
Cell[302514, 7856, 328, 9, 22, "Print",ExpressionUUID->"0fad95dd-790c-4714-a52d-ce395f3dc91c"],
Cell[302845, 7867, 296, 8, 22, "Print",ExpressionUUID->"d7b838d9-cdfe-4861-92b4-bd65c24b15a4"],
Cell[303144, 7877, 309, 8, 22, "Print",ExpressionUUID->"b35c185e-d6bf-40a8-bb88-209d09d6dab0"],
Cell[303456, 7887, 321, 8, 22, "Print",ExpressionUUID->"dbc3f411-e9da-4f47-89d7-bccedd2528ca"],
Cell[303780, 7897, 296, 8, 22, "Print",ExpressionUUID->"d310ae1c-cb8f-43af-859e-235e82a7e324"],
Cell[304079, 7907, 398, 10, 22, "Print",ExpressionUUID->"bd972736-c04a-44f9-bbe7-9361b678e5b4"],
Cell[304480, 7919, 413, 11, 22, "Print",ExpressionUUID->"3f5e52fa-8c28-41b3-890e-4fdba57c5fa9"],
Cell[304896, 7932, 294, 8, 22, "Print",ExpressionUUID->"a1dc50af-166d-45c1-bd51-1268b8527052"],
Cell[305193, 7942, 309, 8, 22, "Print",ExpressionUUID->"61100082-d1f1-4c08-bf67-0ec84cc10a71"],
Cell[305505, 7952, 321, 8, 22, "Print",ExpressionUUID->"3f729898-e320-42ac-a9b2-13aa8c09df2b"],
Cell[305829, 7962, 294, 8, 22, "Print",ExpressionUUID->"f98d3956-3eca-4a53-ac61-e3cd73d7f1b4"],
Cell[306126, 7972, 329, 9, 22, "Print",ExpressionUUID->"a8634678-ae2a-4392-854e-bb1146576f4d"],
Cell[306458, 7983, 339, 9, 22, "Print",ExpressionUUID->"dbd41e10-9bfe-4dd4-babb-6768dbdd17dd"],
Cell[306800, 7994, 294, 8, 22, "Print",ExpressionUUID->"7a67d6cf-14d3-489d-8a98-c3e00332d36e"],
Cell[307097, 8004, 348, 9, 22, "Print",ExpressionUUID->"7a0793d1-bbb8-4fdb-a383-a54daece9f49"],
Cell[307448, 8015, 362, 9, 22, "Print",ExpressionUUID->"ba65d6eb-a557-4508-9da4-9515e44068e3"],
Cell[307813, 8026, 296, 8, 22, "Print",ExpressionUUID->"99ea9e7a-0ad3-449c-a5a7-13eec9cfa2e1"],
Cell[308112, 8036, 316, 9, 22, "Print",ExpressionUUID->"af7e9adc-a30f-4822-8f3b-eb33fad7c239"],
Cell[308431, 8047, 328, 9, 22, "Print",ExpressionUUID->"ed9eeaee-f859-4d86-803c-04bd830afa94"],
Cell[308762, 8058, 294, 8, 22, "Print",ExpressionUUID->"67832e04-297e-49a5-8e95-c522e0423c81"],
Cell[309059, 8068, 314, 9, 22, "Print",ExpressionUUID->"6ab654fa-9292-4e85-adbb-fc066f131771"],
Cell[309376, 8079, 325, 9, 22, "Print",ExpressionUUID->"96480f46-1fd2-40dc-b9d8-fc15efb2297d"],
Cell[309704, 8090, 294, 8, 22, "Print",ExpressionUUID->"3b090cae-e49a-49b4-80b8-116f3546ffb4"],
Cell[310001, 8100, 314, 9, 22, "Print",ExpressionUUID->"c9b291ff-636b-4370-9a05-0f21630e04bb"],
Cell[310318, 8111, 328, 9, 22, "Print",ExpressionUUID->"5fe6e325-d292-4f3e-9056-7e7a368c5f75"],
Cell[310649, 8122, 296, 8, 22, "Print",ExpressionUUID->"41062322-65de-4581-accf-71c288a023c4"],
Cell[310948, 8132, 378, 10, 38, "Print",ExpressionUUID->"04112930-0fe8-4c7b-8598-6ecb9d3782c5"],
Cell[311329, 8144, 390, 10, 38, "Print",ExpressionUUID->"07d3ae4e-6f9a-4ebb-878f-4b851615237b"],
Cell[311722, 8156, 294, 8, 22, "Print",ExpressionUUID->"8218a107-76fe-45d5-97d4-cf39a7371957"],
Cell[312019, 8166, 437, 13, 39, "Print",ExpressionUUID->"0b0fc895-9ea0-4553-9ac2-9bb9035b7c25"],
Cell[312459, 8181, 306, 8, 22, "Print",ExpressionUUID->"0bfcb5b5-c776-4baa-ad62-be7e0e9bee1e"],
Cell[312768, 8191, 296, 8, 22, "Print",ExpressionUUID->"e9133f3a-16de-4ce1-8b18-d3106f878fb1"]
}, Open  ]],
Cell[313079, 8202, 240, 5, 48, "Output",ExpressionUUID->"40d71a81-6dbc-4d52-af12-f74d8a97d203"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[313392, 8215, 231, 4, 67, "Section",ExpressionUUID->"ca9dfa80-2c21-495b-bfb1-007ba6c2900e"],
Cell[313626, 8221, 186, 3, 53, "Subsection",ExpressionUUID->"cc9e1c87-4e09-4813-9862-71eebbfb3aad"],
Cell[CellGroupData[{
Cell[313837, 8228, 161, 3, 37, "Subsection",ExpressionUUID->"f657f205-910e-4ef3-93ec-df4f6836e3fa"],
Cell[314001, 8233, 352, 10, 28, "Input",ExpressionUUID->"d0963e87-6a14-4d02-8103-71bbc8ade603"],
Cell[CellGroupData[{
Cell[314378, 8247, 4030, 90, 90, "Input",ExpressionUUID->"54c24bba-204c-499e-8fe6-32ca97229026"],
Cell[318411, 8339, 3876, 89, 99, "Output",ExpressionUUID->"ef5b2587-dc00-450b-a6c9-fee3b58657db"]
}, Open  ]],
Cell[CellGroupData[{
Cell[322324, 8433, 219, 3, 28, "Input",ExpressionUUID->"22d32a70-569c-46f0-b59c-0fea03bd9b98"],
Cell[322546, 8438, 462, 14, 32, "Output",ExpressionUUID->"ede6b7bd-0e62-4b30-9f11-daa4ab2b438e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[323045, 8457, 3033, 75, 56, "Input",ExpressionUUID->"a25d4959-dba0-4d27-8f2d-da8d2c8cb530"],
Cell[326081, 8534, 5396, 126, 99, "Output",ExpressionUUID->"22110703-9265-4911-a636-6a1cfa3b34f3"]
}, Open  ]],
Cell[331492, 8663, 236, 4, 28, "Input",ExpressionUUID->"f9641e7e-8748-4c4c-96c6-136e04a1d6e8"],
Cell[CellGroupData[{
Cell[331753, 8671, 567, 14, 28, "Input",ExpressionUUID->"9148e494-322e-41f8-a126-d0cc935d53d7"],
Cell[332323, 8687, 4578, 104, 66, "Output",ExpressionUUID->"ce2416fc-c102-4e1d-992e-5839df45f185"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[336950, 8797, 172, 3, 37, "Subsection",ExpressionUUID->"c5bdf1d3-b865-4153-a7d7-2c7c41e66124"],
Cell[337125, 8802, 410, 8, 28, "Input",ExpressionUUID->"5b570cb0-302e-4a05-b8dc-e018a51d15a5"],
Cell[337538, 8812, 1213, 35, 48, "Input",ExpressionUUID->"41d4f0d5-319a-4e4c-91b8-f9528652b982"],
Cell[338754, 8849, 318, 5, 28, "Input",ExpressionUUID->"2e73a0b5-fea0-43bd-96ee-8bb40c3291c4"],
Cell[339075, 8856, 1581, 42, 48, "Input",ExpressionUUID->"8d72aaa2-7ac1-4b08-99f8-7b2140d4fd14"],
Cell[340659, 8900, 1579, 42, 48, "Input",ExpressionUUID->"a5bd9e7e-7d86-4538-87e9-4e2609d48c32"],
Cell[CellGroupData[{
Cell[342263, 8946, 3937, 81, 90, "Input",ExpressionUUID->"37a314ae-9d16-4e38-9e15-d26e60175c98"],
Cell[346203, 9029, 5788, 127, 65, "Output",ExpressionUUID->"41af4940-db4c-43f1-a875-0cea8afa9f34"]
}, Open  ]],
Cell[CellGroupData[{
Cell[352028, 9161, 528, 11, 49, "Input",ExpressionUUID->"2fbb0461-6d34-4957-9485-4032448c7568"],
Cell[352559, 9174, 522, 11, 53, "Output",ExpressionUUID->"20c31cfc-fc65-4bfc-8227-a69a9a98142b"]
}, Open  ]],
Cell[353096, 9188, 281, 5, 28, "Input",ExpressionUUID->"aeb4659f-8063-4371-86f4-5c21f60894a0"],
Cell[353380, 9195, 281, 5, 28, "Input",ExpressionUUID->"9c25b5a9-6a10-45a0-8bd8-12114e4bbac1"],
Cell[CellGroupData[{
Cell[353686, 9204, 462, 11, 28, "Input",ExpressionUUID->"49e6787d-a91f-4aa5-85f1-84173dee1732"],
Cell[354151, 9217, 5013, 105, 65, "Output",ExpressionUUID->"bb5b3caf-3726-49c6-afa3-76a8fe9d7a6d"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[359225, 9329, 160, 3, 53, "Section",ExpressionUUID->"b38239cf-b1d6-4b6b-b1ad-cf72701aa082"],
Cell[359388, 9334, 390, 8, 48, "Input",ExpressionUUID->"e4145d55-d431-44eb-adfa-ef02824a2e4a"],
Cell[CellGroupData[{
Cell[359803, 9346, 1410, 31, 28, "Input",ExpressionUUID->"56352eb4-c9b8-4a9b-a011-dd620b9c7824"],
Cell[361216, 9379, 741, 16, 32, "Output",ExpressionUUID->"3ca43bac-cd9c-4835-a6db-6db369b53f6e"]
}, Open  ]],
Cell[361972, 9398, 306, 5, 28, "Input",ExpressionUUID->"aa678f2d-1d51-4de9-8345-5b09048d2afb"],
Cell[362281, 9405, 310, 5, 28, "Input",ExpressionUUID->"9b79fd8b-d30f-4209-8e20-e99c0fb5952d"],
Cell[CellGroupData[{
Cell[362616, 9414, 773, 16, 48, "Input",ExpressionUUID->"f75334f3-0446-4d7e-bf36-f2eadadd941f"],
Cell[363392, 9432, 758, 16, 51, "Output",ExpressionUUID->"39dceef7-c790-4376-8e68-4cf1ebe50ce8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[364187, 9453, 213, 3, 28, "Input",ExpressionUUID->"eebdc9b0-adc2-4bf0-b595-299976a3f8e4"],
Cell[364403, 9458, 461, 10, 50, "Output",ExpressionUUID->"d13b8120-0abc-48de-855f-cd0592cbd0a1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[364901, 9473, 775, 16, 48, "Input",ExpressionUUID->"d98989d0-fecd-4682-b171-340b60dae922"],
Cell[365679, 9491, 711, 15, 51, "Output",ExpressionUUID->"060ab4b9-9d6a-41e4-bcdd-0d7ba1451e3a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[366427, 9511, 331, 8, 28, "Input",ExpressionUUID->"70237a01-639c-4252-83c1-336f5ed9b3d8"],
Cell[366761, 9521, 742, 16, 51, "Output",ExpressionUUID->"f49c2298-61e6-4073-b45b-047c65637679"]
}, Open  ]]
}, Open  ]]
}
]
*)

