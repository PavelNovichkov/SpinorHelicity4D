(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    238271,       5942]
NotebookOptionsPosition[    207054,       5363]
NotebookOutlinePosition[    220340,       5633]
CellTagsIndexPosition[    220297,       5630]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"<<", "SpinorHelicity6D`"}]], "Input",
 CellChangeTimes->{{3.7942879870454674`*^9, 3.794287993526134*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"f246f599-fc6c-40e9-bb9b-a12032dd9867"],

Cell[CellGroupData[{

Cell[BoxData["\<\"===============SpinorHelicity6D================\"\>"], \
"Print",
 CellChangeTimes->{3.7942879958080335`*^9, 3.7942995465278893`*^9, 
  3.7943001686058064`*^9, 3.7943009169277353`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"42ceeaa7-48dd-4273-a76e-7a1baba0f798"],

Cell[BoxData["\<\"Authors: Manuel Accettulli Huber (QMUL)\"\>"], "Print",
 CellChangeTimes->{3.7942879958080335`*^9, 3.7942995465278893`*^9, 
  3.7943001686058064`*^9, 3.794300916943705*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"67726dd3-9284-4f01-a103-4958618fba5d"],

Cell[BoxData["\<\"         Stefano De Angelis (QMUL)\"\>"], "Print",
 CellChangeTimes->{3.7942879958080335`*^9, 3.7942995465278893`*^9, 
  3.7943001686058064`*^9, 3.7943009169517403`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"2fb3f083-ce95-45e6-bb70-1d9288d271fc"],

Cell[BoxData["\<\"Please report any bug to:\"\>"], "Print",
 CellChangeTimes->{3.7942879958080335`*^9, 3.7942995465278893`*^9, 
  3.7943001686058064`*^9, 3.794300916959708*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"9d53b8d9-1802-41e0-968c-4b1938900fec"],

Cell[BoxData["\<\"m.accettullihuber@qmul.ac.uk\"\>"], "Print",
 CellChangeTimes->{3.7942879958080335`*^9, 3.7942995465278893`*^9, 
  3.7943001686058064`*^9, 3.794300916963708*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"70e84b0f-0b5d-4a75-a904-acccd299f41b"],

Cell[BoxData["\<\"s.deangelis@qmul.ac.uk\"\>"], "Print",
 CellChangeTimes->{3.7942879958080335`*^9, 3.7942995465278893`*^9, 
  3.7943001686058064`*^9, 3.794300916971705*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"917dbcca-2375-4dc1-a1bd-e7234bfb6dad"],

Cell[BoxData["\<\"Version 1.2 , last update 23/01/2020\"\>"], "Print",
 CellChangeTimes->{3.7942879958080335`*^9, 3.7942995465278893`*^9, 
  3.7943001686058064`*^9, 3.7943009169757075`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"ad04a71e-cb20-4bc8-80b0-cb29ebde2261"],

Cell[BoxData["\<\"===============================================\"\>"], \
"Print",
 CellChangeTimes->{3.7942879958080335`*^9, 3.7942995465278893`*^9, 
  3.7943001686058064`*^9, 3.7943009169797077`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"a3b93483-c0b9-419b-b534-d243bd4cf648"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["chain", "Subsection",ExpressionUUID->"2394c209-a7e3-4e05-ab8d-f2f666d49dbe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Contraction", " ", "properties", " ", "of", " ", "the", " ", "chains"}], 
   "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"SquareAngle", " ", "to", " ", "AngleSquare"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"chain", "[", 
      RowBox[{"$square", ",", "x_", ",", "k_List", ",", "y_", ",", "$angle"}],
       "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", "k", "]"}], "+", "1"}], ")"}]}], 
      RowBox[{"chain", "[", 
       RowBox[{"$angle", ",", "y", ",", 
        RowBox[{"Reverse", "[", "k", "]"}], ",", "x", ",", "$square"}], 
       "]"}]}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"AngleAngle", " ", "with", " ", "SquareSquare"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"chain", " ", "/:", " ", 
     RowBox[{"Times", "[", 
      RowBox[{
       RowBox[{"chain", "[", 
        RowBox[{
        "$angle", ",", "x_", ",", "k_List", ",", "y_", ",", "$angle"}], "]"}],
        ",", 
       RowBox[{"chain", "[", 
        RowBox[{
        "$square", ",", "y_", ",", "q_List", ",", "z_", ",", "$square"}], 
        "]"}]}], "]"}], ":=", 
     RowBox[{"chain", "[", 
      RowBox[{"$angle", ",", "x", ",", 
       RowBox[{"Join", "[", 
        RowBox[{"k", ",", 
         RowBox[{"{", "y", "}"}], ",", "q"}], "]"}], ",", "z", ",", 
       "$square"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"chain", " ", "/:", " ", 
     RowBox[{"Times", "[", 
      RowBox[{
       RowBox[{"chain", "[", 
        RowBox[{
        "$angle", ",", "x_", ",", "k_List", ",", "y_", ",", "$angle"}], "]"}],
        ",", 
       RowBox[{"chain", "[", 
        RowBox[{
        "$square", ",", "z_", ",", "q_List", ",", "y_", ",", "$square"}], 
        "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", "q", "]"}], "+", "1"}], ")"}]}], 
      RowBox[{"chain", "[", 
       RowBox[{"$angle", ",", "x", ",", 
        RowBox[{"Join", "[", 
         RowBox[{"k", ",", 
          RowBox[{"{", "y", "}"}], ",", 
          RowBox[{"Reverse", "[", "q", "]"}]}], "]"}], ",", "z", ",", 
        "$square"}], "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"chain", " ", "/:", " ", 
     RowBox[{"Times", "[", 
      RowBox[{
       RowBox[{"chain", "[", 
        RowBox[{
        "$angle", ",", "y_", ",", "k_List", ",", "x_", ",", "$angle"}], "]"}],
        ",", 
       RowBox[{"chain", "[", 
        RowBox[{
        "$square", ",", "y_", ",", "q_List", ",", "z_", ",", "$square"}], 
        "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", "k", "]"}], "+", "1"}], ")"}]}], 
      RowBox[{"chain", "[", 
       RowBox[{"$angle", ",", "x", ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Reverse", "[", "k", "]"}], ",", 
          RowBox[{"{", "y", "}"}], ",", "q"}], "]"}], ",", "z", ",", 
        "$square"}], "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"chain", " ", "/:", " ", 
     RowBox[{"Times", "[", 
      RowBox[{
       RowBox[{"chain", "[", 
        RowBox[{
        "$angle", ",", "y_", ",", "k_List", ",", "x_", ",", "$angle"}], "]"}],
        ",", 
       RowBox[{"chain", "[", 
        RowBox[{
        "$square", ",", "z_", ",", "q_List", ",", "y_", ",", "$square"}], 
        "]"}]}], "]"}], ":=", 
     RowBox[{"chain", "[", 
      RowBox[{"$square", ",", "z", ",", 
       RowBox[{"Join", "[", 
        RowBox[{"q", ",", 
         RowBox[{"{", "y", "}"}], ",", "k"}], "]"}], ",", "x", ",", 
       "$angle"}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"AngleSquare", " ", "with", " ", "SquareSquare"}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"chain", " ", "/:", " ", 
      RowBox[{"Times", "[", 
       RowBox[{
        RowBox[{"chain", "[", 
         RowBox[{
         "$square", ",", "x_", ",", "k_List", ",", "y_", ",", "$angle"}], 
         "]"}], ",", 
        RowBox[{"chain", "[", 
         RowBox[{
         "$square", ",", "y_", ",", "q_List", ",", "z_", ",", "$square"}], 
         "]"}]}], "]"}], ":=", 
      RowBox[{"chain", "[", 
       RowBox[{"$square", ",", "x", ",", 
        RowBox[{"Join", "[", 
         RowBox[{"k", ",", 
          RowBox[{"{", "y", "}"}], ",", "q"}], "]"}], ",", "z", ",", 
        "$square"}], "]"}]}], ";", "\n", 
     RowBox[{"chain", " ", "/:", " ", 
      RowBox[{"Times", "[", 
       RowBox[{
        RowBox[{"chain", "[", 
         RowBox[{
         "$square", ",", "x_", ",", "k_List", ",", "y_", ",", "$angle"}], 
         "]"}], ",", 
        RowBox[{"chain", "[", 
         RowBox[{
         "$square", ",", "z_", ",", "q_List", ",", "y_", ",", "$square"}], 
         "]"}]}], "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "q", "]"}], "+", "1"}], ")"}]}], 
       RowBox[{"chain", "[", 
        RowBox[{"$square", ",", "x", ",", 
         RowBox[{"Join", "[", 
          RowBox[{"k", ",", 
           RowBox[{"{", "y", "}"}], ",", "q"}], "]"}], ",", "z", ",", 
         "$square"}], "]"}]}]}], ";"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"chain", " ", "/:", " ", 
     RowBox[{"Times", "[", 
      RowBox[{
       RowBox[{"chain", "[", 
        RowBox[{
        "$angle", ",", "y_", ",", "k_List", ",", "x_", ",", "$square"}], 
        "]"}], ",", 
       RowBox[{"chain", "[", 
        RowBox[{
        "$square", ",", "y_", ",", "q_List", ",", "z_", ",", "$square"}], 
        "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", "k", "]"}], "+", "1"}], ")"}]}], 
      RowBox[{"chain", "[", 
       RowBox[{"$square", ",", "x", ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Reverse", "[", "k", "]"}], ",", 
          RowBox[{"{", "y", "}"}], ",", "q"}], "]"}], ",", "z", ",", 
        "$square"}], "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"chain", " ", "/:", " ", 
     RowBox[{"Times", "[", 
      RowBox[{
       RowBox[{"chain", "[", 
        RowBox[{
        "$angle", ",", "y_", ",", "k_List", ",", "x_", ",", "$square"}], 
        "]"}], ",", 
       RowBox[{"chain", "[", 
        RowBox[{
        "$square", ",", "z_", ",", "q_List", ",", "y_", ",", "$square"}], 
        "]"}]}], "]"}], ":=", 
     RowBox[{"chain", "[", 
      RowBox[{"$square", ",", "z", ",", 
       RowBox[{"Join", "[", 
        RowBox[{"q", ",", 
         RowBox[{"{", "y", "}"}], ",", "k"}], "]"}], ",", "x", ",", 
       "$square"}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"SquareAngle", " ", "with", " ", "AngleAngle"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"chain", " ", "/:", " ", 
     RowBox[{"Times", "[", 
      RowBox[{
       RowBox[{"chain", "[", 
        RowBox[{
        "$angle", ",", "x_", ",", "k_List", ",", "y_", ",", "$square"}], 
        "]"}], ",", 
       RowBox[{"chain", "[", 
        RowBox[{
        "$angle", ",", "y_", ",", "q_List", ",", "z_", ",", "$angle"}], 
        "]"}]}], "]"}], ":=", 
     RowBox[{"chain", "[", 
      RowBox[{"$angle", ",", "x", ",", 
       RowBox[{"Join", "[", 
        RowBox[{"k", ",", 
         RowBox[{"{", "y", "}"}], ",", "q"}], "]"}], ",", "z", ",", 
       "$angle"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"chain", " ", "/:", " ", 
     RowBox[{"Times", "[", 
      RowBox[{
       RowBox[{"chain", "[", 
        RowBox[{
        "$angle", ",", "x_", ",", "k_List", ",", "y_", ",", "$square"}], 
        "]"}], ",", 
       RowBox[{"chain", "[", 
        RowBox[{
        "$angle", ",", "z_", ",", "q_List", ",", "y_", ",", "$angle"}], 
        "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", "q", "]"}], "+", "1"}], ")"}]}], 
      RowBox[{"chain", "[", 
       RowBox[{"$angle", ",", "x", ",", 
        RowBox[{"Join", "[", 
         RowBox[{"k", ",", 
          RowBox[{"{", "y", "}"}], ",", 
          RowBox[{"Reverse", "[", "q", "]"}]}], "]"}], ",", "z", ",", 
        "$angle"}], "]"}]}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"chain", " ", "/:", " ", 
      RowBox[{"Times", "[", 
       RowBox[{
        RowBox[{"chain", "[", 
         RowBox[{
         "$square", ",", "y_", ",", "k_List", ",", "x_", ",", "$angle"}], 
         "]"}], ",", 
        RowBox[{"chain", "[", 
         RowBox[{
         "$angle", ",", "y_", ",", "q_List", ",", "z_", ",", "$angle"}], 
         "]"}]}], "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "k", "]"}], "+", "1"}], ")"}]}], 
       RowBox[{"chain", "[", 
        RowBox[{"$angle", ",", "x", ",", 
         RowBox[{"Join", "[", 
          RowBox[{"k", ",", 
           RowBox[{"{", "y", "}"}], ",", "q"}], "]"}], ",", "z", ",", 
         "$angle"}], "]"}]}]}], ";", "\n", 
     RowBox[{"chain", " ", "/:", " ", 
      RowBox[{"Times", "[", 
       RowBox[{
        RowBox[{"chain", "[", 
         RowBox[{
         "$square", ",", "y_", ",", "k_List", ",", "x_", ",", "$angle"}], 
         "]"}], ",", 
        RowBox[{"chain", "[", 
         RowBox[{
         "$angle", ",", "z_", ",", "q_List", ",", "y_", ",", "$angle"}], 
         "]"}]}], "]"}], ":=", 
      RowBox[{"chain", "[", 
       RowBox[{"$angle", ",", "z", ",", 
        RowBox[{"Join", "[", 
         RowBox[{"q", ",", 
          RowBox[{"{", "y", "}"}], ",", "k"}], "]"}], ",", "x", ",", 
        "$angle"}], "]"}]}], ";"}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"AngleSquare", " ", "with", " ", "AngleSquare"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"chain", " ", "/:", " ", 
     RowBox[{"Times", "[", 
      RowBox[{
       RowBox[{"chain", "[", 
        RowBox[{
        "$angle", ",", "x_", ",", "k_List", ",", "y_", ",", "$square"}], 
        "]"}], ",", 
       RowBox[{"chain", "[", 
        RowBox[{
        "$angle", ",", "y_", ",", "q_List", ",", "z_", ",", "$square"}], 
        "]"}]}], "]"}], ":=", 
     RowBox[{"chain", "[", 
      RowBox[{"$angle", ",", "x", ",", 
       RowBox[{"Join", "[", 
        RowBox[{"k", ",", 
         RowBox[{"{", "y", "}"}], ",", "q"}], "]"}], ",", "z", ",", 
       "$square"}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"Vanishing", " ", "chains"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"chain", "[", 
      RowBox[{"type_", ",", "x_", ",", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y___"}], "}"}], ",", "z_", ",", "type2_"}], "]"}],
      ":=", "0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"chain", "[", 
      RowBox[{"type_", ",", "x_", ",", 
       RowBox[{"{", 
        RowBox[{"y___", ",", "z_"}], "}"}], ",", "z_", ",", "type2_"}], "]"}],
      ":=", "0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"chain", "[", 
      RowBox[{"type_", ",", "x_", ",", 
       RowBox[{"{", 
        RowBox[{"y___", ",", "z_", ",", "z_", ",", "k___"}], "}"}], ",", "l_",
        ",", "type2_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"mp", "[", 
       RowBox[{"z", ",", "z"}], "]"}], "*", 
      RowBox[{"chain", "[", 
       RowBox[{"type", ",", "x", ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", "k"}], "}"}], ",", "l", ",", "type2"}], "]"}]}]}], 
    ";"}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{"Display", " ", "of", " ", "the", " ", "chains"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AngleSquarechainBox", "[", 
      RowBox[{"beginning_", ",", "args_", ",", "end_"}], "]"}], ":=", 
     RowBox[{"TemplateBox", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"beginning", ",", "args", ",", "end"}], "}"}], ",", 
       "\"\<AngleSquarechain\>\"", ",", "\n", 
       RowBox[{"DisplayFunction", "->", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RowBox", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\[LeftAngleBracket]\>\"", ",", "#1", ",", "#2", ",", "#3", 
             ",", "\"\<]\>\""}], "}"}], "]"}], "&"}], ")"}]}], ",", "\n", 
       RowBox[{"InterpretationFunction", "->", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RowBox", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<chain\>\"", ",", "\"\<[\>\"", ",", "\"\<$angle\>\"", ",", 
             "\"\<,\>\"", ",", "#1", ",", "\"\<,\>\"", ",", "#2", ",", 
             "\"\<,\>\"", ",", "#3", ",", "\"\<,\>\"", ",", "\"\<$square\>\"",
              ",", "\"\<]\>\""}], "}"}], "]"}], "&"}], ")"}]}]}], "\n", 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SquareAnglechainBox", "[", 
      RowBox[{"beginning_", ",", "args_", ",", "end_"}], "]"}], ":=", 
     RowBox[{"TemplateBox", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"beginning", ",", "args", ",", "end"}], "}"}], ",", 
       "\"\<SquareAnglechain\>\"", ",", "\n", 
       RowBox[{"DisplayFunction", "->", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RowBox", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<[\>\"", ",", "#1", ",", "#2", ",", "#3", ",", 
             "\"\<\[RightAngleBracket]\>\""}], "}"}], "]"}], "&"}], ")"}]}], 
       ",", "\n", 
       RowBox[{"InterpretationFunction", "->", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RowBox", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<chain\>\"", ",", "\"\<[\>\"", ",", "\"\<$square\>\"", ",", 
             "\"\<,\>\"", ",", "#1", ",", "\"\<,\>\"", ",", "#2", ",", 
             "\"\<,\>\"", ",", "#3", ",", "\"\<,\>\"", ",", "\"\<$angle\>\"", 
             ",", "\"\<]\>\""}], "}"}], "]"}], "&"}], ")"}]}]}], "\n", 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AngleAnglechainBox", "[", 
      RowBox[{"beginning_", ",", "args_", ",", "end_"}], "]"}], ":=", 
     RowBox[{"TemplateBox", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"beginning", ",", "args", ",", "end"}], "}"}], ",", 
       "\"\<AngleAnglechain\>\"", ",", "\n", 
       RowBox[{"DisplayFunction", "->", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RowBox", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\[LeftAngleBracket]\>\"", ",", "#1", ",", "#2", ",", "#3", 
             ",", "\"\<\[RightAngleBracket]\>\""}], "}"}], "]"}], "&"}], 
         ")"}]}], ",", "\n", 
       RowBox[{"InterpretationFunction", "->", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RowBox", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<chain\>\"", ",", "\"\<[\>\"", ",", "\"\<$angle\>\"", ",", 
             "\"\<,\>\"", ",", "#1", ",", "\"\<,\>\"", ",", "#2", ",", 
             "\"\<,\>\"", ",", "#3", ",", "\"\<,\>\"", ",", "\"\<$angle\>\"", 
             ",", "\"\<]\>\""}], "}"}], "]"}], "&"}], ")"}]}]}], "\n", 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SquareSquarechainBox", "[", 
      RowBox[{"beginning_", ",", "args_", ",", "end_"}], "]"}], ":=", 
     RowBox[{"TemplateBox", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"beginning", ",", "args", ",", "end"}], "}"}], ",", 
       "\"\<SquareSquarechain\>\"", ",", "\n", 
       RowBox[{"DisplayFunction", "->", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RowBox", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<[\>\"", ",", "#1", ",", "#2", ",", "#3", ",", "\"\<]\>\""}], 
            "}"}], "]"}], "&"}], ")"}]}], ",", "\n", 
       RowBox[{"InterpretationFunction", "->", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RowBox", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<chain\>\"", ",", "\"\<[\>\"", ",", "\"\<$square\>\"", ",", 
             "\"\<,\>\"", ",", "#1", ",", "\"\<,\>\"", ",", "#2", ",", 
             "\"\<,\>\"", ",", "#3", ",", "\"\<,\>\"", ",", "\"\<$square\>\"",
              ",", "\"\<]\>\""}], "}"}], "]"}], "&"}], ")"}]}]}], "\n", 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"chain", " ", "/:", " ", 
     RowBox[{
      RowBox[{"MakeBoxes", "[", 
       RowBox[{
        RowBox[{"chain", "[", 
         RowBox[{
         "$angle", ",", "x_", ",", "y_List", ",", "z_", ",", "$square"}], 
         "]"}], ",", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}], "]"}], " ", "/;", 
      RowBox[{"OddQ", "[", 
       RowBox[{
        RowBox[{"Length", "[", "y", "]"}], "+", "2"}], "]"}]}], ":=", 
     RowBox[{"AngleSquarechainBox", "[", 
      RowBox[{
       RowBox[{"ToBoxes", "[", "x", "]"}], ",", 
       RowBox[{"ToBoxes", "[", "y", "]"}], ",", 
       RowBox[{"ToBoxes", "[", "z", "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"chain", " ", "/:", " ", 
     RowBox[{
      RowBox[{"MakeBoxes", "[", 
       RowBox[{
        RowBox[{"chain", "[", 
         RowBox[{
         "$angle", ",", "x_", ",", "y_List", ",", "z_", ",", "$angle"}], 
         "]"}], ",", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}], "]"}], " ", "/;", 
      RowBox[{"EvenQ", "[", 
       RowBox[{
        RowBox[{"Length", "[", "y", "]"}], "+", "2"}], "]"}]}], ":=", 
     RowBox[{"AngleAnglechainBox", "[", 
      RowBox[{
       RowBox[{"ToBoxes", "[", "x", "]"}], ",", 
       RowBox[{"ToBoxes", "[", "y", "]"}], ",", 
       RowBox[{"ToBoxes", "[", "z", "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"chain", " ", "/:", " ", 
     RowBox[{
      RowBox[{"MakeBoxes", "[", 
       RowBox[{
        RowBox[{"chain", "[", 
         RowBox[{
         "$square", ",", "x_", ",", "y_List", ",", "z_", ",", "$angle"}], 
         "]"}], ",", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}], "]"}], " ", "/;", 
      RowBox[{"OddQ", "[", 
       RowBox[{
        RowBox[{"Length", "[", "y", "]"}], "+", "2"}], "]"}]}], ":=", 
     RowBox[{"SquareAnglechainBox", "[", 
      RowBox[{
       RowBox[{"ToBoxes", "[", "x", "]"}], ",", 
       RowBox[{"ToBoxes", "[", "y", "]"}], ",", 
       RowBox[{"ToBoxes", "[", "z", "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"chain", " ", "/:", " ", 
     RowBox[{
      RowBox[{"MakeBoxes", "[", 
       RowBox[{
        RowBox[{"chain", "[", 
         RowBox[{
         "$square", ",", "x_", ",", "y_List", ",", "z_", ",", "$square"}], 
         "]"}], ",", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}], "]"}], " ", "/;", 
      RowBox[{"EvenQ", "[", 
       RowBox[{
        RowBox[{"Length", "[", "y", "]"}], "+", "2"}], "]"}]}], ":=", 
     RowBox[{"SquareSquarechainBox", "[", 
      RowBox[{
       RowBox[{"ToBoxes", "[", "x", "]"}], ",", 
       RowBox[{"ToBoxes", "[", "y", "]"}], ",", 
       RowBox[{"ToBoxes", "[", "z", "]"}]}], "]"}]}], ";"}]}]}]], "Code",Expre\
ssionUUID->"b932be13-5343-4259-98b4-257eac7760fc"]
}, Closed]],

Cell[CellGroupData[{

Cell["ToChain", "Subsection",ExpressionUUID->"a8fccf7f-8353-4c77-9aef-01b61f69dd50"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"ToChain", "[", "exp_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"localexp", ",", "MyPower", ",", "counter"}], "}"}], ",", "\n", 
      RowBox[{
       RowBox[{"localexp", "=", 
        RowBox[{"exp", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Power", "->", "MyPower"}], ",", 
           RowBox[{"Chain", "\[Rule]", "chain"}]}], "}"}]}]}], ";", "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "First", " ", "we", " ", "need", " ", "to", " ", "group", " ", 
          "things", " ", "properly", " ", "in", " ", "order", " ", "to", " ", 
          "apply", " ", "the", " ", "contraction", " ", "properties"}], ",", 
         " ", 
         RowBox[{
          RowBox[{
          "since", " ", "Mathematica", " ", "is", " ", "not", " ", "able", 
           " ", "to", " ", "recognize", " ", "things", " ", "inside", " ", 
           "powers", " ", "as", " ", "contractible", " ", "with", " ", 
           "things", " ", "outside", " ", "that", " ", "power"}], "..."}]}], 
        "*)"}], "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FreeQ", "[", 
           RowBox[{"localexp", ",", "MyPower"}], "]"}], "==", "False"}], ",", 
         "\n", 
         RowBox[{
          RowBox[{"localexp", "=", 
           RowBox[{"localexp", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"A_", "*", 
                RowBox[{"MyPower", "[", 
                 RowBox[{"B_", ",", "x_"}], "]"}]}], "/;", 
               RowBox[{"FreeQ", "[", 
                RowBox[{"A", ",", "MyPower"}], "]"}]}], ":>", 
              RowBox[{
               RowBox[{"MyPower", "[", 
                RowBox[{"A", ",", "1"}], "]"}], "*", 
               RowBox[{"MyPower", "[", 
                RowBox[{"B", ",", "x"}], "]"}]}]}], "}"}]}]}], ";", "\n", 
          RowBox[{"localexp", "=", 
           RowBox[{"localexp", "//.", 
            RowBox[{
             RowBox[{
              RowBox[{"MyPower", "[", 
               RowBox[{"A_", ",", "x_"}], "]"}], "*", 
              RowBox[{"MyPower", "[", 
               RowBox[{"B_", ",", "x_"}], "]"}]}], ":>", 
             RowBox[{"MyPower", "[", 
              RowBox[{
               RowBox[{"A", "*", "B"}], ",", "x"}], "]"}]}]}]}], ";", "\n", 
          RowBox[{"localexp", "=", 
           RowBox[{"localexp", "/.", 
            RowBox[{
             RowBox[{"MyPower", "[", 
              RowBox[{"A_", ",", 
               RowBox[{"x_", "?", "Negative"}]}], "]"}], ":>", 
             RowBox[{"1", "/", 
              RowBox[{"MyPower", "[", 
               RowBox[{"A", ",", 
                RowBox[{"-", "x"}]}], "]"}]}]}]}]}], ";", "\n", 
          RowBox[{"localexp", "=", 
           RowBox[{"localexp", "//.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"MyPower", "[", 
                 RowBox[{
                  RowBox[{"x_", "*", "A_"}], ",", "n_"}], "]"}], "*", 
                RowBox[{"MyPower", "[", 
                 RowBox[{"B_", ",", "m_"}], "]"}]}], "/;", 
               RowBox[{
                RowBox[{"n", ">", "m"}], "&&", 
                RowBox[{"FreeQ", "[", 
                 RowBox[{"B", ",", "x"}], "]"}]}]}], ":>", 
              RowBox[{
               RowBox[{"MyPower", "[", 
                RowBox[{
                 RowBox[{"x", "*", "A"}], ",", 
                 RowBox[{"n", "-", "m"}]}], "]"}], 
               RowBox[{"MyPower", "[", 
                RowBox[{
                 RowBox[{"x", "*", "A", "*", "B"}], ",", "m"}], "]"}]}]}], 
             "}"}]}]}], ";", "\n", 
          RowBox[{"localexp", "=", 
           RowBox[{"localexp", "//.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"MyPower", "[", 
                 RowBox[{"x_", ",", "n_"}], "]"}], "*", 
                RowBox[{"MyPower", "[", 
                 RowBox[{"B_", ",", "m_"}], "]"}]}], "/;", 
               RowBox[{
                RowBox[{"n", ">", "m"}], "&&", 
                RowBox[{"FreeQ", "[", 
                 RowBox[{"B", ",", "x"}], "]"}]}]}], ":>", 
              RowBox[{
               RowBox[{"MyPower", "[", 
                RowBox[{"x", ",", 
                 RowBox[{"n", "-", "m"}]}], "]"}], 
               RowBox[{"MyPower", "[", 
                RowBox[{
                 RowBox[{"x", "*", "B"}], ",", "m"}], "]"}]}]}], "}"}]}]}], 
          ";"}]}], "\n", "]"}], ";", "\n", "\n", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "introduce", " ", "the", " ", "Chains", " ", "and", " ", 
         "let", " ", "them", " ", "contract"}], "*)"}], "\n", 
       RowBox[{"localexp", "=", 
        RowBox[{"localexp", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"SpinorAngleBracket", "[", 
             RowBox[{"x_", ",", "y_"}], "]"}], ":>", 
            RowBox[{"chain", "[", 
             RowBox[{"$angle", ",", "x", ",", 
              RowBox[{"{", "}"}], ",", "y", ",", "$angle"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"SpinorSquareBracket", "[", 
             RowBox[{"x_", ",", "y_"}], "]"}], ":>", 
            RowBox[{"chain", "[", 
             RowBox[{"$square", ",", "x", ",", 
              RowBox[{"{", "}"}], ",", "y", ",", "$square"}], "]"}]}]}], 
          "}"}]}]}], ";", "\n", "\n", 
       RowBox[{"(*", 
        RowBox[{"Back", " ", "to", " ", 
         RowBox[{"mathematica", "'"}], "s", " ", "Power"}], "*)"}], "\n", 
       RowBox[{"localexp", "=", 
        RowBox[{"localexp", "/.", 
         RowBox[{"{", 
          RowBox[{"MyPower", "->", "Power"}], "}"}]}]}], ";", "\n", "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Now", " ", "replace", " ", "the", " ", "chain", " ", "with", " ", 
          "Chain"}], ",", " ", 
         RowBox[{
         "where", " ", "the", " ", "first", " ", "has", " ", "all", " ", 
          "the", " ", "contraction", " ", "properties", " ", "whereas", " ", 
          "the", " ", "second", " ", "does", " ", "not", " ", "and", " ", 
          "thus", " ", "expressions", " ", "stay", " ", "as", " ", "they", 
          " ", "are"}]}], "*)"}], "\n", 
       RowBox[{"localexp", "=", 
        RowBox[{"localexp", "/.", 
         RowBox[{"{", 
          RowBox[{"chain", "->", "Chain"}], "}"}]}]}], ";", "\n", "\n", 
       RowBox[{"(*", 
        RowBox[{
        "Replace", " ", "the", " ", "single", " ", "chains", " ", "back", " ",
          "with", " ", "angle", " ", "and", " ", "square", " ", "brackets"}], 
        "*)"}], "\n", 
       RowBox[{"localexp", "=", 
        RowBox[{"localexp", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Chain", "[", 
             RowBox[{"$angle", ",", "x_", ",", 
              RowBox[{"{", "}"}], ",", "y_", ",", "$angle"}], "]"}], ":>", 
            RowBox[{"SpinorAngleBracket", "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"Chain", "[", 
             RowBox[{"$square", ",", "x_", ",", 
              RowBox[{"{", "}"}], ",", "y_", ",", "$square"}], "]"}], ":>", 
            RowBox[{"SpinorSquareBracket", "[", 
             RowBox[{"x", ",", "y"}], "]"}]}]}], "}"}]}]}], ";", "\n", "\n", 
       RowBox[{"Return", "[", "localexp", "]"}], ";"}]}], "\n", "]"}]}], 
   ";"}], "*)"}]], "Code",ExpressionUUID->"bc8ab63b-8c1a-4f5f-a75a-\
52b53ec3de0d"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "ToChain", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"MinimalChains", "->", "True"}], "}"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"ToChain", "[", 
     RowBox[{"exp_", ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"localexp", ",", "MyPower", ",", "counter"}], "}"}], ",", "\n", 
      RowBox[{
       RowBox[{"localexp", "=", 
        RowBox[{"exp", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Power", "->", "MyPower"}], ",", 
           RowBox[{"Chain", "->", "chain"}]}], "}"}]}]}], ";", "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "First", " ", "we", " ", "need", " ", "to", " ", "group", " ", 
          "things", " ", "properly", " ", "in", " ", "order", " ", "to", " ", 
          "apply", " ", "the", " ", "contraction", " ", "properties"}], ",", 
         " ", 
         RowBox[{
          RowBox[{
          "since", " ", "Mathematica", " ", "is", " ", "not", " ", "able", 
           " ", "to", " ", "recognize", " ", "things", " ", "inside", " ", 
           "powers", " ", "as", " ", "contractible", " ", "with", " ", 
           "things", " ", "outside", " ", "that", " ", "power"}], "..."}]}], 
        "*)"}], "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FreeQ", "[", 
           RowBox[{"localexp", ",", "MyPower"}], "]"}], "==", "False"}], ",", 
         "\n", 
         RowBox[{
          RowBox[{"localexp", "=", 
           RowBox[{"localexp", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"A_", "*", 
                RowBox[{"MyPower", "[", 
                 RowBox[{"B_", ",", "x_"}], "]"}]}], "/;", 
               RowBox[{"FreeQ", "[", 
                RowBox[{"A", ",", "MyPower"}], "]"}]}], ":>", 
              RowBox[{
               RowBox[{"MyPower", "[", 
                RowBox[{"A", ",", "1"}], "]"}], "*", 
               RowBox[{"MyPower", "[", 
                RowBox[{"B", ",", "x"}], "]"}]}]}], "}"}]}]}], ";", "\n", 
          RowBox[{"localexp", "=", 
           RowBox[{"localexp", "//.", 
            RowBox[{
             RowBox[{
              RowBox[{"MyPower", "[", 
               RowBox[{"A_", ",", "x_"}], "]"}], "*", 
              RowBox[{"MyPower", "[", 
               RowBox[{"B_", ",", "x_"}], "]"}]}], ":>", 
             RowBox[{"MyPower", "[", 
              RowBox[{
               RowBox[{"A", "*", "B"}], ",", "x"}], "]"}]}]}]}], ";", "\n", 
          RowBox[{"localexp", "=", 
           RowBox[{"localexp", "/.", 
            RowBox[{
             RowBox[{"MyPower", "[", 
              RowBox[{"A_", ",", 
               RowBox[{"x_", "?", "Negative"}]}], "]"}], ":>", 
             RowBox[{"1", "/", 
              RowBox[{"MyPower", "[", 
               RowBox[{"A", ",", 
                RowBox[{"-", "x"}]}], "]"}]}]}]}]}], ";", "\n", 
          RowBox[{"localexp", "=", 
           RowBox[{"localexp", "//.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"MyPower", "[", 
                 RowBox[{
                  RowBox[{"x_", "*", "A_"}], ",", "n_"}], "]"}], "*", 
                RowBox[{"MyPower", "[", 
                 RowBox[{"B_", ",", "m_"}], "]"}]}], "/;", 
               RowBox[{
                RowBox[{"n", ">", "m"}], "&&", 
                RowBox[{"FreeQ", "[", 
                 RowBox[{"B", ",", "x"}], "]"}]}]}], ":>", 
              RowBox[{
               RowBox[{"MyPower", "[", 
                RowBox[{
                 RowBox[{"x", "*", "A"}], ",", 
                 RowBox[{"n", "-", "m"}]}], "]"}], 
               RowBox[{"MyPower", "[", 
                RowBox[{
                 RowBox[{"x", "*", "A", "*", "B"}], ",", "m"}], "]"}]}]}], 
             "}"}]}]}], ";", "\n", 
          RowBox[{"localexp", "=", 
           RowBox[{"localexp", "//.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"MyPower", "[", 
                 RowBox[{"x_", ",", "n_"}], "]"}], "*", 
                RowBox[{"MyPower", "[", 
                 RowBox[{"B_", ",", "m_"}], "]"}]}], "/;", 
               RowBox[{
                RowBox[{"n", ">", "m"}], "&&", 
                RowBox[{"FreeQ", "[", 
                 RowBox[{"B", ",", "x"}], "]"}]}]}], ":>", 
              RowBox[{
               RowBox[{"MyPower", "[", 
                RowBox[{"x", ",", 
                 RowBox[{"n", "-", "m"}]}], "]"}], 
               RowBox[{"MyPower", "[", 
                RowBox[{
                 RowBox[{"x", "*", "B"}], ",", "m"}], "]"}]}]}], "}"}]}]}], 
          ";"}]}], "\n", "]"}], ";", "\n", "\n", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "introduce", " ", "the", " ", "Chains", " ", "and", " ", 
         "let", " ", "them", " ", "contract"}], "*)"}], "\n", 
       RowBox[{"localexp", "=", 
        RowBox[{"localexp", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"SpinorAngleBracket", "[", 
             RowBox[{"x_", ",", "y_"}], "]"}], ":>", 
            RowBox[{"chain", "[", 
             RowBox[{"$angle", ",", "x", ",", 
              RowBox[{"{", "}"}], ",", "y", ",", "$angle"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"SpinorSquareBracket", "[", 
             RowBox[{"x_", ",", "y_"}], "]"}], ":>", 
            RowBox[{"chain", "[", 
             RowBox[{"$square", ",", "x", ",", 
              RowBox[{"{", "}"}], ",", "y", ",", "$square"}], "]"}]}]}], 
          "}"}]}]}], ";", "\n", "\n", 
       RowBox[{"(*", 
        RowBox[{"Back", " ", "to", " ", 
         RowBox[{"mathematica", "'"}], "s", " ", "Power"}], "*)"}], "\n", 
       RowBox[{"localexp", "=", 
        RowBox[{"localexp", "/.", 
         RowBox[{"{", 
          RowBox[{"MyPower", "->", "Power"}], "}"}]}]}], ";", "\n", "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Now", " ", "replace", " ", "the", " ", "chain", " ", "with", " ", 
          "Chain"}], ",", " ", 
         RowBox[{
         "where", " ", "the", " ", "first", " ", "has", " ", "all", " ", 
          "the", " ", "contraction", " ", "properties", " ", "whereas", " ", 
          "the", " ", "second", " ", "does", " ", "not", " ", "and", " ", 
          "thus", " ", "expressions", " ", "stay", " ", "as", " ", "they", 
          " ", "are"}]}], "*)"}], "\n", 
       RowBox[{"localexp", "=", 
        RowBox[{"localexp", "/.", 
         RowBox[{"{", 
          RowBox[{"chain", "->", "Chain"}], "}"}]}]}], ";", "\n", "\n", 
       RowBox[{"(*", 
        RowBox[{
        "Replace", " ", "the", " ", "single", " ", "chains", " ", "back", " ",
          "with", " ", "angle", " ", "and", " ", "square", " ", "brackets"}], 
        "*)"}], "\n", 
       RowBox[{"localexp", "=", 
        RowBox[{"localexp", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Chain", "[", 
             RowBox[{"$angle", ",", "x_", ",", 
              RowBox[{"{", "}"}], ",", "y_", ",", "$angle"}], "]"}], ":>", 
            RowBox[{"SpinorAngleBracket", "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"Chain", "[", 
             RowBox[{"$square", ",", "x_", ",", 
              RowBox[{"{", "}"}], ",", "y_", ",", "$square"}], "]"}], ":>", 
            RowBox[{"SpinorSquareBracket", "[", 
             RowBox[{"x", ",", "y"}], "]"}]}]}], "}"}]}]}], ";", "\n", "\n", 
       RowBox[{"(*", 
        RowBox[{
        "Reduce", " ", "the", " ", "chains", " ", "to", " ", "minimal", " ", 
         "form", " ", "if", " ", "required"}], "*)"}], "\n", "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"TrueQ", "[", 
          RowBox[{"OptionValue", "[", "MinimalChains", "]"}], "]"}], ",", 
         "\n", 
         RowBox[{
          RowBox[{"localexp", "=", 
           RowBox[{"localexp", "//.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Chain", "[", 
                 RowBox[{"$angle", ",", "x_", ",", 
                  RowBox[{"{", 
                   RowBox[{"y__", ",", "x_", ",", "z__"}], "}"}], ",", "k_", 
                  ",", "type2_"}], "]"}], "/;", 
                RowBox[{"OddQ", "[", 
                 RowBox[{"Length", "[", 
                  RowBox[{"{", "y", "}"}], "]"}], "]"}]}], ":>", 
               RowBox[{
                RowBox[{"Chain", "[", 
                 RowBox[{"$angle", ",", "x", ",", 
                  RowBox[{"{", "y", "}"}], ",", "x", ",", "$square"}], "]"}], 
                "*", 
                RowBox[{"Chain", "[", 
                 RowBox[{"$angle", ",", "x", ",", 
                  RowBox[{"{", "z", "}"}], ",", "k", ",", "type2"}], 
                 "]"}]}]}], ",", "\n", 
              RowBox[{
               RowBox[{
                RowBox[{"Chain", "[", 
                 RowBox[{"$square", ",", "x_", ",", 
                  RowBox[{"{", 
                   RowBox[{"y__", ",", "x_", ",", "z__"}], "}"}], ",", "k_", 
                  ",", "type2_"}], "]"}], "/;", 
                RowBox[{"OddQ", "[", 
                 RowBox[{"Length", "[", 
                  RowBox[{"{", "y", "}"}], "]"}], "]"}]}], ":>", 
               RowBox[{
                RowBox[{"Chain", "[", 
                 RowBox[{"$square", ",", "x", ",", 
                  RowBox[{"{", "y", "}"}], ",", "x", ",", "$angle"}], "]"}], 
                "*", 
                RowBox[{"Chain", "[", 
                 RowBox[{"$square", ",", "x", ",", 
                  RowBox[{"{", "z", "}"}], ",", "k", ",", "type2"}], 
                 "]"}]}]}], ",", "\n", 
              RowBox[{
               RowBox[{
                RowBox[{"Chain", "[", 
                 RowBox[{"type1_", ",", "k_", ",", 
                  RowBox[{"{", 
                   RowBox[{"y__", ",", "x_", ",", "z__"}], "}"}], ",", "x_", 
                  ",", "$angle"}], "]"}], "/;", 
                RowBox[{"OddQ", "[", 
                 RowBox[{"Length", "[", 
                  RowBox[{"{", "z", "}"}], "]"}], "]"}]}], ":>", 
               RowBox[{
                RowBox[{"Chain", "[", 
                 RowBox[{"type1", ",", "k", ",", 
                  RowBox[{"{", "y", "}"}], ",", "x", ",", "$angle"}], "]"}], 
                "*", 
                RowBox[{"Chain", "[", 
                 RowBox[{"$square", ",", "x", ",", 
                  RowBox[{"{", "z", "}"}], ",", "x", ",", "$angle"}], 
                 "]"}]}]}], ",", "\n", 
              RowBox[{
               RowBox[{
                RowBox[{"Chain", "[", 
                 RowBox[{"type1_", ",", "k_", ",", 
                  RowBox[{"{", 
                   RowBox[{"y__", ",", "x_", ",", "z__"}], "}"}], ",", "x_", 
                  ",", "$square"}], "]"}], "/;", 
                RowBox[{"OddQ", "[", 
                 RowBox[{"Length", "[", 
                  RowBox[{"{", "z", "}"}], "]"}], "]"}]}], ":>", 
               RowBox[{
                RowBox[{"Chain", "[", 
                 RowBox[{"type1", ",", "k", ",", 
                  RowBox[{"{", "y", "}"}], ",", "x", ",", "$square"}], "]"}], 
                "*", 
                RowBox[{"Chain", "[", 
                 RowBox[{"$angle", ",", "x", ",", 
                  RowBox[{"{", "z", "}"}], ",", "x", ",", "$square"}], 
                 "]"}]}]}]}], "}"}]}]}], ";"}]}], "\n", "]"}], ";", "\n", 
       "\n", 
       RowBox[{"Return", "[", "localexp", "]"}], ";"}]}], "\n", "]"}]}], 
   ";"}], "*)"}]], "Code",ExpressionUUID->"510188ac-3c89-49c8-b9dc-\
36c51d787d03"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToChainAux", "[", "exp_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"localexp", ",", "MyPower", ",", "counter"}], "}"}], ",", "\n", 
      RowBox[{
       RowBox[{"localexp", "=", 
        RowBox[{"exp", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Power", "->", "MyPower"}], ",", 
           RowBox[{"Chain", "->", "chain"}]}], "}"}]}]}], ";", "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "First", " ", "we", " ", "need", " ", "to", " ", "group", " ", 
          "things", " ", "properly", " ", "in", " ", "order", " ", "to", " ", 
          "apply", " ", "the", " ", "contraction", " ", "properties"}], ",", 
         " ", 
         RowBox[{
          RowBox[{
          "since", " ", "Mathematica", " ", "is", " ", "not", " ", "able", 
           " ", "to", " ", "recognize", " ", "things", " ", "inside", " ", 
           "powers", " ", "as", " ", "contractible", " ", "with", " ", 
           "things", " ", "outside", " ", "that", " ", "power"}], "..."}]}], 
        "*)"}], "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FreeQ", "[", 
           RowBox[{"localexp", ",", "MyPower"}], "]"}], "==", "False"}], ",", 
         "\n", 
         RowBox[{
          RowBox[{"localexp", "=", 
           RowBox[{"localexp", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"A_", "*", 
                RowBox[{"MyPower", "[", 
                 RowBox[{"B_", ",", "x_"}], "]"}]}], "/;", 
               RowBox[{"FreeQ", "[", 
                RowBox[{"A", ",", "MyPower"}], "]"}]}], ":>", 
              RowBox[{
               RowBox[{"MyPower", "[", 
                RowBox[{"A", ",", "1"}], "]"}], "*", 
               RowBox[{"MyPower", "[", 
                RowBox[{"B", ",", "x"}], "]"}]}]}], "}"}]}]}], ";", "\n", 
          RowBox[{"localexp", "=", 
           RowBox[{"localexp", "//.", 
            RowBox[{
             RowBox[{
              RowBox[{"MyPower", "[", 
               RowBox[{"A_", ",", "x_"}], "]"}], "*", 
              RowBox[{"MyPower", "[", 
               RowBox[{"B_", ",", "x_"}], "]"}]}], ":>", 
             RowBox[{"MyPower", "[", 
              RowBox[{
               RowBox[{"A", "*", "B"}], ",", "x"}], "]"}]}]}]}], ";", "\n", 
          RowBox[{"localexp", "=", 
           RowBox[{"localexp", "/.", 
            RowBox[{
             RowBox[{"MyPower", "[", 
              RowBox[{"A_", ",", 
               RowBox[{"x_", "?", "Negative"}]}], "]"}], ":>", 
             RowBox[{"1", "/", 
              RowBox[{"MyPower", "[", 
               RowBox[{"A", ",", 
                RowBox[{"-", "x"}]}], "]"}]}]}]}]}], ";", "\n", 
          RowBox[{"localexp", "=", 
           RowBox[{"localexp", "//.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"MyPower", "[", 
                 RowBox[{
                  RowBox[{"x_", "*", "A_"}], ",", "n_"}], "]"}], "*", 
                RowBox[{"MyPower", "[", 
                 RowBox[{"B_", ",", "m_"}], "]"}]}], "/;", 
               RowBox[{
                RowBox[{"n", ">", "m"}], "&&", 
                RowBox[{"FreeQ", "[", 
                 RowBox[{"B", ",", "x"}], "]"}]}]}], ":>", 
              RowBox[{
               RowBox[{"MyPower", "[", 
                RowBox[{
                 RowBox[{"x", "*", "A"}], ",", 
                 RowBox[{"n", "-", "m"}]}], "]"}], 
               RowBox[{"MyPower", "[", 
                RowBox[{
                 RowBox[{"x", "*", "A", "*", "B"}], ",", "m"}], "]"}]}]}], 
             "}"}]}]}], ";", "\n", 
          RowBox[{"localexp", "=", 
           RowBox[{"localexp", "//.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"MyPower", "[", 
                 RowBox[{"x_", ",", "n_"}], "]"}], "*", 
                RowBox[{"MyPower", "[", 
                 RowBox[{"B_", ",", "m_"}], "]"}]}], "/;", 
               RowBox[{
                RowBox[{"n", ">", "m"}], "&&", 
                RowBox[{"FreeQ", "[", 
                 RowBox[{"B", ",", "x"}], "]"}]}]}], ":>", 
              RowBox[{
               RowBox[{"MyPower", "[", 
                RowBox[{"x", ",", 
                 RowBox[{"n", "-", "m"}]}], "]"}], 
               RowBox[{"MyPower", "[", 
                RowBox[{
                 RowBox[{"x", "*", "B"}], ",", "m"}], "]"}]}]}], "}"}]}]}], 
          ";"}]}], "\n", "]"}], ";", "\n", "\n", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "introduce", " ", "the", " ", "Chains", " ", "and", " ", 
         "let", " ", "them", " ", "contract"}], "*)"}], "\n", 
       RowBox[{"localexp", "=", 
        RowBox[{"localexp", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"SpinorAngleBracket", "[", 
             RowBox[{"x_", ",", "y_"}], "]"}], ":>", 
            RowBox[{"chain", "[", 
             RowBox[{"$angle", ",", "x", ",", 
              RowBox[{"{", "}"}], ",", "y", ",", "$angle"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"SpinorSquareBracket", "[", 
             RowBox[{"x_", ",", "y_"}], "]"}], ":>", 
            RowBox[{"chain", "[", 
             RowBox[{"$square", ",", "x", ",", 
              RowBox[{"{", "}"}], ",", "y", ",", "$square"}], "]"}]}]}], 
          "}"}]}]}], ";", "\n", "\n", 
       RowBox[{"(*", 
        RowBox[{"Back", " ", "to", " ", 
         RowBox[{"mathematica", "'"}], "s", " ", "Power"}], "*)"}], "\n", 
       RowBox[{"localexp", "=", 
        RowBox[{"localexp", "/.", 
         RowBox[{"{", 
          RowBox[{"MyPower", "->", "Power"}], "}"}]}]}], ";", "\n", "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Now", " ", "replace", " ", "the", " ", "chain", " ", "with", " ", 
          "Chain"}], ",", " ", 
         RowBox[{
         "where", " ", "the", " ", "first", " ", "has", " ", "all", " ", 
          "the", " ", "contraction", " ", "properties", " ", "whereas", " ", 
          "the", " ", "second", " ", "does", " ", "not", " ", "and", " ", 
          "thus", " ", "expressions", " ", "stay", " ", "as", " ", "they", 
          " ", "are"}]}], "*)"}], "\n", 
       RowBox[{"localexp", "=", 
        RowBox[{"localexp", "/.", 
         RowBox[{"{", 
          RowBox[{"chain", "->", "Chain"}], "}"}]}]}], ";", "\n", "\n", 
       RowBox[{"(*", 
        RowBox[{
        "Replace", " ", "the", " ", "single", " ", "chains", " ", "back", " ",
          "with", " ", "angle", " ", "and", " ", "square", " ", "brackets"}], 
        "*)"}], "\n", 
       RowBox[{"localexp", "=", 
        RowBox[{"localexp", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Chain", "[", 
             RowBox[{"$angle", ",", "x_", ",", 
              RowBox[{"{", "}"}], ",", "y_", ",", "$angle"}], "]"}], ":>", 
            RowBox[{"SpinorAngleBracket", "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"Chain", "[", 
             RowBox[{"$square", ",", "x_", ",", 
              RowBox[{"{", "}"}], ",", "y_", ",", "$square"}], "]"}], ":>", 
            RowBox[{"SpinorSquareBracket", "[", 
             RowBox[{"x", ",", "y"}], "]"}]}]}], "}"}]}]}], ";", "\n", "\n", 
       RowBox[{"Return", "[", "localexp", "]"}], ";"}]}], "\n", "]"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ToChain", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"MinimalChains", "->", "True"}], ",", 
     RowBox[{"RecursionLimit", "->", "10"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ToChain", "[", 
    RowBox[{"exp_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"expin", ",", "expout", ",", "count"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"expin", "=", "Null"}], ";", "\n", 
      RowBox[{"expout", "=", "exp"}], ";", "\n", 
      RowBox[{"count", "=", "0"}], ";", "\n", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"TrueQ", "[", 
          RowBox[{"expin", "==", "expout"}], "]"}]}], ",", "\n", 
        RowBox[{
         RowBox[{"expin", "=", "expout"}], ";", "\n", 
         RowBox[{"expout", "=", 
          RowBox[{"ToChainAux", "[", "expin", "]"}]}], ";", "\n", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"count", ">=", 
            RowBox[{"OptionValue", "[", "RecursionLimit", "]"}]}], ",", "\n", 
           RowBox[{
            RowBox[{
            "Print", "[", 
             "\"\<Either the expression is very complicated or something has \
gone wrong. You can try increasing the RecursionLimit, if it still fails \
check your expression for errors.\>\"", "]"}], ";", "\n", 
            RowBox[{"Break", "[", "]"}], ";"}]}], "\n", "]"}], ";"}]}], "\n", 
       "]"}], ";", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{
       "Reduce", " ", "the", " ", "chains", " ", "to", " ", "minimal", " ", 
        "form", " ", "if", " ", "required"}], "*)"}], "\n", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", 
         RowBox[{"OptionValue", "[", "MinimalChains", "]"}], "]"}], ",", "\n", 
        RowBox[{
         RowBox[{"expout", "=", 
          RowBox[{"expout", "//.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Chain", "[", 
                RowBox[{"$angle", ",", "x_", ",", 
                 RowBox[{"{", 
                  RowBox[{"y__", ",", "x_", ",", "z__"}], "}"}], ",", "k_", 
                 ",", "type2_"}], "]"}], "/;", 
               RowBox[{"OddQ", "[", 
                RowBox[{"Length", "[", 
                 RowBox[{"{", "y", "}"}], "]"}], "]"}]}], ":>", 
              RowBox[{
               RowBox[{"Chain", "[", 
                RowBox[{"$angle", ",", "x", ",", 
                 RowBox[{"{", "y", "}"}], ",", "x", ",", "$square"}], "]"}], 
               "*", 
               RowBox[{"Chain", "[", 
                RowBox[{"$angle", ",", "x", ",", 
                 RowBox[{"{", "z", "}"}], ",", "k", ",", "type2"}], "]"}]}]}],
              ",", "\n", 
             RowBox[{
              RowBox[{
               RowBox[{"Chain", "[", 
                RowBox[{"$square", ",", "x_", ",", 
                 RowBox[{"{", 
                  RowBox[{"y__", ",", "x_", ",", "z__"}], "}"}], ",", "k_", 
                 ",", "type2_"}], "]"}], "/;", 
               RowBox[{"OddQ", "[", 
                RowBox[{"Length", "[", 
                 RowBox[{"{", "y", "}"}], "]"}], "]"}]}], ":>", 
              RowBox[{
               RowBox[{"Chain", "[", 
                RowBox[{"$square", ",", "x", ",", 
                 RowBox[{"{", "y", "}"}], ",", "x", ",", "$angle"}], "]"}], 
               "*", 
               RowBox[{"Chain", "[", 
                RowBox[{"$square", ",", "x", ",", 
                 RowBox[{"{", "z", "}"}], ",", "k", ",", "type2"}], "]"}]}]}],
              ",", "\n", 
             RowBox[{
              RowBox[{
               RowBox[{"Chain", "[", 
                RowBox[{"type1_", ",", "k_", ",", 
                 RowBox[{"{", 
                  RowBox[{"y__", ",", "x_", ",", "z__"}], "}"}], ",", "x_", 
                 ",", "$angle"}], "]"}], "/;", 
               RowBox[{"OddQ", "[", 
                RowBox[{"Length", "[", 
                 RowBox[{"{", "z", "}"}], "]"}], "]"}]}], ":>", 
              RowBox[{
               RowBox[{"Chain", "[", 
                RowBox[{"type1", ",", "k", ",", 
                 RowBox[{"{", "y", "}"}], ",", "x", ",", "$angle"}], "]"}], 
               "*", 
               RowBox[{"Chain", "[", 
                RowBox[{"$square", ",", "x", ",", 
                 RowBox[{"{", "z", "}"}], ",", "x", ",", "$angle"}], 
                "]"}]}]}], ",", "\n", 
             RowBox[{
              RowBox[{
               RowBox[{"Chain", "[", 
                RowBox[{"type1_", ",", "k_", ",", 
                 RowBox[{"{", 
                  RowBox[{"y__", ",", "x_", ",", "z__"}], "}"}], ",", "x_", 
                 ",", "$square"}], "]"}], "/;", 
               RowBox[{"OddQ", "[", 
                RowBox[{"Length", "[", 
                 RowBox[{"{", "z", "}"}], "]"}], "]"}]}], ":>", 
              RowBox[{
               RowBox[{"Chain", "[", 
                RowBox[{"type1", ",", "k", ",", 
                 RowBox[{"{", "y", "}"}], ",", "x", ",", "$square"}], "]"}], 
               "*", 
               RowBox[{"Chain", "[", 
                RowBox[{"$angle", ",", "x", ",", 
                 RowBox[{"{", "z", "}"}], ",", "x", ",", "$square"}], 
                "]"}]}]}]}], "}"}]}]}], ";"}]}], "\n", "]"}], ";", "\n", "\n", 
      RowBox[{"Return", "[", "expout", "]"}], ";"}]}], "\n", "]"}]}], 
  ";"}]}], "Code",ExpressionUUID->"098a9f6c-301a-4740-b82c-5a3232973423"]
}, Closed]],

Cell[CellGroupData[{

Cell["Defining the function ToChain2", "Subsection",
 CellChangeTimes->{{3.794289954466188*^9, 3.794289958605131*^9}, {
  3.794299557588498*^9, 
  3.7942995597935314`*^9}},ExpressionUUID->"7f918acc-4052-4e4d-a7de-\
58edd83f8637"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "ToChain2", "]"}]], "Input",
 CellChangeTimes->{{3.7942985380802183`*^9, 3.7942985484709744`*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"60577263-044c-49e4-b6d1-b2367705267c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ToChain2", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"MinimalChains", "->", "True"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToChain2", "[", 
    RowBox[{"exp_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ChainPow", ",", "locexp"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Chain", " ", 
       RowBox[{"properties", ":"}]}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", "Basics", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ChainPow", "[", "x__", "]"}], "[", "0", "]"}], ":=", "1"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Minus", " ", "signs", " ", "in", " ", "the", " ", "external", " ", 
        "brackest"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ChainPow", "[", 
          RowBox[{"type1_", ",", 
           RowBox[{"-", "x_"}], ",", 
           RowBox[{"{", "y___", "}"}], ",", "z_", ",", "type2_"}], "]"}], "[",
          "n_", "]"}], "/;", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"MomList", ",", "x"}], "]"}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", "I", ")"}], "^", "n"}], "*", 
        RowBox[{
         RowBox[{"ChainPow", "[", 
          RowBox[{"type1", ",", "x", ",", 
           RowBox[{"{", "y", "}"}], ",", "z", ",", "type2"}], "]"}], "[", "n",
          "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ChainPow", "[", 
          RowBox[{"type1_", ",", "x_", ",", 
           RowBox[{"{", "y___", "}"}], ",", 
           RowBox[{"-", "z_"}], ",", "type2_"}], "]"}], "[", "n_", "]"}], "/;", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"MomList", ",", "z"}], "]"}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", "I", ")"}], "^", "n"}], "*", 
        RowBox[{
         RowBox[{"ChainPow", "[", 
          RowBox[{"type1", ",", "x", ",", 
           RowBox[{"{", "y", "}"}], ",", "z", ",", "type2"}], "]"}], "[", "n",
          "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ChainPow", "[", 
          RowBox[{"type1_", ",", 
           RowBox[{"-", "x_"}], ",", 
           RowBox[{"{", "y___", "}"}], ",", 
           RowBox[{"-", "z_"}], ",", "type2_"}], "]"}], "[", "n_", "]"}], "/;", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"MomList", ",", "x"}], "]"}], "&&", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"MomList", ",", "z"}], "]"}]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "^", "n"}], "*", 
        RowBox[{
         RowBox[{"ChainPow", "[", 
          RowBox[{"type1", ",", "x", ",", 
           RowBox[{"{", "y", "}"}], ",", "z", ",", "type2"}], "]"}], "[", "n",
          "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"SquareAngle", " ", "as", " ", "AngleSquare"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"ChainPow", "[", 
         RowBox[{"$square", ",", "x_", ",", 
          RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$angle"}], "]"}], "[", 
        "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"ChainPow", "[", 
         RowBox[{"$angle", ",", "z", ",", 
          RowBox[{"Reverse", "[", 
           RowBox[{"{", "y", "}"}], "]"}], ",", "x", ",", "$square"}], "]"}], 
        "[", "n", "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"The", " ", "actual", " ", "contraction", " ", "properties"}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{" ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x", "..."}], "y"}]}], "\[RightAngleBracket]"}], "[", 
         RowBox[{
          RowBox[{"y", "..."}], "z"}]}], ")"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"ChainPow", " ", "/:", " ", 
       RowBox[{"Times", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ChainPow", "[", 
           RowBox[{"type1_", ",", "x_", ",", 
            RowBox[{"{", "k___", "}"}], ",", "y_", ",", "$angle"}], "]"}], 
          "[", 
          RowBox[{"n_", "?", "Positive"}], "]"}], ",", 
         RowBox[{
          RowBox[{"ChainPow", "[", 
           RowBox[{"$square", ",", "y_", ",", 
            RowBox[{"{", "q___", "}"}], ",", "z_", ",", "type2_"}], "]"}], 
          "[", 
          RowBox[{"m_", "?", "Positive"}], "]"}]}], "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "m"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"type1", ",", "x", ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "y", ",", "q"}], "}"}], ",", "z", ",", 
             "type2"}], "]"}], "[", "m", "]"}], 
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"type1", ",", "x", ",", 
             RowBox[{"{", "k", "}"}], ",", "y", ",", "$angle"}], "]"}], "[", 
           RowBox[{"n", "-", "m"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"type1", ",", "x", ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "y", ",", "q"}], "}"}], ",", "z", ",", 
             "type2"}], "]"}], "[", "n", "]"}], 
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"$square", ",", "y", ",", 
             RowBox[{"{", "q", "}"}], ",", "z", ",", "type2"}], "]"}], "[", 
           RowBox[{"m", "-", "n"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ChainPow", " ", "/:", " ", 
       RowBox[{"Times", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ChainPow", "[", 
           RowBox[{"type1_", ",", "x_", ",", 
            RowBox[{"{", "k___", "}"}], ",", "y_", ",", "$angle"}], "]"}], 
          "[", 
          RowBox[{"n_", "?", "Negative"}], "]"}], ",", 
         RowBox[{
          RowBox[{"ChainPow", "[", 
           RowBox[{"$square", ",", "y_", ",", 
            RowBox[{"{", "q___", "}"}], ",", "z_", ",", "type2_"}], "]"}], 
          "[", 
          RowBox[{"m_", "?", "Negative"}], "]"}]}], "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[LessEqual]", "m"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"type1", ",", "x", ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "y", ",", "q"}], "}"}], ",", "z", ",", 
             "type2"}], "]"}], "[", "m", "]"}], 
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"type1", ",", "x", ",", 
             RowBox[{"{", "k", "}"}], ",", "y", ",", "$angle"}], "]"}], "[", 
           RowBox[{"n", "-", "m"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"type1", ",", "x", ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "y", ",", "q"}], "}"}], ",", "z", ",", 
             "type2"}], "]"}], "[", "n", "]"}], 
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"$square", ",", "y", ",", 
             RowBox[{"{", "q", "}"}], ",", "z", ",", "type2"}], "]"}], "[", 
           RowBox[{"m", "-", "n"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[LeftAngleBracket]", 
           RowBox[{
            RowBox[{"y", "..."}], "x"}]}], ")"}], "[", 
         RowBox[{
          RowBox[{"y", "..."}], "z"}]}], ")"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"ChainPow", " ", "/:", " ", 
       RowBox[{"Times", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ChainPow", "[", 
           RowBox[{"$angle", ",", "y_", ",", 
            RowBox[{"{", "k___", "}"}], ",", "x_", ",", "type1_"}], "]"}], 
          "[", 
          RowBox[{"n_", "?", "Positive"}], "]"}], ",", 
         RowBox[{
          RowBox[{"ChainPow", "[", 
           RowBox[{"$square", ",", "y_", ",", 
            RowBox[{"{", "q___", "}"}], ",", "z_", ",", "type2_"}], "]"}], 
          "[", 
          RowBox[{"m_", "?", "Positive"}], "]"}]}], "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "m"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"m", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"{", "k", "}"}], "]"}], "+", "1"}], ")"}]}], ")"}]}], 
          "*", 
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"type1", ",", "x", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sequence", "@@", 
                RowBox[{"Reverse", "[", 
                 RowBox[{"{", "k", "}"}], "]"}]}], ",", "y", ",", "q"}], 
              "}"}], ",", "z", ",", "type2"}], "]"}], "[", "m", "]"}], 
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"$angle", ",", "y", ",", 
             RowBox[{"{", "k", "}"}], ",", "x", ",", "type1"}], "]"}], "[", 
           RowBox[{"n", "-", "m"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"n", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"{", "k", "}"}], "]"}], "+", "1"}], ")"}]}], ")"}]}], 
          "*", 
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"type1", ",", "x", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sequence", "@@", 
                RowBox[{"Reverse", "[", 
                 RowBox[{"{", "k", "}"}], "]"}]}], ",", "y", ",", "q"}], 
              "}"}], ",", "z", ",", "type2"}], "]"}], "[", "n", "]"}], 
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"$square", ",", "y", ",", 
             RowBox[{"{", "q", "}"}], ",", "z", ",", "type2"}], "]"}], "[", 
           RowBox[{"m", "-", "n"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ChainPow", " ", "/:", " ", 
       RowBox[{"Times", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ChainPow", "[", 
           RowBox[{"$angle", ",", "y_", ",", 
            RowBox[{"{", "k___", "}"}], ",", "x_", ",", "type1_"}], "]"}], 
          "[", 
          RowBox[{"n_", "?", "Negative"}], "]"}], ",", 
         RowBox[{
          RowBox[{"ChainPow", "[", 
           RowBox[{"$square", ",", "y_", ",", 
            RowBox[{"{", "q___", "}"}], ",", "z_", ",", "type2_"}], "]"}], 
          "[", 
          RowBox[{"m_", "?", "Negative"}], "]"}]}], "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[LessEqual]", "m"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"m", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"{", "k", "}"}], "]"}], "+", "1"}], ")"}]}], ")"}]}], 
          "*", 
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"type1", ",", "x", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sequence", "@@", 
                RowBox[{"Reverse", "[", 
                 RowBox[{"{", "k", "}"}], "]"}]}], ",", "y", ",", "q"}], 
              "}"}], ",", "z", ",", "type2"}], "]"}], "[", "m", "]"}], 
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"$angle", ",", "y", ",", 
             RowBox[{"{", "k", "}"}], ",", "x", ",", "type1"}], "]"}], "[", 
           RowBox[{"n", "-", "m"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"n", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"{", "k", "}"}], "]"}], "+", "1"}], ")"}]}], ")"}]}], 
          "*", 
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"type1", ",", "x", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sequence", "@@", 
                RowBox[{"Reverse", "[", 
                 RowBox[{"{", "k", "}"}], "]"}]}], ",", "y", ",", "q"}], 
              "}"}], ",", "z", ",", "type2"}], "]"}], "[", "n", "]"}], 
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"$square", ",", "y", ",", 
             RowBox[{"{", "q", "}"}], ",", "z", ",", "type2"}], "]"}], "[", 
           RowBox[{"m", "-", "n"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x", "..."}], "y"}]}], "\[RightAngleBracket]"}], "[", 
         RowBox[{
          RowBox[{"y", "..."}], "z"}]}], ")"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ChainPow", " ", "/:", " ", 
       RowBox[{"Times", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ChainPow", "[", 
           RowBox[{"type1_", ",", "x_", ",", 
            RowBox[{"{", "k___", "}"}], ",", "y_", ",", "$angle"}], "]"}], 
          "[", 
          RowBox[{"n_", "?", "Positive"}], "]"}], ",", 
         RowBox[{
          RowBox[{"ChainPow", "[", 
           RowBox[{"type2_", ",", "z_", ",", 
            RowBox[{"{", "q___", "}"}], ",", "y_", ",", "$square"}], "]"}], 
          "[", 
          RowBox[{"m_", "?", "Positive"}], "]"}]}], "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "m"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"m", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"{", "q", "}"}], "]"}], "+", "1"}], ")"}]}], ")"}]}], 
          "*", 
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"type1", ",", "x", ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "y", ",", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"Reverse", "[", 
                 RowBox[{"{", "q", "}"}], "]"}]}]}], "}"}], ",", "z", ",", 
             "type2"}], "]"}], "[", "m", "]"}], 
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"type1", ",", "x", ",", 
             RowBox[{"{", "k", "}"}], ",", "y", ",", "$angle"}], "]"}], "[", 
           RowBox[{"n", "-", "m"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"n", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"{", "q", "}"}], "]"}], "+", "1"}], ")"}]}], ")"}]}], 
          "*", 
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"type1", ",", "x", ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "y", ",", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"Reverse", "[", 
                 RowBox[{"{", "q", "}"}], "]"}]}]}], "}"}], ",", "z", ",", 
             "type2"}], "]"}], "[", "n", "]"}], 
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"type2", ",", "z", ",", 
             RowBox[{"{", "q", "}"}], ",", "y", ",", "$square"}], "]"}], "[", 
           RowBox[{"m", "-", "n"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ChainPow", " ", "/:", " ", 
       RowBox[{"Times", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ChainPow", "[", 
           RowBox[{"type1_", ",", "x_", ",", 
            RowBox[{"{", "k___", "}"}], ",", "y_", ",", "$angle"}], "]"}], 
          "[", 
          RowBox[{"n_", "?", "Negative"}], "]"}], ",", 
         RowBox[{
          RowBox[{"ChainPow", "[", 
           RowBox[{"type2_", ",", "z_", ",", 
            RowBox[{"{", "q___", "}"}], ",", "y_", ",", "$square"}], "]"}], 
          "[", 
          RowBox[{"m_", "?", "Negative"}], "]"}]}], "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[LessEqual]", "m"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"m", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"{", "q", "}"}], "]"}], "+", "1"}], ")"}]}], ")"}]}], 
          "*", 
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"type1", ",", "x", ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "y", ",", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"Reverse", "[", 
                 RowBox[{"{", "q", "}"}], "]"}]}]}], "}"}], ",", "z", ",", 
             "type2"}], "]"}], "[", "m", "]"}], 
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"type1", ",", "x", ",", 
             RowBox[{"{", "k", "}"}], ",", "y", ",", "$angle"}], "]"}], "[", 
           RowBox[{"n", "-", "m"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"n", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"{", "q", "}"}], "]"}], "+", "1"}], ")"}]}], ")"}]}], 
          "*", 
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"type1", ",", "x", ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "y", ",", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"Reverse", "[", 
                 RowBox[{"{", "q", "}"}], "]"}]}]}], "}"}], ",", "z", ",", 
             "type2"}], "]"}], "[", "n", "]"}], 
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"type2", ",", "z", ",", 
             RowBox[{"{", "q", "}"}], ",", "y", ",", "$square"}], "]"}], "[", 
           RowBox[{"m", "-", "n"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{" ", 
          RowBox[{"\[LeftAngleBracket]", 
           RowBox[{
            RowBox[{"y", "..."}], "x"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"z", "..."}], "y"}]}]}], "]"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"ChainPow", " ", "/:", " ", 
       RowBox[{"Times", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ChainPow", "[", 
           RowBox[{"$angle", ",", "y_", ",", 
            RowBox[{"{", "k___", "}"}], ",", "x_", ",", "type1_"}], "]"}], 
          "[", 
          RowBox[{"n_", "?", "Positive"}], "]"}], ",", 
         RowBox[{
          RowBox[{"ChainPow", "[", 
           RowBox[{"type2_", ",", "z_", ",", 
            RowBox[{"{", "q___", "}"}], ",", "y_", ",", "$square"}], "]"}], 
          "[", 
          RowBox[{"m_", "?", "Positive"}], "]"}]}], "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "m"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"type2", ",", "z", ",", 
             RowBox[{"{", 
              RowBox[{"q", ",", "y", ",", "k"}], "}"}], ",", "x", ",", 
             "type1"}], "]"}], "[", "m", "]"}], 
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"$angle", ",", "y", ",", 
             RowBox[{"{", "k", "}"}], ",", "x", ",", "type1"}], "]"}], "[", 
           RowBox[{"n", "-", "m"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"type2", ",", "z", ",", 
             RowBox[{"{", 
              RowBox[{"q", ",", "y", ",", "k"}], "}"}], ",", "x", ",", 
             "type1"}], "]"}], "[", "n", "]"}], 
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"type2", ",", "z", ",", 
             RowBox[{"{", "q", "}"}], ",", "y", ",", "$square"}], "]"}], "[", 
           RowBox[{"m", "-", "n"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ChainPow", " ", "/:", " ", 
       RowBox[{"Times", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ChainPow", "[", 
           RowBox[{"$angle", ",", "y_", ",", 
            RowBox[{"{", "k___", "}"}], ",", "x_", ",", "type1_"}], "]"}], 
          "[", 
          RowBox[{"n_", "?", "Negative"}], "]"}], ",", 
         RowBox[{
          RowBox[{"ChainPow", "[", 
           RowBox[{"type2_", ",", "z_", ",", 
            RowBox[{"{", "q___", "}"}], ",", "y_", ",", "$square"}], "]"}], 
          "[", 
          RowBox[{"m_", "?", "Negative"}], "]"}]}], "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[LessEqual]", "m"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"type2", ",", "z", ",", 
             RowBox[{"{", 
              RowBox[{"q", ",", "y", ",", "k"}], "}"}], ",", "x", ",", 
             "type1"}], "]"}], "[", "m", "]"}], 
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"$angle", ",", "y", ",", 
             RowBox[{"{", "k", "}"}], ",", "x", ",", "type1"}], "]"}], "[", 
           RowBox[{"n", "-", "m"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"type2", ",", "z", ",", 
             RowBox[{"{", 
              RowBox[{"q", ",", "y", ",", "k"}], "}"}], ",", "x", ",", 
             "type1"}], "]"}], "[", "n", "]"}], 
          RowBox[{
           RowBox[{"ChainPow", "[", 
            RowBox[{"type2", ",", "z", ",", 
             RowBox[{"{", "q", "}"}], ",", "y", ",", "$square"}], "]"}], "[", 
           RowBox[{"m", "-", "n"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Applying", " ", "the", " ", "properties", " ", "to", " ", "the", " ", 
        "expression"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Convert", " ", "angle", " ", "and", " ", "square", " ", "brackets", 
        " ", "to", " ", "Chains"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"locexp", "=", 
       RowBox[{"exp", "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"SpinorAngleBracket", "[", 
            RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
           RowBox[{"Chain", "[", 
            RowBox[{"$angle", ",", "x", ",", 
             RowBox[{"{", "}"}], ",", "y", ",", "$angle"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"SpinorSquareBracket", "[", 
            RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
           RowBox[{"Chain", "[", 
            RowBox[{"$square", ",", "x", ",", 
             RowBox[{"{", "}"}], ",", "y", ",", "$square"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"Chain", "[", "x__", "]"}], "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"ChainPow", "[", "x", "]"}], "[", "1", "]"}]}], ",", 
          RowBox[{
           RowBox[{"Power", "[", 
            RowBox[{
             RowBox[{"Chain", "[", "x__", "]"}], ",", "n_"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"ChainPow", "[", "x", "]"}], "[", "n", "]"}]}]}], 
         "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Convert", " ", "back", " ", "to", " ", "angle", " ", "and", " ", 
        "square", " ", "brackets"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"locexp", "=", 
       RowBox[{"locexp", "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Chain", "[", 
            RowBox[{"$angle", ",", "x_", ",", 
             RowBox[{"{", "}"}], ",", "y_", ",", "$angle"}], "]"}], ":>", 
           RowBox[{"SpinorAngleBracket", "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"Chain", "[", 
            RowBox[{"$square", ",", "x_", ",", 
             RowBox[{"{", "}"}], ",", "y_", ",", "$square"}], "]"}], ":>", 
           RowBox[{"SpinorSquareBracket", "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"ChainPow", "[", "x__", "]"}], "[", "n_", "]"}], 
           "\[RuleDelayed]", 
           RowBox[{"Power", "[", 
            RowBox[{
             RowBox[{"Chain", "[", "x", "]"}], ",", "n"}], "]"}]}]}], 
         "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Reduce", " ", "the", " ", "chains", " ", "to", " ", "minimal", " ", 
        "form", " ", "if", " ", "required"}], "*)"}], "\n", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", 
         RowBox[{"OptionValue", "[", "MinimalChains", "]"}], "]"}], ",", "\n", 
        RowBox[{
         RowBox[{"locexp", "=", 
          RowBox[{"locexp", "//.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Chain", "[", 
                RowBox[{"$angle", ",", "x_", ",", 
                 RowBox[{"{", 
                  RowBox[{"y__", ",", "x_", ",", "z__"}], "}"}], ",", "k_", 
                 ",", "type2_"}], "]"}], "/;", 
               RowBox[{"OddQ", "[", 
                RowBox[{"Length", "[", 
                 RowBox[{"{", "y", "}"}], "]"}], "]"}]}], ":>", 
              RowBox[{
               RowBox[{"Chain", "[", 
                RowBox[{"$angle", ",", "x", ",", 
                 RowBox[{"{", "y", "}"}], ",", "x", ",", "$square"}], "]"}], 
               "*", 
               RowBox[{"Chain", "[", 
                RowBox[{"$angle", ",", "x", ",", 
                 RowBox[{"{", "z", "}"}], ",", "k", ",", "type2"}], "]"}]}]}],
              ",", "\n", 
             RowBox[{
              RowBox[{
               RowBox[{"Chain", "[", 
                RowBox[{"$square", ",", "x_", ",", 
                 RowBox[{"{", 
                  RowBox[{"y__", ",", "x_", ",", "z__"}], "}"}], ",", "k_", 
                 ",", "type2_"}], "]"}], "/;", 
               RowBox[{"OddQ", "[", 
                RowBox[{"Length", "[", 
                 RowBox[{"{", "y", "}"}], "]"}], "]"}]}], ":>", 
              RowBox[{
               RowBox[{"Chain", "[", 
                RowBox[{"$square", ",", "x", ",", 
                 RowBox[{"{", "y", "}"}], ",", "x", ",", "$angle"}], "]"}], 
               "*", 
               RowBox[{"Chain", "[", 
                RowBox[{"$square", ",", "x", ",", 
                 RowBox[{"{", "z", "}"}], ",", "k", ",", "type2"}], "]"}]}]}],
              ",", "\n", 
             RowBox[{
              RowBox[{
               RowBox[{"Chain", "[", 
                RowBox[{"type1_", ",", "k_", ",", 
                 RowBox[{"{", 
                  RowBox[{"y__", ",", "x_", ",", "z__"}], "}"}], ",", "x_", 
                 ",", "$angle"}], "]"}], "/;", 
               RowBox[{"OddQ", "[", 
                RowBox[{"Length", "[", 
                 RowBox[{"{", "z", "}"}], "]"}], "]"}]}], ":>", 
              RowBox[{
               RowBox[{"Chain", "[", 
                RowBox[{"type1", ",", "k", ",", 
                 RowBox[{"{", "y", "}"}], ",", "x", ",", "$angle"}], "]"}], 
               "*", 
               RowBox[{"Chain", "[", 
                RowBox[{"$square", ",", "x", ",", 
                 RowBox[{"{", "z", "}"}], ",", "x", ",", "$angle"}], 
                "]"}]}]}], ",", "\n", 
             RowBox[{
              RowBox[{
               RowBox[{"Chain", "[", 
                RowBox[{"type1_", ",", "k_", ",", 
                 RowBox[{"{", 
                  RowBox[{"y__", ",", "x_", ",", "z__"}], "}"}], ",", "x_", 
                 ",", "$square"}], "]"}], "/;", 
               RowBox[{"OddQ", "[", 
                RowBox[{"Length", "[", 
                 RowBox[{"{", "z", "}"}], "]"}], "]"}]}], ":>", 
              RowBox[{
               RowBox[{"Chain", "[", 
                RowBox[{"type1", ",", "k", ",", 
                 RowBox[{"{", "y", "}"}], ",", "x", ",", "$square"}], "]"}], 
               "*", 
               RowBox[{"Chain", "[", 
                RowBox[{"$angle", ",", "x", ",", 
                 RowBox[{"{", "z", "}"}], ",", "x", ",", "$square"}], 
                "]"}]}]}]}], "}"}]}]}], ";"}]}], "\n", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "locexp", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7942889877940516`*^9, 3.7942890104793563`*^9}, {
   3.794289077210966*^9, 3.7942891511322913`*^9}, {3.794289190075119*^9, 
   3.794289191410549*^9}, {3.794289304735552*^9, 3.794289388540432*^9}, {
   3.7942894418448906`*^9, 3.79428945625739*^9}, {3.7942895447188063`*^9, 
   3.794289706381525*^9}, {3.794290016241995*^9, 3.7942900569581194`*^9}, {
   3.794290113446088*^9, 3.794290133691903*^9}, {3.794290166986868*^9, 
   3.7942902226859655`*^9}, {3.7942902986627655`*^9, 3.794290376601362*^9}, {
   3.7942904192971926`*^9, 3.7942904203045006`*^9}, {3.794290484982549*^9, 
   3.79429053746422*^9}, {3.7942906346773205`*^9, 3.794290651132267*^9}, {
   3.7942908801947875`*^9, 3.7942909272918234`*^9}, {3.794290957770317*^9, 
   3.794291002318197*^9}, {3.794291045242425*^9, 3.794291137684281*^9}, {
   3.79429116807696*^9, 3.7942912154891834`*^9}, {3.7942915257438235`*^9, 
   3.794291587093777*^9}, {3.7942916992471037`*^9, 3.7942917133543267`*^9}, {
   3.7942918027233543`*^9, 3.7942919842738905`*^9}, {3.7942920307047358`*^9, 
   3.7942920627121477`*^9}, {3.794292095578283*^9, 3.794292148435954*^9}, 
   3.79429250833945*^9, {3.794292708211032*^9, 3.7942927688568583`*^9}, {
   3.794292939130905*^9, 3.7942929442063336`*^9}, {3.794293096661768*^9, 
   3.794293166908882*^9}, {3.7942932028009243`*^9, 3.7942934573415375`*^9}, {
   3.79429355576513*^9, 3.7942936221047716`*^9}, {3.7942940789152994`*^9, 
   3.794294131021022*^9}, {3.79429476346881*^9, 3.794294766148697*^9}, {
   3.7942948793110495`*^9, 3.794295138688436*^9}, {3.7942951693478513`*^9, 
   3.794295214759412*^9}, {3.794295245175089*^9, 3.7942952615772142`*^9}, {
   3.794295853238386*^9, 3.794295856477704*^9}, {3.794296371641247*^9, 
   3.7942963878095813`*^9}, {3.7942964591902647`*^9, 3.794296645548031*^9}, {
   3.794296687107892*^9, 3.7942967640093007`*^9}, {3.79429683536059*^9, 
   3.794296851743084*^9}, {3.7942975748169007`*^9, 3.7942975796379757`*^9}, 
   3.794297671977166*^9, {3.794297748015113*^9, 3.7942977614693527`*^9}, {
   3.7942980680066814`*^9, 3.7942980737956333`*^9}, {3.7942981141905994`*^9, 
   3.7942982039876585`*^9}, {3.7942984270191374`*^9, 3.7942984872017846`*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"f0af9fde-39b3-4049-bdd2-6f8674ebee2b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Testing the properties", "Subsection",
 CellChangeTimes->{{3.7942899626033897`*^9, 
  3.794289966855057*^9}},ExpressionUUID->"f4f8696d-a5f5-434a-9220-\
b33c7c7d6ac8"],

Cell[CellGroupData[{

Cell["SquareAngle to AngleSqaure", "Subsubsection",
 CellChangeTimes->{{3.7942899731422157`*^9, 
  3.794289979258853*^9}},ExpressionUUID->"e19d84d6-9209-457d-99a6-\
63a0cd204c8d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"1",RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "4"}], "}"}],"5"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.7942891537771807`*^9, 3.7942891720314226`*^9}, {
  3.794289204512566*^9, 3.7942892162321763`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"86a2acfa-b642-43c2-a1f2-c234e04b8db0"],

Cell[BoxData[
 TemplateBox[{"5",RowBox[{"{", 
     RowBox[{"4", ",", "3", ",", "2"}], "}"}],"1"},
  "AngleSquareChain",
  DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
     "]"}]& )]], "Output",
 CellChangeTimes->{{3.794289172699623*^9, 3.7942892165653195`*^9}, {
   3.7942893801977673`*^9, 3.794289391548382*^9}, 3.794289712505187*^9, {
   3.7942911497619696`*^9, 3.794291173724864*^9}, 3.7942912232843356`*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"28b31eea-9b7e-43be-8df4-4ee820287486"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"2", ",", "3", ",", "4"}], "}"}],"5"},
    "SquareAngleChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle",
        "]"}]& )], "^", "3"}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.794291741039296*^9, 3.7942917416486664`*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"391b32fe-e059-43cd-91c7-763c32f9a0bd"],

Cell[BoxData[
 SuperscriptBox[
  TemplateBox[{"5",RowBox[{"{", 
      RowBox[{"4", ",", "3", ",", "2"}], "}"}],"1"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "3"]], "Output",
 CellChangeTimes->{3.7942917420236635`*^9},
 CellLabel->"Out[61]=",ExpressionUUID->"aff234e4-4ea4-4591-bc12-53ad7d850223"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", 
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"2", ",", "3", ",", "4"}], "}"}],"5"},
    "SquareAngleChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle",
        "]"}]& )]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.7942917441759453`*^9, 3.7942917456490216`*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"89ae446d-79e3-43f9-9860-5f77fe64f3d5"],

Cell[BoxData[
 FractionBox["1", 
  TemplateBox[{"5",RowBox[{"{", 
      RowBox[{"4", ",", "3", ",", "2"}], "}"}],"1"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )]]], "Output",
 CellChangeTimes->{3.7942917473374968`*^9},
 CellLabel->"Out[62]=",ExpressionUUID->"14dce694-d00d-449c-b122-993413dd4b17"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Minus signs in the external brackets", "Subsubsection",
 CellChangeTimes->{{3.794289985656743*^9, 
  3.7942899924884806`*^9}},ExpressionUUID->"70c94ee5-2bd4-4159-a924-\
c0519710b2a7"],

Cell[CellGroupData[{

Cell[BoxData["MomList"], "Input",
 CellChangeTimes->{{3.794289763227517*^9, 3.7942897643794403`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"f50bb5b8-224a-4660-a3ee-d321011cfd73"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.7942897646667023`*^9, 3.794291235124715*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"9ff17f7c-d1c3-4bc9-90ae-5c456a0f6f6d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"DeclareMom", "[", 
  RowBox[{"p1", ",", "p3"}], "]"}]], "Input",
 CellChangeTimes->{{3.7942897445096207`*^9, 3.794289786012637*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"7e468a63-cb16-49b9-93d3-5d492a716c98"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{RowBox[{"-", "p1"}],RowBox[{"{", "p2", "}"}],"p3"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.7942897201786785`*^9, 3.7942897416462245`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"5aacaed9-a74b-4161-8c9a-123751345f66"],

Cell[BoxData[
 RowBox[{"\[ImaginaryI]", " ", 
  TemplateBox[{"p1",RowBox[{"{", "p2", "}"}],"p3"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{{3.794289730398334*^9, 3.794289742229663*^9}, 
   3.794289776759365*^9, 3.7942912378743553`*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"b148097e-4b5f-4e58-8983-d5109218ecd3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", "p2", "}"}],RowBox[{"-", "p3"}]},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.79428979426357*^9, 3.794289797427107*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"6d8192b1-b5ff-4790-b1e1-bd11bdcec5a7"],

Cell[BoxData[
 RowBox[{"\[ImaginaryI]", " ", 
  TemplateBox[{"p1",RowBox[{"{", "p2", "}"}],"p3"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{{3.7942897981282225`*^9, 3.7942898133225927`*^9}, 
   3.7942912397243767`*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"b1ee02e6-bf92-42d6-ad07-ca4ccdc85dc3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{
   RowBox[{"-", "p1"}],RowBox[{"{", "p2", "}"}],RowBox[{"-", "p3"}]},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{3.7942898182065535`*^9},
 CellLabel->"In[48]:=",ExpressionUUID->"7e36f814-ddae-42d0-b1d1-d34cb2913810"],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{"p1",RowBox[{"{", "p2", "}"}],"p3"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{3.794289819200879*^9, 3.7942912418257875`*^9},
 CellLabel->"Out[48]=",ExpressionUUID->"7b726d3c-6016-4709-9b0b-0710fae19b6e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", 
      RowBox[{"p2", ",", "p4"}], "}"}],RowBox[{"-", "p3"}]},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.794289826603078*^9, 3.794289838266867*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"be6af7ff-f673-4ae7-a9cf-02c3f753f2e9"],

Cell[BoxData[
 RowBox[{"\[ImaginaryI]", " ", 
  TemplateBox[{"p1",RowBox[{"{", 
      RowBox[{"p2", ",", "p4"}], "}"}],"p3"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{3.794289838626938*^9, 3.7942912431322956`*^9},
 CellLabel->"Out[49]=",ExpressionUUID->"4afbe546-ad92-4248-9346-efd8a7c65adf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{RowBox[{"-", "p1"}],RowBox[{"{", 
      RowBox[{"p2", ",", "p3"}], "}"}],"p4"},
   "SquareSquareChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square",
       "]"}]& )], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.794289844079319*^9, 3.7942898594891186`*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"e0a844c8-09dc-484a-bb3f-89522a974c72"],

Cell[BoxData[
 RowBox[{"\[ImaginaryI]", " ", 
  TemplateBox[{"p1",RowBox[{"{", 
      RowBox[{"p2", ",", "p3"}], "}"}],"p4"},
   "SquareSquareChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square",
       "]"}]& )]}]], "Output",
 CellChangeTimes->{3.7942898600306997`*^9, 3.794291244434779*^9},
 CellLabel->"Out[50]=",ExpressionUUID->"ab6d1147-a46c-4f7d-92f3-8829823fac80"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Now", " ", "raised", " ", "to", " ", "a", " ", "certain", " ", "power"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7942912499520273`*^9, 
  3.7942912578668613`*^9}},ExpressionUUID->"90aabd85-b938-4076-a10a-\
379b8b0a8834"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{
    RowBox[{"-", "p1"}],RowBox[{"{", "p2", "}"}],RowBox[{"-", "p3"}]},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )], "^", "2"}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{
  3.7942898182065535`*^9, {3.7942912786593084`*^9, 3.794291280715819*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"419d05e2-019a-4711-93ea-f311a05c5928"],

Cell[BoxData[
 SuperscriptBox[
  TemplateBox[{"p1",RowBox[{"{", "p2", "}"}],"p3"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "2"]], "Output",
 CellChangeTimes->{3.794289819200879*^9, 3.7942912418257875`*^9, 
  3.7942912822716455`*^9},
 CellLabel->"Out[51]=",ExpressionUUID->"38fec6e0-47bb-462a-961e-912687c42e64"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{
    RowBox[{"-", "p1"}],RowBox[{"{", "p2", "}"}],RowBox[{"-", "p3"}]},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )], "^", "3"}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.794291293444767*^9, 3.794291293892582*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"798c35a3-4f03-4271-a400-0d44005d8237"],

Cell[BoxData[
 RowBox[{"-", 
  SuperscriptBox[
   TemplateBox[{"p1",RowBox[{"{", "p2", "}"}],"p3"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )], "3"]}]], "Output",
 CellChangeTimes->{3.7942912943114414`*^9},
 CellLabel->"Out[52]=",ExpressionUUID->"85b4bba9-34dd-47bc-a646-d2ac4f93879a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{"p1",RowBox[{"{", 
       RowBox[{"p2", ",", "p4"}], "}"}],RowBox[{"-", "p3"}]},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )], "^", "5"}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.794289826603078*^9, 3.794289838266867*^9}, {
  3.7942913023629265`*^9, 3.7942913059123926`*^9}, {3.7942914973457613`*^9, 
  3.7942914977087407`*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"acc8cc89-4e47-47c7-99dc-7d1eb2fe7dab"],

Cell[BoxData[
 RowBox[{"\[ImaginaryI]", " ", 
  SuperscriptBox[
   TemplateBox[{"p1",RowBox[{"{", 
       RowBox[{"p2", ",", "p4"}], "}"}],"p3"},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )], "5"]}]], "Output",
 CellChangeTimes->{3.794289838626938*^9, 3.7942912431322956`*^9, 
  3.7942913072278805`*^9, 3.794291498192477*^9},
 CellLabel->"Out[56]=",ExpressionUUID->"ccd81b9d-c300-4f77-9107-1aecccf60bf7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{"p1",RowBox[{"{", 
       RowBox[{"p2", ",", "p4"}], "}"}],RowBox[{"-", "p3"}]},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )], "^", "3"}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.7942913218857217`*^9, 3.7942913234295864`*^9}, {
  3.794291486638395*^9, 3.7942914876336813`*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"082ab2ea-622b-4211-8e00-ba90d0050f4e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "\[ImaginaryI]"}], " ", 
  SuperscriptBox[
   TemplateBox[{"p1",RowBox[{"{", 
       RowBox[{"p2", ",", "p4"}], "}"}],"p3"},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )], "3"]}]], "Output",
 CellChangeTimes->{3.794291323900296*^9, 3.794291488363768*^9},
 CellLabel->"Out[55]=",ExpressionUUID->"ce5814bd-9aee-4d03-a501-4d11230b5288"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{RowBox[{"-", "p1"}],RowBox[{"{", 
       RowBox[{"p2", ",", "p3"}], "}"}],"p4"},
    "SquareSquareChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
       "$square", "]"}]& )], "^", "7"}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.794289844079319*^9, 3.7942898594891186`*^9}, {
  3.794291504584355*^9, 3.7942915058051434`*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"08964ff8-1290-4c37-a8c0-887f6fc6d035"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "\[ImaginaryI]"}], " ", 
  SuperscriptBox[
   TemplateBox[{"p1",RowBox[{"{", 
       RowBox[{"p2", ",", "p3"}], "}"}],"p4"},
    "SquareSquareChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
       "$square", "]"}]& )], "7"]}]], "Output",
 CellChangeTimes->{3.7942898600306997`*^9, 3.794291244434779*^9, 
  3.7942915063865647`*^9},
 CellLabel->"Out[57]=",ExpressionUUID->"d7ae3fcb-c7ec-4ccb-a4cd-75589f3af8be"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", 
   TemplateBox[{"p1",RowBox[{"{", 
       RowBox[{"p2", ",", "p4"}], "}"}],RowBox[{"-", "p3"}]},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.7942926193685884`*^9, 3.7942926248718805`*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"935391f2-4b0f-4196-9f60-8cc49740f4c5"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox["\[ImaginaryI]", 
   TemplateBox[{"p1",RowBox[{"{", 
       RowBox[{"p2", ",", "p4"}], "}"}],"p3"},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )]]}]], "Output",
 CellChangeTimes->{3.794292625446306*^9},
 CellLabel->"Out[78]=",ExpressionUUID->"91997955-b35d-466a-8a63-9323b5e545b2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", 
   RowBox[{
    TemplateBox[{"p1",RowBox[{"{", 
        RowBox[{"p2", ",", "p4"}], "}"}],RowBox[{"-", "p3"}]},
     "AngleAngleChain",
     DisplayFunction->(
      RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle",
         "]"}]& )], "^", "2"}]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.794292644787641*^9, 3.7942926453840456`*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"54b2ade6-6764-48ee-819c-0285fac7d5e4"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox["1", 
   SuperscriptBox[
    TemplateBox[{"p1",RowBox[{"{", 
        RowBox[{"p2", ",", "p4"}], "}"}],"p3"},
     "AngleAngleChain",
     DisplayFunction->(
      RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle",
         "]"}]& )], "2"]]}]], "Output",
 CellChangeTimes->{3.794292645811883*^9},
 CellLabel->"Out[79]=",ExpressionUUID->"98f1205e-4823-400c-a186-468d3f2a3378"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "If", " ", "the", " ", "label", " ", "is", " ", "not", " ", "declared", " ",
    "to", " ", "be", " ", "a", " ", "momentum", " ", "it", " ", "does", " ", 
   "not", " ", "work"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7942899273845606`*^9, 
  3.7942899454822044`*^9}},ExpressionUUID->"a1f121d4-2505-475d-8645-\
5ec8564a5f11"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{RowBox[{"-", "p5"}],RowBox[{"{", 
      RowBox[{"p2", ",", "p3"}], "}"}],"p4"},
   "SquareSquareChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square",
       "]"}]& )], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.7942898962937512`*^9, 3.794289910324233*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"1deea0e3-df67-4c14-8826-ce0b03be4beb"],

Cell[BoxData[
 TemplateBox[{RowBox[{"-", "p5"}],RowBox[{"{", 
     RowBox[{"p2", ",", "p3"}], "}"}],"p4"},
  "SquareSquareChain",
  DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.7942899109674587`*^9, 3.794291512456303*^9},
 CellLabel->"Out[58]=",ExpressionUUID->"6b1c7ee6-3c09-448f-8340-72f615374aec"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"UndeclareMom", "[", 
  RowBox[{"p1", ",", "p3"}], "]"}]], "Input",
 CellChangeTimes->{{3.7942897551361527`*^9, 3.794289761556017*^9}, {
  3.7942898886461487`*^9, 3.794289889121909*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"0d29bfc1-0fad-4586-84cb-8274255ad692"],

Cell[CellGroupData[{

Cell[BoxData["MomList"], "Input",
 CellChangeTimes->{{3.7942900039468718`*^9, 3.794290005099757*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"47506779-a6aa-420a-a1dd-c99be69f8108"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.794290005369031*^9, 3.7942915144410334`*^9},
 CellLabel->"Out[60]=",ExpressionUUID->"a3d992b5-3c9b-4475-b67f-3aa3902f4b1d"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Contractions (x...y\[RightAngleBracket][y...z)", "Subsubsection",
 CellChangeTimes->{{3.7942905445642815`*^9, 3.794290546506089*^9}, {
  3.7942929290269585`*^9, 
  3.794292929386957*^9}},ExpressionUUID->"8b4e739c-e0db-46ea-babc-\
a8e854e4ff2f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}],"4"},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )], 
   TemplateBox[{"4",RowBox[{"{", 
       RowBox[{"5", ",", "6"}], "}"}],"7"},
    "SquareSquareChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
       "$square", "]"}]& )]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.794290598938884*^9, 3.794290616699339*^9}, {
  3.7942906924727216`*^9, 3.7942907108147182`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"fc657306-4616-4251-9d2d-6530ea718369"],

Cell[BoxData[
 TemplateBox[{"1",RowBox[{"{", 
     RowBox[{"2", ",", "3", ",", "4", ",", "5", ",", "6"}], "}"}],"7"},
  "AngleSquareChain",
  DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.794290617240926*^9, 3.7942906797587175`*^9, 
  3.794290712086276*^9, 3.7942920162963033`*^9},
 CellLabel->"Out[64]=",ExpressionUUID->"b5ffa629-4db8-4f0d-bbe1-1f69327d8091"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    TemplateBox[{"1",RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}],"4"},
     "AngleAngleChain",
     DisplayFunction->(
      RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle",
         "]"}]& )], "^", "2"}], 
   TemplateBox[{"4",RowBox[{"{", 
       RowBox[{"5", ",", "6"}], "}"}],"7"},
    "SquareSquareChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
       "$square", "]"}]& )]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.794292212063836*^9, 3.7942922128237886`*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"e2e6831f-97d7-48e0-abcb-cc3a2e39f213"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"1",RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}],"4"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], " ", 
  TemplateBox[{"1",RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "4", ",", "5", ",", "6"}], "}"}],"7"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{3.794292213246663*^9},
 CellLabel->"Out[67]=",ExpressionUUID->"892fd117-4140-4e95-b666-7ae72ed22787"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}],"4"},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )], 
   RowBox[{
    TemplateBox[{"4",RowBox[{"{", 
        RowBox[{"5", ",", "6"}], "}"}],"7"},
     "SquareSquareChain",
     DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "^", "3"}]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.7942922233785305`*^9, 3.7942922238702097`*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"15be0dfd-ba82-49de-8516-152b1fc34479"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"1",RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "4", ",", "5", ",", "6"}], "}"}],"7"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], " ", 
  SuperscriptBox[
   TemplateBox[{"4",RowBox[{"{", 
       RowBox[{"5", ",", "6"}], "}"}],"7"},
    "SquareSquareChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
       "$square", "]"}]& )], "2"]}]], "Output",
 CellChangeTimes->{3.7942922242582054`*^9},
 CellLabel->"Out[68]=",ExpressionUUID->"874cbccf-90f7-429c-ba69-adb9177e14ab"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    TemplateBox[{"1",RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}],"4"},
     "AngleAngleChain",
     DisplayFunction->(
      RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle",
         "]"}]& )], "^", "4"}], 
   RowBox[{
    TemplateBox[{"4",RowBox[{"{", 
        RowBox[{"5", ",", "6"}], "}"}],"7"},
     "SquareSquareChain",
     DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "^", "7"}]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.79429222999887*^9, 3.794292233964219*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"cf280c98-9060-4259-aac9-934aab9ddb70"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"2", ",", "3", ",", "4", ",", "5", ",", "6"}], "}"}],"7"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )], "4"], " ", 
  SuperscriptBox[
   TemplateBox[{"4",RowBox[{"{", 
       RowBox[{"5", ",", "6"}], "}"}],"7"},
    "SquareSquareChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
       "$square", "]"}]& )], "3"]}]], "Output",
 CellChangeTimes->{3.7942922343392153`*^9},
 CellLabel->"Out[69]=",ExpressionUUID->"1dad52b3-9e70-4a9f-b65e-7e3ed0cecd52"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      TemplateBox[{"1",RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}],"4"},
       "AngleAngleChain",
       DisplayFunction->(
        RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
          "$angle", "]"}]& )], "^", "4"}], 
     RowBox[{
      TemplateBox[{"4",RowBox[{"{", 
          RowBox[{"5", ",", "6"}], "}"}],"7"},
       "SquareSquareChain",
       DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
          "$square", "]"}]& )], "^", "7"}]}], ")"}]}], "//", 
  "ToChain2"}]], "Input",
 CellChangeTimes->{{3.7942922862743425`*^9, 3.7942923194187565`*^9}, {
  3.7942927572030263`*^9, 3.794292759731228*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"4c7d9406-8a18-4d38-abca-cf730534c185"],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{
   SuperscriptBox[
    TemplateBox[{"1",RowBox[{"{", 
        RowBox[{"2", ",", "3", ",", "4", ",", "5", ",", "6"}], "}"}],"7"},
     "AngleSquareChain",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "4"], " ", 
   SuperscriptBox[
    TemplateBox[{"4",RowBox[{"{", 
        RowBox[{"5", ",", "6"}], "}"}],"7"},
     "SquareSquareChain",
     DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "3"]}]]], "Output",
 CellChangeTimes->{{3.794292296359409*^9, 3.79429232057263*^9}, {
  3.7942927549689674`*^9, 3.7942927600324554`*^9}},
 CellLabel->"Out[82]=",ExpressionUUID->"53748432-fbe5-4fd9-abd9-98f6f871d107"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      TemplateBox[{"1",RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}],"4"},
       "AngleAngleChain",
       DisplayFunction->(
        RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
          "$angle", "]"}]& )], "^", "4"}], 
     RowBox[{
      TemplateBox[{"4",RowBox[{"{", 
          RowBox[{"5", ",", "6"}], "}"}],"7"},
       "SquareSquareChain",
       DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
          "$square", "]"}]& )], "^", "2"}]}], ")"}]}], "//", 
  "ToChain2"}]], "Input",
 CellChangeTimes->{{3.794292905402132*^9, 3.7942929102571497`*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"9ab445a9-7f26-4efd-a803-81d74507e13d"],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{
   SuperscriptBox[
    TemplateBox[{"1",RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}],"4"},
     "AngleAngleChain",
     DisplayFunction->(
      RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle",
         "]"}]& )], "2"], " ", 
   SuperscriptBox[
    TemplateBox[{"1",RowBox[{"{", 
        RowBox[{"2", ",", "3", ",", "4", ",", "5", ",", "6"}], "}"}],"7"},
     "AngleSquareChain",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "2"]}]]], "Output",
 CellChangeTimes->{3.7942929107557774`*^9},
 CellLabel->"Out[83]=",ExpressionUUID->"b8c0c774-30c3-4107-8ff7-e64b28451f8c"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Contractions \[LeftAngleBracket]y...x)[y...z)", "Subsubsection",
 CellChangeTimes->{{3.7942936339430904`*^9, 
  3.7942936541989202`*^9}},ExpressionUUID->"1fb2fa9a-91c3-4480-bcf1-\
aa838e924d33"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{"1",RowBox[{"{", "2", "}"}],"3"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )], 
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"4", ",", "5"}], "}"}],"6"},
    "SquareSquareChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
       "$square", "]"}]& )]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.794293992770707*^9, 3.7942940513989162`*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"63545004-0178-4072-864c-c88114177472"],

Cell[BoxData[
 TemplateBox[{"3",RowBox[{"{", 
     RowBox[{"2", ",", "1", ",", "4", ",", "5"}], "}"}],"6"},
  "SquareSquareChain",
  DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square", 
     "]"}]& )]], "Output",
 CellChangeTimes->{{3.794294005673194*^9, 3.794294052503957*^9}, 
   3.794294136016651*^9},
 CellLabel->"Out[90]=",ExpressionUUID->"ead51282-81f5-4b71-9efb-196b34699408"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}],"4"},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )], 
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"5", ",", "6"}], "}"}],"7"},
    "SquareSquareChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
       "$square", "]"}]& )]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.794294149831725*^9, 3.7942941869943485`*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"3bcc8834-f10d-4d18-b398-8ba8f9b77944"],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{"4",RowBox[{"{", 
      RowBox[{"3", ",", "2", ",", "1", ",", "5", ",", "6"}], "}"}],"7"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{{3.7942941702341127`*^9, 3.794294187595688*^9}},
 CellLabel->"Out[93]=",ExpressionUUID->"a8518a92-3ee7-4311-89a0-2b932fc744cd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    TemplateBox[{"1",RowBox[{"{", "2", "}"}],"3"},
     "AngleSquareChain",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "^", "2"}], 
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"4", ",", "5"}], "}"}],"6"},
    "SquareSquareChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
       "$square", "]"}]& )]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.794293992770707*^9, 3.7942940513989162`*^9}, {
  3.7942942400653887`*^9, 3.7942942419493484`*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"86755b41-7bba-405d-92c9-f8f6cdb71038"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"1",RowBox[{"{", "2", "}"}],"3"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], " ", 
  TemplateBox[{"3",RowBox[{"{", 
      RowBox[{"2", ",", "1", ",", "4", ",", "5"}], "}"}],"6"},
   "SquareSquareChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square",
       "]"}]& )]}]], "Output",
 CellChangeTimes->{{3.794294005673194*^9, 3.794294052503957*^9}, 
   3.794294136016651*^9, 3.79429424293674*^9},
 CellLabel->"Out[94]=",ExpressionUUID->"60349e65-c1a2-42b0-856d-48365864fe32"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{"1",RowBox[{"{", "2", "}"}],"3"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )], 
   RowBox[{
    TemplateBox[{"1",RowBox[{"{", 
        RowBox[{"4", ",", "5"}], "}"}],"6"},
     "SquareSquareChain",
     DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "^", "3"}]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.794294258927954*^9, 3.794294262448533*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"407a4fbd-1e0b-4926-a659-6aebc10cf042"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"4", ",", "5"}], "}"}],"6"},
    "SquareSquareChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
       "$square", "]"}]& )], "2"], " ", 
  TemplateBox[{"3",RowBox[{"{", 
      RowBox[{"2", ",", "1", ",", "4", ",", "5"}], "}"}],"6"},
   "SquareSquareChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square",
       "]"}]& )]}]], "Output",
 CellChangeTimes->{3.794294262859434*^9},
 CellLabel->"Out[95]=",ExpressionUUID->"726de70c-58df-4aca-8abb-aa10e15c7265"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    TemplateBox[{"1",RowBox[{"{", "2", "}"}],"3"},
     "AngleSquareChain",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "^", "2"}], 
   RowBox[{
    TemplateBox[{"1",RowBox[{"{", 
        RowBox[{"4", ",", "5"}], "}"}],"6"},
     "SquareSquareChain",
     DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "^", "5"}]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.7942942757280245`*^9, 3.7942942768131294`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"1a2e8c65-6c70-4cda-b23b-ac751e09b37d"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"4", ",", "5"}], "}"}],"6"},
    "SquareSquareChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
       "$square", "]"}]& )], "3"], " ", 
  SuperscriptBox[
   TemplateBox[{"3",RowBox[{"{", 
       RowBox[{"2", ",", "1", ",", "4", ",", "5"}], "}"}],"6"},
    "SquareSquareChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
       "$square", "]"}]& )], "2"]}]], "Output",
 CellChangeTimes->{3.794294277230007*^9},
 CellLabel->"Out[96]=",ExpressionUUID->"6765fe40-fd53-4e17-8813-668daa028952"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    TemplateBox[{"1",RowBox[{"{", "2", "}"}],"3"},
     "AngleSquareChain",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "^", "7"}], 
   RowBox[{
    TemplateBox[{"1",RowBox[{"{", 
        RowBox[{"4", ",", "5"}], "}"}],"6"},
     "SquareSquareChain",
     DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "^", "5"}]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.794294676091463*^9, 3.7942946767297487`*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"21c58784-623f-4770-8a70-de7d286bd48f"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   TemplateBox[{"1",RowBox[{"{", "2", "}"}],"3"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )], "2"], " ", 
  SuperscriptBox[
   TemplateBox[{"3",RowBox[{"{", 
       RowBox[{"2", ",", "1", ",", "4", ",", "5"}], "}"}],"6"},
    "SquareSquareChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
       "$square", "]"}]& )], "5"]}]], "Output",
 CellChangeTimes->{3.794294677171567*^9},
 CellLabel->
  "Out[102]=",ExpressionUUID->"52575563-8703-4eef-b217-4093bf4d2bcf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    TemplateBox[{"1",RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}],"4"},
     "AngleAngleChain",
     DisplayFunction->(
      RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle",
         "]"}]& )], "^", "2"}], 
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"5", ",", "6"}], "}"}],"7"},
    "SquareSquareChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
       "$square", "]"}]& )]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.794294149831725*^9, 3.7942941869943485`*^9}, {
  3.7942942912944007`*^9, 3.7942942920294633`*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"fb624269-8337-4bae-8718-6bf123a723c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}],"4"},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )]}], " ", 
  TemplateBox[{"4",RowBox[{"{", 
      RowBox[{"3", ",", "2", ",", "1", ",", "5", ",", "6"}], "}"}],"7"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{{3.7942941702341127`*^9, 3.794294187595688*^9}, 
   3.7942942927575216`*^9},
 CellLabel->"Out[97]=",ExpressionUUID->"5c566f28-56db-4ea9-ba14-4086ceca8bf7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}],"4"},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )], 
   RowBox[{
    TemplateBox[{"1",RowBox[{"{", 
        RowBox[{"5", ",", "6"}], "}"}],"7"},
     "SquareSquareChain",
     DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "^", "2"}]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.7942943558498163`*^9, 3.794294358505677*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"5dc22128-e0cc-4121-95a8-5ba48ee4d88a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   TemplateBox[{"4",RowBox[{"{", 
       RowBox[{"3", ",", "2", ",", "1", ",", "5", ",", "6"}], "}"}],"7"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], " ", 
  TemplateBox[{"1",RowBox[{"{", 
      RowBox[{"5", ",", "6"}], "}"}],"7"},
   "SquareSquareChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square",
       "]"}]& )]}]], "Output",
 CellChangeTimes->{3.7942943589644976`*^9},
 CellLabel->"Out[98]=",ExpressionUUID->"9e129458-bb75-46f0-871c-6ce9b61d3487"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    TemplateBox[{"1",RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}],"4"},
     "AngleAngleChain",
     DisplayFunction->(
      RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle",
         "]"}]& )], "^", "2"}], 
   RowBox[{
    TemplateBox[{"1",RowBox[{"{", 
        RowBox[{"5", ",", "6"}], "}"}],"7"},
     "SquareSquareChain",
     DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "^", "3"}]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.79429437860194*^9, 3.794294384303693*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"97fbb3a4-3429-46a9-9087-a06c7aedac2a"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   TemplateBox[{"4",RowBox[{"{", 
       RowBox[{"3", ",", "2", ",", "1", ",", "5", ",", "6"}], "}"}],"7"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )], "2"], " ", 
  TemplateBox[{"1",RowBox[{"{", 
      RowBox[{"5", ",", "6"}], "}"}],"7"},
   "SquareSquareChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square",
       "]"}]& )]}]], "Output",
 CellChangeTimes->{3.7942943849819145`*^9},
 CellLabel->"Out[99]=",ExpressionUUID->"cef10cfd-7138-4e32-90a3-310aaa46a6f8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    TemplateBox[{"1",RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}],"4"},
     "AngleAngleChain",
     DisplayFunction->(
      RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle",
         "]"}]& )], "^", "7"}], 
   RowBox[{
    TemplateBox[{"1",RowBox[{"{", 
        RowBox[{"5", ",", "6"}], "}"}],"7"},
     "SquareSquareChain",
     DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "^", "3"}]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.7942944821032333`*^9, 3.794294483057658*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"5b013877-9176-45ae-b629-7b1b8409b1ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SuperscriptBox[
    TemplateBox[{"1",RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}],"4"},
     "AngleAngleChain",
     DisplayFunction->(
      RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle",
         "]"}]& )], "4"]}], " ", 
  SuperscriptBox[
   TemplateBox[{"4",RowBox[{"{", 
       RowBox[{"3", ",", "2", ",", "1", ",", "5", ",", "6"}], "}"}],"7"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )], "3"]}]], "Output",
 CellChangeTimes->{3.794294483511446*^9},
 CellLabel->
  "Out[100]=",ExpressionUUID->"3b00e255-98fe-49fc-996c-f0e472a8b9f2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      TemplateBox[{"1",RowBox[{"{", "2", "}"}],"3"},
       "AngleSquareChain",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
          "$square", "]"}]& )], "^", "2"}], 
     TemplateBox[{"1",RowBox[{"{", 
         RowBox[{"4", ",", "5"}], "}"}],"6"},
      "SquareSquareChain",
      DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
         "$square", "]"}]& )]}], ")"}]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.794294620747445*^9, 3.7942946363567605`*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"8ecff072-25f8-4071-9d6f-2d235ac1118a"],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{
   TemplateBox[{"1",RowBox[{"{", "2", "}"}],"3"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )], " ", 
   TemplateBox[{"3",RowBox[{"{", 
       RowBox[{"2", ",", "1", ",", "4", ",", "5"}], "}"}],"6"},
    "SquareSquareChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
       "$square", "]"}]& )]}]]], "Output",
 CellChangeTimes->{3.79429463674866*^9},
 CellLabel->
  "Out[101]=",ExpressionUUID->"4fb043e2-3816-43d2-8186-9589574a32c6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      TemplateBox[{"1",RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}],"4"},
       "AngleAngleChain",
       DisplayFunction->(
        RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
          "$angle", "]"}]& )], "^", "2"}], 
     RowBox[{
      TemplateBox[{"1",RowBox[{"{", 
          RowBox[{"5", ",", "6"}], "}"}],"7"},
       "SquareSquareChain",
       DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
          "$square", "]"}]& )], "^", "3"}]}], ")"}]}], "//", 
  "ToChain2"}]], "Input",
 CellChangeTimes->{{3.7942946927489705`*^9, 3.794294695897542*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"2fb3ae87-93e1-40cb-a28c-2fcf56862455"],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{
   SuperscriptBox[
    TemplateBox[{"4",RowBox[{"{", 
        RowBox[{"3", ",", "2", ",", "1", ",", "5", ",", "6"}], "}"}],"7"},
     "AngleSquareChain",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "2"], " ", 
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"5", ",", "6"}], "}"}],"7"},
    "SquareSquareChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
       "$square", "]"}]& )]}]]], "Output",
 CellChangeTimes->{3.7942946965118895`*^9},
 CellLabel->
  "Out[103]=",ExpressionUUID->"b9df0a3f-a7ea-4dab-91fa-93231e5fb665"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", 
   RowBox[{"(", 
    RowBox[{
     TemplateBox[{"1",RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}],"4"},
      "AngleAngleChain",
      DisplayFunction->(
       RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(
       RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
         "$angle", "]"}]& )], 
     RowBox[{
      TemplateBox[{"1",RowBox[{"{", 
          RowBox[{"5", ",", "6"}], "}"}],"7"},
       "SquareSquareChain",
       DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
          "$square", "]"}]& )], "^", "2"}]}], ")"}]}], "//", 
  "ToChain2"}]], "Input",
 CellChangeTimes->{{3.7942947313437185`*^9, 3.794294737856349*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"6f89aecc-0f6f-4baf-9fb3-e57c3ca5097c"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox["1", 
   RowBox[{
    TemplateBox[{"4",RowBox[{"{", 
        RowBox[{"3", ",", "2", ",", "1", ",", "5", ",", "6"}], "}"}],"7"},
     "AngleSquareChain",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], " ", 
    TemplateBox[{"1",RowBox[{"{", 
        RowBox[{"5", ",", "6"}], "}"}],"7"},
     "SquareSquareChain",
     DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )]}]]}]], "Output",
 CellChangeTimes->{3.794294738851674*^9},
 CellLabel->
  "Out[104]=",ExpressionUUID->"3a91ad24-ded2-46ce-b620-b7e62c92803b"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Contractions (x...y\[RightAngleBracket](z...y]", "Subsubsection",
 CellChangeTimes->{{3.794295382417925*^9, 
  3.794295406278121*^9}},ExpressionUUID->"cc39d347-b9bd-41ea-bcac-\
6a4a8277356a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}],"4"},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )], 
   TemplateBox[{"5",RowBox[{"{", "6", "}"}],"4"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.794295416670332*^9, 3.7942954333147707`*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"aeab8aff-a718-47f2-905f-62fb43cd9125"],

Cell[BoxData[
 TemplateBox[{"1",RowBox[{"{", 
     RowBox[{"2", ",", "3", ",", "4", ",", "6"}], "}"}],"5"},
  "AngleAngleChain",
  DisplayFunction->(
   RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
     "]"}]& )]], "Output",
 CellChangeTimes->{{3.7942954282742476`*^9, 3.7942954337745657`*^9}},
 CellLabel->
  "Out[107]=",ExpressionUUID->"2634c6fd-592c-4c3b-8034-3e024b404de5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    TemplateBox[{"1",RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}],"4"},
     "AngleAngleChain",
     DisplayFunction->(
      RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle",
         "]"}]& )], "^", "3"}], 
   TemplateBox[{"5",RowBox[{"{", "6", "}"}],"4"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.794295452756782*^9, 3.794295453838947*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"ab6a3649-0dc0-4fae-95fb-f6d4bcebfa8d"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}],"4"},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )], "2"], " ", 
  TemplateBox[{"1",RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "4", ",", "6"}], "}"}],"5"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{3.794295454230875*^9},
 CellLabel->
  "Out[108]=",ExpressionUUID->"4af8c7af-d204-4631-bc24-bb5acf1a6a93"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}],"4"},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )], 
   RowBox[{
    TemplateBox[{"5",RowBox[{"{", "6", "}"}],"4"},
     "AngleSquareChain",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "^", "2"}]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.794295472796198*^9, 3.794295473343789*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"10b8f353-5135-4d0a-a0c7-a938c5175ede"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"1",RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "4", ",", "6"}], "}"}],"5"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], " ", 
  TemplateBox[{"5",RowBox[{"{", "6", "}"}],"4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{3.7942954737326946`*^9},
 CellLabel->
  "Out[109]=",ExpressionUUID->"8ee27ee0-5017-4dfb-850b-ad405966729f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    TemplateBox[{"1",RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}],"4"},
     "AngleAngleChain",
     DisplayFunction->(
      RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle",
         "]"}]& )], "^", "7"}], 
   RowBox[{
    TemplateBox[{"5",RowBox[{"{", "6", "}"}],"4"},
     "AngleSquareChain",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "^", "5"}]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.794295481724329*^9, 3.794295485879221*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"5141c366-4eef-4829-a9d0-c6d590fbd36d"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}],"4"},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )], "2"], " ", 
  SuperscriptBox[
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"2", ",", "3", ",", "4", ",", "6"}], "}"}],"5"},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )], "5"]}]], "Output",
 CellChangeTimes->{3.7942954864008746`*^9},
 CellLabel->
  "Out[110]=",ExpressionUUID->"4a6269cb-a493-4917-be48-f2edfd03fecb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    TemplateBox[{"1",RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}],"4"},
     "AngleAngleChain",
     DisplayFunction->(
      RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle",
         "]"}]& )], "^", "5"}], 
   RowBox[{
    TemplateBox[{"5",RowBox[{"{", "6", "}"}],"4"},
     "AngleSquareChain",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "^", "5"}]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.794295495860531*^9, 3.794295496230589*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"6958e5bf-669f-462a-b867-9d555bc58a86"],

Cell[BoxData[
 SuperscriptBox[
  TemplateBox[{"1",RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "4", ",", "6"}], "}"}],"5"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "5"]], "Output",
 CellChangeTimes->{3.7942954966534357`*^9},
 CellLabel->
  "Out[111]=",ExpressionUUID->"9cec157d-0733-42b4-90d0-e0c9686c5fce"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}],"4"},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )], 
   TemplateBox[{"5",RowBox[{"{", 
       RowBox[{"6", ",", "7"}], "}"}],"4"},
    "SquareSquareChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
       "$square", "]"}]& )]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.794295511756022*^9, 3.7942955199800854`*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"cc91fb79-89f8-43be-b660-c76895ccf0eb"],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{"1",RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "4", ",", "7", ",", "6"}], "}"}],"5"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{3.7942955207420235`*^9},
 CellLabel->
  "Out[112]=",ExpressionUUID->"500b834b-d4e9-4d0c-955b-bec5b845ea4e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    TemplateBox[{"1",RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}],"4"},
     "AngleAngleChain",
     DisplayFunction->(
      RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle",
         "]"}]& )], "^", "2"}], 
   TemplateBox[{"5",RowBox[{"{", 
       RowBox[{"6", ",", "7"}], "}"}],"4"},
    "SquareSquareChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
       "$square", "]"}]& )]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.7942955469937925`*^9, 3.7942955479213696`*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"d75a6061-58ad-4426-b9e8-8d4b91b81cbd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}],"4"},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )]}], " ", 
  TemplateBox[{"1",RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "4", ",", "7", ",", "6"}], "}"}],"5"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{3.794295548390092*^9},
 CellLabel->
  "Out[113]=",ExpressionUUID->"bdc93006-23dc-4500-8275-03ac38e8fca5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}],"4"},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )], 
   RowBox[{
    TemplateBox[{"5",RowBox[{"{", 
        RowBox[{"6", ",", "7"}], "}"}],"4"},
     "SquareSquareChain",
     DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "^", "2"}]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.794295556365735*^9, 3.794295556874428*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"983703ef-c7d8-4463-9566-a1c25743c98d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"2", ",", "3", ",", "4", ",", "7", ",", "6"}], "}"}],"5"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], " ", 
  TemplateBox[{"5",RowBox[{"{", 
      RowBox[{"6", ",", "7"}], "}"}],"4"},
   "SquareSquareChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square",
       "]"}]& )]}]], "Output",
 CellChangeTimes->{3.7942955571965103`*^9},
 CellLabel->
  "Out[114]=",ExpressionUUID->"40d9bd1b-af5c-4766-81af-d46a3dc1eb47"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    TemplateBox[{"1",RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}],"4"},
     "AngleAngleChain",
     DisplayFunction->(
      RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle",
         "]"}]& )], "^", "5"}], 
   RowBox[{
    TemplateBox[{"5",RowBox[{"{", 
        RowBox[{"6", ",", "7"}], "}"}],"4"},
     "SquareSquareChain",
     DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "^", "4"}]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.7942955618959465`*^9, 3.7942955769776707`*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"2969a896-bb6d-4e61-811e-79399e970e51"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"1",RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}],"4"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], " ", 
  SuperscriptBox[
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"2", ",", "3", ",", "4", ",", "7", ",", "6"}], "}"}],"5"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )], "4"]}]], "Output",
 CellChangeTimes->{{3.7942955688463593`*^9, 3.794295577539116*^9}},
 CellLabel->
  "Out[116]=",ExpressionUUID->"698c067c-2cd3-4ccb-a121-01b22760f99c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    TemplateBox[{"1",RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}],"4"},
     "AngleAngleChain",
     DisplayFunction->(
      RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle",
         "]"}]& )], "^", "3"}], 
   RowBox[{
    TemplateBox[{"5",RowBox[{"{", 
        RowBox[{"6", ",", "7"}], "}"}],"4"},
     "SquareSquareChain",
     DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "^", "3"}]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.794295595869157*^9, 3.794295600899706*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"49201f92-28b4-413d-889b-969c32a1764f"],

Cell[BoxData[
 RowBox[{"-", 
  SuperscriptBox[
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"2", ",", "3", ",", "4", ",", "7", ",", "6"}], "}"}],"5"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )], "3"]}]], "Output",
 CellChangeTimes->{3.7942956012686634`*^9},
 CellLabel->
  "Out[117]=",ExpressionUUID->"ad463aaa-533d-479b-b037-e649dc8a4dc8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      TemplateBox[{"1",RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}],"4"},
       "AngleAngleChain",
       DisplayFunction->(
        RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
          "$angle", "]"}]& )], "^", "5"}], 
     RowBox[{
      TemplateBox[{"5",RowBox[{"{", 
          RowBox[{"6", ",", "7"}], "}"}],"4"},
       "SquareSquareChain",
       DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
          "$square", "]"}]& )], "^", "3"}]}], ")"}]}], "//", 
  "ToChain2"}]], "Input",
 CellChangeTimes->{{3.7942956066901703`*^9, 3.794295624808906*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"9aff3c3c-823a-434b-b655-ae908882ea0a"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox["1", 
   RowBox[{
    SuperscriptBox[
     TemplateBox[{"1",RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}],"4"},
      "AngleAngleChain",
      DisplayFunction->(
       RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(
       RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
         "$angle", "]"}]& )], "2"], " ", 
    SuperscriptBox[
     TemplateBox[{"1",RowBox[{"{", 
         RowBox[{"2", ",", "3", ",", "4", ",", "7", ",", "6"}], "}"}],"5"},
      "AngleSquareChain",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
         "$square", "]"}]& )], "3"]}]]}]], "Output",
 CellChangeTimes->{{3.7942956171342707`*^9, 3.7942956252307224`*^9}},
 CellLabel->
  "Out[119]=",ExpressionUUID->"c6d2ac7c-bcb5-4677-8a69-7a2f7d77b034"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      TemplateBox[{"1",RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}],"4"},
       "AngleAngleChain",
       DisplayFunction->(
        RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
          "$angle", "]"}]& )], "^", "3"}], 
     TemplateBox[{"5",RowBox[{"{", "6", "}"}],"4"},
      "AngleSquareChain",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
         "$square", "]"}]& )]}], ")"}]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.7942956538672047`*^9, 3.7942956574515643`*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"0501102c-65c6-483f-a4a8-bfb161ff8a48"],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{
   SuperscriptBox[
    TemplateBox[{"1",RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}],"4"},
     "AngleAngleChain",
     DisplayFunction->(
      RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle",
         "]"}]& )], "2"], " ", 
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"2", ",", "3", ",", "4", ",", "6"}], "}"}],"5"},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )]}]]], "Output",
 CellChangeTimes->{3.794295657952227*^9},
 CellLabel->
  "Out[120]=",ExpressionUUID->"5c979d84-5c81-469d-b64c-28276e38ebaa"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Contractions \[LeftAngleBracket]y...x)(z...y]", "Subsubsection",
 CellChangeTimes->{{3.794296866408894*^9, 3.7942968767194605`*^9}, {
  3.7942969072782593`*^9, 
  3.7942969140715656`*^9}},ExpressionUUID->"31dc7035-d0f0-40a0-883b-\
7758651069bb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{"1",RowBox[{"{", "2", "}"}],"3"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )], 
   TemplateBox[{"4",RowBox[{"{", "5", "}"}],"1"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.794296984825267*^9, 3.7942969976197276`*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"becd0f27-bf81-46c8-a5a7-953a1a311f44"],

Cell[BoxData[
 TemplateBox[{"4",RowBox[{"{", 
     RowBox[{"5", ",", "1", ",", "2"}], "}"}],"3"},
  "AngleSquareChain",
  DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.7942969980894914`*^9},
 CellLabel->
  "Out[122]=",ExpressionUUID->"1919ebe3-f8ca-4bf8-8bfe-397552c89ebf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    TemplateBox[{"1",RowBox[{"{", "2", "}"}],"3"},
     "AngleSquareChain",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "^", "5"}], 
   RowBox[{
    TemplateBox[{"4",RowBox[{"{", "5", "}"}],"1"},
     "AngleSquareChain",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "^", "2"}]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.7942970143853045`*^9, 3.7942970241384115`*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"0a454b66-a7e9-410f-a083-01f677fb4545"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   TemplateBox[{"1",RowBox[{"{", "2", "}"}],"3"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )], "3"], " ", 
  SuperscriptBox[
   TemplateBox[{"4",RowBox[{"{", 
       RowBox[{"5", ",", "1", ",", "2"}], "}"}],"3"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )], "2"]}]], "Output",
 CellChangeTimes->{{3.794297015483551*^9, 3.7942970246327353`*^9}},
 CellLabel->
  "Out[124]=",ExpressionUUID->"65c11cf0-f5ec-4f43-a873-b420a9b2e4e5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}],"4"},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )], 
   TemplateBox[{"5",RowBox[{"{", "6", "}"}],"1"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.7942970392615347`*^9, 3.794297052993235*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"a9c71d11-1cf9-40a2-bfbf-0f0344ed7781"],

Cell[BoxData[
 TemplateBox[{"5",RowBox[{"{", 
     RowBox[{"6", ",", "1", ",", "2", ",", "3"}], "}"}],"4"},
  "AngleAngleChain",
  DisplayFunction->(
   RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.7942970533268538`*^9},
 CellLabel->
  "Out[125]=",ExpressionUUID->"7ea4efa7-4116-40df-9b27-aafd0190ba81"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    TemplateBox[{"1",RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}],"4"},
     "AngleAngleChain",
     DisplayFunction->(
      RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle",
         "]"}]& )], "^", "2"}], 
   TemplateBox[{"5",RowBox[{"{", "6", "}"}],"1"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.7942971289361553`*^9, 3.7942971294503355`*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"0ccbb21f-963e-413c-9dc6-c73eb545fbcb"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"1",RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}],"4"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], " ", 
  TemplateBox[{"5",RowBox[{"{", 
      RowBox[{"6", ",", "1", ",", "2", ",", "3"}], "}"}],"4"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{3.7942971298382916`*^9},
 CellLabel->
  "Out[126]=",ExpressionUUID->"b7850468-6557-4183-822f-b2f3f41649e6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}],"4"},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )], 
   RowBox[{
    TemplateBox[{"5",RowBox[{"{", "6", "}"}],"1"},
     "AngleSquareChain",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "^", "3"}]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.79429714069031*^9, 3.7942971413521657`*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"5703b06c-d8ef-49e6-aff0-f529c864253a"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   TemplateBox[{"5",RowBox[{"{", "6", "}"}],"1"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )], "2"], " ", 
  TemplateBox[{"5",RowBox[{"{", 
      RowBox[{"6", ",", "1", ",", "2", ",", "3"}], "}"}],"4"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{3.794297141963422*^9},
 CellLabel->
  "Out[127]=",ExpressionUUID->"ab9cbebf-90cb-4a0f-921b-c522509185cf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    TemplateBox[{"1",RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}],"4"},
     "AngleAngleChain",
     DisplayFunction->(
      RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle",
         "]"}]& )], "^", "3"}], 
   RowBox[{
    TemplateBox[{"5",RowBox[{"{", "6", "}"}],"1"},
     "AngleSquareChain",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "^", "3"}]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.7942971474423375`*^9, 3.7942971547428975`*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"f6adc185-6ba9-4151-93b7-a00063b66668"],

Cell[BoxData[
 SuperscriptBox[
  TemplateBox[{"5",RowBox[{"{", 
      RowBox[{"6", ",", "1", ",", "2", ",", "3"}], "}"}],"4"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "3"]], "Output",
 CellChangeTimes->{3.7942971553173585`*^9},
 CellLabel->
  "Out[128]=",ExpressionUUID->"3a018c93-d119-4ca4-bf06-f81764d5e553"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      TemplateBox[{"1",RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}],"4"},
       "AngleAngleChain",
       DisplayFunction->(
        RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
          "$angle", "]"}]& )], "^", "3"}], 
     RowBox[{
      TemplateBox[{"5",RowBox[{"{", "6", "}"}],"1"},
       "AngleSquareChain",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
          "$square", "]"}]& )], "^", "3"}]}], ")"}]}], "//", 
  "ToChain2"}]], "Input",
 CellChangeTimes->{{3.7942973196852927`*^9, 3.794297323701351*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"505739cd-3d20-4609-b271-3ac1df059145"],

Cell[BoxData[
 FractionBox["1", 
  SuperscriptBox[
   TemplateBox[{"5",RowBox[{"{", 
       RowBox[{"6", ",", "1", ",", "2", ",", "3"}], "}"}],"4"},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )], "3"]]], "Output",
 CellChangeTimes->{3.7942973243635597`*^9},
 CellLabel->
  "Out[129]=",ExpressionUUID->"5834ef63-4653-4455-9c59-1452c3d50d7b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      TemplateBox[{"1",RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}],"4"},
       "AngleAngleChain",
       DisplayFunction->(
        RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
          "$angle", "]"}]& )], "^", "2"}], 
     TemplateBox[{"5",RowBox[{"{", "6", "}"}],"1"},
      "AngleSquareChain",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
         "$square", "]"}]& )]}], ")"}]}], "//", "ToChain2"}]], "Input",
 CellChangeTimes->{{3.794297338637596*^9, 3.7942973426910915`*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"f5fec690-390e-493e-9f0b-f7bdf2fcbb74"],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{
   TemplateBox[{"1",RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}],"4"},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )], " ", 
   TemplateBox[{"5",RowBox[{"{", 
       RowBox[{"6", ",", "1", ",", "2", ",", "3"}], "}"}],"4"},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )]}]]], "Output",
 CellChangeTimes->{3.7942973434450235`*^9},
 CellLabel->
  "Out[130]=",ExpressionUUID->"b910f245-86f4-412e-9682-0b0bf8a9313d"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compare to ToChain", "Subsection",
 CellChangeTimes->{{3.794297627775709*^9, 
  3.794297636708769*^9}},ExpressionUUID->"d6c62d28-cf1a-4896-8193-\
8fb33c76bee0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test", "=", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[Kappa]", "4"], " ", 
      SuperscriptBox[
       TemplateBox[{"l1",RowBox[{"{", "p1", "}"}],"l2"},
        "AngleSquareChain",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
           "$square", "]"}]& )], "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"p3",RowBox[{"{", 
           RowBox[{"-", "l2"}], "}"}],"p4"},
        "AngleSquareChain",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
           "$square", "]"}]& )], "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"l2","p3"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"l1","p4"},
        "SpinorSquareBracket",
        DisplayFunction->(RowBox[{"[", 
           RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
        InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
      SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
     RowBox[{"128", " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", 
        RowBox[{"-", "l2"}]}], "]"}], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["m", "2"], " ", 
         SuperscriptBox["\[Kappa]", "2"], " ", 
         SuperscriptBox[
          TemplateBox[{"p3",RowBox[{"{", 
              RowBox[{"-", "l1"}], "}"}],"p4"},
           "AngleSquareChain",
           
           DisplayFunction->(
            RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
              "$square", "]"}]& )], "4"], " ", 
         SuperscriptBox[
          TemplateBox[{"l1","l2"},
           "SpinorAngleBracket",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
           InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
         SuperscriptBox[
          TemplateBox[{"l1","l2"},
           "SpinorSquareBracket",
           DisplayFunction->(RowBox[{"[", 
              RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
           InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
         SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
        RowBox[{"64", " ", "s", " ", 
         TemplateBox[{
          TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
           TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
          "ScalarProduct",
          DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
          InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
         " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l1"}], ",", 
           RowBox[{"-", "l2"}]}], "]"}], " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["m", "2"], " ", 
        SuperscriptBox["\[Kappa]", "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"p3",RowBox[{"{", 
             RowBox[{"-", "l2"}], "}"}],"p4"},
          "AngleSquareChain",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
          
          InterpretationFunction->(
           RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
             "$square", "]"}]& )], "4"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1","l2"},
          "SpinorAngleBracket",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
             RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
          InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1","l2"},
          "SpinorSquareBracket",
          DisplayFunction->(RowBox[{"[", 
             RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
          InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
       RowBox[{"64", " ", "s", " ", 
        TemplateBox[{
         TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
          TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
         "ScalarProduct",
         DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
         InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
        " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", 
          RowBox[{"-", "l2"}]}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l2"}], ",", "p3"}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l2"}], ",", "p4"}], "]"}]}]]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7942976402275047`*^9, 3.7942976416804485`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"d8285a74-f0e4-44b4-af96-42fd765087b3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[Kappa]", "4"], " ", 
     SuperscriptBox[
      TemplateBox[{"l1",RowBox[{"{", "p1", "}"}],"l2"},
       "AngleSquareChain",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
          "$square", "]"}]& )], "2"], " ", 
     SuperscriptBox[
      TemplateBox[{"p3",RowBox[{"{", 
          RowBox[{"-", "l2"}], "}"}],"p4"},
       "AngleSquareChain",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
          "$square", "]"}]& )], "2"], " ", 
     SuperscriptBox[
      TemplateBox[{"l2","p3"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
     SuperscriptBox[
      TemplateBox[{"l1","p4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
     SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
    RowBox[{"128", " ", 
     RowBox[{"S4", "[", 
      RowBox[{
       RowBox[{"-", "l1"}], ",", 
       RowBox[{"-", "l2"}]}], "]"}], " ", 
     RowBox[{"S4", "[", 
      RowBox[{
       RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
     RowBox[{"S4", "[", 
      RowBox[{
       RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["m", "2"], " ", 
        SuperscriptBox["\[Kappa]", "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"p3",RowBox[{"{", 
             RowBox[{"-", "l1"}], "}"}],"p4"},
          "AngleSquareChain",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
          
          InterpretationFunction->(
           RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
             "$square", "]"}]& )], "4"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1","l2"},
          "SpinorAngleBracket",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
             RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
          InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1","l2"},
          "SpinorSquareBracket",
          DisplayFunction->(RowBox[{"[", 
             RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
          InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
       RowBox[{"64", " ", "s", " ", 
        TemplateBox[{
         TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
          TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
         "ScalarProduct",
         DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
         InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
        " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", 
          RowBox[{"-", "l2"}]}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["m", "2"], " ", 
       SuperscriptBox["\[Kappa]", "2"], " ", 
       SuperscriptBox[
        TemplateBox[{"p3",RowBox[{"{", 
            RowBox[{"-", "l2"}], "}"}],"p4"},
         "AngleSquareChain",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
            "$square", "]"}]& )], "4"], " ", 
       SuperscriptBox[
        TemplateBox[{"l1","l2"},
         "SpinorAngleBracket",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
            RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
         InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
            RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
       SuperscriptBox[
        TemplateBox[{"l1","l2"},
         "SpinorSquareBracket",
         DisplayFunction->(RowBox[{"[", 
            RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
         InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
            RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
       SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
      RowBox[{"64", " ", "s", " ", 
       TemplateBox[{
        TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
          InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
         TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
          InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
        "ScalarProduct",
        DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
        InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
       " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l1"}], ",", 
         RowBox[{"-", "l2"}]}], "]"}], " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l2"}], ",", "p3"}], "]"}], " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l2"}], ",", "p4"}], "]"}]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.7942976426822753`*^9, 3.79429956670376*^9, 
  3.7943001752871175`*^9, 3.794300926378499*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"23104de6-f07e-4122-9164-75cb262262f1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pref", "=", 
  FractionBox["1", 
   SuperscriptBox[
    TemplateBox[{"p4",RowBox[{"{", "p2", "}"}],"p3"},
     "AngleSquareChain",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "4"]]}]], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"b1c720f2-65e4-4952-a75b-2b04ca2bef6c"],

Cell[BoxData[
 FractionBox["1", 
  SuperscriptBox[
   TemplateBox[{"p4",RowBox[{"{", "p2", "}"}],"p3"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )], "4"]]], "Output",
 CellChangeTimes->{3.7942983832626247`*^9, 3.7942995692759514`*^9, 
  3.794300177963728*^9, 3.7943009292745295`*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"605435a5-f74b-4139-adf6-845223fee4a2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"test", "/", "pref"}], "//", "Expand"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{"%", "//", "ToChain2"}], "]"}]}], "Input",
 CellChangeTimes->{{3.794297646860522*^9, 3.794297652109349*^9}, {
  3.7942977842487392`*^9, 3.7942977866351957`*^9}, {3.794298386669778*^9, 
  3.7942983880766144`*^9}, {3.7942990233537416`*^9, 3.794299039657137*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"46cbd292-df0b-43a4-9124-40d4ed49eb01"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0092093`", ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Kappa]", "4"], " ", 
       SuperscriptBox[
        TemplateBox[{"p4",RowBox[{"{", 
            RowBox[{"p2", ",", "p3", ",", 
              RowBox[{"-", "l2"}]}], "}"}],"p4"},
         "AngleSquareChain",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
            "$square", "]"}]& )], "2"], " ", 
       SuperscriptBox[
        TemplateBox[{"p4",RowBox[{"{", 
            RowBox[{"p2", ",", "p3", ",", "l2", ",", "p1", ",", "l1"}], "}"}],
          "p4"},
         "AngleSquareChain",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
            "$square", "]"}]& )], "2"], " ", 
       SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
      RowBox[{"128", " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l1"}], ",", 
         RowBox[{"-", "l2"}]}], "]"}], " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["m", "2"], " ", 
      SuperscriptBox["\[Kappa]", "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"l2",RowBox[{"{", "l1", "}"}],"l2"},
        "AngleSquareChain",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
           "$square", "]"}]& )], "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"p4",RowBox[{"{", 
           RowBox[{"p2", ",", "p3", ",", 
             RowBox[{"-", "l1"}]}], "}"}],"p4"},
        "AngleSquareChain",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
           "$square", "]"}]& )], "4"], " ", 
      SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
     RowBox[{"128", " ", "s", " ", 
      TemplateBox[{
       TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
         InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
        TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
         InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
       "ScalarProduct",
       DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
       InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", 
        RowBox[{"-", "l2"}]}], "]"}], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["m", "2"], " ", 
      SuperscriptBox["\[Kappa]", "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"l2",RowBox[{"{", "l1", "}"}],"l2"},
        "AngleSquareChain",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
           "$square", "]"}]& )], "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"p4",RowBox[{"{", 
           RowBox[{"p2", ",", "p3", ",", 
             RowBox[{"-", "l2"}]}], "}"}],"p4"},
        "AngleSquareChain",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
           "$square", "]"}]& )], "4"], " ", 
      SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
     RowBox[{"128", " ", "s", " ", 
      TemplateBox[{
       TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
         InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
        TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
         InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
       "ScalarProduct",
       DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
       InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", 
        RowBox[{"-", "l2"}]}], "]"}], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l2"}], ",", "p3"}], "]"}], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l2"}], ",", "p4"}], "]"}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7942976526479816`*^9, 3.7942976798772635`*^9}, {
   3.7942977760891933`*^9, 3.794297787300902*^9}, 3.7942982187720366`*^9, 
   3.7942983891515026`*^9, 3.79429852051083*^9, 3.7942985579154778`*^9, 
   3.7942990441253014`*^9},
 CellLabel->
  "Out[159]=",ExpressionUUID->"3037aece-f460-4dfe-bf41-9febcc44b8a6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"test", "/", "pref"}], "//", "Expand"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{"%", "//", "ToChain"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7942986140907817`*^9, 3.794298616801076*^9}, {
  3.794299054828745*^9, 3.7942990565718904`*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"3d3a715f-dbd8-4771-ac5e-2fbe9482441b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.7057985`", ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Kappa]", "4"], " ", 
       SuperscriptBox[
        TemplateBox[{"p3",RowBox[{"{", 
            RowBox[{
              RowBox[{"-", "l2"}], ",", "p4", ",", "p2"}], "}"}],"p3"},
         "AngleSquareChain",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
            "$square", "]"}]& )], "2"], " ", 
       SuperscriptBox[
        TemplateBox[{"p3",RowBox[{"{", 
            RowBox[{"l2", ",", "p1", ",", "l1", ",", "p4", ",", "p2"}], "}"}],
          "p3"},
         "AngleSquareChain",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
            "$square", "]"}]& )], "2"], " ", 
       SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
      RowBox[{"128", " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l1"}], ",", 
         RowBox[{"-", "l2"}]}], "]"}], " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["m", "2"], " ", 
      SuperscriptBox["\[Kappa]", "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"l1",RowBox[{"{", "l2", "}"}],"l1"},
        "AngleSquareChain",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
           "$square", "]"}]& )], "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"p3",RowBox[{"{", 
           RowBox[{
             RowBox[{"-", "l1"}], ",", "p4", ",", "p2"}], "}"}],"p3"},
        "AngleSquareChain",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
           "$square", "]"}]& )], "4"], " ", 
      SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
     RowBox[{"128", " ", "s", " ", 
      TemplateBox[{
       TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
         InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
        TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
         InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
       "ScalarProduct",
       DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
       InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", 
        RowBox[{"-", "l2"}]}], "]"}], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["m", "2"], " ", 
      SuperscriptBox["\[Kappa]", "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"l1",RowBox[{"{", "l2", "}"}],"l1"},
        "AngleSquareChain",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
           "$square", "]"}]& )], "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"p3",RowBox[{"{", 
           RowBox[{
             RowBox[{"-", "l2"}], ",", "p4", ",", "p2"}], "}"}],"p3"},
        "AngleSquareChain",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
           "$square", "]"}]& )], "4"], " ", 
      SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
     RowBox[{"128", " ", "s", " ", 
      TemplateBox[{
       TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
         InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
        TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
         InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
       "ScalarProduct",
       DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
       InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", 
        RowBox[{"-", "l2"}]}], "]"}], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l2"}], ",", "p3"}], "]"}], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l2"}], ",", "p4"}], "]"}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.794298618571209*^9, 3.7942990647559605`*^9},
 CellLabel->
  "Out[161]=",ExpressionUUID->"8261b972-4dc4-432b-8522-f0738aa59fd2"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"The", " ", "expressions", " ", "are", " ", "the", " ", "same"}], 
   ",", " ", 
   RowBox[{
   "just", " ", "the", " ", "splitting", " ", "of", " ", "the", " ", "chains",
     " ", "has", " ", "been", " ", "performed", " ", "differently"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7942992719671574`*^9, 
  3.79429929659976*^9}},ExpressionUUID->"c5549010-a089-4c9b-8cbc-\
6443501adf13"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Speed", " ", 
   RowBox[{"increment", ":"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.794299185856963*^9, 
  3.794299193025834*^9}},ExpressionUUID->"b1df7b0c-c500-4f52-abd6-\
8be749847a27"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"1.7", "/", "0.009"}]], "Input",
 CellChangeTimes->{{3.794299084282771*^9, 3.794299089867094*^9}},
 CellLabel->
  "In[162]:=",ExpressionUUID->"78686b88-e927-41c7-aeae-e42c56ea23ec"],

Cell[BoxData["188.88888888888889`"], "Output",
 CellChangeTimes->{3.794299090574211*^9},
 CellLabel->
  "Out[162]=",ExpressionUUID->"1f62773f-6a68-42ef-b6b0-3169842de621"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Awesome", "!"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7942991982669153`*^9, 
  3.7942992056145754`*^9}},ExpressionUUID->"97a37157-4206-4817-a0d9-\
cab9d2441572"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "After", " ", "implementing", " ", "it", " ", "in", " ", "the", " ", 
   "package"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7942995834861193`*^9, 
  3.794299592751099*^9}},ExpressionUUID->"32c78d3c-6348-4044-8ddc-\
18c8bde02096"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"test", "/", "pref"}], "//", "Expand"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{"%", "//", "ToChain"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7942986140907817`*^9, 3.794298616801076*^9}, {
  3.794299054828745*^9, 3.7942990565718904`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"d67d5191-d4d7-4310-be17-4aedea9074e8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0096611`", ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Kappa]", "4"], " ", 
       SuperscriptBox[
        TemplateBox[{"p4",RowBox[{"{", 
            RowBox[{"p2", ",", "p3", ",", 
              RowBox[{"-", "l2"}]}], "}"}],"p4"},
         "AngleSquareChain",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
            "$square", "]"}]& )], "2"], " ", 
       SuperscriptBox[
        TemplateBox[{"p4",RowBox[{"{", 
            RowBox[{"p2", ",", "p3", ",", "l2", ",", "p1", ",", "l1"}], "}"}],
          "p4"},
         "AngleSquareChain",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
            "$square", "]"}]& )], "2"], " ", 
       SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
      RowBox[{"128", " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l1"}], ",", 
         RowBox[{"-", "l2"}]}], "]"}], " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["m", "2"], " ", 
      SuperscriptBox["\[Kappa]", "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"l2",RowBox[{"{", "l1", "}"}],"l2"},
        "AngleSquareChain",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
           "$square", "]"}]& )], "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"p4",RowBox[{"{", 
           RowBox[{"p2", ",", "p3", ",", 
             RowBox[{"-", "l1"}]}], "}"}],"p4"},
        "AngleSquareChain",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
           "$square", "]"}]& )], "4"], " ", 
      SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
     RowBox[{"128", " ", "s", " ", 
      TemplateBox[{
       TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
         InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
        TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
         InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
       "ScalarProduct",
       DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
       InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", 
        RowBox[{"-", "l2"}]}], "]"}], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["m", "2"], " ", 
      SuperscriptBox["\[Kappa]", "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"l2",RowBox[{"{", "l1", "}"}],"l2"},
        "AngleSquareChain",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
           "$square", "]"}]& )], "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"p4",RowBox[{"{", 
           RowBox[{"p2", ",", "p3", ",", 
             RowBox[{"-", "l2"}]}], "}"}],"p4"},
        "AngleSquareChain",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
           "$square", "]"}]& )], "4"], " ", 
      SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
     RowBox[{"128", " ", "s", " ", 
      TemplateBox[{
       TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
         InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
        TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
         InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
       "ScalarProduct",
       DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
       InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", 
        RowBox[{"-", "l2"}]}], "]"}], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l2"}], ",", "p3"}], "]"}], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l2"}], ",", "p4"}], "]"}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.794298618571209*^9, 3.7942990647559605`*^9, 
  3.794299594781951*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"8030db71-1cbc-4e9c-84f4-f292982e651f"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{759, 697},
WindowMargins->{{Automatic, 380}, {24, Automatic}},
InputAliases->{"intt" -> RowBox[{"\[Integral]", 
     RowBox[{"\[SelectionPlaceholder]", 
       RowBox[{"\[DifferentialD]", "\[Placeholder]"}]}]}], "dintt" -> RowBox[{
     SubsuperscriptBox[
     "\[Integral]", "\[SelectionPlaceholder]", "\[Placeholder]"], 
     RowBox[{"\[Placeholder]", 
       RowBox[{"\[DifferentialD]", "\[Placeholder]"}]}]}], "rintt" -> RowBox[{
     UnderscriptBox["\[Integral]", 
      RowBox[{"\[SelectionPlaceholder]", "\[Element]", "\[Placeholder]"}]], 
     "\[Placeholder]"}], "sumt" -> RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"\[SelectionPlaceholder]", "=", "\[Placeholder]"}], 
      "\[Placeholder]"], "\[Placeholder]"}], "prodt" -> RowBox[{
     UnderoverscriptBox["\[Product]", 
      RowBox[{"\[SelectionPlaceholder]", "=", "\[Placeholder]"}], 
      "\[Placeholder]"], "\[Placeholder]"}], "dt" -> RowBox[{
     SubscriptBox["\[PartialD]", "\[Placeholder]"], " ", 
     "\[SelectionPlaceholder]"}], "cbrt" -> 
  RadicalBox[
   "\[SelectionPlaceholder]", "3", SurdForm -> True, MultilineFunction -> 
    None], "surd" -> 
  RadicalBox[
   "\[SelectionPlaceholder]", "\[Placeholder]", SurdForm -> True, 
    MultilineFunction -> None], "ket" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "Ket"], "bra" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "Bra"], "braket" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[Placeholder]"}, "BraKet"], 
  "delay" -> TemplateBox[{"\[SelectionPlaceholder]"}, "SystemsModelDelay"], 
  "grad" -> RowBox[{
     SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], "\[Placeholder]"}], 
  "del." -> RowBox[{
     SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], ".", 
     "\[Placeholder]"}], "delx" -> RowBox[{
     SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], "\[Cross]", 
     "\[Placeholder]"}], "del2" -> RowBox[{
     SubsuperscriptBox["\[Del]", "\[SelectionPlaceholder]", 2], 
     "\[Placeholder]"}], "kd" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "KroneckerDeltaSeq"], "algs" -> 
  TemplateBox[{}, "Algebraics"], "bools" -> TemplateBox[{}, "Booleans"], 
  "comps" -> TemplateBox[{}, "Complexes"], "ints" -> 
  TemplateBox[{}, "Integers"], "pris" -> TemplateBox[{}, "Primes"], "rats" -> 
  TemplateBox[{}, "Rationals"], "reals" -> TemplateBox[{}, "Reals"], "dlim" -> 
  RowBox[{
     UnderscriptBox["\[Limit]", 
      RowBox[{"\[SelectionPlaceholder]", 
        UnderscriptBox["\[Rule]", 
         TemplateBox[{}, "Integers"]], "\[Infinity]"}]], "\[Placeholder]"}], 
  "dMlim" -> RowBox[{
     UnderscriptBox["\[MaxLimit]", 
      RowBox[{"\[SelectionPlaceholder]", 
        UnderscriptBox["\[Rule]", 
         TemplateBox[{}, "Integers"]], "\[Infinity]"}]], "\[Placeholder]"}], 
  "dmlim" -> RowBox[{
     UnderscriptBox["\[MinLimit]", 
      RowBox[{"\[SelectionPlaceholder]", 
        UnderscriptBox["\[Rule]", 
         TemplateBox[{}, "Integers"]], "\[Infinity]"}]], "\[Placeholder]"}], 
  "notation" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongLeftRightArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "notation>" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongRightArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "notation<" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongLeftArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "symb" -> RowBox[{"Symbolize", "[", 
     TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], "]"}], 
  "infixnotation" -> RowBox[{"InfixNotation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], ",", 
       "\[Placeholder]"}], "]"}], "addia" -> RowBox[{"AddInputAlias", "[", 
     RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "pattwraper" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "NotationPatternTag"], 
  "madeboxeswraper" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "NotationMadeBoxesTag"], "lu" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorLaUp", DisplayFunction -> (RowBox[{
       SuperscriptBox["\[Lambda]", #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinorundot", "[", #, "]", "[", "$lam", "]", "[", #2, "]", "[", 
       "Null", "]"}]& )], "ld" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorLaDown", DisplayFunction -> (RowBox[{
       SubscriptBox["\[Lambda]", #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinorundot", "[", #, "]", "[", "$lam", "]", "[", "Null", "]", 
       "[", #2, "]"}]& )], "muu" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorMuUp", DisplayFunction -> (RowBox[{
       SuperscriptBox["\[Mu]", #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinorundot", "[", #, "]", "[", "$mu", "]", "[", #2, "]", "[", 
       "Null", "]"}]& )], "mud" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorMuDown", DisplayFunction -> (RowBox[{
       SubscriptBox["\[Mu]", #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinorundot", "[", #, "]", "[", "$mu", "]", "[", "Null", "]", 
       "[", #2, "]"}]& )], "lp" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "SpinorUndotPureL", 
    DisplayFunction -> (RowBox[{"\[Lambda]", "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "mp" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "SpinorUndotPureM", 
    DisplayFunction -> (RowBox[{"\[Mu]", "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "Ld" -> 
  TemplateBox[{
    "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]"}, "SpinorUndot6D", DisplayFunction -> (RowBox[{
       SubscriptBox[
        SuperscriptBox["\[CapitalLambda]", #2], #3], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"SpinorUndot6D", "[", #, "]", "[", #2, "]", "[", "Null", "]", 
       "[", #3, "]"}]& )], "ltu" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorLatUp", DisplayFunction -> (RowBox[{
       SuperscriptBox[
        OverscriptBox["\[Lambda]", "~"], #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinordot", "[", #, "]", "[", "$lam", "]", "[", #2, "]", "[", 
       "Null", "]"}]& )], "ltd" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorLatDown", DisplayFunction -> (RowBox[{
       SubscriptBox[
        OverscriptBox["\[Lambda]", "~"], #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinordot", "[", #, "]", "[", "$lam", "]", "[", "Null", "]", 
       "[", #2, "]"}]& )], "mtu" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorMutUp", DisplayFunction -> (RowBox[{
       SuperscriptBox[
        OverscriptBox["\[Mu]", "~"], #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinordot", "[", #, "]", "[", "$mu", "]", "[", #2, "]", "[", 
       "Null", "]"}]& )], "mtd" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorMutDown", DisplayFunction -> (RowBox[{
       SubscriptBox[
        OverscriptBox["\[Mu]", "~"], #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinordot", "[", #, "]", "[", "$mu", "]", "[", "Null", "]", 
       "[", #2, "]"}]& )], "ltp" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "SpinorDotPureL", 
    DisplayFunction -> (RowBox[{
       OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "mtp" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "SpinorDotPureM", 
    DisplayFunction -> (RowBox[{
       OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "Ltd" -> 
  TemplateBox[{
    "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]"}, "SpinorDot6D", DisplayFunction -> (RowBox[{
       SubscriptBox[
        SubscriptBox[
         OverscriptBox["\[CapitalLambda]", "~"], #2], #3], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"SpinorDot6D", "[", #, "]", "[", #2, "]", "[", "Null", "]", 
       "[", #3, "]"}]& )], "lcup" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "levicivita2up", DisplayFunction -> (SuperscriptBox["\[Epsilon]", 
      RowBox[{#, #2}]]& ), 
    InterpretationFunction -> (
     RowBox[{"levicivita2up", "[", #, ",", #2, "]"}]& )], "lcd" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "levicivita2down", DisplayFunction -> (SubscriptBox["\[Epsilon]", 
      RowBox[{#, #2}]]& ), 
    InterpretationFunction -> (
     RowBox[{"levicivita2down", "[", #, ",", #2, "]"}]& )], "ab" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[Placeholder]"}, 
    "SpinorAngleBracket", DisplayFunction -> (RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ), 
    InterpretationFunction -> (RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], "sb" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[Placeholder]"}, 
    "SpinorSquareBracket", DisplayFunction -> (RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ), 
    InterpretationFunction -> (RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], "sai" -> 
  TemplateBox[{
    "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, "SquAngInvariant",
     DisplayFunction -> (RowBox[{"[", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "\[RightAngleBracket]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Squanginvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], "asi" -> 
  TemplateBox[{
    "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, "AngSquInvariant",
     DisplayFunction -> (RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], "aa" -> 
  TemplateBox[{
    "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, "AngAngInvariant",
     DisplayFunction -> (RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #5], ",", 
       SubscriptBox[#2, #6], ",", 
       SubscriptBox[#3, #7], ",", 
       SubscriptBox[#4, #8], "\[RightAngleBracket]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Anganginvariant", "[", #, ",", #2, ",", #3, ",", #4, "]", 
       "[", #5, ",", #6, ",", #7, ",", #8, "]"}]& )], "bb" -> 
  TemplateBox[{
    "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, "SquSquInvariant",
     DisplayFunction -> (RowBox[{"[", 
       SubscriptBox[#, #5], ",", 
       SubscriptBox[#2, #6], ",", 
       SubscriptBox[#3, #7], ",", 
       SubscriptBox[#4, #8], "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Squsquinvariant", "[", #, ",", #2, ",", #3, ",", #4, "]", 
       "[", #5, ",", #6, ",", #7, ",", #8, "]"}]& )], "fst" -> 
  TemplateBox[{
    "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]"}, "Fstrength", DisplayFunction -> (RowBox[{
       SubscriptBox[
        SuperscriptBox["F", 
         RowBox[{#2, #3}]], 
        RowBox[{#4, #5}]], "[", 
       SubscriptBox[#, 
        RowBox[{#6, #7}]], "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Fstrength[", #, "][", #2, ",", #3, "][", #4, ",", #5, "][", #6, 
       ",", #7, "]"}]& )], "md" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 4}, 
    "MDelta", DisplayFunction -> (RowBox[{
       SubscriptBox[
        SuperscriptBox["\[Delta]", #], #2]}]& ), 
    InterpretationFunction -> (
     RowBox[{"MDelta", "[", #3, "][", #, "][", #2, "]"}]& )]},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 207, 3, 28, "Input",ExpressionUUID->"f246f599-fc6c-40e9-bb9b-a12032dd9867"],
Cell[CellGroupData[{
Cell[812, 29, 306, 6, 22, "Print",ExpressionUUID->"42ceeaa7-48dd-4273-a76e-7a1baba0f798"],
Cell[1121, 37, 294, 5, 22, "Print",ExpressionUUID->"67726dd3-9284-4f01-a103-4958618fba5d"],
Cell[1418, 44, 291, 5, 22, "Print",ExpressionUUID->"2fb3f083-ce95-45e6-bb70-1d9288d271fc"],
Cell[1712, 51, 280, 5, 22, "Print",ExpressionUUID->"9d53b8d9-1802-41e0-968c-4b1938900fec"],
Cell[1995, 58, 283, 5, 22, "Print",ExpressionUUID->"70e84b0f-0b5d-4a75-a904-acccd299f41b"],
Cell[2281, 65, 277, 5, 22, "Print",ExpressionUUID->"917dbcca-2375-4dc1-a1bd-e7234bfb6dad"],
Cell[2561, 72, 293, 5, 22, "Print",ExpressionUUID->"ad04a71e-cb20-4bc8-80b0-cb29ebde2261"],
Cell[2857, 79, 306, 6, 22, "Print",ExpressionUUID->"a3b93483-c0b9-419b-b534-d243bd4cf648"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[3212, 91, 82, 0, 53, "Subsection",ExpressionUUID->"2394c209-a7e3-4e05-ab8d-f2f666d49dbe"],
Cell[3297, 93, 19199, 532, 865, "Code",ExpressionUUID->"b932be13-5343-4259-98b4-257eac7760fc"]
}, Closed]],
Cell[CellGroupData[{
Cell[22533, 630, 84, 0, 37, "Subsection",ExpressionUUID->"a8fccf7f-8353-4c77-9aef-01b61f69dd50"],
Cell[22620, 632, 7613, 185, 483, "Code",ExpressionUUID->"bc8ab63b-8c1a-4f5f-a75a-52b53ec3de0d"],
Cell[30236, 819, 11797, 282, 663, "Code",ExpressionUUID->"510188ac-3c89-49c8-b9dc-36c51d787d03"],
Cell[42036, 1103, 13091, 316, 951, "Code",ExpressionUUID->"098a9f6c-301a-4740-b82c-5a3232973423"]
}, Closed]],
Cell[CellGroupData[{
Cell[55164, 1424, 229, 4, 37, "Subsection",ExpressionUUID->"7f918acc-4052-4e4d-a7de-58edd83f8637"],
Cell[55396, 1430, 221, 4, 28, "Input",ExpressionUUID->"60577263-044c-49e4-b6d1-b2367705267c"],
Cell[55620, 1436, 32376, 779, 2271, "Input",ExpressionUUID->"f0af9fde-39b3-4049-bdd2-6f8674ebee2b"]
}, Closed]],
Cell[CellGroupData[{
Cell[88033, 2220, 172, 3, 37, "Subsection",ExpressionUUID->"f4f8696d-a5f5-434a-9220-b33c7c7d6ac8"],
Cell[CellGroupData[{
Cell[88230, 2227, 179, 3, 44, "Subsubsection",ExpressionUUID->"e19d84d6-9209-457d-99a6-63a0cd204c8d"],
Cell[CellGroupData[{
Cell[88434, 2234, 561, 11, 28, "Input",ExpressionUUID->"86a2acfa-b642-43c2-a1f2-c234e04b8db0"],
Cell[88998, 2247, 621, 11, 32, "Output",ExpressionUUID->"28b31eea-9b7e-43be-8df4-4ee820287486"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89656, 2263, 538, 11, 28, "Input",ExpressionUUID->"391b32fe-e059-43cd-91c7-763c32f9a0bd"],
Cell[90197, 2276, 477, 10, 32, "Output",ExpressionUUID->"aff234e4-4ea4-4591-bc12-53ad7d850223"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90711, 2291, 540, 11, 28, "Input",ExpressionUUID->"89ae446d-79e3-43f9-9860-5f77fe64f3d5"],
Cell[91254, 2304, 474, 10, 85, "Output",ExpressionUUID->"14dce694-d00d-449c-b122-993413dd4b17"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[91777, 2320, 189, 3, 36, "Subsubsection",ExpressionUUID->"70c94ee5-2bd4-4159-a924-c0519710b2a7"],
Cell[CellGroupData[{
Cell[91991, 2327, 180, 2, 28, "Input",ExpressionUUID->"f50bb5b8-224a-4660-a3ee-d321011cfd73"],
Cell[92174, 2331, 190, 3, 32, "Output",ExpressionUUID->"9ff17f7c-d1c3-4bc9-90ae-5c456a0f6f6d"]
}, Open  ]],
Cell[92379, 2337, 235, 4, 28, "Input",ExpressionUUID->"7e468a63-cb16-49b9-93d3-5d492a716c98"],
Cell[CellGroupData[{
Cell[92639, 2345, 490, 9, 28, "Input",ExpressionUUID->"5aacaed9-a74b-4161-8c9a-123751345f66"],
Cell[93132, 2356, 526, 10, 32, "Output",ExpressionUUID->"b148097e-4b5f-4e58-8983-d5109218ecd3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93695, 2371, 485, 9, 28, "Input",ExpressionUUID->"6d8192b1-b5ff-4790-b1e1-bd11bdcec5a7"],
Cell[94183, 2382, 508, 10, 32, "Output",ExpressionUUID->"b1ee02e6-bf92-42d6-ad07-ca4ccdc85dc3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[94728, 2397, 483, 10, 28, "Input",ExpressionUUID->"7e36f814-ddae-42d0-b1d1-d34cb2913810"],
Cell[95214, 2409, 459, 9, 32, "Output",ExpressionUUID->"7b726d3c-6016-4709-9b0b-0710fae19b6e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95710, 2423, 536, 11, 28, "Input",ExpressionUUID->"be6af7ff-f673-4ae7-a9cf-02c3f753f2e9"],
Cell[96249, 2436, 526, 11, 32, "Output",ExpressionUUID->"4afbe546-ad92-4248-9346-efd8a7c65adf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96812, 2452, 500, 10, 28, "Input",ExpressionUUID->"e0a844c8-09dc-484a-bb3f-89522a974c72"],
Cell[97315, 2464, 488, 10, 32, "Output",ExpressionUUID->"ab6d1147-a46c-4f7d-92f3-8829823fac80"]
}, Open  ]],
Cell[97818, 2477, 268, 7, 28, "Input",ExpressionUUID->"90aabd85-b938-4076-a10a-379b8b0a8834"],
Cell[CellGroupData[{
Cell[98111, 2488, 564, 12, 28, "Input",ExpressionUUID->"419d05e2-019a-4711-93ea-f311a05c5928"],
Cell[98678, 2502, 492, 10, 32, "Output",ExpressionUUID->"38fec6e0-47bb-462a-961e-912687c42e64"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99207, 2517, 535, 11, 28, "Input",ExpressionUUID->"798c35a3-4f03-4271-a400-0d44005d8237"],
Cell[99745, 2530, 467, 10, 32, "Output",ExpressionUUID->"85b4bba9-34dd-47bc-a646-d2ac4f93879a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100249, 2545, 673, 14, 28, "Input",ExpressionUUID->"acc8cc89-4e47-47c7-99dc-7d1eb2fe7dab"],
Cell[100925, 2561, 607, 13, 32, "Output",ExpressionUUID->"ccd81b9d-c300-4f77-9107-1aecccf60bf7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[101569, 2579, 622, 13, 28, "Input",ExpressionUUID->"082ab2ea-622b-4211-8e00-ba90d0050f4e"],
Cell[102194, 2594, 574, 13, 32, "Output",ExpressionUUID->"ce5814bd-9aee-4d03-a501-4d11230b5288"]
}, Open  ]],
Cell[CellGroupData[{
Cell[102805, 2612, 581, 12, 28, "Input",ExpressionUUID->"08964ff8-1290-4c37-a8c0-887f6fc6d035"],
Cell[103389, 2626, 564, 13, 32, "Output",ExpressionUUID->"d7ae3fcb-c7ec-4ccb-a4cd-75589f3af8be"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103990, 2644, 571, 12, 28, "Input",ExpressionUUID->"935391f2-4b0f-4196-9f60-8cc49740f4c5"],
Cell[104564, 2658, 526, 12, 53, "Output",ExpressionUUID->"91997955-b35d-466a-8a63-9323b5e545b2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[105127, 2675, 601, 13, 28, "Input",ExpressionUUID->"54b2ade6-6764-48ee-819c-0285fac7d5e4"],
Cell[105731, 2690, 547, 13, 86, "Output",ExpressionUUID->"98f1205e-4823-400c-a186-468d3f2a3378"]
}, Open  ]],
Cell[106293, 2706, 370, 8, 28, "Input",ExpressionUUID->"a1f121d4-2505-475d-8645-5ec8564a5f11"],
Cell[CellGroupData[{
Cell[106688, 2718, 500, 10, 28, "Input",ExpressionUUID->"1deea0e3-df67-4c14-8826-ce0b03be4beb"],
Cell[107191, 2730, 462, 9, 32, "Output",ExpressionUUID->"6b1c7ee6-3c09-448f-8340-72f615374aec"]
}, Open  ]],
Cell[107668, 2742, 288, 5, 28, "Input",ExpressionUUID->"0d29bfc1-0fad-4586-84cb-8274255ad692"],
Cell[CellGroupData[{
Cell[107981, 2751, 180, 2, 28, "Input",ExpressionUUID->"47506779-a6aa-420a-a1dd-c99be69f8108"],
Cell[108164, 2755, 190, 3, 32, "Output",ExpressionUUID->"a3d992b5-3c9b-4475-b67f-3aa3902f4b1d"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[108403, 2764, 250, 4, 36, "Subsubsection",ExpressionUUID->"8b4e739c-e0db-46ea-babc-a8e854e4ff2f"],
Cell[CellGroupData[{
Cell[108678, 2772, 880, 20, 28, "Input",ExpressionUUID->"fc657306-4616-4251-9d2d-6530ea718369"],
Cell[109561, 2794, 538, 10, 32, "Output",ExpressionUUID->"b5ffa629-4db8-4f0d-bbe1-1f69327d8091"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110136, 2809, 861, 20, 28, "Input",ExpressionUUID->"e2e6831f-97d7-48e0-abcb-cc3a2e39f213"],
Cell[111000, 2831, 809, 18, 32, "Output",ExpressionUUID->"892fd117-4140-4e95-b666-7ae72ed22787"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111846, 2854, 862, 20, 28, "Input",ExpressionUUID->"15be0dfd-ba82-49de-8516-152b1fc34479"],
Cell[112711, 2876, 804, 18, 32, "Output",ExpressionUUID->"874cbccf-90f7-429c-ba69-adb9177e14ab"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113552, 2899, 889, 21, 28, "Input",ExpressionUUID->"cf280c98-9060-4259-aac9-934aab9ddb70"],
Cell[114444, 2922, 835, 19, 32, "Output",ExpressionUUID->"1dad52b3-9e70-4a9f-b65e-7e3ed0cecd52"]
}, Open  ]],
Cell[CellGroupData[{
Cell[115316, 2946, 1031, 25, 28, "Input",ExpressionUUID->"4c7d9406-8a18-4d38-abca-cf730534c185"],
Cell[116350, 2973, 946, 21, 53, "Output",ExpressionUUID->"53748432-fbe5-4fd9-abd9-98f6f871d107"]
}, Open  ]],
Cell[CellGroupData[{
Cell[117333, 2999, 978, 24, 28, "Input",ExpressionUUID->"9ab445a9-7f26-4efd-a803-81d74507e13d"],
Cell[118314, 3025, 912, 21, 53, "Output",ExpressionUUID->"b8c0c774-30c3-4107-8ff7-e64b28451f8c"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[119275, 3052, 200, 3, 36, "Subsubsection",ExpressionUUID->"1fb2fa9a-91c3-4480-bcf1-aa838e924d33"],
Cell[CellGroupData[{
Cell[119500, 3059, 778, 17, 28, "Input",ExpressionUUID->"63545004-0178-4072-864c-c88114177472"],
Cell[120281, 3078, 489, 10, 32, "Output",ExpressionUUID->"ead51282-81f5-4b71-9efb-196b34699408"]
}, Open  ]],
Cell[CellGroupData[{
Cell[120807, 3093, 829, 19, 28, "Input",ExpressionUUID->"3bcc8834-f10d-4d18-b398-8ba8f9b77944"],
Cell[121639, 3114, 515, 10, 32, "Output",ExpressionUUID->"a8518a92-3ee7-4311-89a0-2b932fc744cd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122191, 3129, 861, 19, 28, "Input",ExpressionUUID->"86755b41-7bba-405d-92c9-f8f6cdb71038"],
Cell[123055, 3150, 805, 17, 32, "Output",ExpressionUUID->"60349e65-c1a2-42b0-856d-48365864fe32"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123897, 3172, 807, 18, 28, "Input",ExpressionUUID->"407a4fbd-1e0b-4926-a659-6aebc10cf042"],
Cell[124707, 3192, 776, 18, 32, "Output",ExpressionUUID->"726de70c-58df-4aca-8abb-aa10e15c7265"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125520, 3215, 841, 19, 28, "Input",ExpressionUUID->"1a2e8c65-6c70-4cda-b23b-ac751e09b37d"],
Cell[126364, 3236, 807, 19, 32, "Output",ExpressionUUID->"6765fe40-fd53-4e17-8813-668daa028952"]
}, Open  ]],
Cell[CellGroupData[{
Cell[127208, 3260, 843, 20, 28, "Input",ExpressionUUID->"21c58784-623f-4770-8a70-de7d286bd48f"],
Cell[128054, 3282, 799, 19, 32, "Output",ExpressionUUID->"52575563-8703-4eef-b217-4093bf4d2bcf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128890, 3306, 914, 21, 28, "Input",ExpressionUUID->"fb624269-8337-4bae-8718-6bf123a723c9"],
Cell[129807, 3329, 889, 20, 32, "Output",ExpressionUUID->"5c566f28-56db-4ea9-ba14-4086ceca8bf7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130733, 3354, 860, 20, 28, "Input",ExpressionUUID->"5dc22128-e0cc-4121-95a8-5ba48ee4d88a"],
Cell[131596, 3376, 798, 18, 32, "Output",ExpressionUUID->"9e129458-bb75-46f0-871c-6ce9b61d3487"]
}, Open  ]],
Cell[CellGroupData[{
Cell[132431, 3399, 889, 21, 28, "Input",ExpressionUUID->"97fbb3a4-3429-46a9-9087-a06c7aedac2a"],
Cell[133323, 3422, 804, 18, 32, "Output",ExpressionUUID->"cef10cfd-7138-4e32-90a3-310aaa46a6f8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134164, 3445, 896, 22, 28, "Input",ExpressionUUID->"5b013877-9176-45ae-b629-7b1b8409b1ee"],
Cell[135063, 3469, 903, 22, 32, "Output",ExpressionUUID->"3b00e255-98fe-49fc-996c-f0e472a8b9f2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[136003, 3496, 889, 21, 28, "Input",ExpressionUUID->"8ecff072-25f8-4071-9d6f-2d235ac1118a"],
Cell[136895, 3519, 771, 18, 52, "Output",ExpressionUUID->"4fb043e2-3816-43d2-8186-9589574a32c6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137703, 3542, 982, 25, 28, "Input",ExpressionUUID->"2fb3ae87-93e1-40cb-a28c-2fcf56862455"],
Cell[138688, 3569, 844, 20, 53, "Output",ExpressionUUID->"b9df0a3f-a7ea-4dab-91fa-93231e5fb665"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139569, 3594, 948, 24, 28, "Input",ExpressionUUID->"6f89aecc-0f6f-4baf-9fb3-e57c3ca5097c"],
Cell[140520, 3620, 843, 20, 85, "Output",ExpressionUUID->"3a91ad24-ded2-46ce-b620-b7e62c92803b"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[141412, 3646, 197, 3, 36, "Subsubsection",ExpressionUUID->"cc39d347-b9bd-41ea-bcac-6a4a8277356a"],
Cell[CellGroupData[{
Cell[141634, 3653, 821, 19, 28, "Input",ExpressionUUID->"aeab8aff-a718-47f2-905f-62fb43cd9125"],
Cell[142458, 3674, 508, 11, 32, "Output",ExpressionUUID->"2634c6fd-592c-4c3b-8034-3e024b404de5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[143003, 3690, 851, 20, 28, "Input",ExpressionUUID->"ab6a3649-0dc0-4fae-95fb-f6d4bcebfa8d"],
Cell[143857, 3712, 857, 21, 32, "Output",ExpressionUUID->"4af8c7af-d204-4631-bc24-bb5acf1a6a93"]
}, Open  ]],
Cell[CellGroupData[{
Cell[144751, 3738, 849, 20, 28, "Input",ExpressionUUID->"10b8f353-5135-4d0a-a0c7-a938c5175ede"],
Cell[145603, 3760, 778, 18, 32, "Output",ExpressionUUID->"8ee27ee0-5017-4dfb-850b-ad405966729f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146418, 3783, 881, 21, 28, "Input",ExpressionUUID->"5141c366-4eef-4829-a9d0-c6d590fbd36d"],
Cell[147302, 3806, 891, 22, 32, "Output",ExpressionUUID->"4a6269cb-a493-4917-be48-f2edfd03fecb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[148230, 3833, 881, 21, 28, "Input",ExpressionUUID->"6958e5bf-669f-462a-b867-9d555bc58a86"],
Cell[149114, 3856, 513, 12, 32, "Output",ExpressionUUID->"9cec157d-0733-42b4-90d0-e0c9686c5fce"]
}, Open  ]],
Cell[CellGroupData[{
Cell[149664, 3873, 833, 20, 28, "Input",ExpressionUUID->"cc91fb79-89f8-43be-b660-c76895ccf0eb"],
Cell[150500, 3895, 495, 11, 32, "Output",ExpressionUUID->"500b834b-d4e9-4d0c-955b-bec5b845ea4e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[151032, 3911, 867, 21, 28, "Input",ExpressionUUID->"d75a6061-58ad-4426-b9e8-8d4b91b81cbd"],
Cell[151902, 3934, 839, 20, 32, "Output",ExpressionUUID->"bdc93006-23dc-4500-8275-03ac38e8fca5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[152778, 3959, 862, 21, 28, "Input",ExpressionUUID->"983703ef-c7d8-4463-9566-a1c25743c98d"],
Cell[153643, 3982, 802, 19, 32, "Output",ExpressionUUID->"40d9bd1b-af5c-4766-81af-d46a3dc1eb47"]
}, Open  ]],
Cell[CellGroupData[{
Cell[154482, 4006, 898, 22, 28, "Input",ExpressionUUID->"2969a896-bb6d-4e61-811e-79399e970e51"],
Cell[155383, 4030, 870, 20, 32, "Output",ExpressionUUID->"698c067c-2cd3-4ccb-a121-01b22760f99c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[156290, 4055, 894, 22, 28, "Input",ExpressionUUID->"49201f92-28b4-413d-889b-969c32a1764f"],
Cell[157187, 4079, 526, 12, 32, "Output",ExpressionUUID->"ad463aaa-533d-479b-b037-e649dc8a4dc8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[157750, 4096, 982, 25, 28, "Input",ExpressionUUID->"9aff3c3c-823a-434b-b655-ae908882ea0a"],
Cell[158735, 4123, 978, 23, 53, "Output",ExpressionUUID->"c6d2ac7c-bcb5-4677-8a69-7a2f7d77b034"]
}, Open  ]],
Cell[CellGroupData[{
Cell[159750, 4151, 934, 22, 28, "Input",ExpressionUUID->"0501102c-65c6-483f-a4a8-bfb161ff8a48"],
Cell[160687, 4175, 895, 22, 86, "Output",ExpressionUUID->"5c979d84-5c81-469d-b64c-28276e38ebaa"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[161631, 4203, 251, 4, 36, "Subsubsection",ExpressionUUID->"31dc7035-d0f0-40a0-883b-7758651069bb"],
Cell[CellGroupData[{
Cell[161907, 4211, 770, 17, 28, "Input",ExpressionUUID->"becd0f27-bf81-46c8-a5a7-953a1a311f44"],
Cell[162680, 4230, 451, 10, 32, "Output",ExpressionUUID->"1919ebe3-f8ca-4bf8-8bfe-397552c89ebf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163168, 4245, 832, 19, 28, "Input",ExpressionUUID->"0a454b66-a7e9-410f-a083-01f677fb4545"],
Cell[164003, 4266, 831, 19, 32, "Output",ExpressionUUID->"65c11cf0-f5ec-4f43-a873-b420a9b2e4e5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[164871, 4290, 821, 19, 28, "Input",ExpressionUUID->"a9c71d11-1cf9-40a2-bfbf-0f0344ed7781"],
Cell[165695, 4311, 482, 11, 32, "Output",ExpressionUUID->"7ea4efa7-4116-40df-9b27-aafd0190ba81"]
}, Open  ]],
Cell[CellGroupData[{
Cell[166214, 4327, 855, 20, 28, "Input",ExpressionUUID->"0ccbb21f-963e-413c-9dc6-c73eb545fbcb"],
Cell[167072, 4349, 827, 20, 32, "Output",ExpressionUUID->"b7850468-6557-4183-822f-b2f3f41649e6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167936, 4374, 850, 20, 28, "Input",ExpressionUUID->"5703b06c-d8ef-49e6-aff0-f529c864253a"],
Cell[168789, 4396, 806, 19, 32, "Output",ExpressionUUID->"ab9cbebf-90cb-4a0f-921b-c522509185cf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169632, 4420, 885, 21, 28, "Input",ExpressionUUID->"f6adc185-6ba9-4151-93b7-a00063b66668"],
Cell[170520, 4443, 513, 12, 32, "Output",ExpressionUUID->"3a018c93-d119-4ca4-bf06-f81764d5e553"]
}, Open  ]],
Cell[CellGroupData[{
Cell[171070, 4460, 967, 24, 28, "Input",ExpressionUUID->"505739cd-3d20-4609-b271-3ac1df059145"],
Cell[172040, 4486, 542, 13, 53, "Output",ExpressionUUID->"5834ef63-4653-4455-9c59-1452c3d50d7b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[172619, 4504, 932, 22, 28, "Input",ExpressionUUID->"f5fec690-390e-493e-9f0b-f7bdf2fcbb74"],
Cell[173554, 4528, 864, 21, 85, "Output",ExpressionUUID->"b910f245-86f4-412e-9682-0b0bf8a9313d"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[174479, 4556, 166, 3, 53, "Subsection",ExpressionUUID->"d6c62d28-cf1a-4896-8193-8fb33c76bee0"],
Cell[CellGroupData[{
Cell[174670, 4563, 6490, 152, 143, "Input",ExpressionUUID->"d8285a74-f0e4-44b4-af96-42fd765087b3"],
Cell[181163, 4717, 6328, 149, 147, "Output",ExpressionUUID->"23104de6-f07e-4122-9164-75cb262262f1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[187528, 4871, 457, 10, 49, "Input",ExpressionUUID->"b1c720f2-65e4-4952-a75b-2b04ca2bef6c"],
Cell[187988, 4883, 542, 11, 86, "Output",ExpressionUUID->"605435a5-f74b-4139-adf6-845223fee4a2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[188567, 4899, 508, 11, 48, "Input",ExpressionUUID->"46cbd292-df0b-43a4-9124-40d4ed49eb01"],
Cell[189078, 4912, 5273, 123, 143, "Output",ExpressionUUID->"3037aece-f460-4dfe-bf41-9febcc44b8a6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[194388, 5040, 408, 10, 48, "Input",ExpressionUUID->"3d3a715f-dbd8-4771-ac5e-2fbe9482441b"],
Cell[194799, 5052, 5092, 120, 143, "Output",ExpressionUUID->"8261b972-4dc4-432b-8522-f0738aa59fd2"]
}, Open  ]],
Cell[199906, 5175, 443, 11, 48, "Input",ExpressionUUID->"c5549010-a089-4c9b-8cbc-6443501adf13"],
Cell[200352, 5188, 231, 6, 28, "Input",ExpressionUUID->"b1df7b0c-c500-4f52-abd6-8be749847a27"],
Cell[CellGroupData[{
Cell[200608, 5198, 204, 4, 28, "Input",ExpressionUUID->"78686b88-e927-41c7-aeae-e42c56ea23ec"],
Cell[200815, 5204, 171, 3, 32, "Output",ExpressionUUID->"1f62773f-6a68-42ef-b6b0-3169842de621"]
}, Open  ]],
Cell[201001, 5210, 205, 5, 28, "Input",ExpressionUUID->"97a37157-4206-4817-a0d9-cab9d2441572"],
Cell[201209, 5217, 274, 7, 28, "Input",ExpressionUUID->"32c78d3c-6348-4044-8ddc-18c8bde02096"],
Cell[CellGroupData[{
Cell[201508, 5228, 403, 9, 48, "Input",ExpressionUUID->"d67d5191-d4d7-4310-be17-4aedea9074e8"],
Cell[201914, 5239, 5112, 120, 143, "Output",ExpressionUUID->"8030db71-1cbc-4e9c-84f4-f292982e651f"]
}, Open  ]]
}, Open  ]]
}
]
*)

