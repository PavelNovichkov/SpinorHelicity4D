(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    646961,      15736]
NotebookOptionsPosition[    582589,      14580]
NotebookOutlinePosition[    595875,      14850]
CellTagsIndexPosition[    595832,      14847]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"<<", "SpinorHelicity6D`"}]], "Input",
 CellChangeTimes->{{3.794738816072899*^9, 3.794738826382364*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"3d23a24c-8699-48bb-a4ef-f96529484450"],

Cell[CellGroupData[{

Cell[BoxData["\<\"===============SpinorHelicity6D================\"\>"], \
"Print",
 CellChangeTimes->{3.7947388282144575`*^9, 3.794746366626974*^9, 
  3.7947510018895273`*^9, 3.795405703882613*^9, 3.795841803502219*^9, 
  3.7958447414368925`*^9, 3.795859078227971*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"f5629021-07b9-40c1-8f2b-2769bcce7e9c"],

Cell[BoxData["\<\"Authors: Manuel Accettulli Huber (QMUL)\"\>"], "Print",
 CellChangeTimes->{3.7947388282144575`*^9, 3.794746366626974*^9, 
  3.7947510018895273`*^9, 3.795405703882613*^9, 3.795841803502219*^9, 
  3.7958447414368925`*^9, 3.7958590782449603`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"01dd4747-7436-4424-9dd8-7ace6b67d721"],

Cell[BoxData["\<\"         Stefano De Angelis (QMUL)\"\>"], "Print",
 CellChangeTimes->{3.7947388282144575`*^9, 3.794746366626974*^9, 
  3.7947510018895273`*^9, 3.795405703882613*^9, 3.795841803502219*^9, 
  3.7958447414368925`*^9, 3.795859078257889*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"e95d3f6e-8bb5-48d6-b25c-012b68d60dbd"],

Cell[BoxData["\<\"Please report any bug to:\"\>"], "Print",
 CellChangeTimes->{3.7947388282144575`*^9, 3.794746366626974*^9, 
  3.7947510018895273`*^9, 3.795405703882613*^9, 3.795841803502219*^9, 
  3.7958447414368925`*^9, 3.795859078261913*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"b861b833-4dd8-47af-b3ba-ed81ac892002"],

Cell[BoxData["\<\"m.accettullihuber@qmul.ac.uk\"\>"], "Print",
 CellChangeTimes->{3.7947388282144575`*^9, 3.794746366626974*^9, 
  3.7947510018895273`*^9, 3.795405703882613*^9, 3.795841803502219*^9, 
  3.7958447414368925`*^9, 3.795859078266865*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"a1950a46-7aeb-4445-ab03-e6630facf2e5"],

Cell[BoxData["\<\"s.deangelis@qmul.ac.uk\"\>"], "Print",
 CellChangeTimes->{3.7947388282144575`*^9, 3.794746366626974*^9, 
  3.7947510018895273`*^9, 3.795405703882613*^9, 3.795841803502219*^9, 
  3.7958447414368925`*^9, 3.7958590782698565`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"7c3fdb91-e545-4c2d-8d55-01d53cd80a3d"],

Cell[BoxData["\<\"Version 1.2 , last update 23/01/2020\"\>"], "Print",
 CellChangeTimes->{3.7947388282144575`*^9, 3.794746366626974*^9, 
  3.7947510018895273`*^9, 3.795405703882613*^9, 3.795841803502219*^9, 
  3.7958447414368925`*^9, 3.795859078274858*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"4767138b-d2ac-4325-8026-7623fab79895"],

Cell[BoxData["\<\"===============================================\"\>"], \
"Print",
 CellChangeTimes->{3.7947388282144575`*^9, 3.794746366626974*^9, 
  3.7947510018895273`*^9, 3.795405703882613*^9, 3.795841803502219*^9, 
  3.7958447414368925`*^9, 3.795859078279831*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"b4d03040-e78b-4232-8962-460dbecc840f"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "My", " ", "consideration", " ", "is", " ", "that", " ", "probably", " ", 
   "it", " ", "is", " ", "less", " ", "time", " ", "consuming", " ", "to", 
   " ", "build", " ", "the", " ", "replacements", " ", "for", " ", "all", " ",
    "possible", " ", "objects", " ", "and", " ", "then", " ", "apply", " ", 
   "them", " ", "rather", " ", "then", " ", "make", " ", "the", " ", 
   "replacements", " ", "simple", " ", "and", " ", "then", " ", "transform", 
   " ", "the", " ", "expression", " ", "in", " ", "such", " ", "a", " ", 
   "way", " ", "that", " ", "the", " ", "replacements", " ", "can", " ", "be",
    " ", "applied"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7947389415367985`*^9, 
  3.7947390343894854`*^9}},ExpressionUUID->"79bc2e33-d1a5-4af0-9fad-\
50a669c8cf83"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1","p2"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"SpinorAngleBracket", "[", 
     RowBox[{"x_", ",", "p1"}], "]"}], "\[RuleDelayed]", 
    RowBox[{"SpinorAngleBracket", "[", 
     RowBox[{"x", ",", "p3"}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.7947390809569397`*^9, 3.794739099714769*^9}, {
  3.794739131524684*^9, 3.7947391344149523`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"30193168-c86e-48c8-90cd-63c6af2a8b75"],

Cell[BoxData[
 TemplateBox[{"p1","p2"},
  "SpinorAngleBracket",
  DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
     RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
  InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
     RowBox[{#, ",", #2}], "]"}]& )]], "Output",
 CellChangeTimes->{3.7947391002562637`*^9, 3.794739134973406*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"2eafa1cb-c39c-4777-b8dc-1e80e1b8e6e6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1","p2"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"SpinorAngleBracket", "[", 
     RowBox[{"p1", ",", "x_"}], "]"}], "\[RuleDelayed]", 
    RowBox[{"SpinorAngleBracket", "[", 
     RowBox[{"p3", ",", "x"}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.794739112959296*^9, 3.79473914292813*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"23c7d2f4-6e44-4495-bf70-bb371fefe5ce"],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{"p2","p3"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )]}]], "Output",
 CellChangeTimes->{{3.79473912152837*^9, 3.794739143460739*^9}},
 CellLabel->"Out[6]=",ExpressionUUID->"519df45e-0eb6-4030-bbd8-f11ccd84e6c9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Old version", "Subsection",
 CellChangeTimes->{{3.794750887673503*^9, 
  3.79475088926489*^9}},ExpressionUUID->"52efd50d-d3b0-404b-a241-\
cca92bb736a8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$crep", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SubCounter", ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"$crep", "=", 
      RowBox[{"$crep", "+", "1"}]}], ";", 
     RowBox[{"\[Alpha]", "*", 
      RowBox[{"IntegerPart", "[", 
       RowBox[{"$crep", "/", "2"}], "]"}]}]}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SpinorReplaceOld", "[", 
    RowBox[{"exp_", ",", "subs_List"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"locexp", ",", "locsubs", ",", "$a", ",", "$b"}], "}"}], ",", 
     "\n", 
     RowBox[{
      RowBox[{"locexp", "=", 
       RowBox[{"exp", "/.", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"SpinorAngleBracket", "[", 
             RowBox[{"x_", ",", "y_"}], "]"}], "/;", 
            RowBox[{"TrueQ", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Head", "[", "x", "]"}], "==", "OverBar"}], "&&", 
              RowBox[{
               RowBox[{"Head", "[", "y", "]"}], "==", "OverBar"}]}], "]"}]}], 
           "->", " ", 
           RowBox[{"HoldForm", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"SpinorUndot", "[", "x", "]"}], "[", "$mu", "]"}], 
               "[", "SubCounter", "]"}], "[", "Null", "]"}], "*", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"SpinorUndot", "[", "y", "]"}], "[", "$mu", "]"}], 
               "[", "Null", "]"}], "[", "SubCounter", "]"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"SpinorSquareBracket", "[", 
             RowBox[{"x_", ",", "y_"}], "]"}], "/;", 
            RowBox[{"TrueQ", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Head", "[", "x", "]"}], "==", "OverBar"}], "&&", 
              RowBox[{
               RowBox[{"Head", "[", "y", "]"}], "==", "OverBar"}]}], "]"}]}], 
           "->", 
           RowBox[{"HoldForm", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"SpinorDot", "[", "x", "]"}], "[", "$mu", "]"}], "[", 
               "Null", "]"}], "[", "SubCounter", "]"}], "*", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"SpinorDot", "[", "y", "]"}], "[", "$mu", "]"}], "[", 
               "SubCounter", "]"}], "[", "Null", "]"}]}], "]"}]}], ",", "\n", 
          RowBox[{
           RowBox[{
            RowBox[{"SpinorAngleBracket", "[", 
             RowBox[{"x_", ",", "y_"}], "]"}], "/;", 
            RowBox[{"TrueQ", "[", 
             RowBox[{
              RowBox[{"Head", "[", "y", "]"}], "==", "OverBar"}], "]"}]}], "->",
            " ", 
           RowBox[{"HoldForm", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"SpinorUndot", "[", "x", "]"}], "[", "$lam", "]"}], 
               "[", "SubCounter", "]"}], "[", "Null", "]"}], "*", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"SpinorUndot", "[", "y", "]"}], "[", "$mu", "]"}], 
               "[", "Null", "]"}], "[", "SubCounter", "]"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"SpinorSquareBracket", "[", 
             RowBox[{"x_", ",", "y_"}], "]"}], "/;", 
            RowBox[{"TrueQ", "[", 
             RowBox[{
              RowBox[{"Head", "[", "y", "]"}], "==", "OverBar"}], "]"}]}], "->", 
           RowBox[{"HoldForm", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"SpinorDot", "[", "x", "]"}], "[", "$lam", "]"}], "[",
                "Null", "]"}], "[", "SubCounter", "]"}], "*", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"SpinorDot", "[", "y", "]"}], "[", "$mu", "]"}], "[", 
               "SubCounter", "]"}], "[", "Null", "]"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"SpinorAngleBracket", "[", 
            RowBox[{"x_", ",", "y_"}], "]"}], "->", " ", 
           RowBox[{"HoldForm", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"SpinorUndot", "[", "x", "]"}], "[", "$lam", "]"}], 
               "[", "SubCounter", "]"}], "[", "Null", "]"}], "*", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"SpinorUndot", "[", "y", "]"}], "[", "$lam", "]"}], 
               "[", "Null", "]"}], "[", "SubCounter", "]"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"SpinorSquareBracket", "[", 
            RowBox[{"x_", ",", "y_"}], "]"}], "->", 
           RowBox[{"HoldForm", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"SpinorDot", "[", "x", "]"}], "[", "$lam", "]"}], "[",
                "Null", "]"}], "[", "SubCounter", "]"}], "*", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"SpinorDot", "[", "y", "]"}], "[", "$lam", "]"}], "[",
                "SubCounter", "]"}], "[", "Null", "]"}]}], "]"}]}]}], 
         "}"}]}]}], ";", "\n", 
      RowBox[{"locexp", "=", 
       RowBox[{"locexp", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"SpinorUndot", "[", 
               RowBox[{"OverBar", "[", "x_", "]"}], "]"}], "[", "$mu", "]"}], 
             "[", "y_", "]"}], "[", "z_", "]"}], "->", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"SpinorUndot", "[", "x", "]"}], "[", "$mu", "]"}], "[", 
             "y", "]"}], "[", "z", "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"SpinorDot", "[", 
               RowBox[{"OverBar", "[", "x_", "]"}], "]"}], "[", "$mu", "]"}], 
             "[", "y_", "]"}], "[", "z_", "]"}], "->", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"SpinorDot", "[", "x", "]"}], "[", "$mu", "]"}], "[", 
             "y", "]"}], "[", "z", "]"}]}]}], "}"}]}]}], ";", "\n", 
      RowBox[{"locsubs", "=", 
       RowBox[{"subs", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"SpinorUndotPure", "->", "SpinorUndot"}], ",", 
          RowBox[{"SpinorDotPure", "->", "SpinorDot"}]}], "}"}]}]}], ";", 
      "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Do", "[", "\n", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"locsubs", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"locsubs", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "[", "$a_", "]"}], "[",
              "$b_", "]"}]}], ";", "\n", 
           RowBox[{
            RowBox[{"locsubs", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"locsubs", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}], "[", "$a", "]"}], "[", 
             "$b", "]"}]}], ";"}], "\n", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "subs", "]"}]}], "}"}]}], "]"}], ";"}], 
       "*)"}], "\n", 
      RowBox[{"locexp", "=", 
       RowBox[{"locexp", "/.", "locsubs"}]}], ";", "\n", 
      RowBox[{"$crep", "=", "1"}], ";", "\n", 
      RowBox[{"Return", "[", 
       RowBox[{"locexp", "//", "ReleaseHold"}], "]"}], ";"}]}], "\n", "]"}]}],
   ";"}]}], "Code",
 CellChangeTimes->{{3.7958586652931433`*^9, 3.79585866574792*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"156329d6-a802-45ba-8d41-88a09cf47573"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed","wrsym",
   "\"Symbol \\!\\(\\*RowBox[{\\\"SubCounter\\\"}]\\) is Protected.\"",2,136,
   1,25064548125512638122,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.795858667476159*^9},
 CellLabel->
  "During evaluation of \
In[135]:=",ExpressionUUID->"eda1931d-3ac1-48b7-81b3-b3b7c57e0912"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["New version", "Subsection",
 CellChangeTimes->{{3.7947392076500187`*^9, 3.7947392122547393`*^9}, {
  3.7947509006754265`*^9, 
  3.7947509024966908`*^9}},ExpressionUUID->"60a5a24f-a48a-4c99-a37f-\
6939051f60b5"],

Cell[CellGroupData[{

Cell["\<\
First without thinking about linearity. Too convoluted and not working\
\>", "Subsubsection",
 CellChangeTimes->{{3.794739444793776*^9, 3.7947394633700633`*^9}, {
  3.79474399629361*^9, 
  3.794744005911847*^9}},ExpressionUUID->"8b80e998-b0b0-44cd-ae0d-\
0b38e55984a4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     TemplateBox[{"p1"},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
     TemplateBox[{"p3"},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], ",", 
    RowBox[{
     TemplateBox[{"p2"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
     TemplateBox[{"p4"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], ",", 
    RowBox[{
     TemplateBox[{"p2"},
      "SpinorUndotPureM",
      DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
     TemplateBox[{"p4"},
      "SpinorUndotPureM",
      DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )]}], ",", 
    RowBox[{
     TemplateBox[{"p1"},
      "SpinorDotPureM",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
     TemplateBox[{"p3"},
      "SpinorDotPureM",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )]}], ",", 
    RowBox[{
     TemplateBox[{"p5"},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], 
     "\[Rule]", 
     RowBox[{"3", "*", 
      TemplateBox[{"p7"},
       "SpinorUndotPureL",
       DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], 
    ",", 
    RowBox[{
     TemplateBox[{"p6"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
     RowBox[{
      TemplateBox[{"p7"},
       "SpinorDotPureL",
       DisplayFunction->(RowBox[{
          OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "+", 
      TemplateBox[{"p8"},
       "SpinorDotPureL",
       DisplayFunction->(RowBox[{
          OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.7947394073190117`*^9, 3.7947394360391407`*^9}, {
  3.7947406606602736`*^9, 3.7947406964746857`*^9}, {3.794741237824665*^9, 
  3.794741279676182*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"ad29bcf2-a3e0-4801-aa43-990721a57d45"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    TemplateBox[{"p1"},
     "SpinorUndotPureL",
     DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], 
    "\[Rule]", 
    TemplateBox[{"p3"},
     "SpinorUndotPureL",
     DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], ",", 
   RowBox[{
    TemplateBox[{"p2"},
     "SpinorDotPureL",
     DisplayFunction->(RowBox[{
        OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "\[Rule]", 
    TemplateBox[{"p4"},
     "SpinorDotPureL",
     DisplayFunction->(RowBox[{
        OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], ",", 
   RowBox[{
    TemplateBox[{"p2"},
     "SpinorUndotPureM",
     DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], 
    "\[Rule]", 
    TemplateBox[{"p4"},
     "SpinorUndotPureM",
     DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )]}], ",", 
   RowBox[{
    TemplateBox[{"p1"},
     "SpinorDotPureM",
     DisplayFunction->(RowBox[{
        OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "\[Rule]", 
    TemplateBox[{"p3"},
     "SpinorDotPureM",
     DisplayFunction->(RowBox[{
        OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )]}], ",", 
   RowBox[{
    TemplateBox[{"p5"},
     "SpinorUndotPureL",
     DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], 
    "\[Rule]", 
    RowBox[{"3", " ", 
     TemplateBox[{"p7"},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], 
   ",", 
   RowBox[{
    TemplateBox[{"p6"},
     "SpinorDotPureL",
     DisplayFunction->(RowBox[{
        OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "\[Rule]", 
    RowBox[{
     TemplateBox[{"p7"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "+", 
     TemplateBox[{"p8"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.794739436478999*^9, 3.7947406975382586`*^9, 
  3.794741280249055*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"cb1fd3c3-31f5-41d9-8b43-75e96c3dfd1a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RepBuilder", "[", "reps_List", "]"}], ":=", 
   RowBox[{"Catch", "[", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "agreps", ",", "sqreps", ",", "agsimple", ",", "sqsimple", ",", 
         "aghard", ",", "sqhard", ",", "agsubsimple", ",", "sqsubsimple"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "First", " ", "sort", " ", "replacements", " ", "between", " ", 
          "angle", " ", "and", " ", "square"}], ",", " ", 
         RowBox[{
         "and", " ", "check", " ", "if", " ", "the", " ", "replacements", " ",
           "are", " ", "in", " ", "a", " ", "valid", " ", "form"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"AnyTrue", "[", 
           RowBox[{"reps", ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"!", 
                  RowBox[{"FreeQ", "[", 
                   RowBox[{"#", ",", "SpinorUndotPure"}], "]"}]}], "&&", 
                 RowBox[{"!", 
                  RowBox[{"FreeQ", "[", 
                   RowBox[{"#", ",", "SpinorDotPure"}], "]"}]}]}], ")"}], "||", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"FreeQ", "[", 
                  RowBox[{"#", ",", "SpinorUndotPure"}], "]"}], "&&", 
                 RowBox[{"FreeQ", "[", 
                  RowBox[{"#", ",", "SpinorDotPure"}], "]"}]}], ")"}]}], 
              "&"}], ")"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Throw", "[", 
            "\"\<Error in the replacemenst. Please check input.\>\"", "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"agreps", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"reps", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"FreeQ", "[", 
               RowBox[{"#", ",", "SpinorUndotPure"}], "]"}]}], "&"}], ")"}]}],
           "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "agreps", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"sqreps", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"reps", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"FreeQ", "[", 
               RowBox[{"#", ",", "SpinorDotPure"}], "]"}]}], "&"}], ")"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "sqreps", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Take", " ", "into", " ", "account", " ", "the", " ", "appearance", 
          " ", "of", " ", "possible", " ", "\[Mu]", " ", "spinors"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"agreps", "=", 
         RowBox[{"agreps", "/.", 
          RowBox[{
           RowBox[{
            RowBox[{"SpinorUndotPure", "[", "x_", "]"}], "[", "$mu", "]"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"SpinorUndotPure", "[", 
             RowBox[{"OverBar", "[", "x", "]"}], "]"}], "[", "$lam", 
            "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sqreps", "=", 
         RowBox[{"sqreps", "/.", 
          RowBox[{
           RowBox[{
            RowBox[{"SpinorDotPure", "[", "x_", "]"}], "[", "$mu", "]"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"SpinorDotPure", "[", 
             RowBox[{"OverBar", "[", "x", "]"}], "]"}], "[", "$lam", 
            "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "agreps", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", "sqreps", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "For", " ", "better", " ", "speed", " ", "performances", " ", 
           "separate", " ", "into", " ", "two", " ", "cathegories"}], ",", 
          " ", 
          RowBox[{
          "the", " ", "simple", " ", "replacements", " ", "and", " ", "the", 
           " ", "replacements", " ", "which", " ", "involve", " ", "a", " ", 
           "rescaling", " ", "or", " ", "sums", " ", "of", " ", "spinors", 
           " ", "were", " ", "linearity", " ", "is", " ", "required"}]}], 
         "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"aghard", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"agreps", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Head", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "===", "Times"}], "||", 
              RowBox[{
               RowBox[{"Head", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "===", "Plus"}]}], 
             "&"}], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sqhard", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"sqreps", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Head", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "===", "Times"}], "||", 
              RowBox[{
               RowBox[{"Head", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "===", "Plus"}]}], 
             "&"}], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "aghard", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", "sqhard", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"agsimple", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"agreps", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], "===", "Times"}], "||", 
                RowBox[{
                 RowBox[{"Head", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], "===", "Plus"}]}], 
               ")"}]}], "&"}], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sqsimple", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"sqreps", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], "===", "Times"}], "||", 
                RowBox[{
                 RowBox[{"Head", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], "===", "Plus"}]}], 
               ")"}]}], "&"}], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "agsimple", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", "sqsimple", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Build", " ", "the", " ", "replacements", " ", "for", " ", "the", 
           " ", "simple", " ", 
           RowBox[{"cases", ".", " ", "We"}], " ", "need", " ", "to", " ", 
           "replace", " ", "SpinorAngleBracket"}], ",", " ", 
          RowBox[{
          "SpinorSquareBracket", " ", "and", " ", "the", " ", "chain", " ", 
           "extrema"}]}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"agsimple", "=", 
         RowBox[{"agsimple", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"SpinorUndotPure", "[", "x_", "]"}], "[", "$lam", "]"}], 
            "\[RuleDelayed]", "x"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "agsimple", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"agsubsimple", "=", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"a", "=", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{"b", "=", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"SpinorAngleBracket", "[", 
                  RowBox[{"a", ",", "x_"}], "]"}], "\[RuleDelayed]", 
                 RowBox[{"SpinorAngleBracket", "[", 
                  RowBox[{"b", ",", "x"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"SpinorAngleBracket", "[", 
                  RowBox[{"x_", ",", "a"}], "]"}], "\[RuleDelayed]", 
                 RowBox[{"SpinorAngleBracket", "[", 
                  RowBox[{"x", ",", "b"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"Chain", "[", 
                  RowBox[{"$angle", ",", "a", ",", 
                   RowBox[{"{", "y__", "}"}], ",", "a", ",", "$angle"}], 
                  "]"}], "\[RuleDelayed]", 
                 RowBox[{"Chain", "[", 
                  RowBox[{"$angle", ",", "b", ",", 
                   RowBox[{"{", "y", "}"}], ",", "b", ",", "$angle"}], 
                  "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Chain", "[", 
                  RowBox[{"$angle", ",", "a", ",", "x__"}], "]"}], 
                 "\[RuleDelayed]", 
                 RowBox[{"Chain", "[", 
                  RowBox[{"$angle", ",", "b", ",", "x"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"Chain", "[", 
                  RowBox[{"type_", ",", "x_", ",", 
                   RowBox[{"{", "y__", "}"}], ",", "a", ",", "$angle"}], 
                  "]"}], "\[RuleDelayed]", 
                 RowBox[{"Chain", "[", 
                  RowBox[{"type", ",", "x", ",", 
                   RowBox[{"{", "y", "}"}], ",", "b", ",", "$angle"}], 
                  "]"}]}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "agsimple"}], "}"}]}], "]"}], "//", 
          "Flatten"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "agsubsimple", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"sqsimple", "=", 
         RowBox[{"sqsimple", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"SpinorDotPure", "[", "x_", "]"}], "[", "$lam", "]"}], 
            "\[RuleDelayed]", "x"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "sqsimple", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"sqsubsimple", "=", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"a", "=", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{"b", "=", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"SpinorSquareBracket", "[", 
                  RowBox[{"a", ",", "x_"}], "]"}], "\[RuleDelayed]", 
                 RowBox[{"SpinorSquareBracket", "[", 
                  RowBox[{"b", ",", "x"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"SpinorSquareBracket", "[", 
                  RowBox[{"x_", ",", "a"}], "]"}], "\[RuleDelayed]", 
                 RowBox[{"SpinorSquareBracket", "[", 
                  RowBox[{"x", ",", "b"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"Chain", "[", 
                  RowBox[{"$square", ",", "a", ",", 
                   RowBox[{"{", "y__", "}"}], ",", "a", ",", "$square"}], 
                  "]"}], "\[RuleDelayed]", 
                 RowBox[{"Chain", "[", 
                  RowBox[{"$square", ",", "b", ",", 
                   RowBox[{"{", "y", "}"}], ",", "b", ",", "$square"}], 
                  "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Chain", "[", 
                  RowBox[{"$angle", ",", "a", ",", "x__"}], "]"}], 
                 "\[RuleDelayed]", 
                 RowBox[{"Chain", "[", 
                  RowBox[{"$angle", ",", "b", ",", "x"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"Chain", "[", 
                  RowBox[{"type_", ",", "x_", ",", 
                   RowBox[{"{", "y__", "}"}], ",", "a", ",", "$square"}], 
                  "]"}], "\[RuleDelayed]", 
                 RowBox[{"Chain", "[", 
                  RowBox[{"type", ",", "x", ",", 
                   RowBox[{"{", "y", "}"}], ",", "b", ",", "$square"}], 
                  "]"}]}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "sqsimple"}], "}"}]}], "]"}], "//", 
          "Flatten"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "sqsubsimple", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"Join", "[", 
          RowBox[{"agsubsimple", ",", "sqsubsimple"}], "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "]"}], ";"}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzzFIAgEARmELU6GgAqmgohwKXUJIcqhIE5WWTl2iBpFDtyhJkJIkEBLD
TEIIDYSosKkosMTBEskhMlAhNSQJKUFzkBIyosz/hsc3Pw65rNI102i0/kYw
JbnjvErL4p4QewjKp0s8qDqckEArk5BDks2ZhSd9ahWUrZS1kDDy1mHRFDXD
kXu7G1YEMg9kxXUH8IyoUS7pxT4YT7RdwfabcAjmyK8ojDqJLIwFLJQWZS0P
bWvRXzim2WC8NUz9zDPhQl0xDI+SJBeWu1v5UGT2i+BqdVIBtz/dSkg0abXQ
qi5R0l2jBriY2TJCxkDCQRnJ70Abf24Pcr0RL7yech5DQ1p4Ad9LHZfQYt8N
wuB4LAQ1xZkwDDEFt7DuECahT0GmIbkvzEBTIFOBp7mnD6gflNbgX/bxG266
OHXqM0ZvKTR85r+woJ/n6YSFKq0L9p4/dMN/mEP/mg==
  "],
 CellLabel->"In[86]:=",ExpressionUUID->"a802e4cc-9625-48f5-a192-87d6e73bbb32"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RepBuilder", "[", 
  RowBox[{"{", 
   RowBox[{"1", "\[Rule]", "2"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.7947400137449927`*^9, 3.794740020466997*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"be2c4161-a709-4d32-96a1-c831d168eac8"],

Cell[BoxData["\<\"Error in the replacemenst. Please check input.\"\>"], \
"Output",
 CellChangeTimes->{3.794740020947673*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"759db37d-8c32-46c8-929c-0f1a2c5e3896"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RepBuilder", "[", 
  RowBox[{"{", 
   RowBox[{
    TemplateBox[{"1"},
     "SpinorUndotPureL",
     DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
    TemplateBox[{"2"},
     "SpinorDotPureL",
     DisplayFunction->(RowBox[{
        OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7947400291287956`*^9, 3.7947400376160913`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"77c233c2-0dc2-4e3d-96a8-b294010b152e"],

Cell[BoxData["\<\"Error in the replacemenst. Please check input.\"\>"], \
"Output",
 CellChangeTimes->{3.794740038027024*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"693c0f25-96c7-4a8f-aaff-9bed4a33840c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RepBuilder", "[", "test", "]"}]], "Input",
 CellChangeTimes->{{3.794739715947507*^9, 3.794739718888598*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"0644c9cc-93a0-4c98-8375-a6ac25b7081f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"p1", "\[Rule]", "p3"}], ",", 
   RowBox[{
    OverscriptBox["p2", "_"], "\[Rule]", 
    OverscriptBox["p4", "_"]}]}], "}"}]], "Print",
 CellChangeTimes->{{3.794739719522941*^9, 3.7947397393000026`*^9}, 
   3.794740010885626*^9, {3.7947407085139604`*^9, 3.794740724149809*^9}, {
   3.7947412865491486`*^9, 3.794741310691221*^9}, {3.7947417508264265`*^9, 
   3.7947417703115664`*^9}, 3.794741905687788*^9, 3.7947426727166123`*^9, {
   3.794742722277042*^9, 3.794742736979412*^9}, 3.794742799788123*^9, 
   3.7947429450288525`*^9, 3.7947429816576447`*^9, 3.794743197724162*^9, 
   3.7947432524585886`*^9, {3.7947434268978653`*^9, 3.794743442079997*^9}, 
   3.794743491778761*^9},
 CellLabel->
  "During evaluation of \
In[87]:=",ExpressionUUID->"138959a0-e164-4384-b845-1b90f4464aef"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    TemplateBox[{"p1","x$_"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "\[RuleDelayed]", 
    TemplateBox[{"p3","x$"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], ",", 
   RowBox[{
    RowBox[{"-", 
     TemplateBox[{"p1","x$_"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], "\[RuleDelayed]", 
    TemplateBox[{"x$","p3"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], ",", 
   RowBox[{
    RowBox[{"Chain", "[", 
     RowBox[{"$angle", ",", "p1", ",", 
      RowBox[{"{", "y$__", "}"}], ",", "p1", ",", "$angle"}], "]"}], 
    "\[RuleDelayed]", 
    RowBox[{"Chain", "[", 
     RowBox[{"$angle", ",", "p3", ",", 
      RowBox[{"{", "y$", "}"}], ",", "p3", ",", "$angle"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"Chain", "[", 
     RowBox[{"$angle", ",", "p1", ",", "x$__"}], "]"}], "\[RuleDelayed]", 
    RowBox[{"Chain", "[", 
     RowBox[{"$angle", ",", "p3", ",", "x$"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"Chain", "[", 
     RowBox[{"type$_", ",", "x$_", ",", 
      RowBox[{"{", "y$__", "}"}], ",", "p1", ",", "$angle"}], "]"}], 
    "\[RuleDelayed]", 
    RowBox[{"Chain", "[", 
     RowBox[{"type$", ",", "x$", ",", 
      RowBox[{"{", "y$", "}"}], ",", "p3", ",", "$angle"}], "]"}]}], ",", 
   RowBox[{
    TemplateBox[{OverscriptBox["p2", "_"],"x$_"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "\[RuleDelayed]", 
    TemplateBox[{OverscriptBox["p4", "_"],"x$"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], ",", 
   RowBox[{
    RowBox[{"-", 
     TemplateBox[{OverscriptBox["p2", "_"],"x$_"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], "\[RuleDelayed]", 
    TemplateBox[{"x$",OverscriptBox["p4", "_"]},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], ",", 
   RowBox[{
    RowBox[{"Chain", "[", 
     RowBox[{"$angle", ",", 
      OverscriptBox["p2", "_"], ",", 
      RowBox[{"{", "y$__", "}"}], ",", 
      OverscriptBox["p2", "_"], ",", "$angle"}], "]"}], "\[RuleDelayed]", 
    RowBox[{"Chain", "[", 
     RowBox[{"$angle", ",", 
      OverscriptBox["p4", "_"], ",", 
      RowBox[{"{", "y$", "}"}], ",", 
      OverscriptBox["p4", "_"], ",", "$angle"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"Chain", "[", 
     RowBox[{"$angle", ",", 
      OverscriptBox["p2", "_"], ",", "x$__"}], "]"}], "\[RuleDelayed]", 
    RowBox[{"Chain", "[", 
     RowBox[{"$angle", ",", 
      OverscriptBox["p4", "_"], ",", "x$"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"Chain", "[", 
     RowBox[{"type$_", ",", "x$_", ",", 
      RowBox[{"{", "y$__", "}"}], ",", 
      OverscriptBox["p2", "_"], ",", "$angle"}], "]"}], "\[RuleDelayed]", 
    RowBox[{"Chain", "[", 
     RowBox[{"type$", ",", "x$", ",", 
      RowBox[{"{", "y$", "}"}], ",", 
      OverscriptBox["p4", "_"], ",", "$angle"}], "]"}]}]}], "}"}]], "Print",
 CellChangeTimes->{{3.794739719522941*^9, 3.7947397393000026`*^9}, 
   3.794740010885626*^9, {3.7947407085139604`*^9, 3.794740724149809*^9}, {
   3.7947412865491486`*^9, 3.794741310691221*^9}, {3.7947417508264265`*^9, 
   3.7947417703115664`*^9}, 3.794741905687788*^9, 3.7947426727166123`*^9, {
   3.794742722277042*^9, 3.794742736979412*^9}, 3.794742799788123*^9, 
   3.7947429450288525`*^9, 3.7947429816576447`*^9, 3.794743197724162*^9, 
   3.7947432524585886`*^9, {3.7947434268978653`*^9, 3.794743442079997*^9}, 
   3.7947434917977123`*^9},
 CellLabel->
  "During evaluation of \
In[87]:=",ExpressionUUID->"b92853f4-47df-488d-be4d-2a1521f85ec2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"p2", "\[Rule]", "p4"}], ",", 
   RowBox[{
    OverscriptBox["p1", "_"], "\[Rule]", 
    OverscriptBox["p3", "_"]}]}], "}"}]], "Print",
 CellChangeTimes->{{3.794739719522941*^9, 3.7947397393000026`*^9}, 
   3.794740010885626*^9, {3.7947407085139604`*^9, 3.794740724149809*^9}, {
   3.7947412865491486`*^9, 3.794741310691221*^9}, {3.7947417508264265`*^9, 
   3.7947417703115664`*^9}, 3.794741905687788*^9, 3.7947426727166123`*^9, {
   3.794742722277042*^9, 3.794742736979412*^9}, 3.794742799788123*^9, 
   3.7947429450288525`*^9, 3.7947429816576447`*^9, 3.794743197724162*^9, 
   3.7947432524585886`*^9, {3.7947434268978653`*^9, 3.794743442079997*^9}, 
   3.7947434918226547`*^9},
 CellLabel->
  "During evaluation of \
In[87]:=",ExpressionUUID->"2716b9a9-666d-4944-9350-d757f95d011e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    TemplateBox[{"p2","x$_"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "\[RuleDelayed]", 
    TemplateBox[{"p4","x$"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], ",", 
   RowBox[{
    RowBox[{"-", 
     TemplateBox[{"p2","x$_"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], "\[RuleDelayed]", 
    TemplateBox[{"x$","p4"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], ",", 
   RowBox[{
    RowBox[{"Chain", "[", 
     RowBox[{"$square", ",", "p2", ",", 
      RowBox[{"{", "y$__", "}"}], ",", "p2", ",", "$square"}], "]"}], 
    "\[RuleDelayed]", 
    RowBox[{"Chain", "[", 
     RowBox[{"$square", ",", "p4", ",", 
      RowBox[{"{", "y$", "}"}], ",", "p4", ",", "$square"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"Chain", "[", 
     RowBox[{"$angle", ",", "p2", ",", "x$__"}], "]"}], "\[RuleDelayed]", 
    RowBox[{"Chain", "[", 
     RowBox[{"$angle", ",", "p4", ",", "x$"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"Chain", "[", 
     RowBox[{"type$_", ",", "x$_", ",", 
      RowBox[{"{", "y$__", "}"}], ",", "p2", ",", "$square"}], "]"}], 
    "\[RuleDelayed]", 
    RowBox[{"Chain", "[", 
     RowBox[{"type$", ",", "x$", ",", 
      RowBox[{"{", "y$", "}"}], ",", "p4", ",", "$square"}], "]"}]}], ",", 
   RowBox[{
    TemplateBox[{OverscriptBox["p1", "_"],"x$_"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "\[RuleDelayed]", 
    TemplateBox[{OverscriptBox["p3", "_"],"x$"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], ",", 
   RowBox[{
    RowBox[{"-", 
     TemplateBox[{OverscriptBox["p1", "_"],"x$_"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], "\[RuleDelayed]", 
    TemplateBox[{"x$",OverscriptBox["p3", "_"]},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], ",", 
   RowBox[{
    RowBox[{"Chain", "[", 
     RowBox[{"$square", ",", 
      OverscriptBox["p1", "_"], ",", 
      RowBox[{"{", "y$__", "}"}], ",", 
      OverscriptBox["p1", "_"], ",", "$square"}], "]"}], "\[RuleDelayed]", 
    RowBox[{"Chain", "[", 
     RowBox[{"$square", ",", 
      OverscriptBox["p3", "_"], ",", 
      RowBox[{"{", "y$", "}"}], ",", 
      OverscriptBox["p3", "_"], ",", "$square"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"Chain", "[", 
     RowBox[{"$angle", ",", 
      OverscriptBox["p1", "_"], ",", "x$__"}], "]"}], "\[RuleDelayed]", 
    RowBox[{"Chain", "[", 
     RowBox[{"$angle", ",", 
      OverscriptBox["p3", "_"], ",", "x$"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"Chain", "[", 
     RowBox[{"type$_", ",", "x$_", ",", 
      RowBox[{"{", "y$__", "}"}], ",", 
      OverscriptBox["p1", "_"], ",", "$square"}], "]"}], "\[RuleDelayed]", 
    RowBox[{"Chain", "[", 
     RowBox[{"type$", ",", "x$", ",", 
      RowBox[{"{", "y$", "}"}], ",", 
      OverscriptBox["p3", "_"], ",", "$square"}], "]"}]}]}], "}"}]], "Print",
 CellChangeTimes->{{3.794739719522941*^9, 3.7947397393000026`*^9}, 
   3.794740010885626*^9, {3.7947407085139604`*^9, 3.794740724149809*^9}, {
   3.7947412865491486`*^9, 3.794741310691221*^9}, {3.7947417508264265`*^9, 
   3.7947417703115664`*^9}, 3.794741905687788*^9, 3.7947426727166123`*^9, {
   3.794742722277042*^9, 3.794742736979412*^9}, 3.794742799788123*^9, 
   3.7947429450288525`*^9, 3.7947429816576447`*^9, 3.794743197724162*^9, 
   3.7947432524585886`*^9, {3.7947434268978653`*^9, 3.794743442079997*^9}, 
   3.7947434918346167`*^9},
 CellLabel->
  "During evaluation of \
In[87]:=",ExpressionUUID->"ddb78399-0ca7-4f8b-bb35-d8fe024d2e83"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    TemplateBox[{"p1","x$_"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "\[RuleDelayed]", 
    TemplateBox[{"p3","x$"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], ",", 
   RowBox[{
    RowBox[{"-", 
     TemplateBox[{"p1","x$_"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], "\[RuleDelayed]", 
    TemplateBox[{"x$","p3"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], ",", 
   RowBox[{
    RowBox[{"Chain", "[", 
     RowBox[{"$angle", ",", "p1", ",", 
      RowBox[{"{", "y$__", "}"}], ",", "p1", ",", "$angle"}], "]"}], 
    "\[RuleDelayed]", 
    RowBox[{"Chain", "[", 
     RowBox[{"$angle", ",", "p3", ",", 
      RowBox[{"{", "y$", "}"}], ",", "p3", ",", "$angle"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"Chain", "[", 
     RowBox[{"$angle", ",", "p1", ",", "x$__"}], "]"}], "\[RuleDelayed]", 
    RowBox[{"Chain", "[", 
     RowBox[{"$angle", ",", "p3", ",", "x$"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"Chain", "[", 
     RowBox[{"type$_", ",", "x$_", ",", 
      RowBox[{"{", "y$__", "}"}], ",", "p1", ",", "$angle"}], "]"}], 
    "\[RuleDelayed]", 
    RowBox[{"Chain", "[", 
     RowBox[{"type$", ",", "x$", ",", 
      RowBox[{"{", "y$", "}"}], ",", "p3", ",", "$angle"}], "]"}]}], ",", 
   RowBox[{
    TemplateBox[{OverscriptBox["p2", "_"],"x$_"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "\[RuleDelayed]", 
    TemplateBox[{OverscriptBox["p4", "_"],"x$"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], ",", 
   RowBox[{
    RowBox[{"-", 
     TemplateBox[{OverscriptBox["p2", "_"],"x$_"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], "\[RuleDelayed]", 
    TemplateBox[{"x$",OverscriptBox["p4", "_"]},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], ",", 
   RowBox[{
    RowBox[{"Chain", "[", 
     RowBox[{"$angle", ",", 
      OverscriptBox["p2", "_"], ",", 
      RowBox[{"{", "y$__", "}"}], ",", 
      OverscriptBox["p2", "_"], ",", "$angle"}], "]"}], "\[RuleDelayed]", 
    RowBox[{"Chain", "[", 
     RowBox[{"$angle", ",", 
      OverscriptBox["p4", "_"], ",", 
      RowBox[{"{", "y$", "}"}], ",", 
      OverscriptBox["p4", "_"], ",", "$angle"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"Chain", "[", 
     RowBox[{"$angle", ",", 
      OverscriptBox["p2", "_"], ",", "x$__"}], "]"}], "\[RuleDelayed]", 
    RowBox[{"Chain", "[", 
     RowBox[{"$angle", ",", 
      OverscriptBox["p4", "_"], ",", "x$"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"Chain", "[", 
     RowBox[{"type$_", ",", "x$_", ",", 
      RowBox[{"{", "y$__", "}"}], ",", 
      OverscriptBox["p2", "_"], ",", "$angle"}], "]"}], "\[RuleDelayed]", 
    RowBox[{"Chain", "[", 
     RowBox[{"type$", ",", "x$", ",", 
      RowBox[{"{", "y$", "}"}], ",", 
      OverscriptBox["p4", "_"], ",", "$angle"}], "]"}]}], ",", 
   RowBox[{
    TemplateBox[{"p2","x$_"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "\[RuleDelayed]", 
    TemplateBox[{"p4","x$"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], ",", 
   RowBox[{
    RowBox[{"-", 
     TemplateBox[{"p2","x$_"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], "\[RuleDelayed]", 
    TemplateBox[{"x$","p4"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], ",", 
   RowBox[{
    RowBox[{"Chain", "[", 
     RowBox[{"$square", ",", "p2", ",", 
      RowBox[{"{", "y$__", "}"}], ",", "p2", ",", "$square"}], "]"}], 
    "\[RuleDelayed]", 
    RowBox[{"Chain", "[", 
     RowBox[{"$square", ",", "p4", ",", 
      RowBox[{"{", "y$", "}"}], ",", "p4", ",", "$square"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"Chain", "[", 
     RowBox[{"$angle", ",", "p2", ",", "x$__"}], "]"}], "\[RuleDelayed]", 
    RowBox[{"Chain", "[", 
     RowBox[{"$angle", ",", "p4", ",", "x$"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"Chain", "[", 
     RowBox[{"type$_", ",", "x$_", ",", 
      RowBox[{"{", "y$__", "}"}], ",", "p2", ",", "$square"}], "]"}], 
    "\[RuleDelayed]", 
    RowBox[{"Chain", "[", 
     RowBox[{"type$", ",", "x$", ",", 
      RowBox[{"{", "y$", "}"}], ",", "p4", ",", "$square"}], "]"}]}], ",", 
   RowBox[{
    TemplateBox[{OverscriptBox["p1", "_"],"x$_"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "\[RuleDelayed]", 
    TemplateBox[{OverscriptBox["p3", "_"],"x$"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], ",", 
   RowBox[{
    RowBox[{"-", 
     TemplateBox[{OverscriptBox["p1", "_"],"x$_"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], "\[RuleDelayed]", 
    TemplateBox[{"x$",OverscriptBox["p3", "_"]},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], ",", 
   RowBox[{
    RowBox[{"Chain", "[", 
     RowBox[{"$square", ",", 
      OverscriptBox["p1", "_"], ",", 
      RowBox[{"{", "y$__", "}"}], ",", 
      OverscriptBox["p1", "_"], ",", "$square"}], "]"}], "\[RuleDelayed]", 
    RowBox[{"Chain", "[", 
     RowBox[{"$square", ",", 
      OverscriptBox["p3", "_"], ",", 
      RowBox[{"{", "y$", "}"}], ",", 
      OverscriptBox["p3", "_"], ",", "$square"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"Chain", "[", 
     RowBox[{"$angle", ",", 
      OverscriptBox["p1", "_"], ",", "x$__"}], "]"}], "\[RuleDelayed]", 
    RowBox[{"Chain", "[", 
     RowBox[{"$angle", ",", 
      OverscriptBox["p3", "_"], ",", "x$"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"Chain", "[", 
     RowBox[{"type$_", ",", "x$_", ",", 
      RowBox[{"{", "y$__", "}"}], ",", 
      OverscriptBox["p1", "_"], ",", "$square"}], "]"}], "\[RuleDelayed]", 
    RowBox[{"Chain", "[", 
     RowBox[{"type$", ",", "x$", ",", 
      RowBox[{"{", "y$", "}"}], ",", 
      OverscriptBox["p3", "_"], ",", "$square"}], "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.794742981705466*^9, 3.7947431977800484`*^9, 3.794743252502516*^9, {
   3.794743426968634*^9, 3.794743442268041*^9}, 3.794743491866431*^9},
 CellLabel->"Out[87]=",ExpressionUUID->"377e8687-0f69-4186-9930-dd18f8794cde"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"subs", "=", "%"}], ";"}]], "Input",
 CellChangeTimes->{{3.794742984790598*^9, 3.794742987056305*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"9720ce4e-263c-4af3-a0d9-e2624ac3fa8b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1","p2"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "/.", "subs"}]], "Input",
 CellChangeTimes->{{3.7947429946877975`*^9, 3.794743002193528*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"812641f9-a261-4424-ad77-0d5b4bf8c812"],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{"p2","p3"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )]}]], "Output",
 CellChangeTimes->{3.7947430025974913`*^9},
 CellLabel->"Out[63]=",ExpressionUUID->"a3ed4462-8eab-47fa-add4-1196dde1d26d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"l2","p1"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "/.", "subs"}]], "Input",
 CellChangeTimes->{{3.794743018416253*^9, 3.7947430203951874`*^9}, {
  3.7947435523572764`*^9, 3.79474355273484*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"994f89a1-efac-4725-a2a9-827d93f52348"],

Cell[BoxData[
 TemplateBox[{"l2","p1"},
  "SpinorAngleBracket",
  DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
     RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
  InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
     RowBox[{#, ",", #2}], "]"}]& )]], "Output",
 CellChangeTimes->{3.79474302093896*^9, 3.794743553738566*^9},
 CellLabel->"Out[90]=",ExpressionUUID->"81215614-a60b-46ae-aab4-f4a2aac2cbec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", 
      RowBox[{"p2", ",", "p4", ",", "p5"}], "}"}],"p6"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "/.", "subs"}]], "Input",
 CellChangeTimes->{{3.794743030708416*^9, 3.794743051841158*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"defa50fe-5075-4ab8-b24a-bb3ce71ae058"],

Cell[BoxData[
 TemplateBox[{"p3",RowBox[{"{", 
     RowBox[{"p2", ",", "p4", ",", "p5"}], "}"}],"p6"},
  "AngleSquareChain",
  DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
     "]"}]& )]], "Output",
 CellChangeTimes->{{3.794743047862406*^9, 3.79474305219035*^9}},
 CellLabel->"Out[66]=",ExpressionUUID->"ae8b9975-a1a8-41a9-92f0-10e212934f09"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p4",RowBox[{"{", "p2", "}"}],"p1"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "/.", "subs"}]], "Input",
 CellChangeTimes->{{3.794743093494631*^9, 3.794743105779337*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"0f40204e-d207-4033-afbf-2784df0a14ff"],

Cell[BoxData[
 TemplateBox[{"p4",RowBox[{"{", "p2", "}"}],"p3"},
  "SquareAngleChain",
  DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.7947431062073307`*^9},
 CellLabel->"Out[67]=",ExpressionUUID->"7e886991-579d-4fb9-b570-8332f7ec94a4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", 
      RowBox[{"p2", ",", "p4"}], "}"}],"p1"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "/.", "subs"}]], "Input",
 CellChangeTimes->{{3.7947431131689515`*^9, 3.7947431418983183`*^9}, 
   3.794743204992247*^9},
 CellLabel->"In[81]:=",ExpressionUUID->"39f5f864-e400-48ac-92c0-c3855ea463a2"],

Cell[BoxData[
 TemplateBox[{"p3",RowBox[{"{", 
     RowBox[{"p2", ",", "p4"}], "}"}],"p3"},
  "AngleAngleChain",
  DisplayFunction->(
   RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
     "]"}]& )]], "Output",
 CellChangeTimes->{{3.7947431194446516`*^9, 3.7947431427168903`*^9}, {
   3.7947432057457223`*^9, 3.7947432084102793`*^9}, 3.7947432659455442`*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"4a655d33-3d5d-4d7d-aee2-9f09ac1ac7af"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2","p3"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "/.", "subs"}]], "Input",
 CellChangeTimes->{{3.7947435304402657`*^9, 3.794743534842942*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"da88dffa-3b50-49ea-9dfd-dbce88963141"],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{"p3","p4"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )]}]], "Output",
 CellChangeTimes->{3.7947435357197976`*^9},
 CellLabel->"Out[89]=",ExpressionUUID->"5fd05dc1-d63e-439c-bed2-517174d1ea7c"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Again, this time with feeling", "Subsubsection",
 CellChangeTimes->{{3.79474402357288*^9, 
  3.7947440290880165`*^9}},ExpressionUUID->"b20effb0-845a-41c6-890d-\
cd197ec1421e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SpinorReplace2", "[", 
    RowBox[{"exp_", ",", "reps_"}], "]"}], ":=", 
   RowBox[{"Catch", "[", 
    RowBox[{
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "locexp", ",", "locreps", ",", "agwrapper", ",", "sqwrapper", ",", 
         "SpinorAngleBracket", ",", "SpinorSquareBracket", ",", "Chain"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "First", " ", "sort", " ", "replacements", " ", "between", " ", 
          "angle", " ", "and", " ", "square"}], ",", " ", 
         RowBox[{
         "and", " ", "check", " ", "if", " ", "the", " ", "replacements", " ",
           "are", " ", "in", " ", "a", " ", "valid", " ", "form"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"AnyTrue", "[", 
           RowBox[{"reps", ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"!", 
                  RowBox[{"FreeQ", "[", 
                   RowBox[{"#", ",", "SpinorUndotPure"}], "]"}]}], "&&", 
                 RowBox[{"!", 
                  RowBox[{"FreeQ", "[", 
                   RowBox[{"#", ",", "SpinorDotPure"}], "]"}]}]}], ")"}], "||", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"FreeQ", "[", 
                  RowBox[{"#", ",", "SpinorUndotPure"}], "]"}], "&&", 
                 RowBox[{"FreeQ", "[", 
                  RowBox[{"#", ",", "SpinorDotPure"}], "]"}]}], ")"}]}], 
              "&"}], ")"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Throw", "[", 
            "\"\<Error in the replacements. Please check input.\>\"", "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Take", " ", "into", " ", "account", " ", "the", " ", "possible", 
          " ", "presence", " ", "of", " ", "\[Mu]", " ", "spinors"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"locreps", "=", 
         RowBox[{
          RowBox[{"{", "reps", "}"}], "//", "Flatten"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"locreps", "=", 
         RowBox[{"locreps", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"SpinorUndotPure", "[", "x_", "]"}], "[", "$mu", "]"}], 
             "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"SpinorUndotPure", "[", 
               RowBox[{"OverBar", "[", "x", "]"}], "]"}], "[", "$lam", 
              "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"SpinorDotPure", "[", "x_", "]"}], "[", "$mu", "]"}], 
             "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"SpinorDotPure", "[", 
               RowBox[{"OverBar", "[", "x", "]"}], "]"}], "[", "$lam", 
              "]"}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Introduces", " ", "two", " ", "wrappers", " ", "with", " ", 
          "respect", " ", "to", " ", "which", " ", "we", " ", "will", " ", 
          "define", " ", "the", " ", "properties", " ", "which", " ", 
          "perform", " ", "the", " ", "actual", " ", "replacement"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"locreps", "=", 
         RowBox[{"locreps", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"SpinorUndotPure", "[", "x_", "]"}], "[", "$lam", "]"}],
              "\[RuleDelayed]", 
             RowBox[{"agwrapper", "[", "x", "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"SpinorDotPure", "[", "x_", "]"}], "[", "$lam", "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"sqwrapper", "[", "x", "]"}]}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Now", " ", "we", " ", "trnasform", " ", "replacement", " ", "rules",
           " ", "for", " ", "the", " ", "wrappers", " ", "into", " ", 
          "equalities"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"locreps", "=", 
         RowBox[{"locreps", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Rule", "\[Rule]", "Set"}], ",", 
            RowBox[{"RuleDelayed", "\[Rule]", "Set"}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Finally", " ", "we", " ", "define", " ", "the", " ", "local", " ", 
           "properties", " ", "of", " ", "SpinorAngleBracket"}], ",", " ", 
          RowBox[{
          "SpinorSquareBracket", " ", "and", " ", "Chain", " ", "in", " ", 
           "terms", " ", "of", " ", "the", " ", "wrappers"}]}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SpinorAngleBracket", "[", 
          RowBox[{
           RowBox[{"a_", "+", 
            RowBox[{"b_", "*", 
             RowBox[{"agwrapper", "[", "x_", "]"}]}]}], ",", "c_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"a", ",", "c"}], "]"}], "+", 
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{
            RowBox[{"b", "*", 
             RowBox[{"agwrapper", "[", "x", "]"}]}], ",", "c"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SpinorAngleBracket", "[", 
          RowBox[{"c_", ",", 
           RowBox[{"a_", "+", 
            RowBox[{"b_", "*", 
             RowBox[{"agwrapper", "[", "x_", "]"}]}]}]}], "]"}], ":=", 
         RowBox[{
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"c", ",", "a"}], "]"}], "+", 
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"c", ",", 
            RowBox[{"b", "*", 
             RowBox[{"agwrapper", "[", "x", "]"}]}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SpinorAngleBracket", "[", 
          RowBox[{
           RowBox[{"Times", "[", 
            RowBox[{"a_", ",", 
             RowBox[{"agwrapper", "[", "x_", "]"}]}], "]"}], ",", "b_"}], 
          "]"}], ":=", 
         RowBox[{"a", "*", 
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{
            RowBox[{"agwrapper", "[", "x", "]"}], ",", "b"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SpinorAngleBracket", "[", 
          RowBox[{"b_", ",", 
           RowBox[{"Times", "[", 
            RowBox[{"a_", ",", 
             RowBox[{"agwrapper", "[", "x_", "]"}]}], "]"}]}], "]"}], ":=", 
         RowBox[{"a", "*", 
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"b", ",", 
            RowBox[{"agwrapper", "[", "x", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SpinorSquareBracket", "[", 
          RowBox[{
           RowBox[{"a_", "+", 
            RowBox[{"b_", "*", 
             RowBox[{"sqwrapper", "[", "x_", "]"}]}]}], ",", "c_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"a", ",", "c"}], "]"}], "+", 
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{
            RowBox[{"b", "*", 
             RowBox[{"sqwrapper", "[", "x", "]"}]}], ",", "c"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SpinorSquareBracket", "[", 
          RowBox[{"c_", ",", 
           RowBox[{"a_", "+", 
            RowBox[{"b_", "*", 
             RowBox[{"sqwrapper", "[", "x_", "]"}]}]}]}], "]"}], ":=", 
         RowBox[{
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"c", ",", "a"}], "]"}], "+", 
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"c", ",", 
            RowBox[{"b", "*", 
             RowBox[{"sqwrapper", "[", "x", "]"}]}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SpinorSquareBracket", "[", 
          RowBox[{
           RowBox[{"Times", "[", 
            RowBox[{"a_", ",", 
             RowBox[{"sqwrapper", "[", "x_", "]"}]}], "]"}], ",", "b_"}], 
          "]"}], ":=", 
         RowBox[{"a", "*", 
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{
            RowBox[{"sqwrapper", "[", "x", "]"}], ",", "b"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SpinorSquareBracket", "[", 
          RowBox[{"b_", ",", 
           RowBox[{"Times", "[", 
            RowBox[{"a_", ",", 
             RowBox[{"sqwrapper", "[", "x_", "]"}]}], "]"}]}], "]"}], ":=", 
         RowBox[{"a", "*", 
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"b", ",", 
            RowBox[{"sqwrapper", "[", "x", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Chain", "[", 
          RowBox[{"$angle", ",", 
           RowBox[{"a_", "+", 
            RowBox[{"b_", "*", 
             RowBox[{"agwrapper", "[", "x_", "]"}]}]}], ",", 
           RowBox[{"{", "y__", "}"}], ",", "z_", ",", "type_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"Chain", "[", 
           RowBox[{"$angle", ",", "a", ",", 
            RowBox[{"{", "y", "}"}], ",", "z", ",", "type"}], "]"}], "+", 
          RowBox[{"b", "*", 
           RowBox[{"Chain", "[", 
            RowBox[{"$angle", ",", 
             RowBox[{"agwrapper", "[", "x", "]"}], ",", 
             RowBox[{"{", "y", "}"}], ",", "z", ",", "type"}], "]"}]}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Chain", "[", 
          RowBox[{"$angle", ",", 
           RowBox[{"Times", "[", 
            RowBox[{"b_", ",", 
             RowBox[{"agwrapper", "[", "x_", "]"}]}], "]"}], ",", 
           RowBox[{"{", "y__", "}"}], ",", "z_", ",", "type_"}], "]"}], ":=", 
         RowBox[{"b", "*", 
          RowBox[{"Chain", "[", 
           RowBox[{"$angle", ",", 
            RowBox[{"agwrapper", "[", "x", "]"}], ",", 
            RowBox[{"{", "y", "}"}], ",", "z", ",", "type"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Chain", "[", 
          RowBox[{"type_", ",", "z_", ",", 
           RowBox[{"{", "y__", "}"}], ",", 
           RowBox[{"a_", "+", 
            RowBox[{"b_", "*", 
             RowBox[{"agwrapper", "[", "x_", "]"}]}]}], ",", "$angle"}], 
          "]"}], ":=", 
         RowBox[{
          RowBox[{"Chain", "[", 
           RowBox[{"type", ",", "z", ",", 
            RowBox[{"{", "y", "}"}], ",", "a", ",", "$angle"}], "]"}], "+", 
          RowBox[{"b", "*", 
           RowBox[{"Chain", "[", 
            RowBox[{"type", ",", "z", ",", 
             RowBox[{"{", "y", "}"}], ",", 
             RowBox[{"agwrapper", "[", "x", "]"}], ",", "$angle"}], 
            "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Chain", "[", 
          RowBox[{"type_", ",", "z_", ",", 
           RowBox[{"{", "y__", "}"}], ",", 
           RowBox[{"Times", "[", 
            RowBox[{"b_", ",", 
             RowBox[{"agwrapper", "[", "x_", "]"}]}], "]"}], ",", "$angle"}], 
          "]"}], ":=", 
         RowBox[{"b", "*", 
          RowBox[{"Chain", "[", 
           RowBox[{"type", ",", "z", ",", 
            RowBox[{"{", "y", "}"}], ",", 
            RowBox[{"agwrapper", "[", "x", "]"}], ",", "$angle"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Chain", "[", 
          RowBox[{"$square", ",", 
           RowBox[{"a_", "+", 
            RowBox[{"b_", "*", 
             RowBox[{"sqwrapper", "[", "x_", "]"}]}]}], ",", 
           RowBox[{"{", "y__", "}"}], ",", "z_", ",", "type_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"Chain", "[", 
           RowBox[{"$square", ",", "a", ",", 
            RowBox[{"{", "y", "}"}], ",", "z", ",", "type"}], "]"}], "+", 
          RowBox[{"b", "*", 
           RowBox[{"Chain", "[", 
            RowBox[{"$square", ",", 
             RowBox[{"sqwrapper", "[", "x", "]"}], ",", 
             RowBox[{"{", "y", "}"}], ",", "z", ",", "type"}], "]"}]}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Chain", "[", 
          RowBox[{"$square", ",", 
           RowBox[{"Times", "[", 
            RowBox[{"b_", ",", 
             RowBox[{"sqwrapper", "[", "x_", "]"}]}], "]"}], ",", 
           RowBox[{"{", "y__", "}"}], ",", "z_", ",", "type_"}], "]"}], ":=", 
         RowBox[{"b", "*", 
          RowBox[{"Chain", "[", 
           RowBox[{"$square", ",", 
            RowBox[{"sqwrapper", "[", "x", "]"}], ",", 
            RowBox[{"{", "y", "}"}], ",", "z", ",", "type"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Chain", "[", 
          RowBox[{"type_", ",", "z_", ",", 
           RowBox[{"{", "y__", "}"}], ",", 
           RowBox[{"a_", "+", 
            RowBox[{"b_", "*", 
             RowBox[{"sqwrapper", "[", "x_", "]"}]}]}], ",", "$square"}], 
          "]"}], ":=", 
         RowBox[{
          RowBox[{"Chain", "[", 
           RowBox[{"type", ",", "z", ",", 
            RowBox[{"{", "y", "}"}], ",", "a", ",", "$square"}], "]"}], "+", 
          RowBox[{"b", "*", 
           RowBox[{"Chain", "[", 
            RowBox[{"type", ",", "z", ",", 
             RowBox[{"{", "y", "}"}], ",", 
             RowBox[{"sqwrapper", "[", "x", "]"}], ",", "$square"}], 
            "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Chain", "[", 
          RowBox[{"type_", ",", "z_", ",", 
           RowBox[{"{", "y__", "}"}], ",", 
           RowBox[{"Times", "[", 
            RowBox[{"b_", ",", 
             RowBox[{"sqwrapper", "[", "x_", "]"}]}], "]"}], ",", "$square"}],
           "]"}], ":=", 
         RowBox[{"b", "*", 
          RowBox[{"Chain", "[", 
           RowBox[{"type", ",", "z", ",", 
            RowBox[{"{", "y", "}"}], ",", 
            RowBox[{"sqwrapper", "[", "x", "]"}], ",", "$square"}], "]"}]}]}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Finally", " ", "replace", " ", "the", " ", "arguments", " ", "of", 
           " ", "SpinorAngleBracket"}], ",", " ", 
          RowBox[{
          "SpinorSquareBracket", " ", "and", " ", "Chain", " ", "with", " ", 
           "the", " ", "wrapped", " ", "argumenst"}]}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"locexp", "=", 
         RowBox[{"exp", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"SpinorAngleBracket", "[", 
              RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
             RowBox[{"SpinorAngleBracket", "[", 
              RowBox[{
               RowBox[{"agwrapper", "[", "x", "]"}], ",", 
               RowBox[{"agwrapper", "[", "y", "]"}]}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"SpinorSquareBracket", "[", 
              RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
             RowBox[{"SpinorSquareBracket", "[", 
              RowBox[{
               RowBox[{"sqwrapper", "[", "x", "]"}], ",", 
               RowBox[{"sqwrapper", "[", "y", "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Chain", "[", 
              RowBox[{"$angle", ",", "x_", ",", 
               RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$angle"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"Chain", "[", 
              RowBox[{"$angle", ",", 
               RowBox[{"agwrapper", "[", "x", "]"}], ",", 
               RowBox[{"{", "y", "}"}], ",", 
               RowBox[{"agwrapper", "[", "z", "]"}], ",", "$angle"}], "]"}]}],
             ",", 
            RowBox[{
             RowBox[{"Chain", "[", 
              RowBox[{"$square", ",", "x_", ",", 
               RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$square"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"Chain", "[", 
              RowBox[{"$square", ",", 
               RowBox[{"sqwrapper", "[", "x", "]"}], ",", 
               RowBox[{"{", "y", "}"}], ",", 
               RowBox[{"sqwrapper", "[", "z", "]"}], ",", "$square"}], 
              "]"}]}], ",", 
            RowBox[{
             RowBox[{"Chain", "[", 
              RowBox[{"$angle", ",", "x_", ",", 
               RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$square"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"Chain", "[", 
              RowBox[{"$angle", ",", 
               RowBox[{"agwrapper", "[", "x", "]"}], ",", 
               RowBox[{"{", "y", "}"}], ",", 
               RowBox[{"sqwrapper", "[", "z", "]"}], ",", "$square"}], 
              "]"}]}], ",", 
            RowBox[{
             RowBox[{"Chain", "[", 
              RowBox[{"$square", ",", "x_", ",", 
               RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$angle"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"Chain", "[", 
              RowBox[{"$square", ",", 
               RowBox[{"sqwrapper", "[", "x", "]"}], ",", 
               RowBox[{"{", "y", "}"}], ",", 
               RowBox[{"agwrapper", "[", "z", "]"}], ",", "$angle"}], 
              "]"}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Properties", " ", "will", " ", "be", " ", "automatically", " ", 
          "applied", " ", "so", " ", "we", " ", "can", " ", "now", " ", 
          "just", " ", "remove", " ", "the", " ", "wrappers", " ", "and", " ",
           "return", " ", "the", " ", 
          RowBox[{"output", "."}]}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"locexp", "=", 
         RowBox[{"locexp", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"agwrapper", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], 
            ",", 
            RowBox[{
             RowBox[{"sqwrapper", "[", "x_", "]"}], "\[RuleDelayed]", "x"}]}],
            "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "locexp", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwd0F1IUwEYxvEV5g4UfdDQoKJWVNtNjLQmVPjVFJE6cwiR0FqHeSc2GohJ
UgwaizlFpHDRINQMk0JjZV5MRTpEOkMF58SysLKcK8QGraTW/ufi5XfzPBfP
q5WuWKo3qlQqXfowUvxG+9kUL9wV0hzC0qKYHi0dp4rRrRZLUdJoz+GjPVYL
llyN21Gs01/H5Qa5EY+Oe9txNbfEj8Jk9QN8KiYVax2F3Tg5teUFbhseCeGC
9EtGuUWcx/CAS9FVkVxEzzX5L56w3cj8kjayfkGNVSnzYeyclnQYz95swILG
YAHWJ06bselnewWKG+x2dFtjihltOU6sid6uw8x9Uz7F0cVm9BjO30VdYDSA
Q/ktXeicNfbjSmz7c3R5Wwdx8GQ4hLblshEMqXNfYcpnnMZuszSL0j1jFBsG
oqv4ZGFuDR37TUn8Nz/zG2+1aVPKznDGpqW07w0fBQzq/TtwKaHKwt19E9ko
5EcuYrJnzYaBSlMt9o3ddCs9W7MXna/9PjzmcbRiYudEL35fufMB6yvHfyi5
ocQ6lm+1ar6mfTxcvhfN/T0GzAoKx7FKvpyHB5o8bjx7X/iEeQ8PnvnGv4/0
Kr59d+kZjv0peon/AX1HYLo=
  "],
 CellLabel->"In[35]:=",ExpressionUUID->"9e556019-9ef6-4937-82fd-bd5fdcc6808b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     TemplateBox[{"p1"},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
     TemplateBox[{"p3"},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], ",", 
    RowBox[{
     TemplateBox[{"p2"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
     TemplateBox[{"p4"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], ",", 
    RowBox[{
     TemplateBox[{"p2"},
      "SpinorUndotPureM",
      DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
     TemplateBox[{"p4"},
      "SpinorUndotPureM",
      DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )]}], ",", 
    RowBox[{
     TemplateBox[{"p1"},
      "SpinorDotPureM",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
     TemplateBox[{"p3"},
      "SpinorDotPureM",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )]}], ",", 
    RowBox[{
     TemplateBox[{"p5"},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], 
     "\[Rule]", 
     RowBox[{"3", "*", 
      TemplateBox[{"p7"},
       "SpinorUndotPureL",
       DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], 
    ",", 
    RowBox[{
     TemplateBox[{"p6"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
     RowBox[{
      TemplateBox[{"p7"},
       "SpinorDotPureL",
       DisplayFunction->(RowBox[{
          OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "+", 
      TemplateBox[{"p8"},
       "SpinorDotPureL",
       DisplayFunction->(RowBox[{
          OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.7947394073190117`*^9, 3.7947394360391407`*^9}, {
  3.7947406606602736`*^9, 3.7947406964746857`*^9}, {3.794741237824665*^9, 
  3.794741279676182*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"c180b566-63b1-4cc4-9379-68bd2c463628"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    TemplateBox[{"p1"},
     "SpinorUndotPureL",
     DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], 
    "\[Rule]", 
    TemplateBox[{"p3"},
     "SpinorUndotPureL",
     DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], ",", 
   RowBox[{
    TemplateBox[{"p2"},
     "SpinorDotPureL",
     DisplayFunction->(RowBox[{
        OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "\[Rule]", 
    TemplateBox[{"p4"},
     "SpinorDotPureL",
     DisplayFunction->(RowBox[{
        OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], ",", 
   RowBox[{
    TemplateBox[{"p2"},
     "SpinorUndotPureM",
     DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], 
    "\[Rule]", 
    TemplateBox[{"p4"},
     "SpinorUndotPureM",
     DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )]}], ",", 
   RowBox[{
    TemplateBox[{"p1"},
     "SpinorDotPureM",
     DisplayFunction->(RowBox[{
        OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "\[Rule]", 
    TemplateBox[{"p3"},
     "SpinorDotPureM",
     DisplayFunction->(RowBox[{
        OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )]}], ",", 
   RowBox[{
    TemplateBox[{"p5"},
     "SpinorUndotPureL",
     DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], 
    "\[Rule]", 
    RowBox[{"3", " ", 
     TemplateBox[{"p7"},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], 
   ",", 
   RowBox[{
    TemplateBox[{"p6"},
     "SpinorDotPureL",
     DisplayFunction->(RowBox[{
        OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "\[Rule]", 
    RowBox[{
     TemplateBox[{"p7"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "+", 
     TemplateBox[{"p8"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.794739436478999*^9, 3.7947406975382586`*^9, 
  3.794741280249055*^9, 3.794746371210066*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"d6e96c58-bfac-42c9-8dfb-93bd5744baf1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"applytest", "[", "x_", "]"}], ":=", 
  RowBox[{"SpinorReplace2", "[", 
   RowBox[{"x", ",", "test"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.794747249151062*^9, 3.794747264137354*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"4789b337-adce-4ca7-a7d6-98b03ef54186"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1","p2"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applytest"}]], "Input",
 CellChangeTimes->{{3.794747189036724*^9, 3.794747204559988*^9}, {
  3.7947472712754984`*^9, 3.7947472768944645`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"ba8d6a80-e24b-4116-9c86-46bec5012512"],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{"p2","p3"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )]}]], "Output",
 CellChangeTimes->{3.7947472064011993`*^9, 3.7947472771786613`*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"c2125519-2b9d-4505-bbe3-9866d45b87dd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"l1","p1"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applytest"}]], "Input",
 CellChangeTimes->{{3.794747280208789*^9, 3.7947472924830294`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"34fc820f-b6d5-4bd2-a019-fb8a6c8273e5"],

Cell[BoxData[
 TemplateBox[{"l1","p3"},
  "SpinorAngleBracket",
  DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
     RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
  InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
     RowBox[{#, ",", #2}], "]"}]& )]], "Output",
 CellChangeTimes->{3.7947472927955627`*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"0b055f64-9250-4ef5-82eb-5a16bb36e758"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Other version, also allows to replace spinors with matrices times spinors. \
Also linearity does not really work!\
\>", "Subsubsection",
 CellChangeTimes->{{3.795405800245426*^9, 3.7954058288469753`*^9}, {
  3.795427366834747*^9, 3.795427367907858*^9}, {3.7954274719106445`*^9, 
  3.795427479260027*^9}},ExpressionUUID->"6e5ccadb-139c-4204-9d58-\
79f0eac40f9f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"N", ".", "B", ".", " ", "The"}], " ", "matrix", " ", 
         "replacements", " ", "are", " ", "intended", " ", "as", " ", 
         "defined", " ", "on"}], " ", "|", "\[Lambda]"}], 
       "\[RightAngleBracket]"}], " ", "and", " ", "on"}], " ", "|", 
     "\[Lambda]"}], "]"}], ",", " ", 
   RowBox[{"so", " ", "when", " ", "applying", " ", "to", " ", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[Lambda]", "|", " ", 
      RowBox[{"and", " ", "[", 
       RowBox[{"\[Lambda]", "|", " ", 
        RowBox[{
        "minus", " ", "signs", " ", "appear", " ", "when", " ", "the", " ", 
         "number", " ", "of", " ", "matrices", " ", "applied", " ", "is", " ",
          "odd"}]}]}]}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7954257871860456`*^9, 
  3.7954258540482073`*^9}},ExpressionUUID->"46efc746-98ba-4fcb-b6e8-\
a5b51e546c0d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SpinorReplace2", "[", 
    RowBox[{"exp_", ",", "reps_"}], "]"}], ":=", 
   RowBox[{"Catch", "[", 
    RowBox[{
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "locexp", ",", "locreps", ",", "agwrapper", ",", "sqwrapper", ",", 
         "SpinorAngleBracket", ",", "SpinorSquareBracket", ",", "Chain", ",", 
         "special", ",", "dot"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "First", " ", "isolate", " ", "the", " ", "replacements", " ", 
          "containing", " ", "matrices", " ", "which", " ", "will", " ", 
          "get", " ", "special", " ", "treatment"}], ",", " ", 
         RowBox[{
         "and", " ", "check", " ", "if", " ", "the", " ", "replacements", " ",
           "are", " ", "in", " ", "a", " ", "valid", " ", "form"}]}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"locreps", "=", 
         RowBox[{
          RowBox[{"{", "reps", "}"}], "//", "Flatten"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"special", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"locreps", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"FreeQ", "[", 
               RowBox[{"#", ",", "Dot"}], "]"}]}], "&"}], ")"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"locreps", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"locreps", ",", 
           RowBox[{
            RowBox[{"FreeQ", "[", 
             RowBox[{"#", ",", "Dot"}], "]"}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "The", " ", "special", " ", "replacements", " ", "are", " ", 
           "actually", " ", "not", " ", "tested", " ", "since", " ", "the", 
           " ", "number", " ", "of", " ", "possible", " ", "options", " ", 
           "is", " ", "to", " ", "large", " ", "and", " ", "the", " ", "test",
            " ", "would", " ", "become", " ", "time", " ", "consuming"}], 
          "..."}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Take", " ", "into", " ", "account", " ", "the", " ", "possible", 
          " ", "presence", " ", "of", " ", "\[Mu]", " ", "spinors"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"locreps", "=", 
         RowBox[{"locreps", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"SpinorUndotPure", "[", "x_", "]"}], "[", "$mu", "]"}], 
             "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"SpinorUndotPure", "[", 
               RowBox[{"OverBar", "[", "x", "]"}], "]"}], "[", "$lam", 
              "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"SpinorDotPure", "[", "x_", "]"}], "[", "$mu", "]"}], 
             "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"SpinorDotPure", "[", 
               RowBox[{"OverBar", "[", "x", "]"}], "]"}], "[", "$lam", 
              "]"}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Introduces", " ", "two", " ", "wrappers", " ", "with", " ", 
          "respect", " ", "to", " ", "which", " ", "we", " ", "will", " ", 
          "define", " ", "the", " ", "properties", " ", "which", " ", 
          "perform", " ", "the", " ", "actual", " ", "replacement"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"locreps", "=", 
         RowBox[{"locreps", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"SpinorUndotPure", "[", "x_", "]"}], "[", "$lam", "]"}],
              "\[RuleDelayed]", 
             RowBox[{"agwrapper", "[", "x", "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"SpinorDotPure", "[", "x_", "]"}], "[", "$lam", "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"sqwrapper", "[", "x", "]"}]}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Test", " ", "the", " ", "correcteness", " ", "of", " ", "the", " ", 
          "replacements"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"AnyTrue", "[", 
           RowBox[{"locreps", ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"FreeQ", "[", 
                  RowBox[{"#", ",", "agwrapper"}], "]"}], "&&", 
                 RowBox[{"FreeQ", "[", 
                  RowBox[{"#", ",", "sqwrapper"}], "]"}]}], ")"}], "||", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"!", 
                  RowBox[{"FreeQ", "[", 
                   RowBox[{"#", ",", "agwrapper"}], "]"}]}], "&&", 
                 RowBox[{"!", 
                  RowBox[{"FreeQ", "[", 
                   RowBox[{"#", ",", "sqwrapper"}], "]"}]}]}], ")"}]}], "&"}],
              ")"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Throw", "[", 
            "\"\<Some replacements are given in an unknown form. Please check \
input.\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Now", " ", "we", " ", "trnasform", " ", "replacement", " ", "rules",
           " ", "for", " ", "the", " ", "wrappers", " ", "into", " ", 
          "equalities"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"locreps", "=", 
         RowBox[{"locreps", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Rule", "\[Rule]", "Set"}], ",", 
            RowBox[{"RuleDelayed", "\[Rule]", "Set"}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Finally", " ", "we", " ", "define", " ", "the", " ", "local", " ", 
           "properties", " ", "of", " ", "SpinorAngleBracket"}], ",", " ", 
          RowBox[{
          "SpinorSquareBracket", " ", "and", " ", "Chain", " ", "in", " ", 
           "terms", " ", "of", " ", "the", " ", "wrappers"}]}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SpinorAngleBracket", "[", 
          RowBox[{
           RowBox[{"a_", "+", 
            RowBox[{"b_", "*", 
             RowBox[{"agwrapper", "[", "x_", "]"}]}]}], ",", "c_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"a", ",", "c"}], "]"}], "+", 
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{
            RowBox[{"b", "*", 
             RowBox[{"agwrapper", "[", "x", "]"}]}], ",", "c"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SpinorAngleBracket", "[", 
          RowBox[{"c_", ",", 
           RowBox[{"a_", "+", 
            RowBox[{"b_", "*", 
             RowBox[{"agwrapper", "[", "x_", "]"}]}]}]}], "]"}], ":=", 
         RowBox[{
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"c", ",", "a"}], "]"}], "+", 
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"c", ",", 
            RowBox[{"b", "*", 
             RowBox[{"agwrapper", "[", "x", "]"}]}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SpinorAngleBracket", "[", 
          RowBox[{
           RowBox[{"Times", "[", 
            RowBox[{"a_", ",", 
             RowBox[{"agwrapper", "[", "x_", "]"}]}], "]"}], ",", "b_"}], 
          "]"}], ":=", 
         RowBox[{"a", "*", 
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{
            RowBox[{"agwrapper", "[", "x", "]"}], ",", "b"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SpinorAngleBracket", "[", 
          RowBox[{"b_", ",", 
           RowBox[{"Times", "[", 
            RowBox[{"a_", ",", 
             RowBox[{"agwrapper", "[", "x_", "]"}]}], "]"}]}], "]"}], ":=", 
         RowBox[{"a", "*", 
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"b", ",", 
            RowBox[{"agwrapper", "[", "x", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SpinorSquareBracket", "[", 
          RowBox[{
           RowBox[{"a_", "+", 
            RowBox[{"b_", "*", 
             RowBox[{"sqwrapper", "[", "x_", "]"}]}]}], ",", "c_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"a", ",", "c"}], "]"}], "+", 
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{
            RowBox[{"b", "*", 
             RowBox[{"sqwrapper", "[", "x", "]"}]}], ",", "c"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SpinorSquareBracket", "[", 
          RowBox[{"c_", ",", 
           RowBox[{"a_", "+", 
            RowBox[{"b_", "*", 
             RowBox[{"sqwrapper", "[", "x_", "]"}]}]}]}], "]"}], ":=", 
         RowBox[{
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"c", ",", "a"}], "]"}], "+", 
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"c", ",", 
            RowBox[{"b", "*", 
             RowBox[{"sqwrapper", "[", "x", "]"}]}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SpinorSquareBracket", "[", 
          RowBox[{
           RowBox[{"Times", "[", 
            RowBox[{"a_", ",", 
             RowBox[{"sqwrapper", "[", "x_", "]"}]}], "]"}], ",", "b_"}], 
          "]"}], ":=", 
         RowBox[{"a", "*", 
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{
            RowBox[{"sqwrapper", "[", "x", "]"}], ",", "b"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SpinorSquareBracket", "[", 
          RowBox[{"b_", ",", 
           RowBox[{"Times", "[", 
            RowBox[{"a_", ",", 
             RowBox[{"sqwrapper", "[", "x_", "]"}]}], "]"}]}], "]"}], ":=", 
         RowBox[{"a", "*", 
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"b", ",", 
            RowBox[{"sqwrapper", "[", "x", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Chain", "[", 
          RowBox[{"$angle", ",", 
           RowBox[{"a_", "+", 
            RowBox[{"b_", "*", 
             RowBox[{"agwrapper", "[", "x_", "]"}]}]}], ",", 
           RowBox[{"{", "y__", "}"}], ",", "z_", ",", "type_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"Chain", "[", 
           RowBox[{"$angle", ",", "a", ",", 
            RowBox[{"{", "y", "}"}], ",", "z", ",", "type"}], "]"}], "+", 
          RowBox[{"b", "*", 
           RowBox[{"Chain", "[", 
            RowBox[{"$angle", ",", 
             RowBox[{"agwrapper", "[", "x", "]"}], ",", 
             RowBox[{"{", "y", "}"}], ",", "z", ",", "type"}], "]"}]}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Chain", "[", 
          RowBox[{"$angle", ",", 
           RowBox[{"Times", "[", 
            RowBox[{"b_", ",", 
             RowBox[{"agwrapper", "[", "x_", "]"}]}], "]"}], ",", 
           RowBox[{"{", "y__", "}"}], ",", "z_", ",", "type_"}], "]"}], ":=", 
         RowBox[{"b", "*", 
          RowBox[{"Chain", "[", 
           RowBox[{"$angle", ",", 
            RowBox[{"agwrapper", "[", "x", "]"}], ",", 
            RowBox[{"{", "y", "}"}], ",", "z", ",", "type"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Chain", "[", 
          RowBox[{"type_", ",", "z_", ",", 
           RowBox[{"{", "y__", "}"}], ",", 
           RowBox[{"a_", "+", 
            RowBox[{"b_", "*", 
             RowBox[{"agwrapper", "[", "x_", "]"}]}]}], ",", "$angle"}], 
          "]"}], ":=", 
         RowBox[{
          RowBox[{"Chain", "[", 
           RowBox[{"type", ",", "z", ",", 
            RowBox[{"{", "y", "}"}], ",", "a", ",", "$angle"}], "]"}], "+", 
          RowBox[{"b", "*", 
           RowBox[{"Chain", "[", 
            RowBox[{"type", ",", "z", ",", 
             RowBox[{"{", "y", "}"}], ",", 
             RowBox[{"agwrapper", "[", "x", "]"}], ",", "$angle"}], 
            "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Chain", "[", 
          RowBox[{"type_", ",", "z_", ",", 
           RowBox[{"{", "y__", "}"}], ",", 
           RowBox[{"Times", "[", 
            RowBox[{"b_", ",", 
             RowBox[{"agwrapper", "[", "x_", "]"}]}], "]"}], ",", "$angle"}], 
          "]"}], ":=", 
         RowBox[{"b", "*", 
          RowBox[{"Chain", "[", 
           RowBox[{"type", ",", "z", ",", 
            RowBox[{"{", "y", "}"}], ",", 
            RowBox[{"agwrapper", "[", "x", "]"}], ",", "$angle"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Chain", "[", 
          RowBox[{"$square", ",", 
           RowBox[{"a_", "+", 
            RowBox[{"b_", "*", 
             RowBox[{"sqwrapper", "[", "x_", "]"}]}]}], ",", 
           RowBox[{"{", "y__", "}"}], ",", "z_", ",", "type_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"Chain", "[", 
           RowBox[{"$square", ",", "a", ",", 
            RowBox[{"{", "y", "}"}], ",", "z", ",", "type"}], "]"}], "+", 
          RowBox[{"b", "*", 
           RowBox[{"Chain", "[", 
            RowBox[{"$square", ",", 
             RowBox[{"sqwrapper", "[", "x", "]"}], ",", 
             RowBox[{"{", "y", "}"}], ",", "z", ",", "type"}], "]"}]}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Chain", "[", 
          RowBox[{"$square", ",", 
           RowBox[{"Times", "[", 
            RowBox[{"b_", ",", 
             RowBox[{"sqwrapper", "[", "x_", "]"}]}], "]"}], ",", 
           RowBox[{"{", "y__", "}"}], ",", "z_", ",", "type_"}], "]"}], ":=", 
         RowBox[{"b", "*", 
          RowBox[{"Chain", "[", 
           RowBox[{"$square", ",", 
            RowBox[{"sqwrapper", "[", "x", "]"}], ",", 
            RowBox[{"{", "y", "}"}], ",", "z", ",", "type"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Chain", "[", 
          RowBox[{"type_", ",", "z_", ",", 
           RowBox[{"{", "y__", "}"}], ",", 
           RowBox[{"a_", "+", 
            RowBox[{"b_", "*", 
             RowBox[{"sqwrapper", "[", "x_", "]"}]}]}], ",", "$square"}], 
          "]"}], ":=", 
         RowBox[{
          RowBox[{"Chain", "[", 
           RowBox[{"type", ",", "z", ",", 
            RowBox[{"{", "y", "}"}], ",", "a", ",", "$square"}], "]"}], "+", 
          RowBox[{"b", "*", 
           RowBox[{"Chain", "[", 
            RowBox[{"type", ",", "z", ",", 
             RowBox[{"{", "y", "}"}], ",", 
             RowBox[{"sqwrapper", "[", "x", "]"}], ",", "$square"}], 
            "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Chain", "[", 
          RowBox[{"type_", ",", "z_", ",", 
           RowBox[{"{", "y__", "}"}], ",", 
           RowBox[{"Times", "[", 
            RowBox[{"b_", ",", 
             RowBox[{"sqwrapper", "[", "x_", "]"}]}], "]"}], ",", "$square"}],
           "]"}], ":=", 
         RowBox[{"b", "*", 
          RowBox[{"Chain", "[", 
           RowBox[{"type", ",", "z", ",", 
            RowBox[{"{", "y", "}"}], ",", 
            RowBox[{"sqwrapper", "[", "x", "]"}], ",", "$square"}], "]"}]}]}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "If", " ", "there", " ", "are", " ", "special", " ", "replecements", 
          " ", "perform", " ", "the", " ", "same", " ", "operations", " ", 
          "for", " ", "them"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "special", "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "First", " ", "we", " ", "replace", " ", "Dot", " ", "with", " ", 
             "a", " ", "local", " ", "defined", " ", "dot", " ", "symbol"}], 
            ",", " ", 
            RowBox[{
            "because", " ", "Dot", " ", "has", " ", "some", " ", "properties",
              " ", "which", " ", "screw", " ", "up", " ", "our", " ", 
             "pattern", " ", "matching", " ", "later", " ", "on"}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"special", "=", 
            RowBox[{"special", "/.", 
             RowBox[{"{", 
              RowBox[{"Dot", "\[Rule]", "dot"}], "}"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Take", " ", "into", " ", "account", " ", "\[Mu]", " ", 
             "spinors"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"special", "=", 
            RowBox[{"special", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"SpinorUndotPure", "[", "x_", "]"}], "[", "$mu", 
                 "]"}], "\[RuleDelayed]", 
                RowBox[{
                 RowBox[{"SpinorUndotPure", "[", 
                  RowBox[{"OverBar", "[", "x", "]"}], "]"}], "[", "$lam", 
                 "]"}]}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"SpinorDotPure", "[", "x_", "]"}], "[", "$mu", "]"}],
                 "\[RuleDelayed]", 
                RowBox[{
                 RowBox[{"SpinorDotPure", "[", 
                  RowBox[{"OverBar", "[", "x", "]"}], "]"}], "[", "$lam", 
                 "]"}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Introduce", " ", "the", " ", "wrapper"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"special", "=", 
            RowBox[{"special", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"SpinorUndotPure", "[", "x_", "]"}], "[", "$lam", 
                 "]"}], "\[RuleDelayed]", 
                RowBox[{"agwrapper", "[", "x", "]"}]}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"SpinorDotPure", "[", "x_", "]"}], "[", "$lam", 
                 "]"}], "\[RuleDelayed]", 
                RowBox[{"sqwrapper", "[", "x", "]"}]}]}], "}"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Test", " ", "the", " ", "correcteness", " ", "of", " ", "the", 
             " ", "replacements"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"AnyTrue", "[", 
              RowBox[{"special", ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"FreeQ", "[", 
                    RowBox[{"#", ",", "agwrapper"}], "]"}], "&&", 
                    RowBox[{"FreeQ", "[", 
                    RowBox[{"#", ",", "sqwrapper"}], "]"}]}], ")"}], "||", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"!", 
                    RowBox[{"FreeQ", "[", 
                    RowBox[{"#", ",", "agwrapper"}], "]"}]}], "&&", 
                    RowBox[{"!", 
                    RowBox[{"FreeQ", "[", 
                    RowBox[{"#", ",", "sqwrapper"}], "]"}]}]}], ")"}]}], 
                 "&"}], ")"}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "Throw", "[", 
               "\"\<Some replacements are given in an unknown form. Please \
check input.\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Take", " ", "into", " ", "account", " ", "the", " ", "matrix", 
             " ", 
             RowBox[{"products", ".", " ", "When"}], " ", "a", " ", "matrix", 
             " ", "is", " ", "dotted", " ", "into", " ", "an", " ", "angle", 
             " ", "wrapper", " ", "it", " ", "transforms", " ", "it", " ", 
             "into", " ", "a", " ", "square", " ", "and", " ", "the", " ", 
             "opposite", " ", "way", " ", "around"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"special", "=", 
            RowBox[{"special", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"dot", "[", 
                 RowBox[{"A__", ",", 
                  RowBox[{"agwrapper", "[", "x_", "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"OddQ", "[", 
                   RowBox[{"Length", "[", 
                    RowBox[{"{", "A", "}"}], "]"}], "]"}], ",", 
                  RowBox[{"sqwrapper", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "A", "}"}], ",", "x"}], "}"}], "]"}], ",", 
                  RowBox[{"agwrapper", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "A", "}"}], ",", "x"}], "}"}], "]"}]}], 
                 "]"}]}], ",", 
               RowBox[{
                RowBox[{"dot", "[", 
                 RowBox[{"A__", ",", 
                  RowBox[{"sqwrapper", "[", "x_", "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"OddQ", "[", 
                   RowBox[{"Length", "[", 
                    RowBox[{"{", "A", "}"}], "]"}], "]"}], ",", 
                  RowBox[{"agwrapper", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "A", "}"}], ",", "x"}], "}"}], "]"}], ",", 
                  RowBox[{"sqwrapper", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "A", "}"}], ",", "x"}], "}"}], "]"}]}], 
                 "]"}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "special", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Now", " ", "we", " ", "trnasform", " ", "replacement", " ", 
             "rules", " ", "for", " ", "the", " ", "wrappers", " ", "into", 
             " ", "equalities"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"special", "=", 
            RowBox[{"special", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Rule", "\[Rule]", "Set"}], ",", 
               RowBox[{"RuleDelayed", "\[Rule]", "Set"}]}], "}"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "And", " ", "define", " ", "the", " ", "special", " ", 
             "properties", " ", "of", " ", "chains", " ", "and", " ", 
             "brackets", " ", "with", " ", "respect", " ", "to", " ", "these",
              " ", "wrappers"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SpinorAngleBracket", "[", 
             RowBox[{"x_", ",", 
              RowBox[{"agwrapper", "[", 
               RowBox[{"{", 
                RowBox[{"A_List", ",", "y_"}], "}"}], "]"}]}], "]"}], ":=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", 
               RowBox[{"Length", "[", "A", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{
               "$angle", ",", "x", ",", "A", ",", "y", ",", "$square"}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{
               "$angle", ",", "x", ",", "A", ",", "y", ",", "$angle"}], 
               "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SpinorAngleBracket", "[", 
             RowBox[{
              RowBox[{"agwrapper", "[", 
               RowBox[{"{", 
                RowBox[{"A_", ",", "x_"}], "}"}], "]"}], ",", "y_"}], "]"}], ":=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", 
               RowBox[{"Length", "[", "A", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"-", 
               RowBox[{"Chain", "[", 
                RowBox[{"$square", ",", "x", ",", 
                 RowBox[{"Reverse", "[", "A", "]"}], ",", "y", ",", 
                 "$angle"}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{"$angle", ",", "x", ",", 
                RowBox[{"Reverse", "[", "A", "]"}], ",", "y", ",", "$angle"}],
                "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SpinorSquareBracket", "[", 
             RowBox[{"x_", ",", 
              RowBox[{"sqwrapper", "[", 
               RowBox[{"{", 
                RowBox[{"A_", ",", "y_"}], "}"}], "]"}]}], "]"}], ":=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", 
               RowBox[{"Length", "[", "A", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{
               "$square", ",", "x", ",", "A", ",", "y", ",", "$angle"}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{
               "$square", ",", "x", ",", "A", ",", "y", ",", "$square"}], 
               "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SpinorSquareBracket", "[", 
             RowBox[{
              RowBox[{"sqwrapper", "[", 
               RowBox[{"{", 
                RowBox[{"A_", ",", "x_"}], "}"}], "]"}], ",", "y_"}], "]"}], ":=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", 
               RowBox[{"Length", "[", "A", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"-", 
               RowBox[{"Chain", "[", 
                RowBox[{"$angle", ",", "x", ",", 
                 RowBox[{"Reverse", "[", "A", "]"}], ",", "y", ",", 
                 "$square"}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{"$square", ",", "x", ",", 
                RowBox[{"Reverse", "[", "A", "]"}], ",", "y", ",", 
                "$square"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Chain", "[", 
             RowBox[{"type_", ",", "x_", ",", 
              RowBox[{"{", "y__", "}"}], ",", 
              RowBox[{"agwrapper", "[", 
               RowBox[{"{", 
                RowBox[{"A_", ",", "z_"}], "}"}], "]"}], ",", "$angle"}], 
             "]"}], ":=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", 
               RowBox[{"Length", "[", "A", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{"type", ",", "x", ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", 
                  RowBox[{"Sequence", "@@", "A"}]}], "}"}], ",", "z", ",", 
                "$square"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{"type", ",", "x", ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", 
                  RowBox[{"Sequence", "@@", "A"}]}], "}"}], ",", "z", ",", 
                "$angle"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Chain", "[", 
             RowBox[{"$angle", ",", 
              RowBox[{"agwrapper", "[", 
               RowBox[{"{", 
                RowBox[{"A_", ",", "x_"}], "}"}], "]"}], ",", 
              RowBox[{"{", "y__", "}"}], ",", "z_", ",", "type_"}], "]"}], ":=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", 
               RowBox[{"Length", "[", "A", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"-", 
               RowBox[{"Chain", "[", 
                RowBox[{"$square", ",", "x", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Reverse", "[", "A", "]"}]}], ",", "y"}], "}"}], 
                 ",", "z", ",", "type"}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{"$angle", ",", "x", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Sequence", "@@", 
                   RowBox[{"Reverse", "[", "A", "]"}]}], ",", "y"}], "}"}], 
                ",", "z", ",", "type"}], "]"}]}], "\[IndentingNewLine]", 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Chain", "[", 
             RowBox[{"type_", ",", "x_", ",", 
              RowBox[{
               RowBox[{"{", "y__", "}"}], 
               RowBox[{"sqwrapper", "[", 
                RowBox[{"{", 
                 RowBox[{"A_", ",", "z_"}], "}"}], "]"}]}], ",", "$square"}], 
             "]"}], ":=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", 
               RowBox[{"Length", "[", "A", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{"type", ",", "x", ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", 
                  RowBox[{"Sequence", "@@", "A"}]}], "}"}], ",", "z", ",", 
                "$angle"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{"type", ",", "x", ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", 
                  RowBox[{"Sequence", "@@", "A"}]}], "}"}], ",", "z", ",", 
                "$square"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Chain", "[", 
             RowBox[{"$square", ",", 
              RowBox[{"sqwrapper", "[", 
               RowBox[{"{", 
                RowBox[{"A_", ",", "x_"}], "}"}], "]"}], ",", 
              RowBox[{"{", "y__", "}"}], ",", "z_", ",", "type_"}], "]"}], ":=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", 
               RowBox[{"Length", "[", "A", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"-", 
               RowBox[{"Chain", "[", 
                RowBox[{"$angle", ",", "x", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Reverse", "[", "A", "]"}]}], ",", "y"}], "}"}], 
                 ",", "z", ",", "type"}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{"$square", ",", "x", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Sequence", "@@", 
                   RowBox[{"Reverse", "[", "A", "]"}]}], ",", "y"}], "}"}], 
                ",", "z", ",", "type"}], "]"}]}], "\[IndentingNewLine]", 
             "]"}]}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Finally", " ", "replace", " ", "the", " ", "arguments", " ", "of", 
           " ", "SpinorAngleBracket"}], ",", " ", 
          RowBox[{
          "SpinorSquareBracket", " ", "and", " ", "Chain", " ", "with", " ", 
           "the", " ", "wrapped", " ", "argumenst"}]}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"locexp", "=", 
         RowBox[{"exp", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"SpinorAngleBracket", "[", 
              RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
             RowBox[{"SpinorAngleBracket", "[", 
              RowBox[{
               RowBox[{"agwrapper", "[", "x", "]"}], ",", 
               RowBox[{"agwrapper", "[", "y", "]"}]}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"SpinorSquareBracket", "[", 
              RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
             RowBox[{"SpinorSquareBracket", "[", 
              RowBox[{
               RowBox[{"sqwrapper", "[", "x", "]"}], ",", 
               RowBox[{"sqwrapper", "[", "y", "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Chain", "[", 
              RowBox[{"$angle", ",", "x_", ",", 
               RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$angle"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"Chain", "[", 
              RowBox[{"$angle", ",", 
               RowBox[{"agwrapper", "[", "x", "]"}], ",", 
               RowBox[{"{", "y", "}"}], ",", 
               RowBox[{"agwrapper", "[", "z", "]"}], ",", "$angle"}], "]"}]}],
             ",", 
            RowBox[{
             RowBox[{"Chain", "[", 
              RowBox[{"$square", ",", "x_", ",", 
               RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$square"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"Chain", "[", 
              RowBox[{"$square", ",", 
               RowBox[{"sqwrapper", "[", "x", "]"}], ",", 
               RowBox[{"{", "y", "}"}], ",", 
               RowBox[{"sqwrapper", "[", "z", "]"}], ",", "$square"}], 
              "]"}]}], ",", 
            RowBox[{
             RowBox[{"Chain", "[", 
              RowBox[{"$angle", ",", "x_", ",", 
               RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$square"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"Chain", "[", 
              RowBox[{"$angle", ",", 
               RowBox[{"agwrapper", "[", "x", "]"}], ",", 
               RowBox[{"{", "y", "}"}], ",", 
               RowBox[{"sqwrapper", "[", "z", "]"}], ",", "$square"}], 
              "]"}]}], ",", 
            RowBox[{
             RowBox[{"Chain", "[", 
              RowBox[{"$square", ",", "x_", ",", 
               RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$angle"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"Chain", "[", 
              RowBox[{"$square", ",", 
               RowBox[{"sqwrapper", "[", "x", "]"}], ",", 
               RowBox[{"{", "y", "}"}], ",", 
               RowBox[{"agwrapper", "[", "z", "]"}], ",", "$angle"}], 
              "]"}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Properties", " ", "will", " ", "be", " ", "automatically", " ", 
          "applied", " ", "so", " ", "we", " ", "can", " ", "now", " ", 
          "just", " ", "remove", " ", "the", " ", "wrappers", " ", "and", " ",
           "return", " ", "the", " ", 
          RowBox[{"output", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "locexp", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"locexp", "=", 
         RowBox[{"locexp", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"agwrapper", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], 
            ",", 
            RowBox[{
             RowBox[{"sqwrapper", "[", "x_", "]"}], "\[RuleDelayed]", "x"}]}],
            "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "locexp", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7947394702895308`*^9, 3.7947394966480827`*^9}, {
   3.7947395353205905`*^9, 3.7947397378948145`*^9}, {3.7947397704696684`*^9, 
   3.794739825033738*^9}, {3.7947398589409976`*^9, 3.7947400073889494`*^9}, {
   3.794740193295692*^9, 3.7947402061712537`*^9}, {3.794740420368552*^9, 
   3.794740426193962*^9}, {3.7947404831816444`*^9, 3.7947404877597265`*^9}, {
   3.7947405300449743`*^9, 3.794740656400612*^9}, {3.7947407180233226`*^9, 
   3.7947407837308187`*^9}, {3.7947409544863*^9, 3.794740956084936*^9}, {
   3.7947410157599497`*^9, 3.7947412301710854`*^9}, {3.7947412999804945`*^9, 
   3.7947413068119917`*^9}, {3.794741554531171*^9, 3.7947415710882125`*^9}, {
   3.79474163234667*^9, 3.7947417656402893`*^9}, {3.7947418899360924`*^9, 
   3.79474190077973*^9}, {3.7947420511251597`*^9, 3.7947420553240385`*^9}, {
   3.7947421696116962`*^9, 3.7947421963076687`*^9}, {3.794742382535037*^9, 
   3.7947423910861845`*^9}, {3.794742450724674*^9, 3.794742510081684*^9}, {
   3.794742564476531*^9, 3.79474266574505*^9}, {3.7947426965286765`*^9, 
   3.79474273254828*^9}, {3.7947427663822904`*^9, 3.794742786309738*^9}, {
   3.7947428176259446`*^9, 3.7947429297360835`*^9}, {3.794742971072345*^9, 
   3.7947429777375956`*^9}, {3.794743174772397*^9, 3.794743190808432*^9}, {
   3.7947432341602097`*^9, 3.7947432466831045`*^9}, {3.7947432890492578`*^9, 
   3.7947433361499453`*^9}, {3.7947433670059648`*^9, 
   3.7947434367863407`*^9}, {3.794743472029895*^9, 3.7947434864277472`*^9}, {
   3.7947440466951942`*^9, 3.794744071583248*^9}, {3.794744178166579*^9, 
   3.794744372024742*^9}, {3.7947444124493046`*^9, 3.794744428805597*^9}, {
   3.7947444595166254`*^9, 3.7947446704086857`*^9}, {3.7947450846850495`*^9, 
   3.794745206354061*^9}, {3.794745311648248*^9, 3.7947455069392447`*^9}, {
   3.7947455783671465`*^9, 3.7947457333028946`*^9}, {3.794745768271983*^9, 
   3.794745795055341*^9}, {3.794746420267106*^9, 3.7947471602690797`*^9}, {
   3.7947479371139183`*^9, 3.7947479413485746`*^9}, {3.7947488189957037`*^9, 
   3.794748866093114*^9}, {3.7954076179678173`*^9, 3.795407649413705*^9}, {
   3.795407681297426*^9, 3.795407717805777*^9}, {3.7954077712538195`*^9, 
   3.795407845035473*^9}, {3.7954079151928253`*^9, 3.795407938182333*^9}, {
   3.7954079748842335`*^9, 3.795408040388014*^9}, {3.795408270152405*^9, 
   3.7954083481398115`*^9}, {3.7954085085577374`*^9, 
   3.7954085803646746`*^9}, {3.795408648812596*^9, 3.7954086693367004`*^9}, {
   3.795408713098648*^9, 3.795408749525218*^9}, {3.795408826006705*^9, 
   3.795408905662594*^9}, {3.7954089489548*^9, 3.7954089504029274`*^9}, {
   3.7954089841307144`*^9, 3.7954090038499703`*^9}, {3.795409478553567*^9, 
   3.7954095575353136`*^9}, {3.795409613445819*^9, 3.7954097512292376`*^9}, {
   3.7954098459418435`*^9, 3.7954098527406573`*^9}, {3.795409938691762*^9, 
   3.7954099687473736`*^9}, 3.7954100766254025`*^9, {3.7954103775542617`*^9, 
   3.795410508652609*^9}, 3.7954105982129*^9, {3.7954106347083335`*^9, 
   3.7954106371358232`*^9}, {3.7954107138703547`*^9, 
   3.7954107184157095`*^9}, {3.7954123202830467`*^9, 3.7954124649654007`*^9}, 
   3.795416241808112*^9, {3.7954165704926624`*^9, 3.7954167949905*^9}, 
   3.795416868250441*^9, {3.7954169881994066`*^9, 3.795417103511213*^9}, {
   3.795417147944275*^9, 3.79541731319452*^9}, {3.7954174066893015`*^9, 
   3.7954174180821147`*^9}, {3.7954180190793643`*^9, 3.795418100005765*^9}, {
   3.7954181360083423`*^9, 3.7954181589709115`*^9}, {3.7954182840812206`*^9, 
   3.795418349228272*^9}, {3.7954258685554066`*^9, 3.795425922338545*^9}, {
   3.7954260858521996`*^9, 3.7954261164263678`*^9}, {3.795426155622395*^9, 
   3.795426199161937*^9}, {3.795426261536105*^9, 3.795426528788228*^9}, {
   3.7954268028621635`*^9, 3.7954268108498483`*^9}, {3.795426871502618*^9, 
   3.7954268720661097`*^9}, {3.7954270299298215`*^9, 
   3.7954270352416615`*^9}, {3.7954270849217334`*^9, 
   3.7954270900720053`*^9}, {3.7954274996953783`*^9, 3.7954276405555706`*^9}, 
   {3.7954277115145674`*^9, 3.795427718839964*^9}, {3.7954352185249395`*^9, 
   3.7954352479432855`*^9}},ExpressionUUID->"6e8a3dc1-2a9b-482f-8b08-\
7b5f4583493c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Trying to fix linearity", "Subsubsection",
 CellChangeTimes->{{3.795405800245426*^9, 3.7954058288469753`*^9}, {
  3.795427366834747*^9, 3.795427367907858*^9}, {3.7954274719106445`*^9, 
  3.795427479260027*^9}, {3.795435288470886*^9, 
  3.7954353071578712`*^9}},ExpressionUUID->"a06b6e7b-04a0-4596-b3bb-\
9ab6bb6a6b19"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"N", ".", "B", ".", " ", "The"}], " ", "matrix", " ", 
         "replacements", " ", "are", " ", "intended", " ", "as", " ", 
         "defined", " ", "on"}], " ", "|", "\[Lambda]"}], 
       "\[RightAngleBracket]"}], " ", "and", " ", "on"}], " ", "|", 
     "\[Lambda]"}], "]"}], ",", " ", 
   RowBox[{"so", " ", "when", " ", "applying", " ", "to", " ", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[Lambda]", "|", " ", 
      RowBox[{"and", " ", "[", 
       RowBox[{"\[Lambda]", "|", " ", 
        RowBox[{
        "minus", " ", "signs", " ", "appear", " ", "when", " ", "the", " ", 
         "number", " ", "of", " ", "matrices", " ", "applied", " ", "is", " ",
          "odd"}]}]}]}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7954257871860456`*^9, 
  3.7954258540482073`*^9}},ExpressionUUID->"30b4ab18-5ae9-4858-b443-\
07fae342a280"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SpinorReplace2", "[", 
    RowBox[{"exp_", ",", "reps_"}], "]"}], ":=", 
   RowBox[{"Catch", "[", 
    RowBox[{
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "locexp", ",", "locreps", ",", "agwrapper", ",", "sqwrapper", ",", 
         "SpinorAngleBracket", ",", "SpinorSquareBracket", ",", "Chain", ",", 
         "special", ",", "dot"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "First", " ", "isolate", " ", "the", " ", "replacements", " ", 
          "containing", " ", "matrices", " ", "which", " ", "will", " ", 
          "get", " ", "special", " ", "treatment"}], ",", " ", 
         RowBox[{
         "and", " ", "check", " ", "if", " ", "the", " ", "replacements", " ",
           "are", " ", "in", " ", "a", " ", "valid", " ", "form"}]}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"locreps", "=", 
         RowBox[{
          RowBox[{"{", "reps", "}"}], "//", "Flatten"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"special", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"locreps", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"FreeQ", "[", 
               RowBox[{"#", ",", "Dot"}], "]"}]}], "&"}], ")"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"locreps", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"locreps", ",", 
           RowBox[{
            RowBox[{"FreeQ", "[", 
             RowBox[{"#", ",", "Dot"}], "]"}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Take", " ", "into", " ", "account", " ", "the", " ", "possible", 
          " ", "presence", " ", "of", " ", "\[Mu]", " ", "spinors"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"locreps", "=", 
         RowBox[{"locreps", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"SpinorUndotPure", "[", "x_", "]"}], "[", "$mu", "]"}], 
             "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"SpinorUndotPure", "[", 
               RowBox[{"OverBar", "[", "x", "]"}], "]"}], "[", "$lam", 
              "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"SpinorDotPure", "[", "x_", "]"}], "[", "$mu", "]"}], 
             "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"SpinorDotPure", "[", 
               RowBox[{"OverBar", "[", "x", "]"}], "]"}], "[", "$lam", 
              "]"}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Introduces", " ", "two", " ", "wrappers", " ", "with", " ", 
          "respect", " ", "to", " ", "which", " ", "we", " ", "will", " ", 
          "define", " ", "the", " ", "properties", " ", "which", " ", 
          "perform", " ", "the", " ", "actual", " ", "replacement"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"locreps", "=", 
         RowBox[{"locreps", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"SpinorUndotPure", "[", "x_", "]"}], "[", "$lam", "]"}],
              "\[RuleDelayed]", 
             RowBox[{"agwrapper", "[", "x", "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"SpinorDotPure", "[", "x_", "]"}], "[", "$lam", "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"sqwrapper", "[", "x", "]"}]}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Test", " ", "the", " ", "correcteness", " ", "of", " ", "the", " ", 
          "replacements"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"AnyTrue", "[", 
           RowBox[{"locreps", ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"FreeQ", "[", 
                  RowBox[{"#", ",", "agwrapper"}], "]"}], "&&", 
                 RowBox[{"FreeQ", "[", 
                  RowBox[{"#", ",", "sqwrapper"}], "]"}]}], ")"}], "||", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"!", 
                  RowBox[{"FreeQ", "[", 
                   RowBox[{"#", ",", "agwrapper"}], "]"}]}], "&&", 
                 RowBox[{"!", 
                  RowBox[{"FreeQ", "[", 
                   RowBox[{"#", ",", "sqwrapper"}], "]"}]}]}], ")"}]}], "&"}],
              ")"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Throw", "[", 
            "\"\<Some replacements are given in an unknown form. Please check \
input.\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Now", " ", "we", " ", "trnasform", " ", "replacement", " ", "rules",
           " ", "for", " ", "the", " ", "wrappers", " ", "into", " ", 
          "equalities"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"locreps", "=", 
         RowBox[{"locreps", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Rule", "\[Rule]", "Set"}], ",", 
            RowBox[{"RuleDelayed", "\[Rule]", "Set"}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Define", " ", "linearity", " ", "of", " ", "brackets", " ", "and", 
          " ", "chains", " ", "with", " ", "respect", " ", "to", " ", "the", 
          " ", "wrappers"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{
            RowBox[{"a_", "+", "b_"}], ",", "c_"}], "]"}], "/;", 
          RowBox[{"!", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"b", ",", "agwrapper"}], "]"}]}]}], ":=", 
         RowBox[{
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"a", ",", "c"}], "]"}], "+", 
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"c_", ",", 
            RowBox[{"a_", "+", "b_"}]}], "]"}], "/;", 
          RowBox[{"!", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"b", ",", "agwrapper"}], "]"}]}]}], ":=", 
         RowBox[{
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"c", ",", "a"}], "]"}], "+", 
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"c", ",", "b"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SpinorAngleBracket", "[", 
          RowBox[{
           RowBox[{"a_", "*", 
            RowBox[{"agwrapper", "[", "x_", "]"}]}], ",", "y_"}], "]"}], ":=", 
         RowBox[{"a", "*", 
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{
            RowBox[{"agwrapper", "[", "x", "]"}], ",", "y"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SpinorAngleBracket", "[", 
          RowBox[{"y_", ",", 
           RowBox[{"a_", "*", 
            RowBox[{"agwrapper", "[", "x_", "]"}]}]}], "]"}], ":=", 
         RowBox[{"a", "*", 
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"y", ",", 
            RowBox[{"agwrapper", "[", "x", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{
            RowBox[{"a_", "+", "b_"}], ",", "c_"}], "]"}], "/;", 
          RowBox[{"!", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"b", ",", "sqwrapper"}], "]"}]}]}], ":=", 
         RowBox[{
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"a", ",", "c"}], "]"}], "+", 
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"c_", ",", 
            RowBox[{"a_", "+", "b_"}]}], "]"}], "/;", 
          RowBox[{"!", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"b", ",", "sqwrapper"}], "]"}]}]}], ":=", 
         RowBox[{
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"c", ",", "a"}], "]"}], "+", 
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"c", ",", "b"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SpinorSquareBracket", "[", 
          RowBox[{
           RowBox[{"a_", "*", 
            RowBox[{"sqwrapper", "[", "x_", "]"}]}], ",", "y_"}], "]"}], ":=", 
         RowBox[{"a", "*", 
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{
            RowBox[{"sqwrapper", "[", "x", "]"}], ",", "y"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SpinorSquareBracket", "[", 
          RowBox[{"y_", ",", 
           RowBox[{"a_", "*", 
            RowBox[{"sqwrapper", "[", "x_", "]"}]}]}], "]"}], ":=", 
         RowBox[{"a", "*", 
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"y", ",", 
            RowBox[{"sqwrapper", "[", "x", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Chain", "[", 
           RowBox[{"type1_", ",", 
            RowBox[{"a_", "+", "b_"}], ",", "y_", ",", "z_", ",", "type2_"}], 
           "]"}], "/;", 
          RowBox[{"!", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"b", ",", 
             RowBox[{"agwrapper", "|", "sqwrapper"}]}], "]"}]}]}], ":=", 
         RowBox[{
          RowBox[{"Chain", "[", 
           RowBox[{"type1", ",", "a", ",", "y", ",", "z", ",", "type2"}], 
           "]"}], "+", 
          RowBox[{"Chain", "[", 
           RowBox[{"type2", ",", "b", ",", "y", ",", "z", ",", "type2"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Chain", "[", 
           RowBox[{"type1_", ",", "x_", ",", "y_", ",", 
            RowBox[{"a_", "+", "b_"}], ",", "type2_"}], "]"}], "/;", 
          RowBox[{"!", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"b", ",", 
             RowBox[{"agwrapper", "|", "sqwrapper"}]}], "]"}]}]}], ":=", 
         RowBox[{
          RowBox[{"Chain", "[", 
           RowBox[{"type1", ",", "x", ",", "y", ",", "a", ",", "type2"}], 
           "]"}], "+", 
          RowBox[{"Chain", "[", 
           RowBox[{"type1", ",", "x", ",", "y", ",", "b", ",", "type2"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Chain", "[", 
          RowBox[{"type1_", ",", 
           RowBox[{"a_", "*", 
            RowBox[{"agwrapper", "[", "x_", "]"}]}], ",", "y_", ",", "z_", 
           ",", "type2_"}], "]"}], ":=", 
         RowBox[{"a", "*", 
          RowBox[{"Chain", "[", 
           RowBox[{"type1", ",", 
            RowBox[{"agwrapper", "[", "x", "]"}], ",", "y", ",", "z", ",", 
            "type2"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Chain", "[", 
          RowBox[{"type1_", ",", 
           RowBox[{"a_", "*", 
            RowBox[{"sqwrapper", "[", "x_", "]"}]}], ",", "y_", ",", "z_", 
           ",", "type2_"}], "]"}], ":=", 
         RowBox[{"a", "*", 
          RowBox[{"Chain", "[", 
           RowBox[{"type1", ",", 
            RowBox[{"sqwrapper", "[", "x", "]"}], ",", "y", ",", "z", ",", 
            "type2"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Chain", "[", 
          RowBox[{"type1_", ",", "x_", ",", "y_", ",", 
           RowBox[{"a_", "*", 
            RowBox[{"agwrapper", "[", "z_", "]"}]}], ",", "type2_"}], "]"}], ":=", 
         RowBox[{"a", "*", 
          RowBox[{"Chain", "[", 
           RowBox[{"type1", ",", "x", ",", "y", ",", 
            RowBox[{"agwrapper", "[", "z", "]"}], ",", "type2"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Chain", "[", 
          RowBox[{"type1_", ",", "x_", ",", "y_", ",", 
           RowBox[{"a_", "*", 
            RowBox[{"sqwrapper", "[", "z_", "]"}]}], ",", "type2_"}], "]"}], ":=", 
         RowBox[{"a", "*", 
          RowBox[{"Chain", "[", 
           RowBox[{"type1", ",", "x", ",", "y", ",", 
            RowBox[{"sqwrapper", "[", "z", "]"}], ",", "type2"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Now", " ", "for", " ", "the", " ", "special", " ", 
           "replacements"}], ",", " ", 
          RowBox[{"if", " ", "any"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "special", "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "First", " ", "we", " ", "replace", " ", "Dot", " ", "with", " ", 
             "a", " ", "local", " ", "defined", " ", "dot", " ", "symbol"}], 
            ",", " ", 
            RowBox[{
            "because", " ", "Dot", " ", "has", " ", "some", " ", "properties",
              " ", "which", " ", "screw", " ", "up", " ", "our", " ", 
             "pattern", " ", "matching", " ", "later", " ", "on"}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"special", "=", 
            RowBox[{"special", "/.", 
             RowBox[{"{", 
              RowBox[{"Dot", "\[Rule]", "dot"}], "}"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Take", " ", "into", " ", "account", " ", "\[Mu]", " ", 
             "spinors"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"special", "=", 
            RowBox[{"special", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"SpinorUndotPure", "[", "x_", "]"}], "[", "$mu", 
                 "]"}], "\[RuleDelayed]", 
                RowBox[{
                 RowBox[{"SpinorUndotPure", "[", 
                  RowBox[{"OverBar", "[", "x", "]"}], "]"}], "[", "$lam", 
                 "]"}]}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"SpinorDotPure", "[", "x_", "]"}], "[", "$mu", "]"}],
                 "\[RuleDelayed]", 
                RowBox[{
                 RowBox[{"SpinorDotPure", "[", 
                  RowBox[{"OverBar", "[", "x", "]"}], "]"}], "[", "$lam", 
                 "]"}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Introduce", " ", "the", " ", "wrapper"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"special", "=", 
            RowBox[{"special", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"SpinorUndotPure", "[", "x_", "]"}], "[", "$lam", 
                 "]"}], "\[RuleDelayed]", 
                RowBox[{"agwrapper", "[", "x", "]"}]}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"SpinorDotPure", "[", "x_", "]"}], "[", "$lam", 
                 "]"}], "\[RuleDelayed]", 
                RowBox[{"sqwrapper", "[", "x", "]"}]}]}], "}"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Take", " ", "into", " ", "account", " ", "the", " ", "matrix", 
             " ", 
             RowBox[{"products", ".", " ", "When"}], " ", "a", " ", "matrix", 
             " ", "is", " ", "dotted", " ", "into", " ", "an", " ", "angle", 
             " ", "wrapper", " ", "it", " ", "transforms", " ", "it", " ", 
             "into", " ", "a", " ", "square", " ", "and", " ", "the", " ", 
             "opposite", " ", "way", " ", "around"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"special", "=", 
            RowBox[{"special", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"dot", "[", 
                 RowBox[{"A__", ",", 
                  RowBox[{"agwrapper", "[", "x_", "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"OddQ", "[", 
                   RowBox[{"Length", "[", 
                    RowBox[{"{", "A", "}"}], "]"}], "]"}], ",", 
                  RowBox[{"sqwrapper", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "A", "}"}], ",", "x"}], "}"}], "]"}], ",", 
                  RowBox[{"agwrapper", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "A", "}"}], ",", "x"}], "}"}], "]"}]}], 
                 "]"}]}], ",", 
               RowBox[{
                RowBox[{"dot", "[", 
                 RowBox[{"A__", ",", 
                  RowBox[{"sqwrapper", "[", "x_", "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"OddQ", "[", 
                   RowBox[{"Length", "[", 
                    RowBox[{"{", "A", "}"}], "]"}], "]"}], ",", 
                  RowBox[{"agwrapper", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "A", "}"}], ",", "x"}], "}"}], "]"}], ",", 
                  RowBox[{"sqwrapper", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "A", "}"}], ",", "x"}], "}"}], "]"}]}], 
                 "]"}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Test", " ", "the", " ", "correcteness", " ", "of", " ", "the", 
             " ", "replacements"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"AnyTrue", "[", 
              RowBox[{"special", ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"FreeQ", "[", 
                    RowBox[{"#", ",", "agwrapper"}], "]"}], "&&", 
                    RowBox[{"FreeQ", "[", 
                    RowBox[{"#", ",", "sqwrapper"}], "]"}]}], ")"}], "||", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"!", 
                    RowBox[{"FreeQ", "[", 
                    RowBox[{"#", ",", "agwrapper"}], "]"}]}], "&&", 
                    RowBox[{"!", 
                    RowBox[{"FreeQ", "[", 
                    RowBox[{"#", ",", "sqwrapper"}], "]"}]}]}], ")"}]}], 
                 "&"}], ")"}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "Throw", "[", 
               "\"\<Some replacements are given in an unknown form. Please \
check input.\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Now", " ", "we", " ", "trnasform", " ", "replacement", " ", 
             "rules", " ", "for", " ", "the", " ", "wrappers", " ", "into", 
             " ", "equalities"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"special", "=", 
            RowBox[{"special", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Rule", "\[Rule]", "Set"}], ",", 
               RowBox[{"RuleDelayed", "\[Rule]", "Set"}]}], "}"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "And", " ", "define", " ", "the", " ", "special", " ", 
             "properties", " ", "of", " ", "chains", " ", "and", " ", 
             "brackets", " ", "with", " ", "respect", " ", "to", " ", "these",
              " ", "wrappers"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SpinorAngleBracket", "[", 
             RowBox[{"x_", ",", 
              RowBox[{"agwrapper", "[", 
               RowBox[{"{", 
                RowBox[{"A_List", ",", "y_"}], "}"}], "]"}]}], "]"}], ":=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", 
               RowBox[{"Length", "[", "A", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{
               "$angle", ",", "x", ",", "A", ",", "y", ",", "$square"}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{
               "$angle", ",", "x", ",", "A", ",", "y", ",", "$angle"}], 
               "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SpinorAngleBracket", "[", 
             RowBox[{
              RowBox[{"agwrapper", "[", 
               RowBox[{"{", 
                RowBox[{"A_", ",", "x_"}], "}"}], "]"}], ",", "y_"}], "]"}], ":=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", 
               RowBox[{"Length", "[", "A", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"-", 
               RowBox[{"Chain", "[", 
                RowBox[{"$square", ",", "x", ",", 
                 RowBox[{"Reverse", "[", "A", "]"}], ",", "y", ",", 
                 "$angle"}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{"$angle", ",", "x", ",", 
                RowBox[{"Reverse", "[", "A", "]"}], ",", "y", ",", "$angle"}],
                "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SpinorSquareBracket", "[", 
             RowBox[{"x_", ",", 
              RowBox[{"sqwrapper", "[", 
               RowBox[{"{", 
                RowBox[{"A_", ",", "y_"}], "}"}], "]"}]}], "]"}], ":=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", 
               RowBox[{"Length", "[", "A", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{
               "$square", ",", "x", ",", "A", ",", "y", ",", "$angle"}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{
               "$square", ",", "x", ",", "A", ",", "y", ",", "$square"}], 
               "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SpinorSquareBracket", "[", 
             RowBox[{
              RowBox[{"sqwrapper", "[", 
               RowBox[{"{", 
                RowBox[{"A_", ",", "x_"}], "}"}], "]"}], ",", "y_"}], "]"}], ":=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", 
               RowBox[{"Length", "[", "A", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"-", 
               RowBox[{"Chain", "[", 
                RowBox[{"$angle", ",", "x", ",", 
                 RowBox[{"Reverse", "[", "A", "]"}], ",", "y", ",", 
                 "$square"}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{"$square", ",", "x", ",", 
                RowBox[{"Reverse", "[", "A", "]"}], ",", "y", ",", 
                "$square"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Chain", "[", 
             RowBox[{"type_", ",", "x_", ",", 
              RowBox[{"{", "y__", "}"}], ",", 
              RowBox[{"agwrapper", "[", 
               RowBox[{"{", 
                RowBox[{"A_", ",", "z_"}], "}"}], "]"}], ",", "$angle"}], 
             "]"}], ":=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", 
               RowBox[{"Length", "[", "A", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{"type", ",", "x", ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", 
                  RowBox[{"Sequence", "@@", "A"}]}], "}"}], ",", "z", ",", 
                "$square"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{"type", ",", "x", ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", 
                  RowBox[{"Sequence", "@@", "A"}]}], "}"}], ",", "z", ",", 
                "$angle"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Chain", "[", 
             RowBox[{"$angle", ",", 
              RowBox[{"agwrapper", "[", 
               RowBox[{"{", 
                RowBox[{"A_", ",", "x_"}], "}"}], "]"}], ",", 
              RowBox[{"{", "y__", "}"}], ",", "z_", ",", "type_"}], "]"}], ":=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", 
               RowBox[{"Length", "[", "A", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"-", 
               RowBox[{"Chain", "[", 
                RowBox[{"$square", ",", "x", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Reverse", "[", "A", "]"}]}], ",", "y"}], "}"}], 
                 ",", "z", ",", "type"}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{"$angle", ",", "x", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Sequence", "@@", 
                   RowBox[{"Reverse", "[", "A", "]"}]}], ",", "y"}], "}"}], 
                ",", "z", ",", "type"}], "]"}]}], "\[IndentingNewLine]", 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Chain", "[", 
             RowBox[{"type_", ",", "x_", ",", 
              RowBox[{
               RowBox[{"{", "y__", "}"}], 
               RowBox[{"sqwrapper", "[", 
                RowBox[{"{", 
                 RowBox[{"A_", ",", "z_"}], "}"}], "]"}]}], ",", "$square"}], 
             "]"}], ":=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", 
               RowBox[{"Length", "[", "A", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{"type", ",", "x", ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", 
                  RowBox[{"Sequence", "@@", "A"}]}], "}"}], ",", "z", ",", 
                "$angle"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{"type", ",", "x", ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", 
                  RowBox[{"Sequence", "@@", "A"}]}], "}"}], ",", "z", ",", 
                "$square"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Chain", "[", 
             RowBox[{"$square", ",", 
              RowBox[{"sqwrapper", "[", 
               RowBox[{"{", 
                RowBox[{"A_", ",", "x_"}], "}"}], "]"}], ",", 
              RowBox[{"{", "y__", "}"}], ",", "z_", ",", "type_"}], "]"}], ":=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", 
               RowBox[{"Length", "[", "A", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"-", 
               RowBox[{"Chain", "[", 
                RowBox[{"$angle", ",", "x", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Reverse", "[", "A", "]"}]}], ",", "y"}], "}"}], 
                 ",", "z", ",", "type"}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{"$square", ",", "x", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Sequence", "@@", 
                   RowBox[{"Reverse", "[", "A", "]"}]}], ",", "y"}], "}"}], 
                ",", "z", ",", "type"}], "]"}]}], "\[IndentingNewLine]", 
             "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Finally", " ", "replace", " ", "the", " ", "arguments", " ", "of", 
           " ", "SpinorAngleBracket"}], ",", " ", 
          RowBox[{
          "SpinorSquareBracket", " ", "and", " ", "Chain", " ", "with", " ", 
           "the", " ", "wrapped", " ", "argumenst"}]}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"locexp", "=", 
         RowBox[{"exp", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"SpinorAngleBracket", "[", 
              RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
             RowBox[{"SpinorAngleBracket", "[", 
              RowBox[{
               RowBox[{"agwrapper", "[", "x", "]"}], ",", 
               RowBox[{"agwrapper", "[", "y", "]"}]}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"SpinorSquareBracket", "[", 
              RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
             RowBox[{"SpinorSquareBracket", "[", 
              RowBox[{
               RowBox[{"sqwrapper", "[", "x", "]"}], ",", 
               RowBox[{"sqwrapper", "[", "y", "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Chain", "[", 
              RowBox[{"$angle", ",", "x_", ",", 
               RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$angle"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"Chain", "[", 
              RowBox[{"$angle", ",", 
               RowBox[{"agwrapper", "[", "x", "]"}], ",", 
               RowBox[{"{", "y", "}"}], ",", 
               RowBox[{"agwrapper", "[", "z", "]"}], ",", "$angle"}], "]"}]}],
             ",", 
            RowBox[{
             RowBox[{"Chain", "[", 
              RowBox[{"$square", ",", "x_", ",", 
               RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$square"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"Chain", "[", 
              RowBox[{"$square", ",", 
               RowBox[{"sqwrapper", "[", "x", "]"}], ",", 
               RowBox[{"{", "y", "}"}], ",", 
               RowBox[{"sqwrapper", "[", "z", "]"}], ",", "$square"}], 
              "]"}]}], ",", 
            RowBox[{
             RowBox[{"Chain", "[", 
              RowBox[{"$angle", ",", "x_", ",", 
               RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$square"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"Chain", "[", 
              RowBox[{"$angle", ",", 
               RowBox[{"agwrapper", "[", "x", "]"}], ",", 
               RowBox[{"{", "y", "}"}], ",", 
               RowBox[{"sqwrapper", "[", "z", "]"}], ",", "$square"}], 
              "]"}]}], ",", 
            RowBox[{
             RowBox[{"Chain", "[", 
              RowBox[{"$square", ",", "x_", ",", 
               RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$angle"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"Chain", "[", 
              RowBox[{"$square", ",", 
               RowBox[{"sqwrapper", "[", "x", "]"}], ",", 
               RowBox[{"{", "y", "}"}], ",", 
               RowBox[{"agwrapper", "[", "z", "]"}], ",", "$angle"}], 
              "]"}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Properties", " ", "will", " ", "be", " ", "automatically", " ", 
          "applied", " ", "so", " ", "we", " ", "can", " ", "now", " ", 
          "just", " ", "remove", " ", "the", " ", "wrappers", " ", "and", " ",
           "return", " ", "the", " ", 
          RowBox[{"output", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"locexp", "=", 
         RowBox[{"locexp", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"agwrapper", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], 
            ",", 
            RowBox[{
             RowBox[{"sqwrapper", "[", "x_", "]"}], "\[RuleDelayed]", "x"}]}],
            "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "locexp", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7954380158491197`*^9, 3.7954380194225607`*^9}, {
  3.795438133735117*^9, 3.795438134721135*^9}, {3.7954382124284363`*^9, 
  3.795438369441852*^9}, {3.7954384560034056`*^9, 3.7954384672672415`*^9}, {
  3.795438769776924*^9, 3.795438827224826*^9}, {3.7954389026601324`*^9, 
  3.79543909801511*^9}, {3.795439332590802*^9, 3.7954395592959986`*^9}, {
  3.7954396232451677`*^9, 3.7954397560273514`*^9}, {3.795439835561254*^9, 
  3.7954398756364098`*^9}, {3.7954400052795134`*^9, 3.795440107032454*^9}, {
  3.7954401581700296`*^9, 3.7954402185222383`*^9}, {3.7954402867601323`*^9, 
  3.7954402944852467`*^9}, {3.7954403747908225`*^9, 3.7954403777426424`*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"978bb3c0-c874-45a0-8263-bbe3e3383f61"]
}, Closed]],

Cell[CellGroupData[{

Cell["Adding linearity also in the pure spinors of the input", "Subsubsection",
 CellChangeTimes->{{3.795405800245426*^9, 3.7954058288469753`*^9}, {
  3.795427366834747*^9, 3.795427367907858*^9}, {3.7954274719106445`*^9, 
  3.795427479260027*^9}, {3.795435288470886*^9, 3.7954353071578712`*^9}, {
  3.7954407797414756`*^9, 3.7954407886419473`*^9}, {3.79544215245743*^9, 
  3.7954421661156597`*^9}, {3.795858465083912*^9, 
  3.795858468290901*^9}},ExpressionUUID->"cbf56a28-527a-46e0-ae83-\
3c4bffb42539"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"N", ".", "B", ".", " ", "The"}], " ", "matrix", " ", 
         "replacements", " ", "are", " ", "intended", " ", "as", " ", 
         "defined", " ", "on"}], " ", "|", "\[Lambda]"}], 
       "\[RightAngleBracket]"}], " ", "and", " ", "on"}], " ", "|", 
     "\[Lambda]"}], "]"}], ",", " ", 
   RowBox[{"so", " ", "when", " ", "applying", " ", "to", " ", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[Lambda]", "|", " ", 
      RowBox[{"and", " ", "[", 
       RowBox[{"\[Lambda]", "|", " ", 
        RowBox[{
        "minus", " ", "signs", " ", "appear", " ", "when", " ", "the", " ", 
         "number", " ", "of", " ", "matrices", " ", "applied", " ", "is", " ",
          "odd"}]}]}]}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7954257871860456`*^9, 3.7954258540482073`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"3e0a2bfe-eaf4-47cb-992d-93ba15fd6e73"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SpinorReplace2", "[", 
    RowBox[{"exp_", ",", "reps_"}], "]"}], ":=", 
   RowBox[{"Catch", "[", 
    RowBox[{
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "locexp", ",", "locreps", ",", "agwrapper", ",", "sqwrapper", ",", 
         "SpinorAngleBracket", ",", "SpinorSquareBracket", ",", "Chain", ",", 
         "special", ",", "dot"}], "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "We", " ", "replace", " ", "Dot", " ", "with", " ", "a", " ", 
          "local", " ", "defined", " ", "dot", " ", "symbol"}], ",", " ", 
         RowBox[{
         "because", " ", "Dot", " ", "has", " ", "some", " ", "properties", 
          " ", "which", " ", "screw", " ", "up", " ", "our", " ", "pattern", 
          " ", "matching", " ", "later", " ", "on"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"locreps", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "reps", "}"}], "/.", 
           RowBox[{"Dot", "\[Rule]", "dot"}]}], "//", "Flatten"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Apply", " ", "linearity", " ", "to", " ", "the", " ", "PureSpinors",
           " ", "in", " ", "terms", " ", "of", " ", "the", " ", "globally", 
          " ", "defined", " ", "momentum", " ", "labels"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"locreps", "=", 
         RowBox[{"locreps", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"a_", "/;", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"MomList", ",", "a"}], "]"}]}], "\[RuleDelayed]", 
            RowBox[{"MomPure", "[", "a", "]"}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"locreps", "=", 
         RowBox[{"locreps", "//.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"SpinorUndotPure", "[", 
                RowBox[{"a_", "+", "b_"}], "]"}], "[", "type_", "]"}], "/;", 
              RowBox[{"!", 
               RowBox[{"FreeQ", "[", 
                RowBox[{"b", ",", "MomPure"}], "]"}]}]}], "\[RuleDelayed]", 
             RowBox[{
              RowBox[{
               RowBox[{"SpinorUndotPure", "[", "a", "]"}], "[", "type", "]"}],
               "+", 
              RowBox[{
               RowBox[{"SpinorUndotPure", "[", "b", "]"}], "[", "type", 
               "]"}]}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"SpinorDotPure", "[", 
                RowBox[{"a_", "+", "b_"}], "]"}], "[", "type_", "]"}], "/;", 
              RowBox[{"!", 
               RowBox[{"FreeQ", "[", 
                RowBox[{"b", ",", "MomPure"}], "]"}]}]}], "\[RuleDelayed]", 
             RowBox[{
              RowBox[{
               RowBox[{"SpinorDotPure", "[", "a", "]"}], "[", "type", "]"}], 
              "+", 
              RowBox[{
               RowBox[{"SpinorDotPure", "[", "b", "]"}], "[", "type", 
               "]"}]}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"SpinorUndotPure", "[", 
               RowBox[{"a_", "*", 
                RowBox[{"MomPure", "[", "x_", "]"}]}], "]"}], "[", "type_", 
              "]"}], "\[RuleDelayed]", 
             RowBox[{"a", "*", 
              RowBox[{
               RowBox[{"SpinorUndotPure", "[", 
                RowBox[{"MomPure", "[", "x", "]"}], "]"}], "[", "type", 
               "]"}]}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"SpinorDotPure", "[", 
               RowBox[{"a_", "*", 
                RowBox[{"MomPure", "[", "x_", "]"}]}], "]"}], "[", "type_", 
              "]"}], "\[RuleDelayed]", 
             RowBox[{"a", "*", 
              RowBox[{
               RowBox[{"SpinorDotPure", "[", 
                RowBox[{"MomPure", "[", "x", "]"}], "]"}], "[", "type", 
               "]"}]}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"locreps", "=", 
         RowBox[{"locreps", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"MomPure", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], 
           "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Isolate", " ", "the", " ", "replacements", " ", "containing", " ", 
          "matrices", " ", "which", " ", "will", " ", "get", " ", "special", 
          " ", "treatment"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"special", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"locreps", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"FreeQ", "[", 
               RowBox[{"#", ",", "dot"}], "]"}]}], "&"}], ")"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"locreps", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"locreps", ",", 
           RowBox[{
            RowBox[{"FreeQ", "[", 
             RowBox[{"#", ",", "dot"}], "]"}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Take", " ", "into", " ", "account", " ", "the", " ", "possible", 
          " ", "presence", " ", "of", " ", "\[Mu]", " ", "spinors"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"locreps", "=", 
         RowBox[{"locreps", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"SpinorUndotPure", "[", "x_", "]"}], "[", "$mu", "]"}], 
             "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"SpinorUndotPure", "[", 
               RowBox[{"OverBar", "[", "x", "]"}], "]"}], "[", "$lam", 
              "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"SpinorDotPure", "[", "x_", "]"}], "[", "$mu", "]"}], 
             "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"SpinorDotPure", "[", 
               RowBox[{"OverBar", "[", "x", "]"}], "]"}], "[", "$lam", 
              "]"}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Introduces", " ", "two", " ", "wrappers", " ", "with", " ", 
          "respect", " ", "to", " ", "which", " ", "we", " ", "will", " ", 
          "define", " ", "the", " ", "properties", " ", "which", " ", 
          "perform", " ", "the", " ", "actual", " ", "replacement"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"locreps", "=", 
         RowBox[{"locreps", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"SpinorUndotPure", "[", "x_", "]"}], "[", "$lam", "]"}],
              "\[RuleDelayed]", 
             RowBox[{"agwrapper", "[", "x", "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"SpinorDotPure", "[", "x_", "]"}], "[", "$lam", "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"sqwrapper", "[", "x", "]"}]}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Test", " ", "the", " ", "correcteness", " ", "of", " ", "the", " ", 
          "replacements"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"AnyTrue", "[", 
           RowBox[{"locreps", ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"FreeQ", "[", 
                  RowBox[{"#", ",", "agwrapper"}], "]"}], "&&", 
                 RowBox[{"FreeQ", "[", 
                  RowBox[{"#", ",", "sqwrapper"}], "]"}]}], ")"}], "||", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"!", 
                  RowBox[{"FreeQ", "[", 
                   RowBox[{"#", ",", "agwrapper"}], "]"}]}], "&&", 
                 RowBox[{"!", 
                  RowBox[{"FreeQ", "[", 
                   RowBox[{"#", ",", "sqwrapper"}], "]"}]}]}], ")"}]}], "&"}],
              ")"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Throw", "[", 
            "\"\<Some replacements are given in an unknown form. Please check \
input.\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Now", " ", "we", " ", "trnasform", " ", "replacement", " ", "rules",
           " ", "for", " ", "the", " ", "wrappers", " ", "into", " ", 
          "equalities"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"locreps", "=", 
         RowBox[{"locreps", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Rule", "\[Rule]", "Set"}], ",", 
            RowBox[{"RuleDelayed", "\[Rule]", "Set"}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Define", " ", "linearity", " ", "of", " ", "brackets", " ", "and", 
          " ", "chains", " ", "with", " ", "respect", " ", "to", " ", "the", 
          " ", "wrappers"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{
            RowBox[{"a_", "+", "b_"}], ",", "c_"}], "]"}], "/;", 
          RowBox[{"!", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"b", ",", "agwrapper"}], "]"}]}]}], ":=", 
         RowBox[{
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"a", ",", "c"}], "]"}], "+", 
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"c_", ",", 
            RowBox[{"a_", "+", "b_"}]}], "]"}], "/;", 
          RowBox[{"!", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"b", ",", "agwrapper"}], "]"}]}]}], ":=", 
         RowBox[{
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"c", ",", "a"}], "]"}], "+", 
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"c", ",", "b"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SpinorAngleBracket", "[", 
          RowBox[{
           RowBox[{"a_", "*", 
            RowBox[{"agwrapper", "[", "x_", "]"}]}], ",", "y_"}], "]"}], ":=", 
         RowBox[{"a", "*", 
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{
            RowBox[{"agwrapper", "[", "x", "]"}], ",", "y"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SpinorAngleBracket", "[", 
          RowBox[{"y_", ",", 
           RowBox[{"a_", "*", 
            RowBox[{"agwrapper", "[", "x_", "]"}]}]}], "]"}], ":=", 
         RowBox[{"a", "*", 
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"y", ",", 
            RowBox[{"agwrapper", "[", "x", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{
            RowBox[{"a_", "+", "b_"}], ",", "c_"}], "]"}], "/;", 
          RowBox[{"!", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"b", ",", "sqwrapper"}], "]"}]}]}], ":=", 
         RowBox[{
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"a", ",", "c"}], "]"}], "+", 
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"c_", ",", 
            RowBox[{"a_", "+", "b_"}]}], "]"}], "/;", 
          RowBox[{"!", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"b", ",", "sqwrapper"}], "]"}]}]}], ":=", 
         RowBox[{
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"c", ",", "a"}], "]"}], "+", 
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"c", ",", "b"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SpinorSquareBracket", "[", 
          RowBox[{
           RowBox[{"a_", "*", 
            RowBox[{"sqwrapper", "[", "x_", "]"}]}], ",", "y_"}], "]"}], ":=", 
         RowBox[{"a", "*", 
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{
            RowBox[{"sqwrapper", "[", "x", "]"}], ",", "y"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SpinorSquareBracket", "[", 
          RowBox[{"y_", ",", 
           RowBox[{"a_", "*", 
            RowBox[{"sqwrapper", "[", "x_", "]"}]}]}], "]"}], ":=", 
         RowBox[{"a", "*", 
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"y", ",", 
            RowBox[{"sqwrapper", "[", "x", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Chain", "[", 
           RowBox[{"type1_", ",", 
            RowBox[{"a_", "+", "b_"}], ",", "y_", ",", "z_", ",", "type2_"}], 
           "]"}], "/;", 
          RowBox[{"!", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"b", ",", 
             RowBox[{"agwrapper", "|", "sqwrapper"}]}], "]"}]}]}], ":=", 
         RowBox[{
          RowBox[{"Chain", "[", 
           RowBox[{"type1", ",", "a", ",", "y", ",", "z", ",", "type2"}], 
           "]"}], "+", 
          RowBox[{"Chain", "[", 
           RowBox[{"type1", ",", "b", ",", "y", ",", "z", ",", "type2"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Chain", "[", 
           RowBox[{"type1_", ",", "x_", ",", "y_", ",", 
            RowBox[{"a_", "+", "b_"}], ",", "type2_"}], "]"}], "/;", 
          RowBox[{"!", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"b", ",", 
             RowBox[{"agwrapper", "|", "sqwrapper"}]}], "]"}]}]}], ":=", 
         RowBox[{
          RowBox[{"Chain", "[", 
           RowBox[{"type1", ",", "x", ",", "y", ",", "a", ",", "type2"}], 
           "]"}], "+", 
          RowBox[{"Chain", "[", 
           RowBox[{"type1", ",", "x", ",", "y", ",", "b", ",", "type2"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Chain", "[", 
          RowBox[{"type1_", ",", 
           RowBox[{"a_", "*", 
            RowBox[{"agwrapper", "[", "x_", "]"}]}], ",", "y_", ",", "z_", 
           ",", "type2_"}], "]"}], ":=", 
         RowBox[{"a", "*", 
          RowBox[{"Chain", "[", 
           RowBox[{"type1", ",", 
            RowBox[{"agwrapper", "[", "x", "]"}], ",", "y", ",", "z", ",", 
            "type2"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Chain", "[", 
          RowBox[{"type1_", ",", 
           RowBox[{"a_", "*", 
            RowBox[{"sqwrapper", "[", "x_", "]"}]}], ",", "y_", ",", "z_", 
           ",", "type2_"}], "]"}], ":=", 
         RowBox[{"a", "*", 
          RowBox[{"Chain", "[", 
           RowBox[{"type1", ",", 
            RowBox[{"sqwrapper", "[", "x", "]"}], ",", "y", ",", "z", ",", 
            "type2"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Chain", "[", 
          RowBox[{"type1_", ",", "x_", ",", "y_", ",", 
           RowBox[{"a_", "*", 
            RowBox[{"agwrapper", "[", "z_", "]"}]}], ",", "type2_"}], "]"}], ":=", 
         RowBox[{"a", "*", 
          RowBox[{"Chain", "[", 
           RowBox[{"type1", ",", "x", ",", "y", ",", 
            RowBox[{"agwrapper", "[", "z", "]"}], ",", "type2"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Chain", "[", 
          RowBox[{"type1_", ",", "x_", ",", "y_", ",", 
           RowBox[{"a_", "*", 
            RowBox[{"sqwrapper", "[", "z_", "]"}]}], ",", "type2_"}], "]"}], ":=", 
         RowBox[{"a", "*", 
          RowBox[{"Chain", "[", 
           RowBox[{"type1", ",", "x", ",", "y", ",", 
            RowBox[{"sqwrapper", "[", "z", "]"}], ",", "type2"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Now", " ", "for", " ", "the", " ", "special", " ", 
           "replacements"}], ",", " ", 
          RowBox[{"if", " ", "any"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "special", "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Take", " ", "into", " ", "account", " ", "\[Mu]", " ", 
            "spinors"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"special", "=", 
            RowBox[{"special", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"SpinorUndotPure", "[", "x_", "]"}], "[", "$mu", 
                 "]"}], "\[RuleDelayed]", 
                RowBox[{
                 RowBox[{"SpinorUndotPure", "[", 
                  RowBox[{"OverBar", "[", "x", "]"}], "]"}], "[", "$lam", 
                 "]"}]}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"SpinorDotPure", "[", "x_", "]"}], "[", "$mu", "]"}],
                 "\[RuleDelayed]", 
                RowBox[{
                 RowBox[{"SpinorDotPure", "[", 
                  RowBox[{"OverBar", "[", "x", "]"}], "]"}], "[", "$lam", 
                 "]"}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Introduce", " ", "the", " ", "wrapper"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"special", "=", 
            RowBox[{"special", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"SpinorUndotPure", "[", "x_", "]"}], "[", "$lam", 
                 "]"}], "\[RuleDelayed]", 
                RowBox[{"agwrapper", "[", "x", "]"}]}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"SpinorDotPure", "[", "x_", "]"}], "[", "$lam", 
                 "]"}], "\[RuleDelayed]", 
                RowBox[{"sqwrapper", "[", "x", "]"}]}]}], "}"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Take", " ", "into", " ", "account", " ", "the", " ", "matrix", 
             " ", 
             RowBox[{"products", ".", " ", "When"}], " ", "a", " ", "matrix", 
             " ", "is", " ", "dotted", " ", "into", " ", "an", " ", "angle", 
             " ", "wrapper", " ", "it", " ", "transforms", " ", "it", " ", 
             "into", " ", "a", " ", "square", " ", "and", " ", "the", " ", 
             "opposite", " ", "way", " ", "around"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"special", "=", 
            RowBox[{"special", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"dot", "[", 
                 RowBox[{"A__", ",", 
                  RowBox[{"agwrapper", "[", "x_", "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"OddQ", "[", 
                   RowBox[{"Length", "[", 
                    RowBox[{"{", "A", "}"}], "]"}], "]"}], ",", 
                  RowBox[{"sqwrapper", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "A", "}"}], ",", "x"}], "}"}], "]"}], ",", 
                  RowBox[{"agwrapper", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "A", "}"}], ",", "x"}], "}"}], "]"}]}], 
                 "]"}]}], ",", 
               RowBox[{
                RowBox[{"dot", "[", 
                 RowBox[{"A__", ",", 
                  RowBox[{"sqwrapper", "[", "x_", "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"OddQ", "[", 
                   RowBox[{"Length", "[", 
                    RowBox[{"{", "A", "}"}], "]"}], "]"}], ",", 
                  RowBox[{"agwrapper", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "A", "}"}], ",", "x"}], "}"}], "]"}], ",", 
                  RowBox[{"sqwrapper", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "A", "}"}], ",", "x"}], "}"}], "]"}]}], 
                 "]"}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Test", " ", "the", " ", "correcteness", " ", "of", " ", "the", 
             " ", "replacements"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"AnyTrue", "[", 
              RowBox[{"special", ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"FreeQ", "[", 
                    RowBox[{"#", ",", "agwrapper"}], "]"}], "&&", 
                    RowBox[{"FreeQ", "[", 
                    RowBox[{"#", ",", "sqwrapper"}], "]"}]}], ")"}], "||", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"!", 
                    RowBox[{"FreeQ", "[", 
                    RowBox[{"#", ",", "agwrapper"}], "]"}]}], "&&", 
                    RowBox[{"!", 
                    RowBox[{"FreeQ", "[", 
                    RowBox[{"#", ",", "sqwrapper"}], "]"}]}]}], ")"}]}], 
                 "&"}], ")"}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "Throw", "[", 
               "\"\<Some replacements are given in an unknown form. Please \
check input.\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Now", " ", "we", " ", "transform", " ", "replacement", " ", 
             "rules", " ", "for", " ", "the", " ", "wrappers", " ", "into", 
             " ", "equalities"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"special", "=", 
            RowBox[{"special", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Rule", "\[Rule]", "Set"}], ",", 
               RowBox[{"RuleDelayed", "\[Rule]", "Set"}]}], "}"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "And", " ", "define", " ", "the", " ", "special", " ", 
             "properties", " ", "of", " ", "chains", " ", "and", " ", 
             "brackets", " ", "with", " ", "respect", " ", "to", " ", "these",
              " ", "wrappers"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SpinorAngleBracket", "[", 
             RowBox[{"x_", ",", 
              RowBox[{"agwrapper", "[", 
               RowBox[{"{", 
                RowBox[{"A_List", ",", "y_"}], "}"}], "]"}]}], "]"}], ":=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", 
               RowBox[{"Length", "[", "A", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{
               "$angle", ",", "x", ",", "A", ",", "y", ",", "$square"}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{
               "$angle", ",", "x", ",", "A", ",", "y", ",", "$angle"}], 
               "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SpinorAngleBracket", "[", 
             RowBox[{
              RowBox[{"agwrapper", "[", 
               RowBox[{"{", 
                RowBox[{"A_", ",", "x_"}], "}"}], "]"}], ",", "y_"}], "]"}], ":=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", 
               RowBox[{"Length", "[", "A", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"-", 
               RowBox[{"Chain", "[", 
                RowBox[{"$square", ",", "x", ",", 
                 RowBox[{"Reverse", "[", "A", "]"}], ",", "y", ",", 
                 "$angle"}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{"$angle", ",", "x", ",", 
                RowBox[{"Reverse", "[", "A", "]"}], ",", "y", ",", "$angle"}],
                "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SpinorSquareBracket", "[", 
             RowBox[{"x_", ",", 
              RowBox[{"sqwrapper", "[", 
               RowBox[{"{", 
                RowBox[{"A_", ",", "y_"}], "}"}], "]"}]}], "]"}], ":=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", 
               RowBox[{"Length", "[", "A", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{
               "$square", ",", "x", ",", "A", ",", "y", ",", "$angle"}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{
               "$square", ",", "x", ",", "A", ",", "y", ",", "$square"}], 
               "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SpinorSquareBracket", "[", 
             RowBox[{
              RowBox[{"sqwrapper", "[", 
               RowBox[{"{", 
                RowBox[{"A_", ",", "x_"}], "}"}], "]"}], ",", "y_"}], "]"}], ":=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", 
               RowBox[{"Length", "[", "A", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"-", 
               RowBox[{"Chain", "[", 
                RowBox[{"$angle", ",", "x", ",", 
                 RowBox[{"Reverse", "[", "A", "]"}], ",", "y", ",", 
                 "$square"}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{"$square", ",", "x", ",", 
                RowBox[{"Reverse", "[", "A", "]"}], ",", "y", ",", 
                "$square"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Chain", "[", 
             RowBox[{"type_", ",", "x_", ",", 
              RowBox[{"{", "y__", "}"}], ",", 
              RowBox[{"agwrapper", "[", 
               RowBox[{"{", 
                RowBox[{"A_", ",", "z_"}], "}"}], "]"}], ",", "$angle"}], 
             "]"}], ":=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", 
               RowBox[{"Length", "[", "A", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{"type", ",", "x", ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", 
                  RowBox[{"Sequence", "@@", "A"}]}], "}"}], ",", "z", ",", 
                "$square"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{"type", ",", "x", ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", 
                  RowBox[{"Sequence", "@@", "A"}]}], "}"}], ",", "z", ",", 
                "$angle"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Chain", "[", 
             RowBox[{"$angle", ",", 
              RowBox[{"agwrapper", "[", 
               RowBox[{"{", 
                RowBox[{"A_", ",", "x_"}], "}"}], "]"}], ",", 
              RowBox[{"{", "y__", "}"}], ",", "z_", ",", "type_"}], "]"}], ":=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", 
               RowBox[{"Length", "[", "A", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"-", 
               RowBox[{"Chain", "[", 
                RowBox[{"$square", ",", "x", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Reverse", "[", "A", "]"}]}], ",", "y"}], "}"}], 
                 ",", "z", ",", "type"}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{"$angle", ",", "x", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Sequence", "@@", 
                   RowBox[{"Reverse", "[", "A", "]"}]}], ",", "y"}], "}"}], 
                ",", "z", ",", "type"}], "]"}]}], "\[IndentingNewLine]", 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Chain", "[", 
             RowBox[{"type_", ",", "x_", ",", 
              RowBox[{"{", "y__", "}"}], ",", 
              RowBox[{"sqwrapper", "[", 
               RowBox[{"{", 
                RowBox[{"A_", ",", "z_"}], "}"}], "]"}], ",", "$square"}], 
             "]"}], ":=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", 
               RowBox[{"Length", "[", "A", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{"type", ",", "x", ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", 
                  RowBox[{"Sequence", "@@", "A"}]}], "}"}], ",", "z", ",", 
                "$angle"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{"type", ",", "x", ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", 
                  RowBox[{"Sequence", "@@", "A"}]}], "}"}], ",", "z", ",", 
                "$square"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Chain", "[", 
             RowBox[{"$square", ",", 
              RowBox[{"sqwrapper", "[", 
               RowBox[{"{", 
                RowBox[{"A_", ",", "x_"}], "}"}], "]"}], ",", 
              RowBox[{"{", "y__", "}"}], ",", "z_", ",", "type_"}], "]"}], ":=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", 
               RowBox[{"Length", "[", "A", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"-", 
               RowBox[{"Chain", "[", 
                RowBox[{"$angle", ",", "x", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Reverse", "[", "A", "]"}]}], ",", "y"}], "}"}], 
                 ",", "z", ",", "type"}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Chain", "[", 
               RowBox[{"$square", ",", "x", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Sequence", "@@", 
                   RowBox[{"Reverse", "[", "A", "]"}]}], ",", "y"}], "}"}], 
                ",", "z", ",", "type"}], "]"}]}], "\[IndentingNewLine]", 
             "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Finally", " ", "replace", " ", "the", " ", "arguments", " ", "of", 
           " ", "SpinorAngleBracket"}], ",", " ", 
          RowBox[{
          "SpinorSquareBracket", " ", "and", " ", "Chain", " ", "with", " ", 
           "the", " ", "wrapped", " ", "argumenst"}]}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"locexp", "=", 
         RowBox[{"exp", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"SpinorAngleBracket", "[", 
              RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
             RowBox[{"SpinorAngleBracket", "[", 
              RowBox[{
               RowBox[{"agwrapper", "[", "x", "]"}], ",", 
               RowBox[{"agwrapper", "[", "y", "]"}]}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"SpinorSquareBracket", "[", 
              RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
             RowBox[{"SpinorSquareBracket", "[", 
              RowBox[{
               RowBox[{"sqwrapper", "[", "x", "]"}], ",", 
               RowBox[{"sqwrapper", "[", "y", "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Chain", "[", 
              RowBox[{"$angle", ",", "x_", ",", 
               RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$angle"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"Chain", "[", 
              RowBox[{"$angle", ",", 
               RowBox[{"agwrapper", "[", "x", "]"}], ",", 
               RowBox[{"{", "y", "}"}], ",", 
               RowBox[{"agwrapper", "[", "z", "]"}], ",", "$angle"}], "]"}]}],
             ",", 
            RowBox[{
             RowBox[{"Chain", "[", 
              RowBox[{"$square", ",", "x_", ",", 
               RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$square"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"Chain", "[", 
              RowBox[{"$square", ",", 
               RowBox[{"sqwrapper", "[", "x", "]"}], ",", 
               RowBox[{"{", "y", "}"}], ",", 
               RowBox[{"sqwrapper", "[", "z", "]"}], ",", "$square"}], 
              "]"}]}], ",", 
            RowBox[{
             RowBox[{"Chain", "[", 
              RowBox[{"$angle", ",", "x_", ",", 
               RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$square"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"Chain", "[", 
              RowBox[{"$angle", ",", 
               RowBox[{"agwrapper", "[", "x", "]"}], ",", 
               RowBox[{"{", "y", "}"}], ",", 
               RowBox[{"sqwrapper", "[", "z", "]"}], ",", "$square"}], 
              "]"}]}], ",", 
            RowBox[{
             RowBox[{"Chain", "[", 
              RowBox[{"$square", ",", "x_", ",", 
               RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$angle"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"Chain", "[", 
              RowBox[{"$square", ",", 
               RowBox[{"sqwrapper", "[", "x", "]"}], ",", 
               RowBox[{"{", "y", "}"}], ",", 
               RowBox[{"agwrapper", "[", "z", "]"}], ",", "$angle"}], 
              "]"}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Properties", " ", "will", " ", "be", " ", "automatically", " ", 
          "applied", " ", "so", " ", "we", " ", "can", " ", "now", " ", 
          "just", " ", "remove", " ", "the", " ", "wrappers", " ", "and", " ",
           "return", " ", "the", " ", 
          RowBox[{"output", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"locexp", "=", 
         RowBox[{"locexp", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"agwrapper", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], 
            ",", 
            RowBox[{
             RowBox[{"sqwrapper", "[", "x_", "]"}], "\[RuleDelayed]", "x"}]}],
            "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "locexp", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7954380158491197`*^9, 3.7954380194225607`*^9}, {
   3.795438133735117*^9, 3.795438134721135*^9}, {3.7954382124284363`*^9, 
   3.795438369441852*^9}, {3.7954384560034056`*^9, 3.7954384672672415`*^9}, {
   3.795438769776924*^9, 3.795438827224826*^9}, {3.7954389026601324`*^9, 
   3.79543909801511*^9}, {3.795439332590802*^9, 3.7954395592959986`*^9}, {
   3.7954396232451677`*^9, 3.7954397560273514`*^9}, {3.795439835561254*^9, 
   3.7954398756364098`*^9}, {3.7954400052795134`*^9, 3.795440107032454*^9}, {
   3.7954401581700296`*^9, 3.7954402185222383`*^9}, {3.7954402867601323`*^9, 
   3.7954402944852467`*^9}, {3.7954403747908225`*^9, 
   3.7954403777426424`*^9}, {3.7954408579734783`*^9, 
   3.7954411958534236`*^9}, {3.795441241623972*^9, 3.7954412798038177`*^9}, {
   3.7954413405022144`*^9, 3.795441358322451*^9}, {3.795441402928232*^9, 
   3.7954414724919033`*^9}, {3.79544154030861*^9, 3.7954415491001544`*^9}, {
   3.7954416417909374`*^9, 3.7954416422878036`*^9}, {3.7954419159658813`*^9, 
   3.795441917895855*^9}, {3.795442076444665*^9, 3.7954420765942345`*^9}, {
   3.7958418376381655`*^9, 3.79584183815079*^9}, {3.7958444733047967`*^9, 
   3.79584447376855*^9}, 3.795846541884276*^9},
 CellLabel->"In[84]:=",ExpressionUUID->"a3caf81a-13d4-4a05-b7b9-69fecf8d355f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tests", "Subsection",
 CellChangeTimes->{{3.794747914782984*^9, 
  3.7947479164214306`*^9}},ExpressionUUID->"46937f3d-04c3-4b98-acc4-\
610c2a5edc1d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"plain", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     TemplateBox[{"p1"},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
     TemplateBox[{"p3"},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], ",", 
    RowBox[{
     TemplateBox[{"p2"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
     TemplateBox[{"p4"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.7947480262295275`*^9, 3.7947480452782526`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"3c6ffe19-4a52-4304-b833-fb0c22d5b515"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    TemplateBox[{"p1"},
     "SpinorUndotPureL",
     DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], 
    "\[Rule]", 
    TemplateBox[{"p3"},
     "SpinorUndotPureL",
     DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], ",", 
   RowBox[{
    TemplateBox[{"p2"},
     "SpinorDotPureL",
     DisplayFunction->(RowBox[{
        OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "\[Rule]", 
    TemplateBox[{"p4"},
     "SpinorDotPureL",
     DisplayFunction->(RowBox[{
        OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7947480460299397`*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"68a1671f-d84b-483b-ab43-6f63c7141d81"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyplain", "[", "x_", "]"}], ":=", 
  RowBox[{"SpinorReplace2", "[", 
   RowBox[{"x", ",", "plain"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7947480471822634`*^9, 3.7947480660139437`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"629bfb4c-703a-44ab-a025-71a2444a2721"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"linear", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     TemplateBox[{"p1"},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
     RowBox[{
      TemplateBox[{"p3"},
       "SpinorUndotPureL",
       DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "+", 
      RowBox[{"z", "*", 
       TemplateBox[{"p5"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}]}],
     ",", 
    RowBox[{
     TemplateBox[{"p2"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
     RowBox[{
      TemplateBox[{"p4"},
       "SpinorDotPureL",
       DisplayFunction->(RowBox[{
          OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "-", 
      RowBox[{"z", "*", 
       TemplateBox[{"p6"},
        "SpinorDotPureL",
        DisplayFunction->(RowBox[{
           OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}]}]}],
    "}"}]}]], "Input",
 CellChangeTimes->{{3.794747921725979*^9, 3.7947480412086067`*^9}, {
  3.7947480722120695`*^9, 3.794748086620783*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"fa8816ea-fa07-4663-b23d-5b184f37f5fd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    TemplateBox[{"p1"},
     "SpinorUndotPureL",
     DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], 
    "\[Rule]", 
    RowBox[{
     TemplateBox[{"p3"},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "+", 
     RowBox[{"z", " ", 
      TemplateBox[{"p5"},
       "SpinorUndotPureL",
       DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}]}], 
   ",", 
   RowBox[{
    TemplateBox[{"p2"},
     "SpinorDotPureL",
     DisplayFunction->(RowBox[{
        OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "\[Rule]", 
    RowBox[{
     TemplateBox[{"p4"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "-", 
     RowBox[{"z", " ", 
      TemplateBox[{"p6"},
       "SpinorDotPureL",
       DisplayFunction->(RowBox[{
          OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7947480871615686`*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"704e34ea-b648-492c-b4be-dafb559ec70d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"applylinear", "[", "x_", "]"}], ":=", 
  RowBox[{"SpinorReplace2", "[", 
   RowBox[{"x", ",", "linear"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.794748088253676*^9, 3.794748109106122*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"2b943293-72c5-4bc2-a53b-3b6fdf3fe1ed"],

Cell[CellGroupData[{

Cell["Angles", "Subsubsection",
 CellChangeTimes->{{3.794748120284717*^9, 
  3.794748121229681*^9}},ExpressionUUID->"aa8fe545-d5cd-47fd-9278-\
760ea408b513"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1","p2"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947481153272667`*^9, 3.794748131915908*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"1a5057b3-9b46-4a32-8e4c-50f9357acd1d"],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{"p2","p3"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )]}]], "Output",
 CellChangeTimes->{3.7947481324221945`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"7416c477-a3d7-480b-9526-9c688b287dca"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"l1","p1"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.794748136204043*^9, 3.794748145699086*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"43f1de2a-df76-47fa-9388-3487d4c61ded"],

Cell[BoxData[
 TemplateBox[{"l1","p3"},
  "SpinorAngleBracket",
  DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
     RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
  InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
     RowBox[{#, ",", #2}], "]"}]& )]], "Output",
 CellChangeTimes->{3.794748146193217*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"dc7331c6-1f63-4a3b-ad54-1d9b3cf12ffb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1","p2"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.7947481153272667`*^9, 3.794748131915908*^9}, {
  3.7947481725401154`*^9, 3.7947481743202057`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"2d93ba95-f252-4794-9680-766895574e47"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   TemplateBox[{"p2","p3"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}], "-", 
  RowBox[{"z", " ", 
   TemplateBox[{"p2","p5"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.7947481324221945`*^9, 3.794748174981965*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"ecd23d35-54cb-4706-8035-bd74bb725f6e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"l1","p1"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.794748136204043*^9, 3.794748145699086*^9}, {
  3.7947481897953677`*^9, 3.794748192462148*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"70575923-37b1-432b-a157-f12ae26d3e5a"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"l1","p3"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "+", 
  RowBox[{"z", " ", 
   TemplateBox[{"l1","p5"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.794748146193217*^9, 3.7947481928793297`*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"d550105d-5bb8-40fc-b307-ccd3a76b8951"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Squares", "Subsubsection",
 CellChangeTimes->{{3.794748238276725*^9, 
  3.7947482396408043`*^9}},ExpressionUUID->"6d4c4fbd-d354-4ac5-aaee-\
cf879e4fe55a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1","p2"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.79474824414812*^9, 3.7947482569072113`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"e4869842-2ac2-4279-9d61-31a0cce61e5c"],

Cell[BoxData[
 TemplateBox[{"p1","p4"},
  "SpinorSquareBracket",
  DisplayFunction->(RowBox[{"[", 
     RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
  InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
     RowBox[{#, ",", #2}], "]"}]& )]], "Output",
 CellChangeTimes->{3.794748257593755*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"3c41f7c5-e879-4f60-8cba-e17f756eeac6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2","p3"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.794748260340469*^9, 3.79474827028979*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"82a74498-6f7d-4369-8956-d0407dc8a752"],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{"p3","p4"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )]}]], "Output",
 CellChangeTimes->{3.794748270799845*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"b016b509-822e-4f2b-88b1-ba5af65e18bf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1","p2"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.79474824414812*^9, 3.79474828679657*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"fd89999a-d63e-4cf8-a55b-25e6297a95e1"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1","p4"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "-", 
  RowBox[{"z", " ", 
   TemplateBox[{"p1","p6"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.794748257593755*^9, 3.7947482877355127`*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"73cd1466-aa5a-43f2-aeb5-077db41f92d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2","p3"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.794748260340469*^9, 3.7947482920567837`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"d8168eb0-3a52-47d0-835a-c1f35294085d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   TemplateBox[{"p3","p4"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
  RowBox[{"z", " ", 
   TemplateBox[{"p3","p6"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}]}]], "Output",
 CellChangeTimes->{{3.794748270799845*^9, 3.794748292862301*^9}},
 CellLabel->"Out[21]=",ExpressionUUID->"ad106dd5-f577-46ea-8052-dcd993e47b35"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Chains angles", "Subsubsection",
 CellChangeTimes->{{3.7947483387073536`*^9, 3.794748339520731*^9}, {
  3.7947486124328513`*^9, 
  3.7947486137365103`*^9}},ExpressionUUID->"4f951570-5ba2-4527-88bd-\
b08a73212f0e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", "p2", "}"}],"p4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947483448020372`*^9, 3.794748354898479*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"1bef53f6-6f3f-44b8-864c-d8d14b6bb438"],

Cell[BoxData[
 TemplateBox[{"p3",RowBox[{"{", "p2", "}"}],"p4"},
  "AngleSquareChain",
  DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.794748355434944*^9, 3.7947488933289223`*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"a710c392-5ee3-4e5e-ae55-0fa798f4ce24"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", "p2", "}"}],"p4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.7947483448020372`*^9, 3.794748354898479*^9}, {
  3.794748445614644*^9, 3.794748447395432*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"67c5975f-2eed-45c7-bb67-4aa1f4f3fe5d"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p3",RowBox[{"{", "p2", "}"}],"p4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "+", 
  RowBox[{"z", " ", 
   TemplateBox[{"p5",RowBox[{"{", "p2", "}"}],"p4"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.794748355434944*^9, 3.794748488648471*^9, 
  3.79474889523454*^9},
 CellLabel->"Out[37]=",ExpressionUUID->"7bb1277a-69c8-4579-9a66-d23385daf336"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p4",RowBox[{"{", "p2", "}"}],"p1"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947484179908566`*^9, 3.794748454740518*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"8f2a448c-a61e-45bf-8696-c37010183852"],

Cell[BoxData[
 TemplateBox[{"p4",RowBox[{"{", "p2", "}"}],"p3"},
  "SquareAngleChain",
  DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.7947484271703844`*^9, 3.7947488978831387`*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"a0891890-dda9-4e99-8d26-1b196f9dcf8f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p4",RowBox[{"{", "p2", "}"}],"p1"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.794748495006073*^9, 3.7947484966764836`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"d6b8c639-6fa6-483a-b834-2cb42e20d07d"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p4",RowBox[{"{", "p2", "}"}],"p3"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "+", 
  RowBox[{"z", " ", 
   TemplateBox[{"p4",RowBox[{"{", "p2", "}"}],"p5"},
    "SquareAngleChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle",
        "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.794748497113364*^9, 3.794748899205615*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"cda882e4-fc07-4bb5-996c-87b5e7f17895"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", 
      RowBox[{"p2", ",", "p3"}], "}"}],"p4"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947485092847323`*^9, 3.7947485195373297`*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"64f44b4f-5782-4d3a-92fb-8938bce3a1b7"],

Cell[BoxData[
 TemplateBox[{"p3",RowBox[{"{", 
     RowBox[{"p2", ",", "p3"}], "}"}],"p4"},
  "AngleAngleChain",
  DisplayFunction->(
   RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.7947485201060905`*^9, 3.79474890481462*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"7df5d7ff-f1e1-43eb-827e-6484c2cbb680"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", 
      RowBox[{"p2", ",", "p3"}], "}"}],"p4"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.7947485291999035`*^9, 3.79474853008352*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"d2a2fab5-105d-4d87-b312-7b75b98b6bbd"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p3",RowBox[{"{", 
      RowBox[{"p2", ",", "p3"}], "}"}],"p4"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "+", 
  RowBox[{"z", " ", 
   TemplateBox[{"p5",RowBox[{"{", 
       RowBox[{"p2", ",", "p3"}], "}"}],"p4"},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.7947485305876904`*^9, 3.794748907938732*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"6a96b171-fd06-4d5d-bb46-b3e87d3f42ba"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Chains squares", "Subsubsection",
 CellChangeTimes->{{3.7947483387073536`*^9, 3.794748339520731*^9}, {
  3.7947486124328513`*^9, 
  3.794748633426945*^9}},ExpressionUUID->"251c96f3-3f60-4963-a160-\
820afe50638b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p3",RowBox[{"{", "p4", "}"}],"p2"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947483448020372`*^9, 3.794748354898479*^9}, {
  3.794748625290289*^9, 3.794748646457346*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"7b002d70-2c0c-4e87-8ea3-37ccef368972"],

Cell[BoxData[
 TemplateBox[{"p3",RowBox[{"{", "p4", "}"}],"p4"},
  "AngleSquareChain",
  DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
     "]"}]& )]], "Output",
 CellChangeTimes->{
  3.794748355434944*^9, {3.7947486359981284`*^9, 3.794748647732076*^9}, 
   3.7947486869847255`*^9, 3.794748911263562*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"d352d85e-0a20-4fe5-85f8-93722e6a7d03"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p3",RowBox[{"{", "p5", "}"}],"p2"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.7947483448020372`*^9, 3.794748354898479*^9}, {
  3.794748445614644*^9, 3.794748447395432*^9}, {3.79474869445179*^9, 
  3.7947487130948706`*^9}, {3.794748919647318*^9, 3.7947489199976115`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"e175df56-e48f-4a6c-aced-2595c31853c2"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p3",RowBox[{"{", "p5", "}"}],"p4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "-", 
  RowBox[{"z", " ", 
   TemplateBox[{"p3",RowBox[{"{", "p5", "}"}],"p6"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}]}]], "Output",
 CellChangeTimes->{
  3.794748355434944*^9, 3.794748488648471*^9, {3.79474869604881*^9, 
   3.7947487137469687`*^9}, {3.7947489146617794`*^9, 3.7947489205710754`*^9}},
 CellLabel->"Out[44]=",ExpressionUUID->"83a4f5b4-944c-4f82-aec6-b25b2af80482"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2",RowBox[{"{", "p4", "}"}],"p3"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947484179908566`*^9, 3.794748454740518*^9}, {
  3.794748948812261*^9, 3.794748953415962*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"b38f2499-cdf9-4315-8a34-87ec8f5895fb"],

Cell[BoxData[
 TemplateBox[{"p4",RowBox[{"{", "p4", "}"}],"p3"},
  "SquareAngleChain",
  DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.7947484271703844`*^9, 3.794748954279978*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"6210cf01-b783-454d-ab7e-1c5721c585ca"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2",RowBox[{"{", "p4", "}"}],"p3"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.794748495006073*^9, 3.7947484966764836`*^9}, {
  3.7947489602613754`*^9, 3.7947489642467136`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"e666768f-b61a-49b0-ad03-b50d5fbaa616"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p4",RowBox[{"{", "p4", "}"}],"p3"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "-", 
  RowBox[{"z", " ", 
   TemplateBox[{"p6",RowBox[{"{", "p4", "}"}],"p3"},
    "SquareAngleChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle",
        "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.794748497113364*^9, 3.794748965839892*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"6c791c94-130a-461a-8fe2-c5e4c41e801a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2",RowBox[{"{", 
      RowBox[{"p1", ",", "p3"}], "}"}],"p4"},
   "SquareSquareChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square",
       "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947489796149*^9, 3.7947489888202257`*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"85ce0c12-54a4-432a-bd43-34085bc41e02"],

Cell[BoxData[
 TemplateBox[{"p4",RowBox[{"{", 
     RowBox[{"p1", ",", "p3"}], "}"}],"p4"},
  "SquareSquareChain",
  DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.7947489892851896`*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"04779bdc-520f-4d59-9779-7d57b4dc1113"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2",RowBox[{"{", 
      RowBox[{"p1", ",", "p3"}], "}"}],"p4"},
   "SquareSquareChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square",
       "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.794748996211546*^9, 3.7947489969753675`*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"62c7d708-f797-473b-8b8b-b37b7f91137c"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p4",RowBox[{"{", 
      RowBox[{"p1", ",", "p3"}], "}"}],"p4"},
   "SquareSquareChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square",
       "]"}]& )], "-", 
  RowBox[{"z", " ", 
   TemplateBox[{"p6",RowBox[{"{", 
       RowBox[{"p1", ",", "p3"}], "}"}],"p4"},
    "SquareSquareChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
       "$square", "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.7947489975537853`*^9},
 CellLabel->"Out[48]=",ExpressionUUID->"92b957de-2b82-483f-8fa9-d9cc6cd43777"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Chains mixed", "Subsubsection",
 CellChangeTimes->{{3.7947490375599337`*^9, 
  3.794749039909021*^9}},ExpressionUUID->"6f184ba9-8487-47a8-a763-\
24859047fcc7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", "p8", "}"}],"p2"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947490449664536`*^9, 3.7947490545911417`*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"d71aa89d-9555-4cbf-bc22-53026f10d163"],

Cell[BoxData[
 TemplateBox[{"p3",RowBox[{"{", "p8", "}"}],"p4"},
  "AngleSquareChain",
  DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.794749054948547*^9},
 CellLabel->"Out[49]=",ExpressionUUID->"2b4096d1-e2ff-4de6-8a47-1cdf1be839b4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", "p8", "}"}],"p2"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.794749062592343*^9, 3.7947491061617165`*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"5e0e0148-a055-48bb-93d6-31c16e3a1f44"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p3",RowBox[{"{", "p8", "}"}],"p4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "-", 
  RowBox[{"z", " ", 
   TemplateBox[{"p3",RowBox[{"{", "p8", "}"}],"p6"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], "+", 
  RowBox[{"z", " ", 
   RowBox[{"(", 
    RowBox[{
     TemplateBox[{"p5",RowBox[{"{", "p8", "}"}],"p4"},
      "AngleSquareChain",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
         "$square", "]"}]& )], "-", 
     RowBox[{"z", " ", 
      TemplateBox[{"p5",RowBox[{"{", "p8", "}"}],"p6"},
       "AngleSquareChain",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
          "$square", "]"}]& )]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.794749063869943*^9, 3.794749106667944*^9}},
 CellLabel->"Out[52]=",ExpressionUUID->"a4853a99-df12-41ad-8426-b194fde46a03"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["With \[Mu] spinors", "Subsubsection",
 CellChangeTimes->{{3.7947491440787992`*^9, 
  3.7947491490838604`*^9}},ExpressionUUID->"4a3c4d9b-3317-44bf-9c71-\
ec979a100418"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pr", "=", 
  RowBox[{
   TemplateBox[{"p1","p7","1","2"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], "//", "To4D"}]}]], "Input",
 CellChangeTimes->{{3.7947491582174597`*^9, 3.7947492033599286`*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"600b65f4-e173-46f7-8989-db69573a5aa3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     TemplateBox[{"p1"},
      "extramass",
      DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
      InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
     TemplateBox[{"p7",OverscriptBox["p1", "_"]},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], 
    TemplateBox[{"p1",OverscriptBox["p1", "_"]},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]]}], "+", 
  FractionBox[
   RowBox[{
    TemplateBox[{"p7"},
     "extramass",
     DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
     InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
    TemplateBox[{"p1",OverscriptBox["p7", "_"]},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], 
   TemplateBox[{"p7",OverscriptBox["p7", "_"]},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]]}]], "Output",
 CellChangeTimes->{{3.7947491706360226`*^9, 3.794749204260088*^9}},
 CellLabel->"Out[55]=",ExpressionUUID->"03c7e32b-b4f3-4b35-b91a-68c656243d0e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpinorReplace2", "[", 
  RowBox[{"pr", ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"p1"},
      "SpinorUndotPureM",
      DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
     TemplateBox[{"p2"},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.794749178371219*^9, 3.7947492132648125`*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"769e2cf5-5ef4-4c7c-8524-6f096ceafe7a"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    TemplateBox[{"p1"},
     "extramass",
     DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
     InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
    TemplateBox[{"p2","p7"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], 
   TemplateBox[{"p1","p2"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]], "+", 
  FractionBox[
   RowBox[{
    TemplateBox[{"p7"},
     "extramass",
     DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
     InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
    TemplateBox[{"p1",OverscriptBox["p7", "_"]},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], 
   TemplateBox[{"p7",OverscriptBox["p7", "_"]},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]]}]], "Output",
 CellChangeTimes->{3.794749214477919*^9},
 CellLabel->"Out[56]=",ExpressionUUID->"7da4822d-04e4-4680-bdc1-684ec0ea2b62"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpinorReplace2", "[", 
  RowBox[{"pr", ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"p1"},
      "SpinorUndotPureM",
      DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
     TemplateBox[{"p2"},
      "SpinorUndotPureM",
      DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )]}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.794749232064951*^9, 3.794749241288847*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"73f9e93f-a783-4f5b-8b6a-18f88f9e75e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     TemplateBox[{"p1"},
      "extramass",
      DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
      InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
     TemplateBox[{"p7",OverscriptBox["p2", "_"]},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], 
    TemplateBox[{"p1",OverscriptBox["p2", "_"]},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]]}], "+", 
  FractionBox[
   RowBox[{
    TemplateBox[{"p7"},
     "extramass",
     DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
     InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
    TemplateBox[{"p1",OverscriptBox["p7", "_"]},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], 
   TemplateBox[{"p7",OverscriptBox["p7", "_"]},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]]}]], "Output",
 CellChangeTimes->{3.794749242351922*^9},
 CellLabel->"Out[57]=",ExpressionUUID->"8886eb47-4ec5-4db6-a9d0-7d773d754672"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpinorReplace2", "[", 
  RowBox[{"pr", ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"p7"},
      "SpinorDotPureM",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
     TemplateBox[{"p3"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.794749254050561*^9, 3.7947492768712463`*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"e79bce4f-2105-41af-84bb-3481ea9d6103"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     TemplateBox[{"p1"},
      "extramass",
      DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
      InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
     TemplateBox[{"p7",OverscriptBox["p1", "_"]},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], 
    TemplateBox[{"p1",OverscriptBox["p1", "_"]},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]]}], "-", 
  FractionBox[
   RowBox[{
    TemplateBox[{"p7"},
     "extramass",
     DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
     InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
    TemplateBox[{"p1","p3"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], 
   TemplateBox[{"p3","p7"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]]}]], "Output",
 CellChangeTimes->{3.7947492781378846`*^9},
 CellLabel->"Out[58]=",ExpressionUUID->"b8081898-a366-444e-86b9-f239585c6768"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpinorReplace2", "[", 
  RowBox[{"pr", ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"p7"},
      "SpinorDotPureM",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
     TemplateBox[{"p3"},
      "SpinorDotPureM",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )]}], "}"}]}],
   "]"}]], "Input",
 CellChangeTimes->{{3.794749293304788*^9, 3.7947492972929125`*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"40899ff8-4f04-493d-a64e-9b90b41372e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     TemplateBox[{"p1"},
      "extramass",
      DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
      InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
     TemplateBox[{"p7",OverscriptBox["p1", "_"]},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], 
    TemplateBox[{"p1",OverscriptBox["p1", "_"]},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]]}], "+", 
  FractionBox[
   RowBox[{
    TemplateBox[{"p7"},
     "extramass",
     DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
     InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
    TemplateBox[{"p1",OverscriptBox["p3", "_"]},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], 
   TemplateBox[{"p7",OverscriptBox["p3", "_"]},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]]}]], "Output",
 CellChangeTimes->{3.794749298086068*^9},
 CellLabel->"Out[59]=",ExpressionUUID->"b3154660-dad5-4b97-bc87-f17e5957599c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpinorReplace2", "[", 
  RowBox[{"pr", ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"p7"},
      "SpinorDotPureM",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
     RowBox[{
      TemplateBox[{"p3"},
       "SpinorDotPureM",
       DisplayFunction->(RowBox[{
          OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "+", 
      RowBox[{"z", "*", 
       TemplateBox[{"p9"},
        "SpinorDotPureM",
        DisplayFunction->(RowBox[{
           OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )]}]}]}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.794749343514308*^9, 3.7947493660069275`*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"fa4e07de-35ff-4e17-b69f-44abc642b5ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     TemplateBox[{"p1"},
      "extramass",
      DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
      InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
     TemplateBox[{"p7",OverscriptBox["p1", "_"]},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], 
    TemplateBox[{"p1",OverscriptBox["p1", "_"]},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]]}], "+", 
  FractionBox[
   RowBox[{
    TemplateBox[{"p7"},
     "extramass",
     DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
     InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
    RowBox[{"(", 
     RowBox[{
      TemplateBox[{"p1",OverscriptBox["p3", "_"]},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "+", 
      RowBox[{"z", " ", 
       TemplateBox[{"p1",OverscriptBox["p9", "_"]},
        "SpinorSquareBracket",
        DisplayFunction->(RowBox[{"[", 
           RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
        InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}]}], ")"}]}], 
   RowBox[{
    TemplateBox[{"p7",OverscriptBox["p3", "_"]},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "+", 
    RowBox[{"z", " ", 
     TemplateBox[{"p7",OverscriptBox["p9", "_"]},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}]}]]}]], "Output",
 CellChangeTimes->{{3.79474935888162*^9, 3.7947493667197495`*^9}},
 CellLabel->"Out[61]=",ExpressionUUID->"cf4939a7-ba3d-4b3c-b828-21e82375bc64"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Comparison with previous version", "Subsection",
 CellChangeTimes->{{3.794749398308717*^9, 
  3.7947494077047615`*^9}},ExpressionUUID->"fb9bef28-f62d-4b5e-a7ee-\
6cd7bc118aa1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A4mp", "[", 
   RowBox[{"p1_", ",", "p2_", ",", "p3_", ",", "p4_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Kappa]", "/", "2"}], ")"}], "^", "2"}]}], "*", 
   RowBox[{
    RowBox[{
     TemplateBox[{"p3",RowBox[{"{", "p1", "}"}],"p4"},
      "AngleSquareChain",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
         "$square", "]"}]& )], "^", "4"}], "/", 
    RowBox[{
     RowBox[{"S4", "[", 
      RowBox[{"p1", ",", "p2"}], "]"}], "^", "2"}]}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"I", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"mp", "[", 
         RowBox[{"p3", "+", "p1"}], "]"}], "-", 
        RowBox[{"m", "^", "2"}]}], ")"}]}], "+", 
     RowBox[{"I", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"mp", "[", 
         RowBox[{"p3", "+", "p2"}], "]"}], "-", 
        RowBox[{"m", "^", "2"}]}], ")"}]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{3.7922376386107187`*^9},
 CellLabel->"In[62]:=",ExpressionUUID->"2c56949f-5c3d-4926-ad51-9b378b338d1d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"grtest", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "I"}], "*", 
     RowBox[{"S4", "[", 
      RowBox[{"p1", ",", "p2"}], "]"}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{"I", "*", 
     FractionBox[
      RowBox[{
       TemplateBox[{"p1","p3"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "^", "4"}], 
      RowBox[{
       TemplateBox[{"p1","p2"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], 
       TemplateBox[{"p2","p3"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], 
       TemplateBox[{"p3","p4"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], 
       TemplateBox[{"p4","p1"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}]]}], ")"}], 
   RowBox[{"(", 
    RowBox[{"I", "*", 
     FractionBox[
      RowBox[{
       TemplateBox[{"p1","p3"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "^", "4"}], 
      RowBox[{
       TemplateBox[{"p1","p2"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], 
       TemplateBox[{"p2","p4"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], 
       TemplateBox[{"p4","p3"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], 
       TemplateBox[{"p3","p1"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}]]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.794749648826609*^9, 3.7947497087952642`*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"0916a85f-1a94-4e73-8404-4e766992d4f9"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"S4", "[", 
     RowBox[{"p1", ",", "p2"}], "]"}], " ", 
    SuperscriptBox[
     TemplateBox[{"p1","p3"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "7"]}], 
   RowBox[{
    SuperscriptBox[
     TemplateBox[{"p1","p2"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
    TemplateBox[{"p1","p4"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"p2","p3"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"p2","p4"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    SuperscriptBox[
     TemplateBox[{"p3","p4"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "2"]}]]}]], "Output",
 CellChangeTimes->{3.7947494731832438`*^9, 3.7947495232369404`*^9, 
  3.794749709481186*^9},
 CellLabel->"Out[73]=",ExpressionUUID->"be198d24-38a7-4b2a-acfe-acb6b5e75273"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SpinorReplace", "[", 
   RowBox[{"grtest", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       TemplateBox[{"p1"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
       TemplateBox[{"p5"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
      ",", 
      RowBox[{
       TemplateBox[{"p2"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
       TemplateBox[{"p6"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
      ",", 
      RowBox[{
       TemplateBox[{"p3"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
       TemplateBox[{"p7"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
      ",", 
      RowBox[{
       TemplateBox[{"p4"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
       TemplateBox[{"p8"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], 
     "}"}]}], "]"}], "//", "RepeatedTiming"}]], "Input",
 CellChangeTimes->{{3.7947499552542458`*^9, 3.7947500301675105`*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"d951df46-3cc5-42d2-b521-b01f666824da"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0004324614999999999`1.", ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"S4", "[", 
       RowBox[{"p1", ",", "p2"}], "]"}], " ", 
      SuperscriptBox[
       TemplateBox[{"p5","p7"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "7"]}], 
     RowBox[{
      SuperscriptBox[
       TemplateBox[{"p5","p6"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
      TemplateBox[{"p5","p8"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"p6","p7"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"p6","p8"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      SuperscriptBox[
       TemplateBox[{"p7","p8"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "2"]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7947500238678427`*^9, 3.7947500317011337`*^9}},
 CellLabel->"Out[89]=",ExpressionUUID->"d76632cd-8522-4445-b9a0-cf3a43f4fee7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SpinorReplace2", "[", 
   RowBox[{"grtest", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       TemplateBox[{"p1"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
       TemplateBox[{"p5"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
      ",", 
      RowBox[{
       TemplateBox[{"p2"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
       TemplateBox[{"p6"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
      ",", 
      RowBox[{
       TemplateBox[{"p3"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
       TemplateBox[{"p7"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
      ",", 
      RowBox[{
       TemplateBox[{"p4"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
       TemplateBox[{"p8"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], 
     "}"}]}], "]"}], "//", "RepeatedTiming"}]], "Input",
 CellChangeTimes->{3.794750041387506*^9},
 CellLabel->"In[90]:=",ExpressionUUID->"1fa7e1b1-5f4c-4486-acee-f7f45fa96327"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.000840724038461539`1.", ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"S4", "[", 
       RowBox[{"p1", ",", "p2"}], "]"}], " ", 
      SuperscriptBox[
       TemplateBox[{"p5","p7"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "7"]}], 
     RowBox[{
      SuperscriptBox[
       TemplateBox[{"p5","p6"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
      TemplateBox[{"p5","p8"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"p6","p7"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"p6","p8"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      SuperscriptBox[
       TemplateBox[{"p7","p8"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "2"]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.794750043198017*^9},
 CellLabel->"Out[90]=",ExpressionUUID->"15702290-ab6a-490a-bd89-c0f211b3b7ff"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Gluons", "Subsection",
 CellChangeTimes->{{3.7638907132104855`*^9, 
  3.763890714249737*^9}},ExpressionUUID->"156dc702-72f2-4233-8f6a-\
5bc1948b0e64"],

Cell[BoxData["NewProcess"], "Input",
 CellChangeTimes->{{3.763890699121151*^9, 3.7638907014209995`*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"256d8cc9-b4db-497e-a01a-5e1dd490eba7"],

Cell[BoxData[
 RowBox[{"KillMasses", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.763890703470558*^9, 3.763890709442602*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"b15787af-aca2-4b4c-b8e9-a932b1d3b4e6"],

Cell[BoxData[
 RowBox[{"To4DAlways", "[", "True", "]"}]], "Input",
 CellChangeTimes->{{3.794750256943302*^9, 3.794750268296935*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"c1668be0-9fd1-4929-89bd-a17394e4c908"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TrF4tree", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Fstrength", "[", "1", "]"}], "[", 
       RowBox[{"AA", ",", "BB"}], "]"}], "[", 
      RowBox[{"CC", ",", "DD"}], "]"}], "[", 
     RowBox[{"a", ",", "adot"}], "]"}], 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Fstrength", "[", "2", "]"}], "[", 
       RowBox[{"CC", ",", "DD"}], "]"}], "[", 
      RowBox[{"EE", ",", "FF"}], "]"}], "[", 
     RowBox[{"b", ",", "bdot"}], "]"}], 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Fstrength", "[", "3", "]"}], "[", 
       RowBox[{"EE", ",", "FF"}], "]"}], "[", 
      RowBox[{"GG", ",", "HH"}], "]"}], "[", 
     RowBox[{"c", ",", "cdot"}], "]"}], 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Fstrength", "[", "4", "]"}], "[", 
       RowBox[{"GG", ",", "HH"}], "]"}], "[", 
      RowBox[{"AA", ",", "BB"}], "]"}], "[", 
     RowBox[{"d", ",", "ddot"}], "]"}]}], "//", "Expand"}]}]], "Input",
 CellChangeTimes->{{3.7638907384689703`*^9, 3.7638908313286343`*^9}, {
  3.76389091417316*^9, 3.763890917683772*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"8c47f618-aa87-4290-bc5c-390762ba5729"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{"1","4","a","ddot"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], " ", 
   TemplateBox[{"2","3","b","cdot"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], " ", 
   TemplateBox[{"3","2","c","bdot"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], " ", 
   TemplateBox[{"4","1","d","adot"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )]}], "-", 
  RowBox[{
   TemplateBox[{"1","3","a","cdot"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], " ", 
   TemplateBox[{"2","4","b","ddot"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], " ", 
   TemplateBox[{"3","2","c","bdot"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], " ", 
   TemplateBox[{"4","1","d","adot"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )]}], "-", 
  RowBox[{
   TemplateBox[{"1","4","a","ddot"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], " ", 
   TemplateBox[{"2","3","b","cdot"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], " ", 
   TemplateBox[{"3","1","c","adot"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], " ", 
   TemplateBox[{"4","2","d","bdot"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )]}], "+", 
  RowBox[{
   TemplateBox[{"1","3","a","cdot"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], " ", 
   TemplateBox[{"2","4","b","ddot"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], " ", 
   TemplateBox[{"3","1","c","adot"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], " ", 
   TemplateBox[{"4","2","d","bdot"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )]}], "-", 
  RowBox[{
   TemplateBox[{"1","3","a","cdot"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], " ", 
   TemplateBox[{"2","1","b","adot"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], " ", 
   TemplateBox[{"3","4","c","ddot"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], " ", 
   TemplateBox[{"4","2","d","bdot"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )]}], "-", 
  RowBox[{
   TemplateBox[{"1","2","a","bdot"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], " ", 
   TemplateBox[{"2","4","b","ddot"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], " ", 
   TemplateBox[{"3","1","c","adot"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], " ", 
   TemplateBox[{"4","3","d","cdot"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )]}], "+", 
  RowBox[{
   TemplateBox[{"1","2","a","bdot"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], " ", 
   TemplateBox[{"2","1","b","adot"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], " ", 
   TemplateBox[{"3","4","c","ddot"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], " ", 
   TemplateBox[{"4","3","d","cdot"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )]}]}]], "Output",
 CellChangeTimes->{
  3.7638908317435255`*^9, 3.7638910216517124`*^9, {3.794750242201088*^9, 
   3.7947502712638073`*^9}, 3.7954419697628155`*^9},
 CellLabel->
  "Out[125]=",ExpressionUUID->"9a2171e5-b02c-4f33-9580-ce2893e7a15b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"i", "\[Rule]", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{
        "a", ",", "b", ",", "c", ",", "d", ",", "adot", ",", "bdot", ",", 
         "cdot", ",", "ddot"}], "}"}]}], "}"}]}], "]"}]}], "//", 
  "SchoutenSimplify"}]], "Input",
 CellChangeTimes->{{3.7638910243126354`*^9, 3.7638910500099344`*^9}, {
  3.7638911420118957`*^9, 3.7638911459543285`*^9}},
 CellLabel->
  "In[224]:=",ExpressionUUID->"573876a3-4a3a-4f4e-802a-d6708c116a7a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "2"}], " ", 
  TemplateBox[{"1","2"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], " ", 
  TemplateBox[{"1","4"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], " ", 
  TemplateBox[{"2","3"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], " ", 
  TemplateBox[{"3","4"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )]}]], "Output",
 CellChangeTimes->{3.7638910536990194`*^9, 3.7638911465287914`*^9},
 CellLabel->
  "Out[224]=",ExpressionUUID->"1e7a68c8-2079-4c26-86d8-e331537393ba"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Using", " ", "the", " ", "generalization", " ", "of", " ", "Schouten", " ",
    "one", " ", "can", " ", "recast", " ", "this", " ", "in", " ", "the", " ",
    "form", " ", 
   RowBox[{"(", 
    RowBox[{
    "having", " ", "already", " ", "substituted", " ", "the", " ", "helicity",
      " ", "indices"}], ")"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.763890842323234*^9, 
  3.7638909304506197`*^9}},ExpressionUUID->"01670609-9628-46b0-aec2-\
755904b10b73"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TrF4treenice", "=", 
  RowBox[{
   RowBox[{
    TemplateBox[{"1","4","1","1"},
     "AngSquInvariant",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[#, #3], ",", 
        SubscriptBox[#2, #4], "]"}]& ),
     InterpretationFunction->(
      RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
        "]"}]& )], 
    TemplateBox[{"2","1","1","1"},
     "AngSquInvariant",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[#, #3], ",", 
        SubscriptBox[#2, #4], "]"}]& ),
     InterpretationFunction->(
      RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
        "]"}]& )], 
    TemplateBox[{"3","2","1","1"},
     "AngSquInvariant",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[#, #3], ",", 
        SubscriptBox[#2, #4], "]"}]& ),
     InterpretationFunction->(
      RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
        "]"}]& )], 
    TemplateBox[{"4","3","1","1"},
     "AngSquInvariant",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[#, #3], ",", 
        SubscriptBox[#2, #4], "]"}]& ),
     InterpretationFunction->(
      RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
        "]"}]& )]}], "+", 
   RowBox[{
    TemplateBox[{"1","2","1","1"},
     "AngSquInvariant",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[#, #3], ",", 
        SubscriptBox[#2, #4], "]"}]& ),
     InterpretationFunction->(
      RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
        "]"}]& )], 
    TemplateBox[{"2","3","1","1"},
     "AngSquInvariant",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[#, #3], ",", 
        SubscriptBox[#2, #4], "]"}]& ),
     InterpretationFunction->(
      RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
        "]"}]& )], 
    TemplateBox[{"3","4","1","1"},
     "AngSquInvariant",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[#, #3], ",", 
        SubscriptBox[#2, #4], "]"}]& ),
     InterpretationFunction->(
      RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
        "]"}]& )], 
    TemplateBox[{"4","1","1","1"},
     "AngSquInvariant",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[#, #3], ",", 
        SubscriptBox[#2, #4], "]"}]& ),
     InterpretationFunction->(
      RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
        "]"}]& )]}], "+", 
   RowBox[{
    TemplateBox[{"1","2","3","4","1","1","1","1"},
     "AngAngInvariant",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[#, #5], ",", 
        SubscriptBox[#2, #6], ",", 
        SubscriptBox[#3, #7], ",", 
        SubscriptBox[#4, #8], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(
      RowBox[{"AngAngInvariant", "[", #, ",", #2, ",", #3, ",", #4, "]", 
        "[", #5, ",", #6, ",", #7, ",", #8, "]"}]& )], 
    TemplateBox[{"1","2","3","4","1","1","1","1"},
     "SquSquInvariant",
     DisplayFunction->(RowBox[{"[", 
        SubscriptBox[#, #5], ",", 
        SubscriptBox[#2, #6], ",", 
        SubscriptBox[#3, #7], ",", 
        SubscriptBox[#4, #8], "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SquSquInvariant", "[", #, ",", #2, ",", #3, ",", #4, "]", 
        "[", #5, ",", #6, ",", #7, ",", #8, "]"}]& )]}]}]}]], "Input",
 CellChangeTimes->{{3.763890865576059*^9, 3.763890882147794*^9}, {
  3.763891109947611*^9, 3.763891116996804*^9}, {3.7947502509489584`*^9, 
  3.794750254109806*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"9c6b8fe6-a7c1-4631-bff3-5ead20011d1e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "2"}], " ", 
  TemplateBox[{"1","2"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], " ", 
  TemplateBox[{"1","4"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], " ", 
  TemplateBox[{"2","3"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], " ", 
  TemplateBox[{"3","4"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )]}]], "Output",
 CellChangeTimes->{
  3.7638909327813845`*^9, {3.7638911107006207`*^9, 3.7638911177058687`*^9}, 
   3.7947502469510083`*^9, 3.7947502772729173`*^9, 3.7947510209571133`*^9, 
   3.7954419741863832`*^9},
 CellLabel->
  "Out[126]=",ExpressionUUID->"ff72dea1-bbfe-4fb1-9714-817f23d5ab92"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "In", " ", "the", " ", "following", " ", "an", " ", "arbitrary", " ", 
    "parameter", " ", "\[Alpha]", " ", "has", " ", "been", " ", "added"}], 
   ",", " ", 
   RowBox[{
   "which", " ", "led", " ", "initially", " ", "to", " ", "the", " ", "so", 
    " ", "called", " ", "De", " ", "Angelis", " ", "conjecture"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.763891465259435*^9, 
  3.7638914967422504`*^9}},ExpressionUUID->"c678ae43-d625-48e6-8624-\
9f35d0bffc66"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TrF4loop", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", "TrF4treenice"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          TemplateBox[{RowBox[{"-", "l1"}],"4","a","1"},
           "AngSquInvariant",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              SubscriptBox[#, #3], ",", 
              SubscriptBox[#2, #4], "]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4,
               "]"}]& )], 
          TemplateBox[{RowBox[{"-", "l2"}],RowBox[{"-", "l1"}],"b","adot"},
           "AngSquInvariant",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              SubscriptBox[#, #3], ",", 
              SubscriptBox[#2, #4], "]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4,
               "]"}]& )], 
          TemplateBox[{"3",RowBox[{"-", "l2"}],"1","bdot"},
           "AngSquInvariant",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              SubscriptBox[#, #3], ",", 
              SubscriptBox[#2, #4], "]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4,
               "]"}]& )], 
          TemplateBox[{"4","3","1","1"},
           "AngSquInvariant",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              SubscriptBox[#, #3], ",", 
              SubscriptBox[#2, #4], "]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4,
               "]"}]& )]}], "+", 
         RowBox[{
          TemplateBox[{RowBox[{"-", "l1"}],RowBox[{"-", "l2"}],"a","bdot"},
           "AngSquInvariant",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              SubscriptBox[#, #3], ",", 
              SubscriptBox[#2, #4], "]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4,
               "]"}]& )], 
          TemplateBox[{RowBox[{"-", "l2"}],"3","b","1"},
           "AngSquInvariant",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              SubscriptBox[#, #3], ",", 
              SubscriptBox[#2, #4], "]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4,
               "]"}]& )], 
          TemplateBox[{"3","4","1","1"},
           "AngSquInvariant",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              SubscriptBox[#, #3], ",", 
              SubscriptBox[#2, #4], "]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4,
               "]"}]& )], 
          TemplateBox[{"4",RowBox[{"-", "l1"}],"1","adot"},
           "AngSquInvariant",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              SubscriptBox[#, #3], ",", 
              SubscriptBox[#2, #4], "]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4,
               "]"}]& )]}], "+", 
         RowBox[{"\[Alpha]", "*", 
          
          TemplateBox[{
           RowBox[{"-", "l1"}],RowBox[{"-", "l2"}],"3","4","a","b","1","1"},
           "AngAngInvariant",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              SubscriptBox[#, #5], ",", 
              SubscriptBox[#2, #6], ",", 
              SubscriptBox[#3, #7], ",", 
              SubscriptBox[#4, #8], "\[RightAngleBracket]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"AngAngInvariant", "[", #, ",", #2, ",", #3, ",", #4, "]",
               "[", #5, ",", #6, ",", #7, ",", #8, "]"}]& )], 
          
          TemplateBox[{
           RowBox[{"-", "l1"}],RowBox[{"-", "l2"}],"3","4","adot","bdot","1",
            "1"},
           "SquSquInvariant",
           DisplayFunction->(RowBox[{"[", 
              SubscriptBox[#, #5], ",", 
              SubscriptBox[#2, #6], ",", 
              SubscriptBox[#3, #7], ",", 
              SubscriptBox[#4, #8], "]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"SquSquInvariant", "[", #, ",", #2, ",", #3, ",", #4, "]",
               "[", #5, ",", #6, ",", #7, ",", #8, "]"}]& )]}]}], ")"}], "*", 
       FractionBox[
        RowBox[{"-", "I"}], 
        RowBox[{
         TemplateBox[{"1","2"},
          "SpinorAngleBracket",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
             RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
          InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], 
         TemplateBox[{"2","1"},
          "SpinorSquareBracket",
          DisplayFunction->(RowBox[{"[", 
             RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
          InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], 
         RowBox[{"S", "[", 
          RowBox[{"2", ",", "l2"}], "]"}]}]], "*", 
       TemplateBox[{"1","2","l2","l1","1","1","c","d"},
        "AngAngInvariant",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           SubscriptBox[#, #5], ",", 
           SubscriptBox[#2, #6], ",", 
           SubscriptBox[#3, #7], ",", 
           SubscriptBox[#4, #8], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(
         RowBox[{"AngAngInvariant", "[", #, ",", #2, ",", #3, ",", #4, "]", 
           "[", #5, ",", #6, ",", #7, ",", #8, "]"}]& )], "*", 
       TemplateBox[{"1","2","l2","l1","1","1","cdot","ddot"},
        "SquSquInvariant",
        DisplayFunction->(RowBox[{"[", 
           SubscriptBox[#, #5], ",", 
           SubscriptBox[#2, #6], ",", 
           SubscriptBox[#3, #7], ",", 
           SubscriptBox[#4, #8], "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SquSquInvariant", "[", #, ",", #2, ",", #3, ",", #4, "]", 
           "[", #5, ",", #6, ",", #7, ",", #8, "]"}]& )], "*", 
       TemplateBox[{"a","d"},
        "levicivita2up",
        DisplayFunction->(SuperscriptBox["\[Epsilon]", 
          RowBox[{#, #2}]]& ),
        InterpretationFunction->(
         RowBox[{"levicivita2up", "[", #, ",", #2, "]"}]& )], "*", 
       TemplateBox[{"b","c"},
        "levicivita2up",
        DisplayFunction->(SuperscriptBox["\[Epsilon]", 
          RowBox[{#, #2}]]& ),
        InterpretationFunction->(
         RowBox[{"levicivita2up", "[", #, ",", #2, "]"}]& )], "*", 
       TemplateBox[{"adot","ddot"},
        "levicivita2up",
        DisplayFunction->(SuperscriptBox["\[Epsilon]", 
          RowBox[{#, #2}]]& ),
        InterpretationFunction->(
         RowBox[{"levicivita2up", "[", #, ",", #2, "]"}]& )], "*", 
       TemplateBox[{"bdot","cdot"},
        "levicivita2up",
        DisplayFunction->(SuperscriptBox["\[Epsilon]", 
          RowBox[{#, #2}]]& ),
        InterpretationFunction->(
         RowBox[{"levicivita2up", "[", #, ",", #2, "]"}]& )]}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"b", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"d", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"adot", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"bdot", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"cdot", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ddot", ",", "2"}], "}"}]}], "]"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"extramass", "[", "l2", "]"}], "\[Rule]", 
      RowBox[{"-", 
       RowBox[{"extramass", "[", "l1", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"extramasstilde", "[", "l2", "]"}], "\[Rule]", 
      RowBox[{"-", 
       RowBox[{"extramasstilde", "[", "l1", "]"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TrF4loop", "=", 
   RowBox[{"%", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"extramass", "[", "x_", "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"m", "^", "2"}], "/", 
       RowBox[{"(", 
        RowBox[{"extramasstilde", "[", "x", "]"}], ")"}]}]}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7638909643130856`*^9, 3.763891018743543*^9}, {
   3.7638911647910123`*^9, 3.7638911824996467`*^9}, {3.763891244960327*^9, 
   3.763891246318696*^9}, {3.7638914528605895`*^9, 3.7638914545570045`*^9}, 
   3.763895242083912*^9, {3.7640642690537343`*^9, 3.7640642831300945`*^9}, {
   3.7947502947222843`*^9, 3.794750314315245*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"ef565b54-226b-429c-b07a-2cb067f1522e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "TrF4loop", "]"}]], "Input",
 CellChangeTimes->{{3.7947504236616445`*^9, 3.7947504277905416`*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"7725d7c4-0058-4788-9d70-9c24574a6f3f"],

Cell[BoxData["27"], "Output",
 CellChangeTimes->{3.794750428232559*^9, 3.794751030663978*^9, 
  3.7954419798980083`*^9},
 CellLabel->
  "Out[130]=",ExpressionUUID->"9348626f-e007-4b58-b6a1-2f173cef662e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SpinorReplace", "[", 
   RowBox[{"TrF4loop", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       TemplateBox[{"l1"},
        "SpinorUndotPureM",
        DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
       TemplateBox[{"l2"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
      ",", 
      RowBox[{
       TemplateBox[{"l1"},
        "SpinorDotPureM",
        DisplayFunction->(RowBox[{
           OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
       TemplateBox[{"3"},
        "SpinorDotPureL",
        DisplayFunction->(RowBox[{
           OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], ",", 
      RowBox[{
       TemplateBox[{"l2"},
        "SpinorUndotPureM",
        DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
       TemplateBox[{"l1"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
      ",", 
      RowBox[{
       TemplateBox[{"l2"},
        "SpinorDotPureM",
        DisplayFunction->(RowBox[{
           OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
       TemplateBox[{"3"},
        "SpinorDotPureL",
        DisplayFunction->(RowBox[{
           OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], 
     "}"}]}], "]"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.794750338890738*^9, 3.7947504323554068`*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"905605ff-1461-442b-a209-de0fdbfb07d2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.012459`", ",", 
   RowBox[{
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["m", "4"], " ", 
      TemplateBox[{"3","4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "l2"}], "]"}], " ", 
      TemplateBox[{"1","2"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"1","4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"2","3"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}]], "-", 
    FractionBox[
     RowBox[{"2", " ", "\[ImaginaryI]", " ", 
      SuperscriptBox["m", "4"], " ", "\[Alpha]", " ", 
      TemplateBox[{"3","4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "l2"}], "]"}], " ", 
      TemplateBox[{"1","2"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"1","4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"2","3"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}]], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["m", "2"], " ", 
      TemplateBox[{"l1","l2"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"3","l2"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"4","l1"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "l2"}], "]"}], " ", 
      TemplateBox[{"1","2"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"1","4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"2","3"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}]], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox[
       TemplateBox[{"l1","l2"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
      TemplateBox[{"3","l2"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"4","l1"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"l1","l2"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "l2"}], "]"}], " ", 
      TemplateBox[{"1","2"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"1","4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"2","3"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.794750400772504*^9, 3.7947504327996283`*^9},
 CellLabel->
  "Out[105]=",ExpressionUUID->"41987327-575a-4705-a689-5417888e58bc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SpinorReplace2", "[", 
   RowBox[{"TrF4loop", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       TemplateBox[{"l1"},
        "SpinorUndotPureM",
        DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
       TemplateBox[{"l2"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
      ",", 
      RowBox[{
       TemplateBox[{"l1"},
        "SpinorDotPureM",
        DisplayFunction->(RowBox[{
           OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
       TemplateBox[{"3"},
        "SpinorDotPureL",
        DisplayFunction->(RowBox[{
           OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], ",", 
      RowBox[{
       TemplateBox[{"l2"},
        "SpinorUndotPureM",
        DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
       TemplateBox[{"l1"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
      ",", 
      RowBox[{
       TemplateBox[{"l2"},
        "SpinorDotPureM",
        DisplayFunction->(RowBox[{
           OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
       TemplateBox[{"3"},
        "SpinorDotPureL",
        DisplayFunction->(RowBox[{
           OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], 
     "}"}]}], "]"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{3.7947504422858596`*^9},
 CellLabel->
  "In[106]:=",ExpressionUUID->"224c7179-d472-4f27-95f7-80b6f1fcde49"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0211316`", ",", 
   RowBox[{
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["m", "4"], " ", 
      TemplateBox[{"3","4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "l2"}], "]"}], " ", 
      TemplateBox[{"1","2"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"1","4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"2","3"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}]], "-", 
    FractionBox[
     RowBox[{"2", " ", "\[ImaginaryI]", " ", 
      SuperscriptBox["m", "4"], " ", "\[Alpha]", " ", 
      TemplateBox[{"3","4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "l2"}], "]"}], " ", 
      TemplateBox[{"1","2"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"1","4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"2","3"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}]], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["m", "2"], " ", 
      TemplateBox[{"l1","l2"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"3","l2"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"4","l1"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "l2"}], "]"}], " ", 
      TemplateBox[{"1","2"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"1","4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"2","3"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}]], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox[
       TemplateBox[{"l1","l2"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
      TemplateBox[{"3","l2"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"4","l1"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"l1","l2"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "l2"}], "]"}], " ", 
      TemplateBox[{"1","2"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"1","4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"2","3"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.7947504431048193`*^9},
 CellLabel->
  "Out[106]=",ExpressionUUID->"66db0fb2-9e2a-4dd5-9bf7-3895ed122066"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "Somehow", " ", "it", " ", "is", " ", "much", " ", "slower", " ", "than", 
    " ", "the", " ", "old", " ", 
    RowBox[{"version", ".", " ", "I"}], " ", "guess", " ", "because", " ", 
    "of", " ", "all", " ", "the", " ", "replacements", " ", "you", " ", 
    "have", " ", "to", " ", 
    RowBox[{"build", ".", " ", "I"}], " ", "suppose", " ", "that", " ", "it", 
    " ", "will", " ", "be", " ", "faster", " ", "and", " ", "faster", " ", 
    "the", " ", "more", " ", "terms", " ", "there", " ", "are"}], ",", " ", 
   RowBox[{
    RowBox[{"or", " ", "at", " ", "least", " ", "I", " ", "hope", " ", "so"}],
     "..."}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.794750501755795*^9, 
  3.7947505689409256`*^9}},ExpressionUUID->"f880c812-6dc9-44ae-9c40-\
54bcbfbb309f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ultrasum", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "i", "]"}], "*", "TrF4loop"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "100"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7947505722740498`*^9, 3.7947506059323177`*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"3ed7bbfd-7d87-499d-a017-b9f28ce31774"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SpinorReplace", "[", 
    RowBox[{"ultrasum", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        TemplateBox[{"l1"},
         "SpinorUndotPureM",
         DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"l2"},
         "SpinorUndotPureL",
         DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
       ",", 
       RowBox[{
        TemplateBox[{"l1"},
         "SpinorDotPureM",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"3"},
         "SpinorDotPureL",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], ",", 
       RowBox[{
        TemplateBox[{"l2"},
         "SpinorUndotPureM",
         DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"l1"},
         "SpinorUndotPureL",
         DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
       ",", 
       RowBox[{
        TemplateBox[{"l2"},
         "SpinorDotPureM",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"3"},
         "SpinorDotPureL",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], 
      "}"}]}], "]"}], "//", "AbsoluteTiming"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "[", 
  RowBox[{"[", "1", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.794750338890738*^9, 3.7947504323554068`*^9}, {
  3.79475065156732*^9, 3.7947506841834335`*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"956bf133-9a63-457b-bd0a-fb89c561c3ed"],

Cell[BoxData["1.4191944`"], "Output",
 CellChangeTimes->{
  3.794750400772504*^9, 3.7947504327996283`*^9, {3.7947506575300527`*^9, 
   3.7947506865822783`*^9}},
 CellLabel->
  "Out[113]=",ExpressionUUID->"fb1afc4e-12f6-4d25-982d-ba1601f97383"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SpinorReplace2", "[", 
    RowBox[{"ultrasum", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        TemplateBox[{"l1"},
         "SpinorUndotPureM",
         DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"l2"},
         "SpinorUndotPureL",
         DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
       ",", 
       RowBox[{
        TemplateBox[{"l1"},
         "SpinorDotPureM",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"3"},
         "SpinorDotPureL",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], ",", 
       RowBox[{
        TemplateBox[{"l2"},
         "SpinorUndotPureM",
         DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"l1"},
         "SpinorUndotPureL",
         DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
       ",", 
       RowBox[{
        TemplateBox[{"l2"},
         "SpinorDotPureM",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"3"},
         "SpinorDotPureL",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], 
      "}"}]}], "]"}], "//", "AbsoluteTiming"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "[", 
  RowBox[{"[", "1", "]"}], "]"}]}], "Input",
 CellChangeTimes->{
  3.7947504422858596`*^9, {3.794750690716691*^9, 3.7947507008011045`*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"d3c69e87-a625-47c0-8175-9bd4a6aa286c"],

Cell[BoxData["0.494205`"], "Output",
 CellChangeTimes->{3.7947504431048193`*^9, 3.7947507021631794`*^9},
 CellLabel->
  "Out[115]=",ExpressionUUID->"06df4d53-413b-4c7f-b012-4a167640a133"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ultrasum2", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "i", "]"}], "*", "TrF4loop"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1000"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7947505722740498`*^9, 3.7947506059323177`*^9}, {
  3.7947507257518635`*^9, 3.7947507289520197`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"ec6019f3-af70-4650-870a-4bfb353f3211"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SpinorReplace", "[", 
    RowBox[{"ultrasum2", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        TemplateBox[{"l1"},
         "SpinorUndotPureM",
         DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"l2"},
         "SpinorUndotPureL",
         DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
       ",", 
       RowBox[{
        TemplateBox[{"l1"},
         "SpinorDotPureM",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"3"},
         "SpinorDotPureL",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], ",", 
       RowBox[{
        TemplateBox[{"l2"},
         "SpinorUndotPureM",
         DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"l1"},
         "SpinorUndotPureL",
         DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
       ",", 
       RowBox[{
        TemplateBox[{"l2"},
         "SpinorDotPureM",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"3"},
         "SpinorDotPureL",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], 
      "}"}]}], "]"}], "//", "AbsoluteTiming"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "[", 
  RowBox[{"[", "1", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.794750338890738*^9, 3.7947504323554068`*^9}, {
   3.79475065156732*^9, 3.7947506841834335`*^9}, 3.7947507337083645`*^9},
 CellLabel->
  "In[117]:=",ExpressionUUID->"efa2d832-b3e3-4190-9206-dddaf0612b27"],

Cell[BoxData["14.2281744`"], "Output",
 CellChangeTimes->{
  3.794750400772504*^9, 3.7947504327996283`*^9, {3.7947506575300527`*^9, 
   3.7947506865822783`*^9}, 3.7947507484902835`*^9},
 CellLabel->
  "Out[118]=",ExpressionUUID->"a06190c0-6b5f-4577-abbe-6bc594b27aea"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SpinorReplace2", "[", 
    RowBox[{"ultrasum2", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        TemplateBox[{"l1"},
         "SpinorUndotPureM",
         DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"l2"},
         "SpinorUndotPureL",
         DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
       ",", 
       RowBox[{
        TemplateBox[{"l1"},
         "SpinorDotPureM",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"3"},
         "SpinorDotPureL",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], ",", 
       RowBox[{
        TemplateBox[{"l2"},
         "SpinorUndotPureM",
         DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"l1"},
         "SpinorUndotPureL",
         DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
       ",", 
       RowBox[{
        TemplateBox[{"l2"},
         "SpinorDotPureM",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"3"},
         "SpinorDotPureL",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], 
      "}"}]}], "]"}], "//", "AbsoluteTiming"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "[", 
  RowBox[{"[", "1", "]"}], "]"}]}], "Input",
 CellChangeTimes->{
  3.7947504422858596`*^9, {3.794750690716691*^9, 3.7947507008011045`*^9}, 
   3.7947507409070015`*^9},
 CellLabel->
  "In[119]:=",ExpressionUUID->"f223d375-a940-40ca-965c-7d41ae256608"],

Cell[BoxData["3.7050287`"], "Output",
 CellChangeTimes->{3.7947504431048193`*^9, 3.7947507021631794`*^9, 
  3.7947507549024467`*^9},
 CellLabel->
  "Out[120]=",ExpressionUUID->"26b6d206-4b7d-4004-8c46-f78fe0fd731d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "As", " ", "I", " ", "suspected", " ", "the", " ", "new", " ", "version", 
   " ", "works", " ", "far", " ", "better", " ", "with", " ", "a", " ", 
   "higher", " ", "number", " ", "of", " ", "terms"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7947507655192966`*^9, 
  3.7947507870961103`*^9}},ExpressionUUID->"d159b5d2-110f-4a01-bd05-\
f55d3d1b6259"]
}, Closed]],

Cell[CellGroupData[{

Cell["Tests last version", "Subsection",
 CellChangeTimes->{{3.794747914782984*^9, 3.7947479164214306`*^9}, {
  3.7958428453199844`*^9, 
  3.7958428513040895`*^9}},ExpressionUUID->"9aec7acf-fa32-4847-b205-\
cce18bf563e2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"plain", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     TemplateBox[{"p1"},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
     TemplateBox[{"p3"},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], ",", 
    RowBox[{
     TemplateBox[{"p2"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
     TemplateBox[{"p4"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.7947480262295275`*^9, 3.7947480452782526`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"103c83cd-b78e-407c-9156-1ccd287c20e4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    TemplateBox[{"p1"},
     "SpinorUndotPureL",
     DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], 
    "\[Rule]", 
    TemplateBox[{"p3"},
     "SpinorUndotPureL",
     DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], ",", 
   RowBox[{
    TemplateBox[{"p2"},
     "SpinorDotPureL",
     DisplayFunction->(RowBox[{
        OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "\[Rule]", 
    TemplateBox[{"p4"},
     "SpinorDotPureL",
     DisplayFunction->(RowBox[{
        OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7947480460299397`*^9, 3.7958428574524593`*^9, 
  3.7958447632529535`*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"312145da-309c-42f8-8c1b-6a65b9487089"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyplain", "[", "x_", "]"}], ":=", 
  RowBox[{"SpinorReplace2", "[", 
   RowBox[{"x", ",", "plain"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7947480471822634`*^9, 3.7947480660139437`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"b003e034-0194-4f5c-9daa-7e812614290d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"linear1", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     TemplateBox[{"p1"},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
     RowBox[{
      TemplateBox[{"p3"},
       "SpinorUndotPureL",
       DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "+", 
      RowBox[{"z", "*", 
       TemplateBox[{"p5"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}]}],
     ",", 
    RowBox[{
     TemplateBox[{"p2"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
     RowBox[{
      TemplateBox[{"p4"},
       "SpinorDotPureL",
       DisplayFunction->(RowBox[{
          OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "-", 
      RowBox[{"z", "*", 
       TemplateBox[{"p6"},
        "SpinorDotPureL",
        DisplayFunction->(RowBox[{
           OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}]}]}],
    "}"}]}]], "Input",
 CellChangeTimes->{{3.794747921725979*^9, 3.7947480412086067`*^9}, {
   3.7947480722120695`*^9, 3.794748086620783*^9}, 3.7958428653090897`*^9},
 CellLabel->"In[6]:=",ExpressionUUID->"468094c1-819b-45ed-89ff-84ce7554cfda"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    TemplateBox[{"p1"},
     "SpinorUndotPureL",
     DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], 
    "\[Rule]", 
    RowBox[{
     TemplateBox[{"p3"},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "+", 
     RowBox[{"z", " ", 
      TemplateBox[{"p5"},
       "SpinorUndotPureL",
       DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}]}], 
   ",", 
   RowBox[{
    TemplateBox[{"p2"},
     "SpinorDotPureL",
     DisplayFunction->(RowBox[{
        OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "\[Rule]", 
    RowBox[{
     TemplateBox[{"p4"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "-", 
     RowBox[{"z", " ", 
      TemplateBox[{"p6"},
       "SpinorDotPureL",
       DisplayFunction->(RowBox[{
          OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7947480871615686`*^9, 3.7958428664158044`*^9, 
  3.7958447635381975`*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"056057f3-4ce0-4fcb-a572-8695a91c3963"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"applylinear", "[", "x_", "]"}], ":=", 
  RowBox[{"SpinorReplace2", "[", 
   RowBox[{"x", ",", "linear1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.794748088253676*^9, 3.794748109106122*^9}, 
   3.795842869599553*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"bee66237-b52c-4913-84ff-d08bb810eca2"],

Cell[CellGroupData[{

Cell["Angles", "Subsubsection",
 CellChangeTimes->{{3.794748120284717*^9, 
  3.794748121229681*^9}},ExpressionUUID->"8994a5cf-289d-47ae-a7aa-\
46939e1503e0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1","p2"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947481153272667`*^9, 3.794748131915908*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"f70ccb1c-81bb-4d60-88de-d9506522744c"],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{"p2","p3"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )]}]], "Output",
 CellChangeTimes->{3.7947481324221945`*^9, 3.7958428731145277`*^9, 
  3.7958450507860284`*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"cf237b61-b67e-4934-87f6-f7d2acd8ae8a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"l1","p1"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.794748136204043*^9, 3.794748145699086*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"d897b425-be07-408a-8ed7-dfe8a61f246e"],

Cell[BoxData[
 TemplateBox[{"l1","p3"},
  "SpinorAngleBracket",
  DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
     RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
  InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
     RowBox[{#, ",", #2}], "]"}]& )]], "Output",
 CellChangeTimes->{3.794748146193217*^9, 3.795842874173117*^9, 
  3.795845051013743*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"242f6404-7bc7-4b9c-bb1b-99b434502fe4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1","p2"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.7947481153272667`*^9, 3.794748131915908*^9}, {
  3.7947481725401154`*^9, 3.7947481743202057`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"edecdf92-0627-4777-ac4a-7d5599152dd1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   TemplateBox[{"p2","p3"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}], "-", 
  RowBox[{"z", " ", 
   TemplateBox[{"p2","p5"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.7947481324221945`*^9, 3.794748174981965*^9, 
  3.7958428750719204`*^9, 3.7958450511216393`*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"e2718f32-2050-437e-a56d-df1be8593adf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"l1","p1"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.794748136204043*^9, 3.794748145699086*^9}, {
  3.7947481897953677`*^9, 3.794748192462148*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"daaae3be-a1d2-4ac6-b11d-194584ac0d8d"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"l1","p3"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "+", 
  RowBox[{"z", " ", 
   TemplateBox[{"l1","p5"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.794748146193217*^9, 3.7947481928793297`*^9, 
  3.7958428759467444`*^9, 3.7958450512251205`*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"b6cf71b6-fd2b-4cf6-848e-ff232860bea7"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Squares", "Subsubsection",
 CellChangeTimes->{{3.794748238276725*^9, 
  3.7947482396408043`*^9}},ExpressionUUID->"0337dbcf-93ab-45a6-a863-\
07faf887d50b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1","p2"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.79474824414812*^9, 3.7947482569072113`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"a31f0336-0aaa-401e-9deb-0a798007acb7"],

Cell[BoxData[
 TemplateBox[{"p1","p4"},
  "SpinorSquareBracket",
  DisplayFunction->(RowBox[{"[", 
     RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
  InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
     RowBox[{#, ",", #2}], "]"}]& )]], "Output",
 CellChangeTimes->{3.794748257593755*^9, 3.7958428778480854`*^9, 
  3.7958450564415703`*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"d55a749d-f1a4-4cfe-b7af-e071bfbcba53"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2","p3"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.794748260340469*^9, 3.79474827028979*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"7fb13f5e-7fb3-4fa4-a5e9-5a0e60b02c1f"],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{"p3","p4"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )]}]], "Output",
 CellChangeTimes->{3.794748270799845*^9, 3.7958428785870967`*^9, 
  3.795845056633787*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"1c368ff3-338f-41af-b3af-c876d3d078d2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1","p2"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.79474824414812*^9, 3.79474828679657*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"4d2fa448-41ab-4e3a-85d4-2c0933981fac"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1","p4"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "-", 
  RowBox[{"z", " ", 
   TemplateBox[{"p1","p6"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.794748257593755*^9, 3.7947482877355127`*^9, 
  3.7958428799053373`*^9, 3.7958450567519565`*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"f5e516c5-ec30-4eef-9e32-862c6ade72b3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2","p3"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.794748260340469*^9, 3.7947482920567837`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"ff3681a3-8fc2-4088-b681-9981a61eb46c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   TemplateBox[{"p3","p4"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
  RowBox[{"z", " ", 
   TemplateBox[{"p3","p6"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}]}]], "Output",
 CellChangeTimes->{{3.794748270799845*^9, 3.794748292862301*^9}, 
   3.7958428890737734`*^9, 3.795845056869296*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"5aac1f14-9fe5-400b-ba84-de94f075c619"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Chains angles", "Subsubsection",
 CellChangeTimes->{{3.7947483387073536`*^9, 3.794748339520731*^9}, {
  3.7947486124328513`*^9, 
  3.7947486137365103`*^9}},ExpressionUUID->"fedd52a8-741b-4b95-932d-\
3f06e9f944dc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", "p2", "}"}],"p4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947483448020372`*^9, 3.794748354898479*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"19151209-b398-406b-9a48-7ed987fb8fe1"],

Cell[BoxData[
 TemplateBox[{"p3",RowBox[{"{", "p2", "}"}],"p4"},
  "AngleSquareChain",
  DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.794748355434944*^9, 3.7947488933289223`*^9, 
  3.7958428911038313`*^9, 3.795844400436764*^9, 3.7958447731040893`*^9, 
  3.7958450616192775`*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"08bedfb7-9cf0-4ad8-a57e-78c26f033477"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", "p2", "}"}],"p4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.7947483448020372`*^9, 3.794748354898479*^9}, {
  3.794748445614644*^9, 3.794748447395432*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"9262be44-eac3-4487-81ff-a928fac0256d"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p3",RowBox[{"{", "p2", "}"}],"p4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "+", 
  RowBox[{"z", " ", 
   TemplateBox[{"p5",RowBox[{"{", "p2", "}"}],"p4"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}]}]], "Output",
 CellChangeTimes->{
  3.794748355434944*^9, 3.794748488648471*^9, 3.79474889523454*^9, 
   3.7958444078149867`*^9, 3.7958445101326513`*^9, {3.795844769129387*^9, 
   3.7958447734924088`*^9}, 3.7958450617978525`*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"943e0028-0028-4036-9419-51386a9a19bf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p4",RowBox[{"{", "p2", "}"}],"p1"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947484179908566`*^9, 3.794748454740518*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"8b2ccaf0-9062-4dae-9d13-e9f6672f8182"],

Cell[BoxData[
 TemplateBox[{"p4",RowBox[{"{", "p2", "}"}],"p3"},
  "SquareAngleChain",
  DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.7947484271703844`*^9, 3.7947488978831387`*^9, 
  3.79584451263539*^9, 3.795844773629807*^9, 3.795845061930428*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"007069b5-6c16-4ecc-b275-c72d3145d7eb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p4",RowBox[{"{", "p2", "}"}],"p1"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.794748495006073*^9, 3.7947484966764836`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"039507ce-e8aa-49c0-851d-75a9b249d28a"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p4",RowBox[{"{", "p2", "}"}],"p3"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "+", 
  RowBox[{"z", " ", 
   TemplateBox[{"p4",RowBox[{"{", "p2", "}"}],"p5"},
    "SquareAngleChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle",
        "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.794748497113364*^9, 3.794748899205615*^9, 
  3.795844513809491*^9, 3.7958447737659893`*^9, 3.7958450620494304`*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"d13e5b24-6770-455f-b634-c72aace777c4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", 
      RowBox[{"p2", ",", "p3"}], "}"}],"p4"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947485092847323`*^9, 3.7947485195373297`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"fbc99ad5-5b06-47a7-b43f-1a73a6e4b8b5"],

Cell[BoxData[
 TemplateBox[{"p3",RowBox[{"{", 
     RowBox[{"p2", ",", "p3"}], "}"}],"p4"},
  "AngleAngleChain",
  DisplayFunction->(
   RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.7947485201060905`*^9, 3.79474890481462*^9, 
  3.7958445162613773`*^9, 3.7958447739040227`*^9, 3.795845062165242*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"99638bc9-aac8-4f6a-9673-7e1b083f546d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", 
      RowBox[{"p2", ",", "p3"}], "}"}],"p4"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.7947485291999035`*^9, 3.79474853008352*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"feb7f886-615e-4826-b7c6-bcd93314e047"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p3",RowBox[{"{", 
      RowBox[{"p2", ",", "p3"}], "}"}],"p4"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "+", 
  RowBox[{"z", " ", 
   TemplateBox[{"p5",RowBox[{"{", 
       RowBox[{"p2", ",", "p3"}], "}"}],"p4"},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.7947485305876904`*^9, 3.794748907938732*^9, 
  3.795844517502597*^9, 3.7958447740500126`*^9, 3.795845062286977*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"efc12d42-1898-45b0-a4c2-2f0b3af60ee4"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Chains squares", "Subsubsection",
 CellChangeTimes->{{3.7947483387073536`*^9, 3.794748339520731*^9}, {
  3.7947486124328513`*^9, 
  3.794748633426945*^9}},ExpressionUUID->"b6dcd010-e466-437e-8c35-\
6dba312f5ac6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p3",RowBox[{"{", "p4", "}"}],"p2"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947483448020372`*^9, 3.794748354898479*^9}, {
  3.794748625290289*^9, 3.794748646457346*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"d22d256c-afa2-4afc-8d21-7e3ffc903c18"],

Cell[BoxData[
 TemplateBox[{"p3",RowBox[{"{", "p4", "}"}],"p4"},
  "AngleSquareChain",
  DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
     "]"}]& )]], "Output",
 CellChangeTimes->{
  3.794748355434944*^9, {3.7947486359981284`*^9, 3.794748647732076*^9}, 
   3.7947486869847255`*^9, 3.794748911263562*^9, 3.795844520141059*^9, 
   3.7958451385152283`*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"e108e7d0-9e2c-4dbc-a4ba-52b759a24055"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p3",RowBox[{"{", "p5", "}"}],"p2"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.7947483448020372`*^9, 3.794748354898479*^9}, {
  3.794748445614644*^9, 3.794748447395432*^9}, {3.79474869445179*^9, 
  3.7947487130948706`*^9}, {3.794748919647318*^9, 3.7947489199976115`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"fc4eee4f-0490-4470-a84d-7fdbc9dfd97d"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p3",RowBox[{"{", "p5", "}"}],"p4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "-", 
  RowBox[{"z", " ", 
   TemplateBox[{"p3",RowBox[{"{", "p5", "}"}],"p6"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}]}]], "Output",
 CellChangeTimes->{
  3.794748355434944*^9, 3.794748488648471*^9, {3.79474869604881*^9, 
   3.7947487137469687`*^9}, {3.7947489146617794`*^9, 3.7947489205710754`*^9}, 
   3.7958445216253357`*^9, 3.795845138706133*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"e06da208-9bba-4fde-919c-e56dd572db41"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2",RowBox[{"{", "p4", "}"}],"p3"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947484179908566`*^9, 3.794748454740518*^9}, {
  3.794748948812261*^9, 3.794748953415962*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"a68aa795-fd96-48e3-8a28-d900f8e48d56"],

Cell[BoxData[
 TemplateBox[{"p4",RowBox[{"{", "p4", "}"}],"p3"},
  "SquareAngleChain",
  DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.7947484271703844`*^9, 3.794748954279978*^9, 
  3.7958445229866104`*^9, 3.7958451388394623`*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"7aac3945-30b7-41a6-a9f6-70deef115caa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2",RowBox[{"{", "p4", "}"}],"p3"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.794748495006073*^9, 3.7947484966764836`*^9}, {
  3.7947489602613754`*^9, 3.7947489642467136`*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"b5940af9-58f8-477a-86b4-a919142eb327"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p4",RowBox[{"{", "p4", "}"}],"p3"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "-", 
  RowBox[{"z", " ", 
   TemplateBox[{"p6",RowBox[{"{", "p4", "}"}],"p3"},
    "SquareAngleChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle",
        "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.794748497113364*^9, 3.794748965839892*^9, 
  3.795844524492609*^9, 3.795845138961252*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"a24fcbba-9aed-481e-9248-85f37a5fae9e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2",RowBox[{"{", 
      RowBox[{"p1", ",", "p3"}], "}"}],"p4"},
   "SquareSquareChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square",
       "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947489796149*^9, 3.7947489888202257`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"84b52462-464f-41c4-9528-8fe5c2474b2a"],

Cell[BoxData[
 TemplateBox[{"p4",RowBox[{"{", 
     RowBox[{"p1", ",", "p3"}], "}"}],"p4"},
  "SquareSquareChain",
  DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.7947489892851896`*^9, 3.795844526350099*^9, 
  3.7958451390853744`*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"0607bff0-d8b3-42dd-a2a1-24ede2e3c850"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2",RowBox[{"{", 
      RowBox[{"p1", ",", "p3"}], "}"}],"p4"},
   "SquareSquareChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square",
       "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.794748996211546*^9, 3.7947489969753675`*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"79d7055e-e813-4a21-820a-c532df214f09"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p4",RowBox[{"{", 
      RowBox[{"p1", ",", "p3"}], "}"}],"p4"},
   "SquareSquareChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square",
       "]"}]& )], "-", 
  RowBox[{"z", " ", 
   TemplateBox[{"p6",RowBox[{"{", 
       RowBox[{"p1", ",", "p3"}], "}"}],"p4"},
    "SquareSquareChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
       "$square", "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.7947489975537853`*^9, 3.7958445277622037`*^9, 
  3.795845139207796*^9},
 CellLabel->"Out[34]=",ExpressionUUID->"3db6782c-7d02-4508-ba88-cb09b8927f0b"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Chains mixed", "Subsubsection",
 CellChangeTimes->{{3.7947490375599337`*^9, 
  3.794749039909021*^9}},ExpressionUUID->"e2ef3fc6-8845-47d0-9af3-\
f731b76040b3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", "p8", "}"}],"p2"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947490449664536`*^9, 3.7947490545911417`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"9d74c30a-c001-4bc1-9dfe-aa4df2e96254"],

Cell[BoxData[
 TemplateBox[{"p3",RowBox[{"{", "p8", "}"}],"p4"},
  "AngleSquareChain",
  DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.794749054948547*^9, 3.795844530399457*^9, 
  3.795845142688033*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"db35b864-8444-41a3-8930-2c3c48ff2316"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", "p8", "}"}],"p2"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.794749062592343*^9, 3.7947491061617165`*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"a706f324-ca4d-4067-8f80-3b2f791c40c8"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p3",RowBox[{"{", "p8", "}"}],"p4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "-", 
  RowBox[{"z", " ", 
   TemplateBox[{"p3",RowBox[{"{", "p8", "}"}],"p6"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], "+", 
  RowBox[{"z", " ", 
   RowBox[{"(", 
    RowBox[{
     TemplateBox[{"p5",RowBox[{"{", "p8", "}"}],"p4"},
      "AngleSquareChain",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
         "$square", "]"}]& )], "-", 
     RowBox[{"z", " ", 
      TemplateBox[{"p5",RowBox[{"{", "p8", "}"}],"p6"},
       "AngleSquareChain",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
          "$square", "]"}]& )]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.794749063869943*^9, 3.794749106667944*^9}},
 CellLabel->"Out[52]=",ExpressionUUID->"bcf59044-36e4-48bd-9a89-51a7e28b06eb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", "p8", "}"}],"p2"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellLabel->"In[38]:=",ExpressionUUID->"6e6547b4-7b60-43f3-aa44-272849aa2823"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p3",RowBox[{"{", "p8", "}"}],"p4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "-", 
  RowBox[{"z", " ", 
   TemplateBox[{"p3",RowBox[{"{", "p8", "}"}],"p6"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], "+", 
  RowBox[{"z", " ", 
   TemplateBox[{"p5",RowBox[{"{", "p8", "}"}],"p4"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], "-", 
  RowBox[{
   SuperscriptBox["z", "2"], " ", 
   TemplateBox[{"p5",RowBox[{"{", "p8", "}"}],"p6"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.7958445437452145`*^9, 3.7958451528563347`*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"03825c59-f07b-46e4-824f-b734f06b42da"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["With \[Mu] spinors", "Subsubsection",
 CellChangeTimes->{{3.7947491440787992`*^9, 
  3.7947491490838604`*^9}},ExpressionUUID->"e16af162-a18f-4aab-950a-\
56969467069a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pr", "=", 
  RowBox[{
   TemplateBox[{"p1","p7","1","2"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], "//", "To4D"}]}]], "Input",
 CellChangeTimes->{{3.7947491582174597`*^9, 3.7947492033599286`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"f0dc91b6-25b0-48fa-8a77-4fea14761fd3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     TemplateBox[{"p1"},
      "extramass",
      DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
      InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
     TemplateBox[{"p7",OverscriptBox["p1", "_"]},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], 
    TemplateBox[{"p1",OverscriptBox["p1", "_"]},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]]}], "+", 
  FractionBox[
   RowBox[{
    TemplateBox[{"p7"},
     "extramass",
     DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
     InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
    TemplateBox[{"p1",OverscriptBox["p7", "_"]},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], 
   TemplateBox[{"p7",OverscriptBox["p7", "_"]},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]]}]], "Output",
 CellChangeTimes->{{3.7947491706360226`*^9, 3.794749204260088*^9}, 
   3.7958445901625443`*^9, 3.7958451586305857`*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"1dacbf30-b536-47e6-92a6-33e4011a405e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpinorReplace2", "[", 
  RowBox[{"pr", ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"p1"},
      "SpinorUndotPureM",
      DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
     TemplateBox[{"p2"},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.794749178371219*^9, 3.7947492132648125`*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"58d54392-38d4-4731-89cd-60aabfe3c688"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    TemplateBox[{"p1"},
     "extramass",
     DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
     InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
    TemplateBox[{"p2","p7"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], 
   TemplateBox[{"p1","p2"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]], "+", 
  FractionBox[
   RowBox[{
    TemplateBox[{"p7"},
     "extramass",
     DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
     InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
    TemplateBox[{"p1",OverscriptBox["p7", "_"]},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], 
   TemplateBox[{"p7",OverscriptBox["p7", "_"]},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]]}]], "Output",
 CellChangeTimes->{3.794749214477919*^9, 3.7958445955220947`*^9, 
  3.7958451588866816`*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"8dcef396-ec9c-4494-8e5a-52c02b10df56"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpinorReplace2", "[", 
  RowBox[{"pr", ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"p1"},
      "SpinorUndotPureM",
      DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
     TemplateBox[{"p2"},
      "SpinorUndotPureM",
      DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )]}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.794749232064951*^9, 3.794749241288847*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"4510bae9-ba88-4da6-a390-766b60fd00e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     TemplateBox[{"p1"},
      "extramass",
      DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
      InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
     TemplateBox[{"p7",OverscriptBox["p2", "_"]},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], 
    TemplateBox[{"p1",OverscriptBox["p2", "_"]},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]]}], "+", 
  FractionBox[
   RowBox[{
    TemplateBox[{"p7"},
     "extramass",
     DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
     InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
    TemplateBox[{"p1",OverscriptBox["p7", "_"]},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], 
   TemplateBox[{"p7",OverscriptBox["p7", "_"]},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]]}]], "Output",
 CellChangeTimes->{3.794749242351922*^9, 3.795844598742113*^9, 
  3.795845159044207*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"5e04de3e-a655-4ce8-b473-aa85a4a42d31"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpinorReplace2", "[", 
  RowBox[{"pr", ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"p7"},
      "SpinorDotPureM",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
     TemplateBox[{"p3"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.794749254050561*^9, 3.7947492768712463`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"663f1e4c-80b3-45b6-86d0-e9f6a0985e7a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     TemplateBox[{"p1"},
      "extramass",
      DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
      InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
     TemplateBox[{"p7",OverscriptBox["p1", "_"]},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], 
    TemplateBox[{"p1",OverscriptBox["p1", "_"]},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]]}], "-", 
  FractionBox[
   RowBox[{
    TemplateBox[{"p7"},
     "extramass",
     DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
     InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
    TemplateBox[{"p1","p3"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], 
   TemplateBox[{"p3","p7"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]]}]], "Output",
 CellChangeTimes->{3.7947492781378846`*^9, 3.795844601167265*^9, 
  3.79584515918946*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"51dd4128-40d6-48d6-b2e7-d3e45e0b8c25"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpinorReplace2", "[", 
  RowBox[{"pr", ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"p7"},
      "SpinorDotPureM",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
     TemplateBox[{"p3"},
      "SpinorDotPureM",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )]}], "}"}]}],
   "]"}]], "Input",
 CellChangeTimes->{{3.794749293304788*^9, 3.7947492972929125`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"f625becd-615e-4b3e-9718-378508c5b2bf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     TemplateBox[{"p1"},
      "extramass",
      DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
      InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
     TemplateBox[{"p7",OverscriptBox["p1", "_"]},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], 
    TemplateBox[{"p1",OverscriptBox["p1", "_"]},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]]}], "+", 
  FractionBox[
   RowBox[{
    TemplateBox[{"p7"},
     "extramass",
     DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
     InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
    TemplateBox[{"p1",OverscriptBox["p3", "_"]},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], 
   TemplateBox[{"p7",OverscriptBox["p3", "_"]},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]]}]], "Output",
 CellChangeTimes->{3.794749298086068*^9, 3.7958446029285183`*^9, 
  3.7958451593293395`*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"fdaf33b1-1f32-42d6-9f97-68c891eb719a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpinorReplace2", "[", 
  RowBox[{"pr", ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"p7"},
      "SpinorDotPureM",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
     RowBox[{
      TemplateBox[{"p3"},
       "SpinorDotPureM",
       DisplayFunction->(RowBox[{
          OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "+", 
      RowBox[{"z", "*", 
       TemplateBox[{"p9"},
        "SpinorDotPureM",
        DisplayFunction->(RowBox[{
           OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )]}]}]}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.794749343514308*^9, 3.7947493660069275`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"4ddeb916-5c9a-4405-9afc-b825a6626cfd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     TemplateBox[{"p1"},
      "extramass",
      DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
      InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
     TemplateBox[{"p7",OverscriptBox["p1", "_"]},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], 
    TemplateBox[{"p1",OverscriptBox["p1", "_"]},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]]}], "+", 
  FractionBox[
   RowBox[{
    TemplateBox[{"p7"},
     "extramass",
     DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
     InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
    RowBox[{"(", 
     RowBox[{
      TemplateBox[{"p1",OverscriptBox["p3", "_"]},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "+", 
      RowBox[{"z", " ", 
       TemplateBox[{"p1",OverscriptBox["p9", "_"]},
        "SpinorSquareBracket",
        DisplayFunction->(RowBox[{"[", 
           RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
        InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}]}], ")"}]}], 
   RowBox[{
    TemplateBox[{"p7",OverscriptBox["p3", "_"]},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "+", 
    RowBox[{"z", " ", 
     TemplateBox[{"p7",OverscriptBox["p9", "_"]},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}]}]]}]], "Output",
 CellChangeTimes->{{3.79474935888162*^9, 3.7947493667197495`*^9}, 
   3.7958446059933653`*^9, 3.7958451594775066`*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"a0b5df47-1165-450b-8ca2-730f39f08b34"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Definitions", "Subsubsection",
 CellChangeTimes->{{3.7958451945442095`*^9, 
  3.7958451962877116`*^9}},ExpressionUUID->"b16ea7a0-adb7-4321-b3c0-\
7ce115b6ed4a"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Now", " ", "linearity", " ", "with", " ", "no", " ", "coefficients"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7958452389451213`*^9, 
  3.795845247485969*^9}},ExpressionUUID->"97818e72-4254-4869-a9c7-\
87aab2eccace"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"linear2", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     TemplateBox[{"p1"},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
     RowBox[{
      TemplateBox[{"p3"},
       "SpinorUndotPureL",
       DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "+", 
      TemplateBox[{"p5"},
       "SpinorUndotPureL",
       DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], 
    ",", 
    RowBox[{
     TemplateBox[{"p2"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
     RowBox[{
      TemplateBox[{"p4"},
       "SpinorDotPureL",
       DisplayFunction->(RowBox[{
          OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "-", 
      TemplateBox[{"p6"},
       "SpinorDotPureL",
       DisplayFunction->(RowBox[{
          OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.794747921725979*^9, 3.7947480412086067`*^9}, {
   3.7947480722120695`*^9, 3.794748086620783*^9}, 3.7958428653090897`*^9, {
   3.7958452005277443`*^9, 3.7958452088424354`*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"74a5e26a-539f-4f81-8cb9-a74a3792ca39"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    TemplateBox[{"p1"},
     "SpinorUndotPureL",
     DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], 
    "\[Rule]", 
    RowBox[{
     TemplateBox[{"p3"},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "+", 
     TemplateBox[{"p5"},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], 
   ",", 
   RowBox[{
    TemplateBox[{"p2"},
     "SpinorDotPureL",
     DisplayFunction->(RowBox[{
        OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "\[Rule]", 
    RowBox[{
     TemplateBox[{"p4"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "-", 
     TemplateBox[{"p6"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7947480871615686`*^9, 3.7958428664158044`*^9, 
  3.7958447635381975`*^9, 3.7958452116236677`*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"ac38dc84-d8c1-4d94-8604-76dd93b0afdd"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"applylinear", "[", "x_", "]"}], ":=", 
  RowBox[{"SpinorReplace2", "[", 
   RowBox[{"x", ",", "linear2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.794748088253676*^9, 3.794748109106122*^9}, 
   3.795842869599553*^9, {3.795845213932208*^9, 3.7958452144417505`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"1470780f-96a1-4c43-94af-1371bee6af75"]
}, Closed]],

Cell[CellGroupData[{

Cell["Angles", "Subsubsection",
 CellChangeTimes->{{3.794748120284717*^9, 
  3.794748121229681*^9}},ExpressionUUID->"0f03a802-a37f-4789-83e7-\
78c2438ce9f1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1","p2"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.7947481153272667`*^9, 3.794748131915908*^9}, {
  3.7947481725401154`*^9, 3.7947481743202057`*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"fde28cf3-a011-4998-8ec9-ef42759d0fbe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   TemplateBox[{"p2","p3"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}], "-", 
  TemplateBox[{"p2","p5"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )]}]], "Output",
 CellChangeTimes->{3.7947481324221945`*^9, 3.794748174981965*^9, 
  3.7958428750719204`*^9, 3.7958450511216393`*^9, 3.7958452244617977`*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"eb0743f6-e8b8-4c8c-af5a-690c9b611e2b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"l1","p1"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.794748136204043*^9, 3.794748145699086*^9}, {
  3.7947481897953677`*^9, 3.794748192462148*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"9359d288-7c96-452e-b3ca-cc867b975db7"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"l1","p3"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "+", 
  TemplateBox[{"l1","p5"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )]}]], "Output",
 CellChangeTimes->{3.794748146193217*^9, 3.7947481928793297`*^9, 
  3.7958428759467444`*^9, 3.7958450512251205`*^9, 3.7958452246699257`*^9},
 CellLabel->"Out[48]=",ExpressionUUID->"f7547648-d4f5-4e91-9d2c-5ac5befa7405"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Squares", "Subsubsection",
 CellChangeTimes->{{3.794748238276725*^9, 
  3.7947482396408043`*^9}},ExpressionUUID->"54653ef5-40ab-423e-8143-\
6cd58494c103"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1","p2"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.79474824414812*^9, 3.79474828679657*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"488bd412-8317-41c9-865d-07d1bcb01f83"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1","p4"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "-", 
  TemplateBox[{"p1","p6"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )]}]], "Output",
 CellChangeTimes->{3.794748257593755*^9, 3.7947482877355127`*^9, 
  3.7958428799053373`*^9, 3.7958450567519565`*^9, 3.795845232118335*^9},
 CellLabel->"Out[49]=",ExpressionUUID->"933b1c42-6bb8-4f2b-abb1-c8e990a5c9ae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2","p3"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.794748260340469*^9, 3.7947482920567837`*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"7a30de50-ad03-45ca-aaa5-eb9e6ed6a679"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   TemplateBox[{"p3","p4"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
  TemplateBox[{"p3","p6"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )]}]], "Output",
 CellChangeTimes->{{3.794748270799845*^9, 3.794748292862301*^9}, 
   3.7958428890737734`*^9, 3.795845056869296*^9, 3.7958452331270037`*^9},
 CellLabel->"Out[50]=",ExpressionUUID->"ad2640b0-c57e-472b-9abe-be08ba4e1915"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Chains angles", "Subsubsection",
 CellChangeTimes->{{3.7947483387073536`*^9, 3.794748339520731*^9}, {
  3.7947486124328513`*^9, 
  3.7947486137365103`*^9}},ExpressionUUID->"b9adf893-a65f-424c-a71b-\
bccc95cdd666"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", "p2", "}"}],"p4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.7947483448020372`*^9, 3.794748354898479*^9}, {
  3.794748445614644*^9, 3.794748447395432*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"46a1f76f-fff8-4942-8f69-bdbb0bb8e5db"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p3",RowBox[{"{", "p2", "}"}],"p4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "+", 
  TemplateBox[{"p5",RowBox[{"{", "p2", "}"}],"p4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{
  3.794748355434944*^9, 3.794748488648471*^9, 3.79474889523454*^9, 
   3.7958444078149867`*^9, 3.7958445101326513`*^9, {3.795844769129387*^9, 
   3.7958447734924088`*^9}, 3.7958450617978525`*^9, 3.7958452544597583`*^9},
 CellLabel->"Out[51]=",ExpressionUUID->"ce7563bf-4bdc-4458-a384-73c1f510a684"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p4",RowBox[{"{", "p2", "}"}],"p1"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.794748495006073*^9, 3.7947484966764836`*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"96865545-ef28-4d58-b87b-9f786f0ac19e"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p4",RowBox[{"{", "p2", "}"}],"p3"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "+", 
  TemplateBox[{"p4",RowBox[{"{", "p2", "}"}],"p5"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{3.794748497113364*^9, 3.794748899205615*^9, 
  3.795844513809491*^9, 3.7958447737659893`*^9, 3.7958450620494304`*^9, 
  3.795845259029779*^9},
 CellLabel->"Out[52]=",ExpressionUUID->"9bdeaa2b-5174-4d94-a937-d935ba4b7023"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", 
      RowBox[{"p2", ",", "p3"}], "}"}],"p4"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.7947485291999035`*^9, 3.79474853008352*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"4637daaf-a675-4251-a6de-a271b3f0fe7a"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p3",RowBox[{"{", 
      RowBox[{"p2", ",", "p3"}], "}"}],"p4"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "+", 
  TemplateBox[{"p5",RowBox[{"{", 
      RowBox[{"p2", ",", "p3"}], "}"}],"p4"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{3.7947485305876904`*^9, 3.794748907938732*^9, 
  3.795844517502597*^9, 3.7958447740500126`*^9, 3.795845062286977*^9, 
  3.7958452629496927`*^9},
 CellLabel->"Out[53]=",ExpressionUUID->"68cdc766-fff9-4c5e-b69c-4c90f3c003e9"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Chains squares", "Subsubsection",
 CellChangeTimes->{{3.7947483387073536`*^9, 3.794748339520731*^9}, {
  3.7947486124328513`*^9, 
  3.794748633426945*^9}},ExpressionUUID->"c112bc90-4e00-4a1b-b421-\
db827079b9a0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p3",RowBox[{"{", "p5", "}"}],"p2"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.7947483448020372`*^9, 3.794748354898479*^9}, {
  3.794748445614644*^9, 3.794748447395432*^9}, {3.79474869445179*^9, 
  3.7947487130948706`*^9}, {3.794748919647318*^9, 3.7947489199976115`*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"bdeec0c1-2945-4678-9486-42ae06d43fda"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p3",RowBox[{"{", "p5", "}"}],"p4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "-", 
  TemplateBox[{"p3",RowBox[{"{", "p5", "}"}],"p6"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{
  3.794748355434944*^9, 3.794748488648471*^9, {3.79474869604881*^9, 
   3.7947487137469687`*^9}, {3.7947489146617794`*^9, 3.7947489205710754`*^9}, 
   3.7958445216253357`*^9, 3.795845138706133*^9, 3.79584527315335*^9},
 CellLabel->"Out[54]=",ExpressionUUID->"8df52f2d-1a66-49d8-8589-256d6a359263"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2",RowBox[{"{", "p4", "}"}],"p3"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.794748495006073*^9, 3.7947484966764836`*^9}, {
  3.7947489602613754`*^9, 3.7947489642467136`*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"8a3bbccb-f7e7-42a5-967b-bc528c07fe31"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p4",RowBox[{"{", "p4", "}"}],"p3"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "-", 
  TemplateBox[{"p6",RowBox[{"{", "p4", "}"}],"p3"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{3.794748497113364*^9, 3.794748965839892*^9, 
  3.795844524492609*^9, 3.795845138961252*^9, 3.7958452803037524`*^9},
 CellLabel->"Out[55]=",ExpressionUUID->"acdab2d0-e7ed-43a2-855e-78416e4dd391"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2",RowBox[{"{", 
      RowBox[{"p1", ",", "p3"}], "}"}],"p4"},
   "SquareSquareChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square",
       "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.794748996211546*^9, 3.7947489969753675`*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"d0d284f4-b1c7-41e3-9b3a-8a1be85e5672"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p4",RowBox[{"{", 
      RowBox[{"p1", ",", "p3"}], "}"}],"p4"},
   "SquareSquareChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square",
       "]"}]& )], "-", 
  TemplateBox[{"p6",RowBox[{"{", 
      RowBox[{"p1", ",", "p3"}], "}"}],"p4"},
   "SquareSquareChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square",
       "]"}]& )]}]], "Output",
 CellChangeTimes->{3.7947489975537853`*^9, 3.7958445277622037`*^9, 
  3.795845139207796*^9, 3.7958452853076468`*^9},
 CellLabel->"Out[56]=",ExpressionUUID->"e015c807-89b0-44a6-a637-45e7ebd09fd8"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Chains mixed", "Subsubsection",
 CellChangeTimes->{{3.7947490375599337`*^9, 
  3.794749039909021*^9}},ExpressionUUID->"0f397946-ec81-4f2c-83cd-\
6d984718766e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", "p8", "}"}],"p2"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellLabel->"In[58]:=",ExpressionUUID->"8bc24fa8-3bd9-4320-9586-864957cc9e2c"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p3",RowBox[{"{", "p8", "}"}],"p4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "-", 
  TemplateBox[{"p3",RowBox[{"{", "p8", "}"}],"p6"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "+", 
  TemplateBox[{"p5",RowBox[{"{", "p8", "}"}],"p4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "-", 
  TemplateBox[{"p5",RowBox[{"{", "p8", "}"}],"p6"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{
  3.7958445437452145`*^9, 3.7958451528563347`*^9, {3.7958453148776283`*^9, 
   3.79584531875148*^9}},
 CellLabel->"Out[58]=",ExpressionUUID->"648c185b-bdce-4781-b575-034b4eaae3b0"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["With \[Mu] spinors", "Subsubsection",
 CellChangeTimes->{{3.7947491440787992`*^9, 
  3.7947491490838604`*^9}},ExpressionUUID->"36b59e0e-0712-485e-8355-\
c2441c8f05f7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pr", "=", 
  RowBox[{
   TemplateBox[{"p1","p7","1","2"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], "//", "To4D"}]}]], "Input",
 CellChangeTimes->{{3.7947491582174597`*^9, 3.7947492033599286`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"3f9a3107-1ad0-49bc-a109-da0557940c61"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     TemplateBox[{"p1"},
      "extramass",
      DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
      InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
     TemplateBox[{"p7",OverscriptBox["p1", "_"]},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], 
    TemplateBox[{"p1",OverscriptBox["p1", "_"]},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]]}], "+", 
  FractionBox[
   RowBox[{
    TemplateBox[{"p7"},
     "extramass",
     DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
     InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
    TemplateBox[{"p1",OverscriptBox["p7", "_"]},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], 
   TemplateBox[{"p7",OverscriptBox["p7", "_"]},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]]}]], "Output",
 CellChangeTimes->{{3.7947491706360226`*^9, 3.794749204260088*^9}, 
   3.7958445901625443`*^9, 3.7958451586305857`*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"44885802-6690-4115-9230-e545315429e5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpinorReplace2", "[", 
  RowBox[{"pr", ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"p7"},
      "SpinorDotPureM",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
     RowBox[{
      TemplateBox[{"p3"},
       "SpinorDotPureM",
       DisplayFunction->(RowBox[{
          OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "+", 
      TemplateBox[{"p9"},
       "SpinorDotPureM",
       DisplayFunction->(RowBox[{
          OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )]}]}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.794749343514308*^9, 3.7947493660069275`*^9}, {
  3.7958453665978146`*^9, 3.7958453667573433`*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"70e4f3d2-d61d-4dd4-9607-a7a00c08b063"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     TemplateBox[{"p1"},
      "extramass",
      DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
      InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
     TemplateBox[{"p7",OverscriptBox["p1", "_"]},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], 
    TemplateBox[{"p1",OverscriptBox["p1", "_"]},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]]}], "+", 
  FractionBox[
   RowBox[{
    TemplateBox[{"p7"},
     "extramass",
     DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
     InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
    RowBox[{"(", 
     RowBox[{
      TemplateBox[{"p1",OverscriptBox["p3", "_"]},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "+", 
      TemplateBox[{"p1",OverscriptBox["p9", "_"]},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], ")"}]}], 
   RowBox[{
    TemplateBox[{"p7",OverscriptBox["p3", "_"]},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "+", 
    TemplateBox[{"p7",OverscriptBox["p9", "_"]},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}]]}]], "Output",
 CellChangeTimes->{{3.79474935888162*^9, 3.7947493667197495`*^9}, 
   3.7958446059933653`*^9, 3.7958451594775066`*^9, 3.795845367477719*^9},
 CellLabel->"Out[59]=",ExpressionUUID->"64932cc6-024d-48dd-ad42-6578416024ec"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["With odd number of matrices", "Subsubsection",
 CellChangeTimes->{{3.795845462602293*^9, 3.795845465682218*^9}, {
  3.7958468944981422`*^9, 
  3.7958468977713747`*^9}},ExpressionUUID->"7a68bfed-f239-4de1-8b75-\
4b67010eb4dd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"plain3", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     TemplateBox[{"p1"},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], 
     "\[Rule]", 
     RowBox[{"A", ".", 
      TemplateBox[{"p3"},
       "SpinorDotPureL",
       DisplayFunction->(RowBox[{
          OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], ",", 
    RowBox[{
     TemplateBox[{"p2"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], 
     "\[Rule]", 
     RowBox[{"B", ".", 
      TemplateBox[{"p4"},
       "SpinorUndotPureL",
       DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.7947480262295275`*^9, 3.7947480452782526`*^9}, {
   3.795845484926546*^9, 3.7958455152592893`*^9}, 3.795845889049905*^9},
 CellLabel->"In[64]:=",ExpressionUUID->"88117158-326d-4874-9dec-23c67e6279aa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    TemplateBox[{"p1"},
     "SpinorUndotPureL",
     DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], 
    "\[Rule]", 
    RowBox[{"A", ".", 
     TemplateBox[{"p3"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], ",", 
   RowBox[{
    TemplateBox[{"p2"},
     "SpinorDotPureL",
     DisplayFunction->(RowBox[{
        OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "\[Rule]", 
    RowBox[{"B", ".", 
     TemplateBox[{"p4"},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7947480460299397`*^9, 3.7958428574524593`*^9, 
  3.7958447632529535`*^9, 3.795845517257507*^9, 3.795845889627109*^9},
 CellLabel->"Out[64]=",ExpressionUUID->"b4c1a5db-4df8-4898-983f-e5c213476bc3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyplain", "[", "x_", "]"}], ":=", 
  RowBox[{"SpinorReplace2", "[", 
   RowBox[{"x", ",", "plain3"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7947480471822634`*^9, 3.7947480660139437`*^9}, 
   3.7958458919112434`*^9},
 CellLabel->"In[65]:=",ExpressionUUID->"a098c6cb-3fa2-4108-8750-fd1df3d4822b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"linear3", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     TemplateBox[{"p1"},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
     RowBox[{
      RowBox[{"A", ".", 
       TemplateBox[{"p3"},
        "SpinorDotPureL",
        DisplayFunction->(RowBox[{
           OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], "+", 
      RowBox[{"z", "*", 
       TemplateBox[{"p5"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}]}],
     ",", 
    RowBox[{
     TemplateBox[{"p2"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
     RowBox[{
      RowBox[{"B", ".", 
       TemplateBox[{"p4"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
      "-", 
      RowBox[{"z", "*", 
       TemplateBox[{"p6"},
        "SpinorDotPureL",
        DisplayFunction->(RowBox[{
           OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}]}]}],
    "}"}]}]], "Input",
 CellChangeTimes->{{3.794747921725979*^9, 3.7947480412086067`*^9}, {
   3.7947480722120695`*^9, 3.794748086620783*^9}, 3.7958428653090897`*^9, {
   3.7958455329352455`*^9, 3.7958455425239735`*^9}, {3.795845884237342*^9, 
   3.795845884983327*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"acc59b5a-5fac-4d2a-ba30-ce6645f437b2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    TemplateBox[{"p1"},
     "SpinorUndotPureL",
     DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], 
    "\[Rule]", 
    RowBox[{
     RowBox[{"A", ".", 
      TemplateBox[{"p3"},
       "SpinorDotPureL",
       DisplayFunction->(RowBox[{
          OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], "+", 
     RowBox[{"z", " ", 
      TemplateBox[{"p5"},
       "SpinorUndotPureL",
       DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}]}], 
   ",", 
   RowBox[{
    TemplateBox[{"p2"},
     "SpinorDotPureL",
     DisplayFunction->(RowBox[{
        OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "\[Rule]", 
    RowBox[{
     RowBox[{"B", ".", 
      TemplateBox[{"p4"},
       "SpinorUndotPureL",
       DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], "-", 
     RowBox[{"z", " ", 
      TemplateBox[{"p6"},
       "SpinorDotPureL",
       DisplayFunction->(RowBox[{
          OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7947480871615686`*^9, 3.7958428664158044`*^9, 
  3.7958447635381975`*^9, 3.79584554497352*^9, 3.7958458950100527`*^9},
 CellLabel->"Out[66]=",ExpressionUUID->"9cfb1815-5d31-4187-bbbf-564a8fc6dcbe"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"applylinear", "[", "x_", "]"}], ":=", 
  RowBox[{"SpinorReplace2", "[", 
   RowBox[{"x", ",", "linear3"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.794748088253676*^9, 3.794748109106122*^9}, 
   3.795842869599553*^9, {3.7958458971114645`*^9, 3.795845897529933*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"28feceae-2a0d-45ec-9334-365b52bec383"]
}, Closed]],

Cell[CellGroupData[{

Cell["Angles", "Subsubsection",
 CellChangeTimes->{{3.794748120284717*^9, 
  3.794748121229681*^9}},ExpressionUUID->"cff4619d-8a12-4a07-ba75-\
ff6e7a9fa876"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1","p2"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947481153272667`*^9, 3.794748131915908*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"b8dd8160-602f-47ac-8366-adbc2931152d"],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{"p3",RowBox[{"{", "A", "}"}],"p2"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{3.7947481324221945`*^9, 3.7958428731145277`*^9, 
  3.7958450507860284`*^9, 3.7958458999810963`*^9},
 CellLabel->"Out[68]=",ExpressionUUID->"704d4d55-c255-4320-b81b-2267b43ab06d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"l1","p1"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.794748136204043*^9, 3.794748145699086*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"69a82831-d2b9-4ca9-921e-bf0767b05868"],

Cell[BoxData[
 TemplateBox[{"l1",RowBox[{"{", "A", "}"}],"p3"},
  "AngleSquareChain",
  DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.794748146193217*^9, 3.795842874173117*^9, 
  3.795845051013743*^9, 3.7958459099947596`*^9},
 CellLabel->"Out[69]=",ExpressionUUID->"0224d57a-0a54-4047-a8be-87ec40205916"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1","p2"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.7947481153272667`*^9, 3.794748131915908*^9}, {
  3.7947481725401154`*^9, 3.7947481743202057`*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"38494be4-c0a9-4ea7-a205-864dfeead489"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   TemplateBox[{"p3",RowBox[{"{", "A", "}"}],"p2"},
    "SquareAngleChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle",
        "]"}]& )]}], "-", 
  RowBox[{"z", " ", 
   TemplateBox[{"p2","p5"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.7947481324221945`*^9, 3.794748174981965*^9, 
  3.7958428750719204`*^9, 3.7958450511216393`*^9, 3.795845912281765*^9},
 CellLabel->"Out[70]=",ExpressionUUID->"e6c433f9-467e-4e2a-a2ce-fe824aeaf539"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"l1","p1"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.794748136204043*^9, 3.794748145699086*^9}, {
  3.7947481897953677`*^9, 3.794748192462148*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"ee17a68e-0560-4f58-ba65-f114251832e9"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"l1",RowBox[{"{", "A", "}"}],"p3"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "+", 
  RowBox[{"z", " ", 
   TemplateBox[{"l1","p5"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.794748146193217*^9, 3.7947481928793297`*^9, 
  3.7958428759467444`*^9, 3.7958450512251205`*^9, 3.795845917954013*^9},
 CellLabel->"Out[71]=",ExpressionUUID->"43dbf391-553d-4849-a3e6-61ce82d021e6"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Squares", "Subsubsection",
 CellChangeTimes->{{3.794748238276725*^9, 
  3.7947482396408043`*^9}},ExpressionUUID->"cb5a8270-a076-49f4-aa0b-\
6b6d880c37b1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1","p2"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.79474824414812*^9, 3.7947482569072113`*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"4d3dea7e-48f5-494e-9fb3-fa4d727c9f02"],

Cell[BoxData[
 TemplateBox[{"p1",RowBox[{"{", "B", "}"}],"p4"},
  "SquareAngleChain",
  DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.794748257593755*^9, 3.7958428778480854`*^9, 
  3.7958450564415703`*^9, 3.795845942264944*^9},
 CellLabel->"Out[72]=",ExpressionUUID->"06ea403c-9ab9-43ab-9386-775ce546a1e3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2","p3"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.794748260340469*^9, 3.79474827028979*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"30e774b7-dd3b-4178-ad14-2fb748931756"],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{"p4",RowBox[{"{", "B", "}"}],"p3"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{3.794748270799845*^9, 3.7958428785870967`*^9, 
  3.795845056633787*^9, 3.7958459442066727`*^9},
 CellLabel->"Out[73]=",ExpressionUUID->"4eb53729-5920-4c2f-9f15-99bde9dd4b08"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1","p2"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.79474824414812*^9, 3.79474828679657*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"b49dcb1e-358e-4ef9-85c7-2a8fbbe88385"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", "B", "}"}],"p4"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "-", 
  RowBox[{"z", " ", 
   TemplateBox[{"p1","p6"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.794748257593755*^9, 3.7947482877355127`*^9, 
  3.7958428799053373`*^9, 3.7958450567519565`*^9, 3.795845953628883*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"10e228dd-35d9-44df-b843-d97973809c51"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2","p3"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.794748260340469*^9, 3.7947482920567837`*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"47799dd1-e58b-4e92-b1aa-a5d6b8ac14fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   TemplateBox[{"p4",RowBox[{"{", "B", "}"}],"p3"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], "+", 
  RowBox[{"z", " ", 
   TemplateBox[{"p3","p6"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}]}]], "Output",
 CellChangeTimes->{{3.794748270799845*^9, 3.794748292862301*^9}, 
   3.7958428890737734`*^9, 3.795845056869296*^9, 3.795845955813262*^9},
 CellLabel->"Out[75]=",ExpressionUUID->"1dc7d46d-eb1e-40f8-8049-23fce055f66f"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Chains angles", "Subsubsection",
 CellChangeTimes->{{3.7947483387073536`*^9, 3.794748339520731*^9}, {
  3.7947486124328513`*^9, 
  3.7947486137365103`*^9}},ExpressionUUID->"6460402a-1319-4e89-ad34-\
9112e2dc8191"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", "p2", "}"}],"p4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947483448020372`*^9, 3.794748354898479*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"d2afaed2-7844-4998-9cd3-065c0e3679a5"],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{"p3",RowBox[{"{", 
      RowBox[{"A", ",", "p2"}], "}"}],"p4"},
   "SquareSquareChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square",
       "]"}]& )]}]], "Output",
 CellChangeTimes->{3.794748355434944*^9, 3.7947488933289223`*^9, 
  3.7958428911038313`*^9, 3.795844400436764*^9, 3.7958447731040893`*^9, 
  3.7958450616192775`*^9, 3.795846210463872*^9},
 CellLabel->"Out[76]=",ExpressionUUID->"8b6d822f-c0ed-415c-a658-f33a61140477"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", "p2", "}"}],"p4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.7947483448020372`*^9, 3.794748354898479*^9}, {
  3.794748445614644*^9, 3.794748447395432*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"79bb6b38-a2f3-47fb-a592-c1ada0fdd993"],

Cell[BoxData[
 RowBox[{
  RowBox[{"z", " ", 
   TemplateBox[{"p5",RowBox[{"{", "p2", "}"}],"p4"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], "-", 
  TemplateBox[{"p3",RowBox[{"{", 
      RowBox[{"A", ",", "p2"}], "}"}],"p4"},
   "SquareSquareChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square",
       "]"}]& )]}]], "Output",
 CellChangeTimes->{
  3.794748355434944*^9, 3.794748488648471*^9, 3.79474889523454*^9, 
   3.7958444078149867`*^9, 3.7958445101326513`*^9, {3.795844769129387*^9, 
   3.7958447734924088`*^9}, 3.7958450617978525`*^9, 3.79584621739437*^9},
 CellLabel->"Out[77]=",ExpressionUUID->"3dc987f9-155c-40c7-acf5-32137f8ae228"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p4",RowBox[{"{", "p2", "}"}],"p1"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947484179908566`*^9, 3.794748454740518*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"f9394d02-4d0e-4ed8-b477-bf2bbb2f35e0"],

Cell[BoxData[
 TemplateBox[{"p4",RowBox[{"{", 
     RowBox[{"p2", ",", "A"}], "}"}],"p3"},
  "SquareSquareChain",
  DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.7947484271703844`*^9, 3.7947488978831387`*^9, 
  3.79584451263539*^9, 3.795844773629807*^9, 3.795845061930428*^9, 
  3.7958462275861063`*^9},
 CellLabel->"Out[78]=",ExpressionUUID->"8c375f12-18cd-485d-929f-728fe2686af9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p4",RowBox[{"{", "p2", "}"}],"p1"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.794748495006073*^9, 3.7947484966764836`*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"434d28a7-f422-4c9e-86da-bcff487361ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"z", " ", 
   TemplateBox[{"p4",RowBox[{"{", "p2", "}"}],"p5"},
    "SquareAngleChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle",
        "]"}]& )]}], "+", 
  TemplateBox[{"p4",RowBox[{"{", 
      RowBox[{"p2", ",", "A"}], "}"}],"p3"},
   "SquareSquareChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square",
       "]"}]& )]}]], "Output",
 CellChangeTimes->{3.794748497113364*^9, 3.794748899205615*^9, 
  3.795844513809491*^9, 3.7958447737659893`*^9, 3.7958450620494304`*^9, 
  3.795846235755257*^9},
 CellLabel->"Out[79]=",ExpressionUUID->"fa56a3b3-78a7-4aa0-9908-82609697e994"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", 
      RowBox[{"p2", ",", "p3"}], "}"}],"p4"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947485092847323`*^9, 3.7947485195373297`*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"808ed795-bc64-40b0-a422-86664f49615c"],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{"p3",RowBox[{"{", 
      RowBox[{"A", ",", "p2", ",", "p3"}], "}"}],"p4"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{3.7947485201060905`*^9, 3.79474890481462*^9, 
  3.7958445162613773`*^9, 3.7958447739040227`*^9, 3.795845062165242*^9, 
  3.7958462437897696`*^9},
 CellLabel->"Out[80]=",ExpressionUUID->"bea9eb65-6017-4142-b4ff-875d5c1723c3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", 
      RowBox[{"p2", ",", "p3"}], "}"}],"p4"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.7947485291999035`*^9, 3.79474853008352*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"fa027e7c-c8f3-481d-a151-0e62d0cd71f9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"z", " ", 
   TemplateBox[{"p5",RowBox[{"{", 
       RowBox[{"p2", ",", "p3"}], "}"}],"p4"},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )]}], "-", 
  TemplateBox[{"p3",RowBox[{"{", 
      RowBox[{"A", ",", "p2", ",", "p3"}], "}"}],"p4"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{3.7947485305876904`*^9, 3.794748907938732*^9, 
  3.795844517502597*^9, 3.7958447740500126`*^9, 3.795845062286977*^9, 
  3.795846247968589*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"b9e0fc5a-c3bb-44de-97c3-5a0f408abd48"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Chains squares", "Subsubsection",
 CellChangeTimes->{{3.7947483387073536`*^9, 3.794748339520731*^9}, {
  3.7947486124328513`*^9, 
  3.794748633426945*^9}},ExpressionUUID->"c2b86f4a-2fc6-43ee-8d4d-\
7639d3e54e8b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p3",RowBox[{"{", "p4", "}"}],"p2"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947483448020372`*^9, 3.794748354898479*^9}, {
  3.794748625290289*^9, 3.794748646457346*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"818614c8-009a-4e79-9a7a-795b1aef6aff"],

Cell[BoxData[
 TemplateBox[{"p3",RowBox[{"{", 
     RowBox[{"p4", ",", "B"}], "}"}],"p4"},
  "AngleAngleChain",
  DisplayFunction->(
   RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
     "]"}]& )]], "Output",
 CellChangeTimes->{
  3.794748355434944*^9, {3.7947486359981284`*^9, 3.794748647732076*^9}, 
   3.7947486869847255`*^9, 3.794748911263562*^9, 3.795844520141059*^9, 
   3.7958451385152283`*^9, 3.7958462525104437`*^9, 3.7958465577259035`*^9},
 CellLabel->"Out[85]=",ExpressionUUID->"51d70d58-9336-4e8c-8440-a2204203a027"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p3",RowBox[{"{", "p5", "}"}],"p2"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.7947483448020372`*^9, 3.794748354898479*^9}, {
  3.794748445614644*^9, 3.794748447395432*^9}, {3.79474869445179*^9, 
  3.7947487130948706`*^9}, {3.794748919647318*^9, 3.7947489199976115`*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"e90709cf-e304-4981-b454-425c2f830d57"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "z"}], " ", 
   TemplateBox[{"p3",RowBox[{"{", "p5", "}"}],"p6"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], "+", 
  TemplateBox[{"p3",RowBox[{"{", 
      RowBox[{"p5", ",", "B"}], "}"}],"p4"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{
  3.794748355434944*^9, 3.794748488648471*^9, {3.79474869604881*^9, 
   3.7947487137469687`*^9}, {3.7947489146617794`*^9, 3.7947489205710754`*^9}, 
   3.7958445216253357`*^9, 3.795845138706133*^9, 3.7958462581812897`*^9, 
   3.7958465620294304`*^9},
 CellLabel->"Out[86]=",ExpressionUUID->"549f7915-9d9f-4e61-91cc-674fbaad4295"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2",RowBox[{"{", "p4", "}"}],"p3"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947484179908566`*^9, 3.794748454740518*^9}, {
  3.794748948812261*^9, 3.794748953415962*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"82f5c9f7-c66c-4df2-94ff-85c340ac1ae0"],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{"p4",RowBox[{"{", 
      RowBox[{"B", ",", "p4"}], "}"}],"p3"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{3.7947484271703844`*^9, 3.794748954279978*^9, 
  3.7958445229866104`*^9, 3.7958451388394623`*^9, 3.795846567535697*^9},
 CellLabel->"Out[87]=",ExpressionUUID->"ae98a42f-3ae1-4b88-9a98-780d969914b1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2",RowBox[{"{", "p4", "}"}],"p3"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.794748495006073*^9, 3.7947484966764836`*^9}, {
  3.7947489602613754`*^9, 3.7947489642467136`*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"b36a2e58-fb02-49e4-91e9-ae449dc0c038"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   TemplateBox[{"p4",RowBox[{"{", 
       RowBox[{"B", ",", "p4"}], "}"}],"p3"},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )]}], "-", 
  RowBox[{"z", " ", 
   TemplateBox[{"p6",RowBox[{"{", "p4", "}"}],"p3"},
    "SquareAngleChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle",
        "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.794748497113364*^9, 3.794748965839892*^9, 
  3.795844524492609*^9, 3.795845138961252*^9, 3.7958465762733445`*^9},
 CellLabel->"Out[89]=",ExpressionUUID->"d1d30752-0535-4775-9138-fae7fb8696df"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2",RowBox[{"{", 
      RowBox[{"p1", ",", "p3"}], "}"}],"p4"},
   "SquareSquareChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square",
       "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947489796149*^9, 3.7947489888202257`*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"f5d841b4-4fd6-4ca9-98a2-061c10da1c52"],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{"p4",RowBox[{"{", 
      RowBox[{"B", ",", "p1", ",", "p3"}], "}"}],"p4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{3.7947489892851896`*^9, 3.795844526350099*^9, 
  3.7958451390853744`*^9, 3.7958465775898075`*^9},
 CellLabel->"Out[90]=",ExpressionUUID->"c2e7959c-bb64-4a4c-97ac-17aadb177f28"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2",RowBox[{"{", 
      RowBox[{"p1", ",", "p3"}], "}"}],"p4"},
   "SquareSquareChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square",
       "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.794748996211546*^9, 3.7947489969753675`*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"1804f1df-c9ec-42d1-be15-4dc0587e5e43"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   TemplateBox[{"p4",RowBox[{"{", 
       RowBox[{"B", ",", "p1", ",", "p3"}], "}"}],"p4"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], "-", 
  RowBox[{"z", " ", 
   TemplateBox[{"p6",RowBox[{"{", 
       RowBox[{"p1", ",", "p3"}], "}"}],"p4"},
    "SquareSquareChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
       "$square", "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.7947489975537853`*^9, 3.7958445277622037`*^9, 
  3.795845139207796*^9, 3.7958465808381233`*^9},
 CellLabel->"Out[91]=",ExpressionUUID->"c4e31506-14bb-44a6-8395-2f8c22e4573c"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Chains mixed", "Subsubsection",
 CellChangeTimes->{{3.7947490375599337`*^9, 
  3.794749039909021*^9}},ExpressionUUID->"a640b0be-6519-4e7a-826e-\
cab5774d41bb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", "p8", "}"}],"p2"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947490449664536`*^9, 3.7947490545911417`*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"19be47f4-d412-4cee-980d-945e16d64f5b"],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{"p3",RowBox[{"{", 
      RowBox[{"A", ",", "p8", ",", "B"}], "}"}],"p4"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{3.794749054948547*^9, 3.795844530399457*^9, 
  3.795845142688033*^9, 3.795846583318483*^9},
 CellLabel->"Out[92]=",ExpressionUUID->"7bc974a2-3fb5-42b2-b858-c79cdf5e5ad2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", "p8", "}"}],"p2"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.794749062592343*^9, 3.7947491061617165`*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"6aeda1ee-1572-4f7c-928a-d039ff6b31c7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    SuperscriptBox["z", "2"]}], " ", 
   TemplateBox[{"p5",RowBox[{"{", "p8", "}"}],"p6"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], "+", 
  RowBox[{"z", " ", 
   TemplateBox[{"p5",RowBox[{"{", 
       RowBox[{"p8", ",", "B"}], "}"}],"p4"},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )]}], "+", 
  RowBox[{"z", " ", 
   TemplateBox[{"p3",RowBox[{"{", 
       RowBox[{"A", ",", "p8"}], "}"}],"p6"},
    "SquareSquareChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
       "$square", "]"}]& )]}], "-", 
  TemplateBox[{"p3",RowBox[{"{", 
      RowBox[{"A", ",", "p8", ",", "B"}], "}"}],"p4"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{{3.794749063869943*^9, 3.794749106667944*^9}, 
   3.7958465862576237`*^9},
 CellLabel->"Out[93]=",ExpressionUUID->"84a8311c-16f2-4ab8-b8e1-5d9eadbfda1a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", "p8", "}"}],"p2"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellLabel->"In[94]:=",ExpressionUUID->"d0b174d9-fdf3-4ba5-96ae-f05a9ac6aedb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    SuperscriptBox["z", "2"]}], " ", 
   TemplateBox[{"p5",RowBox[{"{", "p8", "}"}],"p6"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], "+", 
  RowBox[{"z", " ", 
   TemplateBox[{"p5",RowBox[{"{", 
       RowBox[{"p8", ",", "B"}], "}"}],"p4"},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )]}], "+", 
  RowBox[{"z", " ", 
   TemplateBox[{"p3",RowBox[{"{", 
       RowBox[{"A", ",", "p8"}], "}"}],"p6"},
    "SquareSquareChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
       "$square", "]"}]& )]}], "-", 
  TemplateBox[{"p3",RowBox[{"{", 
      RowBox[{"A", ",", "p8", ",", "B"}], "}"}],"p4"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{3.7958445437452145`*^9, 3.7958451528563347`*^9, 
  3.7958465924031854`*^9},
 CellLabel->"Out[94]=",ExpressionUUID->"bc2497d5-e61a-407c-bd9f-a66ec368eafc"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["With \[Mu] spinors", "Subsubsection",
 CellChangeTimes->{{3.7947491440787992`*^9, 
  3.7947491490838604`*^9}},ExpressionUUID->"2c6e396a-1793-437f-bdd8-\
e6308a68299f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pr", "=", 
  RowBox[{
   TemplateBox[{"p1","p7","1","2"},
    "AngSquInvariant",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], "//", "To4D"}]}]], "Input",
 CellChangeTimes->{{3.7947491582174597`*^9, 3.7947492033599286`*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"7e1b5186-1c85-4ebb-9a34-4bc895f87ec5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     TemplateBox[{"p1"},
      "extramass",
      DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
      InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
     TemplateBox[{"p7",OverscriptBox["p1", "_"]},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], 
    TemplateBox[{"p1",OverscriptBox["p1", "_"]},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]]}], "+", 
  FractionBox[
   RowBox[{
    TemplateBox[{"p7"},
     "extramass",
     DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
     InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
    TemplateBox[{"p1",OverscriptBox["p7", "_"]},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], 
   TemplateBox[{"p7",OverscriptBox["p7", "_"]},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]]}]], "Output",
 CellChangeTimes->{{3.7947491706360226`*^9, 3.794749204260088*^9}, 
   3.7958445901625443`*^9, 3.7958451586305857`*^9, 3.795846599386507*^9},
 CellLabel->"Out[95]=",ExpressionUUID->"8437ac92-9f78-42bd-9d72-3fb64e117974"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpinorReplace2", "[", 
  RowBox[{"pr", ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"p1"},
      "SpinorUndotPureM",
      DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], 
     "\[Rule]", 
     RowBox[{"A", ".", 
      TemplateBox[{"p2"},
       "SpinorDotPureL",
       DisplayFunction->(RowBox[{
          OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.794749178371219*^9, 3.7947492132648125`*^9}, {
  3.795846607941591*^9, 3.7958466153428373`*^9}, {3.795846649460539*^9, 
  3.7958466529885826`*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"c9ce71a8-79b8-4d33-9aee-cb2585830203"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     TemplateBox[{"p7",RowBox[{"{", "A", "}"}],"p2"},
      "AngleSquareChain",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
         "$square", "]"}]& )], " ", 
     TemplateBox[{"p1"},
      "extramass",
      DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
      InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )]}], 
    TemplateBox[{"p1",RowBox[{"{", "A", "}"}],"p2"},
     "AngleSquareChain",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )]]}], "+", 
  FractionBox[
   RowBox[{
    TemplateBox[{"p7"},
     "extramass",
     DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
     InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
    TemplateBox[{"p1",OverscriptBox["p7", "_"]},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], 
   TemplateBox[{"p7",OverscriptBox["p7", "_"]},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]]}]], "Output",
 CellChangeTimes->{
  3.794749214477919*^9, 3.7958445955220947`*^9, 3.7958451588866816`*^9, {
   3.795846601262493*^9, 3.7958466165126667`*^9}, 3.7958466538552585`*^9},
 CellLabel->"Out[98]=",ExpressionUUID->"7473c62f-b7c2-48b6-a1a7-293b7f80914c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpinorReplace2", "[", 
  RowBox[{"pr", ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"p7"},
      "SpinorDotPureM",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
     TemplateBox[{"p3"},
      "SpinorDotPureM",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )]}], "}"}]}],
   "]"}]], "Input",
 CellChangeTimes->{{3.794749293304788*^9, 3.7947492972929125`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"38e0157d-8a9a-4fee-b069-84f2f78dc9a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     TemplateBox[{"p1"},
      "extramass",
      DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
      InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
     TemplateBox[{"p7",OverscriptBox["p1", "_"]},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], 
    TemplateBox[{"p1",OverscriptBox["p1", "_"]},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]]}], "+", 
  FractionBox[
   RowBox[{
    TemplateBox[{"p7"},
     "extramass",
     DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
     InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
    TemplateBox[{"p1",OverscriptBox["p3", "_"]},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], 
   TemplateBox[{"p7",OverscriptBox["p3", "_"]},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]]}]], "Output",
 CellChangeTimes->{3.794749298086068*^9, 3.7958446029285183`*^9, 
  3.7958451593293395`*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"089aa89b-7772-4be1-8e07-9ad6422b4693"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpinorReplace2", "[", 
  RowBox[{"pr", ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"p7"},
      "SpinorDotPureM",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
     RowBox[{
      TemplateBox[{"p3"},
       "SpinorDotPureM",
       DisplayFunction->(RowBox[{
          OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "+", 
      RowBox[{"z", "*", 
       TemplateBox[{"p9"},
        "SpinorDotPureM",
        DisplayFunction->(RowBox[{
           OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )]}]}]}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.794749343514308*^9, 3.7947493660069275`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"d1cdbd57-5532-4d2d-8a0f-ba8680b20d77"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     TemplateBox[{"p1"},
      "extramass",
      DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
      InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
     TemplateBox[{"p7",OverscriptBox["p1", "_"]},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], 
    TemplateBox[{"p1",OverscriptBox["p1", "_"]},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]]}], "+", 
  FractionBox[
   RowBox[{
    TemplateBox[{"p7"},
     "extramass",
     DisplayFunction->(RowBox[{"\[CapitalMu]", "[", #, "]"}]& ),
     InterpretationFunction->(RowBox[{"Extramass", "[", #, "]"}]& )], " ", 
    RowBox[{"(", 
     RowBox[{
      TemplateBox[{"p1",OverscriptBox["p3", "_"]},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "+", 
      RowBox[{"z", " ", 
       TemplateBox[{"p1",OverscriptBox["p9", "_"]},
        "SpinorSquareBracket",
        DisplayFunction->(RowBox[{"[", 
           RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
        InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}]}], ")"}]}], 
   RowBox[{
    TemplateBox[{"p7",OverscriptBox["p3", "_"]},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "+", 
    RowBox[{"z", " ", 
     TemplateBox[{"p7",OverscriptBox["p9", "_"]},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}]}]]}]], "Output",
 CellChangeTimes->{{3.79474935888162*^9, 3.7947493667197495`*^9}, 
   3.7958446059933653`*^9, 3.7958451594775066`*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"d26781b0-6ff2-47f9-9c6f-6420a20d9d15"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["With even number of matrices", "Subsubsection",
 CellChangeTimes->{{3.795845462602293*^9, 3.795845465682218*^9}, {
  3.7958468944981422`*^9, 3.7958468977713747`*^9}, {3.7958469331736827`*^9, 
  3.79584693354473*^9}},ExpressionUUID->"b59d2331-cc7d-4ec3-8f37-\
8d65207efcbf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"plain4", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     TemplateBox[{"p1"},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], 
     "\[Rule]", 
     RowBox[{"A", ".", "B", ".", 
      TemplateBox[{"p3"},
       "SpinorUndotPureL",
       DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], 
    ",", 
    RowBox[{
     TemplateBox[{"p2"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], 
     "\[Rule]", 
     RowBox[{"a", ".", "b", ".", 
      TemplateBox[{"p4"},
       "SpinorDotPureL",
       DisplayFunction->(RowBox[{
          OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.7947480262295275`*^9, 3.7947480452782526`*^9}, {
   3.795845484926546*^9, 3.7958455152592893`*^9}, 3.795845889049905*^9, {
   3.795846966480217*^9, 3.795846992315096*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"7ee686d7-29de-40fb-b711-30fff0877646"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    TemplateBox[{"p1"},
     "SpinorUndotPureL",
     DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], 
    "\[Rule]", 
    RowBox[{"A", ".", "B", ".", 
     TemplateBox[{"p3"},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], 
   ",", 
   RowBox[{
    TemplateBox[{"p2"},
     "SpinorDotPureL",
     DisplayFunction->(RowBox[{
        OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "\[Rule]", 
    RowBox[{"a", ".", "b", ".", 
     TemplateBox[{"p4"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7947480460299397`*^9, 3.7958428574524593`*^9, 
  3.7958447632529535`*^9, 3.795845517257507*^9, 3.795845889627109*^9, 
  3.795846993779146*^9},
 CellLabel->"Out[99]=",ExpressionUUID->"c66a43ea-ea83-4124-ad35-1f4b2e686724"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyplain", "[", "x_", "]"}], ":=", 
  RowBox[{"SpinorReplace2", "[", 
   RowBox[{"x", ",", "plain4"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7947480471822634`*^9, 3.7947480660139437`*^9}, 
   3.7958458919112434`*^9, {3.7958469965916677`*^9, 3.7958469968759146`*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"8fc34850-5823-4796-b127-e1ef93af0b33"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"linear4", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     TemplateBox[{"p1"},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
     RowBox[{
      RowBox[{"A", ".", "B", ".", 
       TemplateBox[{"p3"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
      "+", 
      RowBox[{"z", "*", 
       TemplateBox[{"p5"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}]}],
     ",", 
    RowBox[{
     TemplateBox[{"p2"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
     RowBox[{
      RowBox[{"a", ".", "b", ".", 
       TemplateBox[{"p4"},
        "SpinorDotPureL",
        DisplayFunction->(RowBox[{
           OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], "-", 
      RowBox[{"z", "*", 
       TemplateBox[{"p6"},
        "SpinorDotPureL",
        DisplayFunction->(RowBox[{
           OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}]}]}],
    "}"}]}]], "Input",
 CellChangeTimes->{{3.794747921725979*^9, 3.7947480412086067`*^9}, {
   3.7947480722120695`*^9, 3.794748086620783*^9}, 3.7958428653090897`*^9, {
   3.7958455329352455`*^9, 3.7958455425239735`*^9}, {3.795845884237342*^9, 
   3.795845884983327*^9}, {3.795847000006543*^9, 3.795847014795932*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"955a330b-6e01-4f8b-afd4-cc5665df94ec"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    TemplateBox[{"p1"},
     "SpinorUndotPureL",
     DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], 
    "\[Rule]", 
    RowBox[{
     RowBox[{"A", ".", "B", ".", 
      TemplateBox[{"p3"},
       "SpinorUndotPureL",
       DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], "+", 
     RowBox[{"z", " ", 
      TemplateBox[{"p5"},
       "SpinorUndotPureL",
       DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}]}], 
   ",", 
   RowBox[{
    TemplateBox[{"p2"},
     "SpinorDotPureL",
     DisplayFunction->(RowBox[{
        OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "\[Rule]", 
    RowBox[{
     RowBox[{"a", ".", "b", ".", 
      TemplateBox[{"p4"},
       "SpinorDotPureL",
       DisplayFunction->(RowBox[{
          OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], "-", 
     RowBox[{"z", " ", 
      TemplateBox[{"p6"},
       "SpinorDotPureL",
       DisplayFunction->(RowBox[{
          OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7947480871615686`*^9, 3.7958428664158044`*^9, 
  3.7958447635381975`*^9, 3.79584554497352*^9, 3.7958458950100527`*^9, 
  3.7958470171895638`*^9},
 CellLabel->
  "Out[101]=",ExpressionUUID->"0d115d6b-2e14-4b00-a131-f2558a8a7461"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"applylinear", "[", "x_", "]"}], ":=", 
  RowBox[{"SpinorReplace2", "[", 
   RowBox[{"x", ",", "linear4"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.794748088253676*^9, 3.794748109106122*^9}, 
   3.795842869599553*^9, {3.7958458971114645`*^9, 3.795845897529933*^9}, {
   3.7958470193557863`*^9, 3.795847019622069*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"0d253cdb-e9ae-4cd0-b9e0-3689271c9c2d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Angles", "Subsubsection",
 CellChangeTimes->{{3.794748120284717*^9, 
  3.794748121229681*^9}},ExpressionUUID->"b7318a16-c4ba-4f2e-ac01-\
8b723887c33b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1","p2"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947481153272667`*^9, 3.794748131915908*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"5e1b1afa-de3c-4d91-a0a7-5238c53ef07e"],

Cell[BoxData[
 TemplateBox[{"p3",RowBox[{"{", 
     RowBox[{"B", ",", "A"}], "}"}],"p2"},
  "AngleAngleChain",
  DisplayFunction->(
   RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.7947481324221945`*^9, 3.7958428731145277`*^9, 
  3.7958450507860284`*^9, 3.7958458999810963`*^9, 3.7958470217593384`*^9},
 CellLabel->
  "Out[103]=",ExpressionUUID->"2849e6eb-00aa-490c-97d1-46ca21509c66"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"l1","p1"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.794748136204043*^9, 3.794748145699086*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"25003584-f456-437e-a16c-86d444b720a2"],

Cell[BoxData[
 TemplateBox[{"l1",RowBox[{"{", 
     RowBox[{"A", ",", "B"}], "}"}],"p3"},
  "AngleAngleChain",
  DisplayFunction->(
   RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.794748146193217*^9, 3.795842874173117*^9, 
  3.795845051013743*^9, 3.7958459099947596`*^9, 3.7958470358247175`*^9},
 CellLabel->
  "Out[104]=",ExpressionUUID->"d68c07b9-ca6e-476f-8262-bbe685cb0321"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1","p2"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.7947481153272667`*^9, 3.794748131915908*^9}, {
  3.7947481725401154`*^9, 3.7947481743202057`*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"84e7431c-3861-42b9-8116-bb4026124ada"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p3",RowBox[{"{", 
      RowBox[{"B", ",", "A"}], "}"}],"p2"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "-", 
  RowBox[{"z", " ", 
   TemplateBox[{"p2","p5"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.7947481324221945`*^9, 3.794748174981965*^9, 
  3.7958428750719204`*^9, 3.7958450511216393`*^9, 3.795845912281765*^9, 
  3.795847038968278*^9},
 CellLabel->
  "Out[105]=",ExpressionUUID->"dcc4fdac-47cd-416b-8484-9cbfea357621"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"l1","p1"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.794748136204043*^9, 3.794748145699086*^9}, {
  3.7947481897953677`*^9, 3.794748192462148*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"8967b8bf-f061-4c6d-bbf0-b651f0258a8e"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"l1",RowBox[{"{", 
      RowBox[{"A", ",", "B"}], "}"}],"p3"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "+", 
  RowBox[{"z", " ", 
   TemplateBox[{"l1","p5"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.794748146193217*^9, 3.7947481928793297`*^9, 
  3.7958428759467444`*^9, 3.7958450512251205`*^9, 3.795845917954013*^9, 
  3.795847041174412*^9},
 CellLabel->
  "Out[106]=",ExpressionUUID->"289c9e6e-be22-42d5-85d2-3262979f8ef8"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Squares", "Subsubsection",
 CellChangeTimes->{{3.794748238276725*^9, 
  3.7947482396408043`*^9}},ExpressionUUID->"90724ebb-a5a7-41c8-a128-\
eb990ac9e1b8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1","p2"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.79474824414812*^9, 3.7947482569072113`*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"437d616b-5a58-4ee8-a414-5e91d60fc784"],

Cell[BoxData[
 TemplateBox[{"p1",RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}],"p4"},
  "SquareSquareChain",
  DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.794748257593755*^9, 3.7958428778480854`*^9, 
  3.7958450564415703`*^9, 3.795845942264944*^9, 3.7958470920732765`*^9},
 CellLabel->
  "Out[107]=",ExpressionUUID->"e32d3d06-eed6-465b-a0d7-70ab4391741c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2","p3"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.794748260340469*^9, 3.79474827028979*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"b8aaa9d3-16b7-43ec-bea3-0aa4018f21b6"],

Cell[BoxData[
 TemplateBox[{"p4",RowBox[{"{", 
     RowBox[{"b", ",", "a"}], "}"}],"p3"},
  "SquareSquareChain",
  DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.794748270799845*^9, 3.7958428785870967`*^9, 
  3.795845056633787*^9, 3.7958459442066727`*^9, 3.7958470953046303`*^9},
 CellLabel->
  "Out[108]=",ExpressionUUID->"a57207ff-4877-4b67-9db3-e07e6058bc6c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1","p2"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.79474824414812*^9, 3.79474828679657*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"319477f6-cd4d-491a-b077-bf95ae2527e8"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}],"p4"},
   "SquareSquareChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square",
       "]"}]& )], "-", 
  RowBox[{"z", " ", 
   TemplateBox[{"p1","p6"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.794748257593755*^9, 3.7947482877355127`*^9, 
  3.7958428799053373`*^9, 3.7958450567519565`*^9, 3.795845953628883*^9, 
  3.7958471001915226`*^9},
 CellLabel->
  "Out[109]=",ExpressionUUID->"c9fe4dd0-06ba-45ef-ad4d-f79a8f79362c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2","p3"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.794748260340469*^9, 3.7947482920567837`*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"bc1997c0-c5b9-4bb7-a36e-df01994a67f5"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p4",RowBox[{"{", 
      RowBox[{"b", ",", "a"}], "}"}],"p3"},
   "SquareSquareChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square",
       "]"}]& )], "+", 
  RowBox[{"z", " ", 
   TemplateBox[{"p3","p6"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}]}]], "Output",
 CellChangeTimes->{{3.794748270799845*^9, 3.794748292862301*^9}, 
   3.7958428890737734`*^9, 3.795845056869296*^9, 3.795845955813262*^9, 
   3.795847103335146*^9},
 CellLabel->
  "Out[110]=",ExpressionUUID->"ecd33bcb-1197-4332-9184-3a875213f39a"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Chains angles", "Subsubsection",
 CellChangeTimes->{{3.7947483387073536`*^9, 3.794748339520731*^9}, {
  3.7947486124328513`*^9, 
  3.7947486137365103`*^9}},ExpressionUUID->"105a0d1f-907a-4782-8511-\
e6d760f59dbf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", "p2", "}"}],"p4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947483448020372`*^9, 3.794748354898479*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"5a59a0c7-2028-4f02-aa8f-9a879807ad0e"],

Cell[BoxData[
 TemplateBox[{"p3",RowBox[{"{", 
     RowBox[{"B", ",", "A", ",", "p2"}], "}"}],"p4"},
  "AngleSquareChain",
  DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.794748355434944*^9, 3.7947488933289223`*^9, 
  3.7958428911038313`*^9, 3.795844400436764*^9, 3.7958447731040893`*^9, 
  3.7958450616192775`*^9, 3.795846210463872*^9, 3.7958471059900465`*^9},
 CellLabel->
  "Out[111]=",ExpressionUUID->"93d470ae-afe1-4ae6-bcf1-a7516122b98e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", "p2", "}"}],"p4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.7947483448020372`*^9, 3.794748354898479*^9}, {
  3.794748445614644*^9, 3.794748447395432*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"cfd65849-9a84-4371-994a-6adc42e1b391"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p3",RowBox[{"{", 
      RowBox[{"B", ",", "A", ",", "p2"}], "}"}],"p4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "+", 
  RowBox[{"z", " ", 
   TemplateBox[{"p5",RowBox[{"{", "p2", "}"}],"p4"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}]}]], "Output",
 CellChangeTimes->{
  3.794748355434944*^9, 3.794748488648471*^9, 3.79474889523454*^9, 
   3.7958444078149867`*^9, 3.7958445101326513`*^9, {3.795844769129387*^9, 
   3.7958447734924088`*^9}, 3.7958450617978525`*^9, 3.79584621739437*^9, 
   3.795847142388691*^9},
 CellLabel->
  "Out[112]=",ExpressionUUID->"c93cd738-eac8-44b8-a0fb-73e66883c655"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p4",RowBox[{"{", "p2", "}"}],"p1"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947484179908566`*^9, 3.794748454740518*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"38de4e48-5bf9-4d21-89f5-d9acca4c122f"],

Cell[BoxData[
 TemplateBox[{"p4",RowBox[{"{", 
     RowBox[{"p2", ",", "A", ",", "B"}], "}"}],"p3"},
  "SquareAngleChain",
  DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.7947484271703844`*^9, 3.7947488978831387`*^9, 
  3.79584451263539*^9, 3.795844773629807*^9, 3.795845061930428*^9, 
  3.7958462275861063`*^9, 3.795847147135992*^9},
 CellLabel->
  "Out[113]=",ExpressionUUID->"126d4455-fe93-405c-932b-baeea1550f85"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p4",RowBox[{"{", "p2", "}"}],"p1"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.794748495006073*^9, 3.7947484966764836`*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"9df131f5-7ae8-4a4b-9419-967be5c1bf05"],

Cell[BoxData[
 RowBox[{
  RowBox[{"z", " ", 
   TemplateBox[{"p4",RowBox[{"{", "p2", "}"}],"p5"},
    "SquareAngleChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle",
        "]"}]& )]}], "+", 
  TemplateBox[{"p4",RowBox[{"{", 
      RowBox[{"p2", ",", "A", ",", "B"}], "}"}],"p3"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{3.794748497113364*^9, 3.794748899205615*^9, 
  3.795844513809491*^9, 3.7958447737659893`*^9, 3.7958450620494304`*^9, 
  3.795846235755257*^9, 3.795847150119977*^9},
 CellLabel->
  "Out[114]=",ExpressionUUID->"e01a23d3-14c9-42b4-864c-bb3ec6ec1ba3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", 
      RowBox[{"p2", ",", "p3"}], "}"}],"p4"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947485092847323`*^9, 3.7947485195373297`*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"1f4976f8-7a86-41ff-810d-25c9f96383b4"],

Cell[BoxData[
 TemplateBox[{"p3",RowBox[{"{", 
     RowBox[{"B", ",", "A", ",", "p2", ",", "p3"}], "}"}],"p4"},
  "AngleAngleChain",
  DisplayFunction->(
   RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.7947485201060905`*^9, 3.79474890481462*^9, 
  3.7958445162613773`*^9, 3.7958447739040227`*^9, 3.795845062165242*^9, 
  3.7958462437897696`*^9, 3.795847154315792*^9},
 CellLabel->
  "Out[115]=",ExpressionUUID->"b98dc581-b712-43a2-921b-4a42c2b3d727"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", 
      RowBox[{"p2", ",", "p3"}], "}"}],"p4"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.7947485291999035`*^9, 3.79474853008352*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"274369c3-0d1d-41aa-9ce5-5d134d17386a"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p3",RowBox[{"{", 
      RowBox[{"B", ",", "A", ",", "p2", ",", "p3"}], "}"}],"p4"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "+", 
  RowBox[{"z", " ", 
   TemplateBox[{"p5",RowBox[{"{", 
       RowBox[{"p2", ",", "p3"}], "}"}],"p4"},
    "AngleAngleChain",
    DisplayFunction->(
     RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
       "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.7947485305876904`*^9, 3.794748907938732*^9, 
  3.795844517502597*^9, 3.7958447740500126`*^9, 3.795845062286977*^9, 
  3.795846247968589*^9, 3.7958471595138893`*^9},
 CellLabel->
  "Out[116]=",ExpressionUUID->"ec253355-5004-4245-b8d3-193c4c598135"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Chains squares", "Subsubsection",
 CellChangeTimes->{{3.7947483387073536`*^9, 3.794748339520731*^9}, {
  3.7947486124328513`*^9, 
  3.794748633426945*^9}},ExpressionUUID->"c3782e84-8432-4444-9c91-\
a4536e95b4fd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p3",RowBox[{"{", "p4", "}"}],"p2"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947483448020372`*^9, 3.794748354898479*^9}, {
  3.794748625290289*^9, 3.794748646457346*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"cadb0c34-8682-4149-b21b-e8fce316533e"],

Cell[BoxData[
 TemplateBox[{"p3",RowBox[{"{", 
     RowBox[{"p4", ",", "a", ",", "b"}], "}"}],"p4"},
  "AngleSquareChain",
  DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
     "]"}]& )]], "Output",
 CellChangeTimes->{
  3.794748355434944*^9, {3.7947486359981284`*^9, 3.794748647732076*^9}, 
   3.7947486869847255`*^9, 3.794748911263562*^9, 3.795844520141059*^9, 
   3.7958451385152283`*^9, 3.7958462525104437`*^9, 3.7958465577259035`*^9, 
   3.795847161918454*^9},
 CellLabel->
  "Out[117]=",ExpressionUUID->"121807a2-0f2c-4609-bb94-621867d00228"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p3",RowBox[{"{", "p5", "}"}],"p2"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.7947483448020372`*^9, 3.794748354898479*^9}, {
  3.794748445614644*^9, 3.794748447395432*^9}, {3.79474869445179*^9, 
  3.7947487130948706`*^9}, {3.794748919647318*^9, 3.7947489199976115`*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"7e91b411-9a81-49c8-9c18-06a3c89f22f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "z"}], " ", 
   TemplateBox[{"p3",RowBox[{"{", "p5", "}"}],"p6"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], "+", 
  TemplateBox[{"p3",RowBox[{"{", 
      RowBox[{"p5", ",", "a", ",", "b"}], "}"}],"p4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )]}]], "Output",
 CellChangeTimes->{
  3.794748355434944*^9, 3.794748488648471*^9, {3.79474869604881*^9, 
   3.7947487137469687`*^9}, {3.7947489146617794`*^9, 3.7947489205710754`*^9}, 
   3.7958445216253357`*^9, 3.795845138706133*^9, 3.7958462581812897`*^9, 
   3.7958465620294304`*^9, 3.795847166347608*^9},
 CellLabel->
  "Out[118]=",ExpressionUUID->"682fabcf-cc50-47d9-b7a5-08085c4ddcd8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2",RowBox[{"{", "p4", "}"}],"p3"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947484179908566`*^9, 3.794748454740518*^9}, {
  3.794748948812261*^9, 3.794748953415962*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"eccacae5-291a-4c27-acd5-aa8cbedb4ec4"],

Cell[BoxData[
 TemplateBox[{"p4",RowBox[{"{", 
     RowBox[{"b", ",", "a", ",", "p4"}], "}"}],"p3"},
  "SquareAngleChain",
  DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.7947484271703844`*^9, 3.794748954279978*^9, 
  3.7958445229866104`*^9, 3.7958451388394623`*^9, 3.795846567535697*^9, 
  3.7958471682904115`*^9},
 CellLabel->
  "Out[119]=",ExpressionUUID->"55fb6249-468b-4964-a13a-65864c415d2c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2",RowBox[{"{", "p4", "}"}],"p3"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.794748495006073*^9, 3.7947484966764836`*^9}, {
  3.7947489602613754`*^9, 3.7947489642467136`*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"6df30190-52a1-47e8-af46-f0e20605a074"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p4",RowBox[{"{", 
      RowBox[{"b", ",", "a", ",", "p4"}], "}"}],"p3"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "-", 
  RowBox[{"z", " ", 
   TemplateBox[{"p6",RowBox[{"{", "p4", "}"}],"p3"},
    "SquareAngleChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle",
        "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.794748497113364*^9, 3.794748965839892*^9, 
  3.795844524492609*^9, 3.795845138961252*^9, 3.7958465762733445`*^9, 
  3.795847173817628*^9},
 CellLabel->
  "Out[120]=",ExpressionUUID->"d70724ce-e2e6-4c58-9517-26f99a76cdcc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2",RowBox[{"{", 
      RowBox[{"p1", ",", "p3"}], "}"}],"p4"},
   "SquareSquareChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square",
       "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947489796149*^9, 3.7947489888202257`*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"2252d356-b6d9-4fd1-8551-0b83b44f5b37"],

Cell[BoxData[
 TemplateBox[{"p4",RowBox[{"{", 
     RowBox[{"b", ",", "a", ",", "p1", ",", "p3"}], "}"}],"p4"},
  "SquareSquareChain",
  DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.7947489892851896`*^9, 3.795844526350099*^9, 
  3.7958451390853744`*^9, 3.7958465775898075`*^9, 3.795847178056299*^9},
 CellLabel->
  "Out[121]=",ExpressionUUID->"0b20e322-7970-4db4-8058-ea2fba696156"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2",RowBox[{"{", 
      RowBox[{"p1", ",", "p3"}], "}"}],"p4"},
   "SquareSquareChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square",
       "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.794748996211546*^9, 3.7947489969753675`*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"091ddaf3-a291-44a7-bdcd-d1af35fdd94a"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p4",RowBox[{"{", 
      RowBox[{"b", ",", "a", ",", "p1", ",", "p3"}], "}"}],"p4"},
   "SquareSquareChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square",
       "]"}]& )], "-", 
  RowBox[{"z", " ", 
   TemplateBox[{"p6",RowBox[{"{", 
       RowBox[{"p1", ",", "p3"}], "}"}],"p4"},
    "SquareSquareChain",
    DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", 
       "$square", "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.7947489975537853`*^9, 3.7958445277622037`*^9, 
  3.795845139207796*^9, 3.7958465808381233`*^9, 3.7958471862483816`*^9},
 CellLabel->
  "Out[122]=",ExpressionUUID->"0586d1f5-919a-4ecb-af00-2e46e0b81efa"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Chains mixed", "Subsubsection",
 CellChangeTimes->{{3.7947490375599337`*^9, 
  3.794749039909021*^9}},ExpressionUUID->"84f224ed-1571-40ea-acb4-\
4f8e7fb1fc4a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", "p8", "}"}],"p2"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applyplain"}]], "Input",
 CellChangeTimes->{{3.7947490449664536`*^9, 3.7947490545911417`*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"2dc3b8ba-0d36-4ae7-bd8a-0df8f0646dcb"],

Cell[BoxData[
 TemplateBox[{"p3",RowBox[{"{", 
     RowBox[{"B", ",", "A", ",", "p8", ",", "a", ",", "b"}], "}"}],"p4"},
  "AngleSquareChain",
  DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
  InterpretationFunction->(
   RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
     "]"}]& )]], "Output",
 CellChangeTimes->{3.794749054948547*^9, 3.795844530399457*^9, 
  3.795845142688033*^9, 3.795846583318483*^9, 3.7958471990899973`*^9},
 CellLabel->
  "Out[123]=",ExpressionUUID->"0ffa9396-746b-4db0-990f-0a67b6b33f4a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", "p8", "}"}],"p2"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellChangeTimes->{{3.794749062592343*^9, 3.7947491061617165`*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"58d32128-873c-4fcd-94b3-ce0c9a9594db"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "z"}], " ", 
   TemplateBox[{"p3",RowBox[{"{", 
       RowBox[{"B", ",", "A", ",", "p8"}], "}"}],"p6"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], "+", 
  TemplateBox[{"p3",RowBox[{"{", 
      RowBox[{"B", ",", "A", ",", "p8", ",", "a", ",", "b"}], "}"}],"p4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "-", 
  RowBox[{
   SuperscriptBox["z", "2"], " ", 
   TemplateBox[{"p5",RowBox[{"{", "p8", "}"}],"p6"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], "+", 
  RowBox[{"z", " ", 
   TemplateBox[{"p5",RowBox[{"{", 
       RowBox[{"p8", ",", "a", ",", "b"}], "}"}],"p4"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}]}]], "Output",
 CellChangeTimes->{{3.794749063869943*^9, 3.794749106667944*^9}, 
   3.7958465862576237`*^9, 3.7958472051228943`*^9},
 CellLabel->
  "Out[124]=",ExpressionUUID->"c9988141-35ef-419a-8924-863149dc5431"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p1",RowBox[{"{", "p8", "}"}],"p2"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "//", "applylinear"}]], "Input",
 CellLabel->
  "In[125]:=",ExpressionUUID->"721290d6-c34b-4029-a8c8-e7032961fb36"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "z"}], " ", 
   TemplateBox[{"p3",RowBox[{"{", 
       RowBox[{"B", ",", "A", ",", "p8"}], "}"}],"p6"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], "+", 
  TemplateBox[{"p3",RowBox[{"{", 
      RowBox[{"B", ",", "A", ",", "p8", ",", "a", ",", "b"}], "}"}],"p4"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "-", 
  RowBox[{
   SuperscriptBox["z", "2"], " ", 
   TemplateBox[{"p5",RowBox[{"{", "p8", "}"}],"p6"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], "+", 
  RowBox[{"z", " ", 
   TemplateBox[{"p5",RowBox[{"{", 
       RowBox[{"p8", ",", "a", ",", "b"}], "}"}],"p4"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.7958445437452145`*^9, 3.7958451528563347`*^9, 
  3.7958465924031854`*^9, 3.795847211291395*^9},
 CellLabel->
  "Out[125]=",ExpressionUUID->"48420d30-198e-4831-a11e-dc1a705f63dc"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Linearity with respect to arguments of \[Lambda]", "Subsubsection",
 CellChangeTimes->{{3.795858240663418*^9, 
  3.795858252196983*^9}},ExpressionUUID->"d3a98fa4-a5aa-4f9b-9b16-\
8bd39c9c8e7d"],

Cell[BoxData[
 RowBox[{"UndeclareMom", "[", 
  RowBox[{"p1", ",", "p2", ",", "p3"}], "]"}]], "Input",
 CellChangeTimes->{{3.795858337108571*^9, 3.79585834251315*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"35b3f027-4df5-4c6e-a8a0-db48308cc7dc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpinorReplace2", "[", 
  RowBox[{
   TemplateBox[{"p1","p4"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"p1"},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
     TemplateBox[{RowBox[{"p2", "+", "p3"}]},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.795858256308671*^9, 3.795858331219758*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"52c55f05-6c69-4a57-b6cb-78afa9c4b0c5"],

Cell[BoxData[
 TemplateBox[{RowBox[{"p2", "+", "p3"}],"p4"},
  "SpinorAngleBracket",
  DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
     RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
  InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
     RowBox[{#, ",", #2}], "]"}]& )]], "Output",
 CellChangeTimes->{3.7958583091634064`*^9, 3.795858344273647*^9},
 CellLabel->
  "Out[131]=",ExpressionUUID->"fc2e432f-c3f7-4304-9afa-bb98ccc3815a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"DeclareMom", "[", 
  RowBox[{"p1", ",", "p2", ",", "p3"}], "]"}]], "Input",
 CellChangeTimes->{{3.795858312026538*^9, 3.7958583167725086`*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"52613d44-33ea-4961-be5e-97ac1660ef42"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpinorReplace2", "[", 
  RowBox[{
   TemplateBox[{"p1","p4"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"p1"},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
     TemplateBox[{RowBox[{"p2", "+", "p3"}]},
      "SpinorUndotPureL",
      DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7958583495945015`*^9, 3.7958583499059486`*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"9d710631-89fd-45d1-a28a-7d008f133c31"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2","p4"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "+", 
  TemplateBox[{"p3","p4"},
   "SpinorAngleBracket",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
      RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )]}]], "Output",
 CellChangeTimes->{{3.795858323871501*^9, 3.7958583506015787`*^9}},
 CellLabel->
  "Out[133]=",ExpressionUUID->"b3be4d6e-816f-4972-87ce-48bcb082d8c5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpinorReplace2", "[", 
  RowBox[{
   TemplateBox[{"p1","p4"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"p1"},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
     TemplateBox[{RowBox[{"p2", "+", 
         RowBox[{"z", "*", "p3"}]}]},
      "SpinorDotPureL",
      DisplayFunction->(RowBox[{
         OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7958583600002956`*^9, 3.79585838967443*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"7ced2e1a-7a44-4c23-a6a1-ee7cecb9d9fb"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"p2","p4"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], "+", 
  RowBox[{"z", " ", 
   TemplateBox[{"p3","p4"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}]}]], "Output",
 CellChangeTimes->{3.7958583910168777`*^9},
 CellLabel->
  "Out[134]=",ExpressionUUID->"4e0fc6f5-9a56-42e5-9710-42690d952224"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Comparison with previous version", "Subsection",
 CellChangeTimes->{{3.794749398308717*^9, 
  3.7947494077047615`*^9}},ExpressionUUID->"59065a1a-718f-480b-999a-\
e92bb1cbd3bb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A4mp", "[", 
   RowBox[{"p1_", ",", "p2_", ",", "p3_", ",", "p4_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Kappa]", "/", "2"}], ")"}], "^", "2"}]}], "*", 
   RowBox[{
    RowBox[{
     TemplateBox[{"p3",RowBox[{"{", "p1", "}"}],"p4"},
      "AngleSquareChain",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
         "$square", "]"}]& )], "^", "4"}], "/", 
    RowBox[{
     RowBox[{"S4", "[", 
      RowBox[{"p1", ",", "p2"}], "]"}], "^", "2"}]}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"I", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"mp", "[", 
         RowBox[{"p3", "+", "p1"}], "]"}], "-", 
        RowBox[{"m", "^", "2"}]}], ")"}]}], "+", 
     RowBox[{"I", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"mp", "[", 
         RowBox[{"p3", "+", "p2"}], "]"}], "-", 
        RowBox[{"m", "^", "2"}]}], ")"}]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{3.7922376386107187`*^9},
 CellLabel->
  "In[138]:=",ExpressionUUID->"88224eeb-19a8-4f25-ad58-b6d4478a83b9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"grtest", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "I"}], "*", 
     RowBox[{"S4", "[", 
      RowBox[{"p1", ",", "p2"}], "]"}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{"I", "*", 
     FractionBox[
      RowBox[{
       TemplateBox[{"p1","p3"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "^", "4"}], 
      RowBox[{
       TemplateBox[{"p1","p2"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], 
       TemplateBox[{"p2","p3"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], 
       TemplateBox[{"p3","p4"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], 
       TemplateBox[{"p4","p1"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}]]}], ")"}], 
   RowBox[{"(", 
    RowBox[{"I", "*", 
     FractionBox[
      RowBox[{
       TemplateBox[{"p1","p3"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "^", "4"}], 
      RowBox[{
       TemplateBox[{"p1","p2"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], 
       TemplateBox[{"p2","p4"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], 
       TemplateBox[{"p4","p3"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], 
       TemplateBox[{"p3","p1"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}]]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.794749648826609*^9, 3.7947497087952642`*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"180fb7c7-5929-418e-a37d-ec2b7eb1a656"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"S4", "[", 
     RowBox[{"p1", ",", "p2"}], "]"}], " ", 
    SuperscriptBox[
     TemplateBox[{"p1","p3"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "7"]}], 
   RowBox[{
    SuperscriptBox[
     TemplateBox[{"p1","p2"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
    TemplateBox[{"p1","p4"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"p2","p3"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    TemplateBox[{"p2","p4"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], " ", 
    SuperscriptBox[
     TemplateBox[{"p3","p4"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "2"]}]]}]], "Output",
 CellChangeTimes->{3.7947494731832438`*^9, 3.7947495232369404`*^9, 
  3.794749709481186*^9, 3.7958586883157268`*^9},
 CellLabel->
  "Out[139]=",ExpressionUUID->"ff23ff0c-69ea-40d5-a89d-a1c7852a61e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SpinorReplaceOld", "[", 
   RowBox[{"grtest", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       TemplateBox[{"p1"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
       TemplateBox[{"p5"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
      ",", 
      RowBox[{
       TemplateBox[{"p2"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
       TemplateBox[{"p6"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
      ",", 
      RowBox[{
       TemplateBox[{"p3"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
       TemplateBox[{"p7"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
      ",", 
      RowBox[{
       TemplateBox[{"p4"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
       TemplateBox[{"p8"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], 
     "}"}]}], "]"}], "//", "RepeatedTiming"}]], "Input",
 CellChangeTimes->{{3.7947499552542458`*^9, 3.7947500301675105`*^9}, {
  3.7958586921994743`*^9, 3.795858692561653*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"f735bbbb-ba29-4fd8-af45-fc3471bce4ab"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.000438278455284553`1.", ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"S4", "[", 
       RowBox[{"p1", ",", "p2"}], "]"}], " ", 
      SuperscriptBox[
       TemplateBox[{"p5","p7"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "7"]}], 
     RowBox[{
      SuperscriptBox[
       TemplateBox[{"p5","p6"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
      TemplateBox[{"p5","p8"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"p6","p7"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"p6","p8"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      SuperscriptBox[
       TemplateBox[{"p7","p8"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "2"]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7947500238678427`*^9, 3.7947500317011337`*^9}, 
   3.7958586971000977`*^9},
 CellLabel->
  "Out[140]=",ExpressionUUID->"9fc127f9-a3ae-4877-a541-b1f685dc28ea"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SpinorReplace2", "[", 
   RowBox[{"grtest", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       TemplateBox[{"p1"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
       TemplateBox[{"p5"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
      ",", 
      RowBox[{
       TemplateBox[{"p2"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
       TemplateBox[{"p6"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
      ",", 
      RowBox[{
       TemplateBox[{"p3"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
       TemplateBox[{"p7"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
      ",", 
      RowBox[{
       TemplateBox[{"p4"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "->", 
       TemplateBox[{"p8"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], 
     "}"}]}], "]"}], "//", "RepeatedTiming"}]], "Input",
 CellChangeTimes->{3.794750041387506*^9},
 CellLabel->
  "In[142]:=",ExpressionUUID->"816d2e3b-4b12-4e1b-8b55-fa263fe02fc5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0006292206944444444`2.", ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"S4", "[", 
       RowBox[{"p1", ",", "p2"}], "]"}], " ", 
      SuperscriptBox[
       TemplateBox[{"p5","p7"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "7"]}], 
     RowBox[{
      SuperscriptBox[
       TemplateBox[{"p5","p6"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
      TemplateBox[{"p5","p8"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"p6","p7"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"p6","p8"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      SuperscriptBox[
       TemplateBox[{"p7","p8"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "2"]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.794750043198017*^9, {3.7958587031564584`*^9, 3.795858708984913*^9}},
 CellLabel->
  "Out[142]=",ExpressionUUID->"122b7aa4-8707-4699-aef1-5bef1849fcf0"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Gluons", "Subsection",
 CellChangeTimes->{{3.7638907132104855`*^9, 
  3.763890714249737*^9}},ExpressionUUID->"484b548e-67b6-49f1-9740-\
3e623782c0e6"],

Cell[BoxData["NewProcess"], "Input",
 CellChangeTimes->{{3.763890699121151*^9, 3.7638907014209995`*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"cb29454b-e4bb-4853-bcda-941963393cab"],

Cell[BoxData[
 RowBox[{"KillMasses", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.763890703470558*^9, 3.763890709442602*^9}},
 CellLabel->
  "In[144]:=",ExpressionUUID->"30e0924c-9157-46e9-8fde-edcb76f5db58"],

Cell[BoxData[
 RowBox[{"To4DAlways", "[", "True", "]"}]], "Input",
 CellChangeTimes->{{3.794750256943302*^9, 3.794750268296935*^9}},
 CellLabel->
  "In[145]:=",ExpressionUUID->"9022d303-d85e-44d6-ab64-cad111fc18dd"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Using", " ", "the", " ", "generalization", " ", "of", " ", "Schouten", " ",
    "one", " ", "can", " ", "recast", " ", "this", " ", "in", " ", "the", " ",
    "form", " ", 
   RowBox[{"(", 
    RowBox[{
    "having", " ", "already", " ", "substituted", " ", "the", " ", "helicity",
      " ", "indices"}], ")"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.763890842323234*^9, 
  3.7638909304506197`*^9}},ExpressionUUID->"3e116113-055f-4270-9902-\
66d5811a35e8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TrF4treenice", "=", 
  RowBox[{
   RowBox[{
    TemplateBox[{"1","4","1","1"},
     "AngSquInvariant",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[#, #3], ",", 
        SubscriptBox[#2, #4], "]"}]& ),
     InterpretationFunction->(
      RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
        "]"}]& )], 
    TemplateBox[{"2","1","1","1"},
     "AngSquInvariant",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[#, #3], ",", 
        SubscriptBox[#2, #4], "]"}]& ),
     InterpretationFunction->(
      RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
        "]"}]& )], 
    TemplateBox[{"3","2","1","1"},
     "AngSquInvariant",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[#, #3], ",", 
        SubscriptBox[#2, #4], "]"}]& ),
     InterpretationFunction->(
      RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
        "]"}]& )], 
    TemplateBox[{"4","3","1","1"},
     "AngSquInvariant",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[#, #3], ",", 
        SubscriptBox[#2, #4], "]"}]& ),
     InterpretationFunction->(
      RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
        "]"}]& )]}], "+", 
   RowBox[{
    TemplateBox[{"1","2","1","1"},
     "AngSquInvariant",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[#, #3], ",", 
        SubscriptBox[#2, #4], "]"}]& ),
     InterpretationFunction->(
      RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
        "]"}]& )], 
    TemplateBox[{"2","3","1","1"},
     "AngSquInvariant",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[#, #3], ",", 
        SubscriptBox[#2, #4], "]"}]& ),
     InterpretationFunction->(
      RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
        "]"}]& )], 
    TemplateBox[{"3","4","1","1"},
     "AngSquInvariant",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[#, #3], ",", 
        SubscriptBox[#2, #4], "]"}]& ),
     InterpretationFunction->(
      RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
        "]"}]& )], 
    TemplateBox[{"4","1","1","1"},
     "AngSquInvariant",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[#, #3], ",", 
        SubscriptBox[#2, #4], "]"}]& ),
     InterpretationFunction->(
      RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
        "]"}]& )]}], "+", 
   RowBox[{
    TemplateBox[{"1","2","3","4","1","1","1","1"},
     "AngAngInvariant",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[#, #5], ",", 
        SubscriptBox[#2, #6], ",", 
        SubscriptBox[#3, #7], ",", 
        SubscriptBox[#4, #8], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(
      RowBox[{"AngAngInvariant", "[", #, ",", #2, ",", #3, ",", #4, "]", 
        "[", #5, ",", #6, ",", #7, ",", #8, "]"}]& )], 
    TemplateBox[{"1","2","3","4","1","1","1","1"},
     "SquSquInvariant",
     DisplayFunction->(RowBox[{"[", 
        SubscriptBox[#, #5], ",", 
        SubscriptBox[#2, #6], ",", 
        SubscriptBox[#3, #7], ",", 
        SubscriptBox[#4, #8], "]"}]& ),
     InterpretationFunction->(
      RowBox[{"SquSquInvariant", "[", #, ",", #2, ",", #3, ",", #4, "]", 
        "[", #5, ",", #6, ",", #7, ",", #8, "]"}]& )]}]}]}]], "Input",
 CellChangeTimes->{{3.763890865576059*^9, 3.763890882147794*^9}, {
  3.763891109947611*^9, 3.763891116996804*^9}, {3.7947502509489584`*^9, 
  3.794750254109806*^9}},
 CellLabel->
  "In[147]:=",ExpressionUUID->"3bfc0fcc-978a-41ba-b5f8-3d539708404a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "2"}], " ", 
  TemplateBox[{"1","2"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], " ", 
  TemplateBox[{"1","4"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], " ", 
  TemplateBox[{"2","3"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )], " ", 
  TemplateBox[{"3","4"},
   "SpinorSquareBracket",
   DisplayFunction->(RowBox[{"[", 
      RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
   InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
      RowBox[{#, ",", #2}], "]"}]& )]}]], "Output",
 CellChangeTimes->{
  3.7638909327813845`*^9, {3.7638911107006207`*^9, 3.7638911177058687`*^9}, 
   3.7947502469510083`*^9, 3.7947502772729173`*^9, 3.7947510209571133`*^9, 
   3.7954419741863832`*^9, 3.7958587391764193`*^9},
 CellLabel->
  "Out[147]=",ExpressionUUID->"9d549501-d000-41d5-9f24-6690e477daaf"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "In", " ", "the", " ", "following", " ", "an", " ", "arbitrary", " ", 
    "parameter", " ", "\[Alpha]", " ", "has", " ", "been", " ", "added"}], 
   ",", " ", 
   RowBox[{
   "which", " ", "led", " ", "initially", " ", "to", " ", "the", " ", "so", 
    " ", "called", " ", "De", " ", "Angelis", " ", "conjecture"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.763891465259435*^9, 
  3.7638914967422504`*^9}},ExpressionUUID->"2ceea2fb-3fad-4b39-855e-\
d2207549afef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TrF4loop", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", "TrF4treenice"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          TemplateBox[{RowBox[{"-", "l1"}],"4","a","1"},
           "AngSquInvariant",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              SubscriptBox[#, #3], ",", 
              SubscriptBox[#2, #4], "]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4,
               "]"}]& )], 
          TemplateBox[{RowBox[{"-", "l2"}],RowBox[{"-", "l1"}],"b","adot"},
           "AngSquInvariant",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              SubscriptBox[#, #3], ",", 
              SubscriptBox[#2, #4], "]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4,
               "]"}]& )], 
          TemplateBox[{"3",RowBox[{"-", "l2"}],"1","bdot"},
           "AngSquInvariant",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              SubscriptBox[#, #3], ",", 
              SubscriptBox[#2, #4], "]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4,
               "]"}]& )], 
          TemplateBox[{"4","3","1","1"},
           "AngSquInvariant",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              SubscriptBox[#, #3], ",", 
              SubscriptBox[#2, #4], "]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4,
               "]"}]& )]}], "+", 
         RowBox[{
          TemplateBox[{RowBox[{"-", "l1"}],RowBox[{"-", "l2"}],"a","bdot"},
           "AngSquInvariant",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              SubscriptBox[#, #3], ",", 
              SubscriptBox[#2, #4], "]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4,
               "]"}]& )], 
          TemplateBox[{RowBox[{"-", "l2"}],"3","b","1"},
           "AngSquInvariant",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              SubscriptBox[#, #3], ",", 
              SubscriptBox[#2, #4], "]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4,
               "]"}]& )], 
          TemplateBox[{"3","4","1","1"},
           "AngSquInvariant",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              SubscriptBox[#, #3], ",", 
              SubscriptBox[#2, #4], "]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4,
               "]"}]& )], 
          TemplateBox[{"4",RowBox[{"-", "l1"}],"1","adot"},
           "AngSquInvariant",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              SubscriptBox[#, #3], ",", 
              SubscriptBox[#2, #4], "]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"AngSquInvariant", "[", #, ",", #2, "]", "[", #3, ",", #4,
               "]"}]& )]}], "+", 
         RowBox[{"\[Alpha]", "*", 
          
          TemplateBox[{
           RowBox[{"-", "l1"}],RowBox[{"-", "l2"}],"3","4","a","b","1","1"},
           "AngAngInvariant",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              SubscriptBox[#, #5], ",", 
              SubscriptBox[#2, #6], ",", 
              SubscriptBox[#3, #7], ",", 
              SubscriptBox[#4, #8], "\[RightAngleBracket]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"AngAngInvariant", "[", #, ",", #2, ",", #3, ",", #4, "]",
               "[", #5, ",", #6, ",", #7, ",", #8, "]"}]& )], 
          
          TemplateBox[{
           RowBox[{"-", "l1"}],RowBox[{"-", "l2"}],"3","4","adot","bdot","1",
            "1"},
           "SquSquInvariant",
           DisplayFunction->(RowBox[{"[", 
              SubscriptBox[#, #5], ",", 
              SubscriptBox[#2, #6], ",", 
              SubscriptBox[#3, #7], ",", 
              SubscriptBox[#4, #8], "]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"SquSquInvariant", "[", #, ",", #2, ",", #3, ",", #4, "]",
               "[", #5, ",", #6, ",", #7, ",", #8, "]"}]& )]}]}], ")"}], "*", 
       FractionBox[
        RowBox[{"-", "I"}], 
        RowBox[{
         TemplateBox[{"1","2"},
          "SpinorAngleBracket",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
             RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
          InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], 
         TemplateBox[{"2","1"},
          "SpinorSquareBracket",
          DisplayFunction->(RowBox[{"[", 
             RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
          InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], 
         RowBox[{"S", "[", 
          RowBox[{"2", ",", "l2"}], "]"}]}]], "*", 
       TemplateBox[{"1","2","l2","l1","1","1","c","d"},
        "AngAngInvariant",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           SubscriptBox[#, #5], ",", 
           SubscriptBox[#2, #6], ",", 
           SubscriptBox[#3, #7], ",", 
           SubscriptBox[#4, #8], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(
         RowBox[{"AngAngInvariant", "[", #, ",", #2, ",", #3, ",", #4, "]", 
           "[", #5, ",", #6, ",", #7, ",", #8, "]"}]& )], "*", 
       TemplateBox[{"1","2","l2","l1","1","1","cdot","ddot"},
        "SquSquInvariant",
        DisplayFunction->(RowBox[{"[", 
           SubscriptBox[#, #5], ",", 
           SubscriptBox[#2, #6], ",", 
           SubscriptBox[#3, #7], ",", 
           SubscriptBox[#4, #8], "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SquSquInvariant", "[", #, ",", #2, ",", #3, ",", #4, "]", 
           "[", #5, ",", #6, ",", #7, ",", #8, "]"}]& )], "*", 
       TemplateBox[{"a","d"},
        "levicivita2up",
        DisplayFunction->(SuperscriptBox["\[Epsilon]", 
          RowBox[{#, #2}]]& ),
        InterpretationFunction->(
         RowBox[{"levicivita2up", "[", #, ",", #2, "]"}]& )], "*", 
       TemplateBox[{"b","c"},
        "levicivita2up",
        DisplayFunction->(SuperscriptBox["\[Epsilon]", 
          RowBox[{#, #2}]]& ),
        InterpretationFunction->(
         RowBox[{"levicivita2up", "[", #, ",", #2, "]"}]& )], "*", 
       TemplateBox[{"adot","ddot"},
        "levicivita2up",
        DisplayFunction->(SuperscriptBox["\[Epsilon]", 
          RowBox[{#, #2}]]& ),
        InterpretationFunction->(
         RowBox[{"levicivita2up", "[", #, ",", #2, "]"}]& )], "*", 
       TemplateBox[{"bdot","cdot"},
        "levicivita2up",
        DisplayFunction->(SuperscriptBox["\[Epsilon]", 
          RowBox[{#, #2}]]& ),
        InterpretationFunction->(
         RowBox[{"levicivita2up", "[", #, ",", #2, "]"}]& )]}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"b", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"d", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"adot", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"bdot", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"cdot", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ddot", ",", "2"}], "}"}]}], "]"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"extramass", "[", "l2", "]"}], "\[Rule]", 
      RowBox[{"-", 
       RowBox[{"extramass", "[", "l1", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"extramasstilde", "[", "l2", "]"}], "\[Rule]", 
      RowBox[{"-", 
       RowBox[{"extramasstilde", "[", "l1", "]"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TrF4loop", "=", 
   RowBox[{"%", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"extramass", "[", "x_", "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"m", "^", "2"}], "/", 
       RowBox[{"(", 
        RowBox[{"extramasstilde", "[", "x", "]"}], ")"}]}]}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7638909643130856`*^9, 3.763891018743543*^9}, {
   3.7638911647910123`*^9, 3.7638911824996467`*^9}, {3.763891244960327*^9, 
   3.763891246318696*^9}, {3.7638914528605895`*^9, 3.7638914545570045`*^9}, 
   3.763895242083912*^9, {3.7640642690537343`*^9, 3.7640642831300945`*^9}, {
   3.7947502947222843`*^9, 3.794750314315245*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"b8aa7cba-b359-4508-94c5-392b11faeba9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "TrF4loop", "]"}]], "Input",
 CellChangeTimes->{{3.7947504236616445`*^9, 3.7947504277905416`*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"19a76aa5-3a6d-4f7f-b7d5-b53cdb906922"],

Cell[BoxData["27"], "Output",
 CellChangeTimes->{3.794750428232559*^9, 3.794751030663978*^9, 
  3.7954419798980083`*^9, 3.7958587545977182`*^9},
 CellLabel->
  "Out[151]=",ExpressionUUID->"99b22e1f-6716-4a6c-b7b5-22016bd63656"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SpinorReplaceOld", "[", 
   RowBox[{"TrF4loop", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       TemplateBox[{"l1"},
        "SpinorUndotPureM",
        DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
       TemplateBox[{"l2"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
      ",", 
      RowBox[{
       TemplateBox[{"l1"},
        "SpinorDotPureM",
        DisplayFunction->(RowBox[{
           OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
       TemplateBox[{"3"},
        "SpinorDotPureL",
        DisplayFunction->(RowBox[{
           OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], ",", 
      RowBox[{
       TemplateBox[{"l2"},
        "SpinorUndotPureM",
        DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
       TemplateBox[{"l1"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
      ",", 
      RowBox[{
       TemplateBox[{"l2"},
        "SpinorDotPureM",
        DisplayFunction->(RowBox[{
           OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
       TemplateBox[{"3"},
        "SpinorDotPureL",
        DisplayFunction->(RowBox[{
           OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], 
     "}"}]}], "]"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.794750338890738*^9, 3.7947504323554068`*^9}, {
  3.795858756930357*^9, 3.7958587572794313`*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"2b038bf5-e7ab-4c8c-b583-b0e98dab6e14"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0104635`", ",", 
   RowBox[{
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["m", "4"], " ", 
      TemplateBox[{"3","4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "l2"}], "]"}], " ", 
      TemplateBox[{"1","2"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"1","4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"2","3"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}]], "-", 
    FractionBox[
     RowBox[{"2", " ", "\[ImaginaryI]", " ", 
      SuperscriptBox["m", "4"], " ", "\[Alpha]", " ", 
      TemplateBox[{"3","4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "l2"}], "]"}], " ", 
      TemplateBox[{"1","2"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"1","4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"2","3"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}]], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["m", "2"], " ", 
      TemplateBox[{"l1","l2"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"3","l2"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"4","l1"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "l2"}], "]"}], " ", 
      TemplateBox[{"1","2"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"1","4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"2","3"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}]], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox[
       TemplateBox[{"l1","l2"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
      TemplateBox[{"3","l2"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"4","l1"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"l1","l2"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "l2"}], "]"}], " ", 
      TemplateBox[{"1","2"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"1","4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"2","3"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.794750400772504*^9, 3.7947504327996283`*^9, {3.7958587604132533`*^9, 
   3.795858775176099*^9}},
 CellLabel->
  "Out[154]=",ExpressionUUID->"16979328-5ca9-4db0-8ff3-3a63d85a5c4e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SpinorReplace2", "[", 
   RowBox[{"TrF4loop", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       TemplateBox[{"l1"},
        "SpinorUndotPureM",
        DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
       TemplateBox[{"l2"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
      ",", 
      RowBox[{
       TemplateBox[{"l1"},
        "SpinorDotPureM",
        DisplayFunction->(RowBox[{
           OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
       TemplateBox[{"3"},
        "SpinorDotPureL",
        DisplayFunction->(RowBox[{
           OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], ",", 
      RowBox[{
       TemplateBox[{"l2"},
        "SpinorUndotPureM",
        DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
       TemplateBox[{"l1"},
        "SpinorUndotPureL",
        DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
      ",", 
      RowBox[{
       TemplateBox[{"l2"},
        "SpinorDotPureM",
        DisplayFunction->(RowBox[{
           OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
       TemplateBox[{"3"},
        "SpinorDotPureL",
        DisplayFunction->(RowBox[{
           OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], 
     "}"}]}], "]"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{3.7947504422858596`*^9},
 CellLabel->
  "In[155]:=",ExpressionUUID->"2fc97d5f-8b15-4dde-be17-baa9413b69e7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0094474`", ",", 
   RowBox[{
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["m", "4"], " ", 
      TemplateBox[{"3","4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "l2"}], "]"}], " ", 
      TemplateBox[{"1","2"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"1","4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"2","3"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}]], "-", 
    FractionBox[
     RowBox[{"2", " ", "\[ImaginaryI]", " ", 
      SuperscriptBox["m", "4"], " ", "\[Alpha]", " ", 
      TemplateBox[{"3","4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "l2"}], "]"}], " ", 
      TemplateBox[{"1","2"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"1","4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"2","3"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}]], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["m", "2"], " ", 
      TemplateBox[{"l1","l2"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"3","l2"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"4","l1"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "l2"}], "]"}], " ", 
      TemplateBox[{"1","2"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"1","4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"2","3"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}]], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox[
       TemplateBox[{"l1","l2"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
      TemplateBox[{"3","l2"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"4","l1"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"l1","l2"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "l2"}], "]"}], " ", 
      TemplateBox[{"1","2"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"1","4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], " ", 
      TemplateBox[{"2","3"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7947504431048193`*^9, {3.7958587678367248`*^9, 3.7958587774249744`*^9}},
 CellLabel->
  "Out[155]=",ExpressionUUID->"0437429b-bfcd-4ff7-97d0-efbe31d476f9"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ultrasum", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "i", "]"}], "*", "TrF4loop"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "100"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7947505722740498`*^9, 3.7947506059323177`*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"3b64e086-f3b4-4664-baa4-aba7bab45d27"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SpinorReplaceOld", "[", 
    RowBox[{"ultrasum", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        TemplateBox[{"l1"},
         "SpinorUndotPureM",
         DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"l2"},
         "SpinorUndotPureL",
         DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
       ",", 
       RowBox[{
        TemplateBox[{"l1"},
         "SpinorDotPureM",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"3"},
         "SpinorDotPureL",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], ",", 
       RowBox[{
        TemplateBox[{"l2"},
         "SpinorUndotPureM",
         DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"l1"},
         "SpinorUndotPureL",
         DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
       ",", 
       RowBox[{
        TemplateBox[{"l2"},
         "SpinorDotPureM",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"3"},
         "SpinorDotPureL",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], 
      "}"}]}], "]"}], "//", "AbsoluteTiming"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "[", 
  RowBox[{"[", "1", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.794750338890738*^9, 3.7947504323554068`*^9}, {
  3.79475065156732*^9, 3.7947506841834335`*^9}, {3.7958587951622734`*^9, 
  3.7958587955191145`*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"3fd2fd8d-9e19-46e2-aa66-eed102a95330"],

Cell[BoxData["0.8804673`"], "Output",
 CellChangeTimes->{
  3.794750400772504*^9, 3.7947504327996283`*^9, {3.7947506575300527`*^9, 
   3.7947506865822783`*^9}, 3.795858798779504*^9},
 CellLabel->
  "Out[158]=",ExpressionUUID->"7a053e22-6592-41cc-8465-6157919275eb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SpinorReplace2", "[", 
    RowBox[{"ultrasum", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        TemplateBox[{"l1"},
         "SpinorUndotPureM",
         DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"l2"},
         "SpinorUndotPureL",
         DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
       ",", 
       RowBox[{
        TemplateBox[{"l1"},
         "SpinorDotPureM",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"3"},
         "SpinorDotPureL",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], ",", 
       RowBox[{
        TemplateBox[{"l2"},
         "SpinorUndotPureM",
         DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"l1"},
         "SpinorUndotPureL",
         DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
       ",", 
       RowBox[{
        TemplateBox[{"l2"},
         "SpinorDotPureM",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"3"},
         "SpinorDotPureL",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], 
      "}"}]}], "]"}], "//", "AbsoluteTiming"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "[", 
  RowBox[{"[", "1", "]"}], "]"}]}], "Input",
 CellChangeTimes->{
  3.7947504422858596`*^9, {3.794750690716691*^9, 3.7947507008011045`*^9}},
 CellLabel->
  "In[159]:=",ExpressionUUID->"3123835b-75b5-4516-b247-9d0847f02861"],

Cell[BoxData["0.4738071`"], "Output",
 CellChangeTimes->{3.7947504431048193`*^9, 3.7947507021631794`*^9, 
  3.7958588024478717`*^9},
 CellLabel->
  "Out[160]=",ExpressionUUID->"a2cb3c11-8343-44bb-a8d7-164718b62c89"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ultrasum2", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "i", "]"}], "*", "TrF4loop"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1000"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7947505722740498`*^9, 3.7947506059323177`*^9}, {
  3.7947507257518635`*^9, 3.7947507289520197`*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"7edc580f-46f4-4121-b058-5aae859237bd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SpinorReplaceOld", "[", 
    RowBox[{"ultrasum2", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        TemplateBox[{"l1"},
         "SpinorUndotPureM",
         DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"l2"},
         "SpinorUndotPureL",
         DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
       ",", 
       RowBox[{
        TemplateBox[{"l1"},
         "SpinorDotPureM",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"3"},
         "SpinorDotPureL",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], ",", 
       RowBox[{
        TemplateBox[{"l2"},
         "SpinorUndotPureM",
         DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"l1"},
         "SpinorUndotPureL",
         DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
       ",", 
       RowBox[{
        TemplateBox[{"l2"},
         "SpinorDotPureM",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"3"},
         "SpinorDotPureL",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], 
      "}"}]}], "]"}], "//", "AbsoluteTiming"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "[", 
  RowBox[{"[", "1", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.794750338890738*^9, 3.7947504323554068`*^9}, {
   3.79475065156732*^9, 3.7947506841834335`*^9}, 3.7947507337083645`*^9, {
   3.7958588162248783`*^9, 3.795858816589938*^9}, {3.795858869638994*^9, 
   3.795858873543173*^9}},ExpressionUUID->"86bbdc21-8bf7-4bbf-9b8a-\
c4dc5301b0f2"],

Cell[BoxData["8.1134137`"], "Output",
 CellChangeTimes->{
  3.794750400772504*^9, 3.7947504327996283`*^9, {3.7947506575300527`*^9, 
   3.7947506865822783`*^9}, 3.7947507484902835`*^9, 3.795858825541417*^9},
 CellLabel->
  "Out[163]=",ExpressionUUID->"6bccc68d-4501-4a4b-a73b-6864186f0a9e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SpinorReplace2", "[", 
    RowBox[{"ultrasum2", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        TemplateBox[{"l1"},
         "SpinorUndotPureM",
         DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"l2"},
         "SpinorUndotPureL",
         DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
       ",", 
       RowBox[{
        TemplateBox[{"l1"},
         "SpinorDotPureM",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"3"},
         "SpinorDotPureL",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], ",", 
       RowBox[{
        TemplateBox[{"l2"},
         "SpinorUndotPureM",
         DisplayFunction->(RowBox[{"\[Mu]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"l1"},
         "SpinorUndotPureL",
         DisplayFunction->(RowBox[{"\[Lambda]", "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )]}], 
       ",", 
       RowBox[{
        TemplateBox[{"l2"},
         "SpinorDotPureM",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "->", 
        TemplateBox[{"3"},
         "SpinorDotPureL",
         DisplayFunction->(RowBox[{
            OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )]}]}], 
      "}"}]}], "]"}], "//", "AbsoluteTiming"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "[", 
  RowBox[{"[", "1", "]"}], "]"}]}], "Input",
 CellChangeTimes->{
  3.7947504422858596`*^9, {3.794750690716691*^9, 3.7947507008011045`*^9}, 
   3.7947507409070015`*^9},
 CellLabel->
  "In[164]:=",ExpressionUUID->"bdcd432c-6598-438a-9e07-c7018944acab"],

Cell[BoxData["2.5462399`"], "Output",
 CellChangeTimes->{3.7947504431048193`*^9, 3.7947507021631794`*^9, 
  3.7947507549024467`*^9, 3.795858837701701*^9},
 CellLabel->
  "Out[165]=",ExpressionUUID->"897282d6-3239-4197-8425-b64929c4d312"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "As", " ", "I", " ", "suspected", " ", "the", " ", "new", " ", "version", 
   " ", "works", " ", "far", " ", "better", " ", "with", " ", "a", " ", 
   "higher", " ", "number", " ", "of", " ", "terms"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7947507655192966`*^9, 
  3.7947507870961103`*^9}},ExpressionUUID->"18c10813-df87-4003-a920-\
d11c695fdc10"]
}, Closed]]
},
WindowSize->{759, 697},
WindowMargins->{{367, Automatic}, {Automatic, 17}},
InputAliases->{"intt" -> RowBox[{"\[Integral]", 
     RowBox[{"\[SelectionPlaceholder]", 
       RowBox[{"\[DifferentialD]", "\[Placeholder]"}]}]}], "dintt" -> RowBox[{
     SubsuperscriptBox[
     "\[Integral]", "\[SelectionPlaceholder]", "\[Placeholder]"], 
     RowBox[{"\[Placeholder]", 
       RowBox[{"\[DifferentialD]", "\[Placeholder]"}]}]}], "rintt" -> RowBox[{
     UnderscriptBox["\[Integral]", 
      RowBox[{"\[SelectionPlaceholder]", "\[Element]", "\[Placeholder]"}]], 
     "\[Placeholder]"}], "sumt" -> RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"\[SelectionPlaceholder]", "=", "\[Placeholder]"}], 
      "\[Placeholder]"], "\[Placeholder]"}], "prodt" -> RowBox[{
     UnderoverscriptBox["\[Product]", 
      RowBox[{"\[SelectionPlaceholder]", "=", "\[Placeholder]"}], 
      "\[Placeholder]"], "\[Placeholder]"}], "dt" -> RowBox[{
     SubscriptBox["\[PartialD]", "\[Placeholder]"], " ", 
     "\[SelectionPlaceholder]"}], "cbrt" -> 
  RadicalBox[
   "\[SelectionPlaceholder]", "3", SurdForm -> True, MultilineFunction -> 
    None], "surd" -> 
  RadicalBox[
   "\[SelectionPlaceholder]", "\[Placeholder]", SurdForm -> True, 
    MultilineFunction -> None], "ket" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "Ket"], "bra" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "Bra"], "braket" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[Placeholder]"}, "BraKet"], 
  "delay" -> TemplateBox[{"\[SelectionPlaceholder]"}, "SystemsModelDelay"], 
  "grad" -> RowBox[{
     SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], "\[Placeholder]"}], 
  "del." -> RowBox[{
     SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], ".", 
     "\[Placeholder]"}], "delx" -> RowBox[{
     SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], "\[Cross]", 
     "\[Placeholder]"}], "del2" -> RowBox[{
     SubsuperscriptBox["\[Del]", "\[SelectionPlaceholder]", 2], 
     "\[Placeholder]"}], "kd" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "KroneckerDeltaSeq"], "algs" -> 
  TemplateBox[{}, "Algebraics"], "bools" -> TemplateBox[{}, "Booleans"], 
  "comps" -> TemplateBox[{}, "Complexes"], "ints" -> 
  TemplateBox[{}, "Integers"], "pris" -> TemplateBox[{}, "Primes"], "rats" -> 
  TemplateBox[{}, "Rationals"], "reals" -> TemplateBox[{}, "Reals"], "dlim" -> 
  RowBox[{
     UnderscriptBox["\[Limit]", 
      RowBox[{"\[SelectionPlaceholder]", 
        UnderscriptBox["\[Rule]", 
         TemplateBox[{}, "Integers"]], "\[Infinity]"}]], "\[Placeholder]"}], 
  "dMlim" -> RowBox[{
     UnderscriptBox["\[MaxLimit]", 
      RowBox[{"\[SelectionPlaceholder]", 
        UnderscriptBox["\[Rule]", 
         TemplateBox[{}, "Integers"]], "\[Infinity]"}]], "\[Placeholder]"}], 
  "dmlim" -> RowBox[{
     UnderscriptBox["\[MinLimit]", 
      RowBox[{"\[SelectionPlaceholder]", 
        UnderscriptBox["\[Rule]", 
         TemplateBox[{}, "Integers"]], "\[Infinity]"}]], "\[Placeholder]"}], 
  "notation" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongLeftRightArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "notation>" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongRightArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "notation<" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongLeftArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "symb" -> RowBox[{"Symbolize", "[", 
     TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], "]"}], 
  "infixnotation" -> RowBox[{"InfixNotation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], ",", 
       "\[Placeholder]"}], "]"}], "addia" -> RowBox[{"AddInputAlias", "[", 
     RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "pattwraper" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "NotationPatternTag"], 
  "madeboxeswraper" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "NotationMadeBoxesTag"], "lu" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorLaUp", DisplayFunction -> (RowBox[{
       SuperscriptBox["\[Lambda]", #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinorundot", "[", #, "]", "[", "$lam", "]", "[", #2, "]", "[", 
       "Null", "]"}]& )], "ld" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorLaDown", DisplayFunction -> (RowBox[{
       SubscriptBox["\[Lambda]", #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinorundot", "[", #, "]", "[", "$lam", "]", "[", "Null", "]", 
       "[", #2, "]"}]& )], "muu" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorMuUp", DisplayFunction -> (RowBox[{
       SuperscriptBox["\[Mu]", #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinorundot", "[", #, "]", "[", "$mu", "]", "[", #2, "]", "[", 
       "Null", "]"}]& )], "mud" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorMuDown", DisplayFunction -> (RowBox[{
       SubscriptBox["\[Mu]", #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinorundot", "[", #, "]", "[", "$mu", "]", "[", "Null", "]", 
       "[", #2, "]"}]& )], "lp" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "SpinorUndotPureL", 
    DisplayFunction -> (RowBox[{"\[Lambda]", "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "mp" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "SpinorUndotPureM", 
    DisplayFunction -> (RowBox[{"\[Mu]", "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "Ld" -> 
  TemplateBox[{
    "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]"}, "SpinorUndot6D", DisplayFunction -> (RowBox[{
       SubscriptBox[
        SuperscriptBox["\[CapitalLambda]", #2], #3], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"SpinorUndot6D", "[", #, "]", "[", #2, "]", "[", "Null", "]", 
       "[", #3, "]"}]& )], "ltu" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorLatUp", DisplayFunction -> (RowBox[{
       SuperscriptBox[
        OverscriptBox["\[Lambda]", "~"], #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinordot", "[", #, "]", "[", "$lam", "]", "[", #2, "]", "[", 
       "Null", "]"}]& )], "ltd" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorLatDown", DisplayFunction -> (RowBox[{
       SubscriptBox[
        OverscriptBox["\[Lambda]", "~"], #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinordot", "[", #, "]", "[", "$lam", "]", "[", "Null", "]", 
       "[", #2, "]"}]& )], "mtu" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorMutUp", DisplayFunction -> (RowBox[{
       SuperscriptBox[
        OverscriptBox["\[Mu]", "~"], #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinordot", "[", #, "]", "[", "$mu", "]", "[", #2, "]", "[", 
       "Null", "]"}]& )], "mtd" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorMutDown", DisplayFunction -> (RowBox[{
       SubscriptBox[
        OverscriptBox["\[Mu]", "~"], #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinordot", "[", #, "]", "[", "$mu", "]", "[", "Null", "]", 
       "[", #2, "]"}]& )], "ltp" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "SpinorDotPureL", 
    DisplayFunction -> (RowBox[{
       OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "mtp" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "SpinorDotPureM", 
    DisplayFunction -> (RowBox[{
       OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "Ltd" -> 
  TemplateBox[{
    "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]"}, "SpinorDot6D", DisplayFunction -> (RowBox[{
       SubscriptBox[
        SubscriptBox[
         OverscriptBox["\[CapitalLambda]", "~"], #2], #3], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"SpinorDot6D", "[", #, "]", "[", #2, "]", "[", "Null", "]", 
       "[", #3, "]"}]& )], "lcup" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "levicivita2up", DisplayFunction -> (SuperscriptBox["\[Epsilon]", 
      RowBox[{#, #2}]]& ), 
    InterpretationFunction -> (
     RowBox[{"levicivita2up", "[", #, ",", #2, "]"}]& )], "lcd" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "levicivita2down", DisplayFunction -> (SubscriptBox["\[Epsilon]", 
      RowBox[{#, #2}]]& ), 
    InterpretationFunction -> (
     RowBox[{"levicivita2down", "[", #, ",", #2, "]"}]& )], "ab" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[Placeholder]"}, 
    "SpinorAngleBracket", DisplayFunction -> (RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ), 
    InterpretationFunction -> (RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], "sb" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[Placeholder]"}, 
    "SpinorSquareBracket", DisplayFunction -> (RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ), 
    InterpretationFunction -> (RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], "sai" -> 
  TemplateBox[{
    "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, "SquAngInvariant",
     DisplayFunction -> (RowBox[{"[", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "\[RightAngleBracket]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Squanginvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], "asi" -> 
  TemplateBox[{
    "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, "AngSquInvariant",
     DisplayFunction -> (RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], "aa" -> 
  TemplateBox[{
    "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, "AngAngInvariant",
     DisplayFunction -> (RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #5], ",", 
       SubscriptBox[#2, #6], ",", 
       SubscriptBox[#3, #7], ",", 
       SubscriptBox[#4, #8], "\[RightAngleBracket]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Anganginvariant", "[", #, ",", #2, ",", #3, ",", #4, "]", 
       "[", #5, ",", #6, ",", #7, ",", #8, "]"}]& )], "bb" -> 
  TemplateBox[{
    "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, "SquSquInvariant",
     DisplayFunction -> (RowBox[{"[", 
       SubscriptBox[#, #5], ",", 
       SubscriptBox[#2, #6], ",", 
       SubscriptBox[#3, #7], ",", 
       SubscriptBox[#4, #8], "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Squsquinvariant", "[", #, ",", #2, ",", #3, ",", #4, "]", 
       "[", #5, ",", #6, ",", #7, ",", #8, "]"}]& )], "fst" -> 
  TemplateBox[{
    "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]"}, "Fstrength", DisplayFunction -> (RowBox[{
       SubscriptBox[
        SuperscriptBox["F", 
         RowBox[{#2, #3}]], 
        RowBox[{#4, #5}]], "[", 
       SubscriptBox[#, 
        RowBox[{#6, #7}]], "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Fstrength[", #, "][", #2, ",", #3, "][", #4, ",", #5, "][", #6, 
       ",", #7, "]"}]& )], "md" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 4}, 
    "MDelta", DisplayFunction -> (RowBox[{
       SubscriptBox[
        SuperscriptBox["\[Delta]", #], #2]}]& ), 
    InterpretationFunction -> (
     RowBox[{"MDelta", "[", #3, "][", #, "][", #2, "]"}]& )]},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 205, 3, 28, "Input",ExpressionUUID->"3d23a24c-8699-48bb-a4ef-f96529484450"],
Cell[CellGroupData[{
Cell[810, 29, 373, 7, 22, "Print",ExpressionUUID->"f5629021-07b9-40c1-8f2b-2769bcce7e9c"],
Cell[1186, 38, 365, 6, 22, "Print",ExpressionUUID->"01dd4747-7436-4424-9dd8-7ace6b67d721"],
Cell[1554, 46, 358, 6, 22, "Print",ExpressionUUID->"e95d3f6e-8bb5-48d6-b25c-012b68d60dbd"],
Cell[1915, 54, 349, 6, 22, "Print",ExpressionUUID->"b861b833-4dd8-47af-b3ba-ed81ac892002"],
Cell[2267, 62, 352, 6, 22, "Print",ExpressionUUID->"a1950a46-7aeb-4445-ab03-e6630facf2e5"],
Cell[2622, 70, 348, 6, 22, "Print",ExpressionUUID->"7c3fdb91-e545-4c2d-8d55-01d53cd80a3d"],
Cell[2973, 78, 360, 6, 22, "Print",ExpressionUUID->"4767138b-d2ac-4325-8026-7623fab79895"],
Cell[3336, 86, 373, 7, 22, "Print",ExpressionUUID->"b4d03040-e78b-4232-8962-460dbecc840f"]
}, Open  ]]
}, Open  ]],
Cell[3736, 97, 820, 14, 86, "Input",ExpressionUUID->"79bc2e33-d1a5-4af0-9fad-50a669c8cf83"],
Cell[CellGroupData[{
Cell[4581, 115, 730, 16, 28, "Input",ExpressionUUID->"30193168-c86e-48c8-90cd-63c6af2a8b75"],
Cell[5314, 133, 440, 8, 32, "Output",ExpressionUUID->"2eafa1cb-c39c-4777-b8dc-1e80e1b8e6e6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5791, 146, 676, 15, 28, "Input",ExpressionUUID->"23c7d2f4-6e44-4495-bf70-bb371fefe5ce"],
Cell[6470, 163, 462, 9, 32, "Output",ExpressionUUID->"519df45e-0eb6-4030-bbd8-f11ccd84e6c9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6969, 177, 158, 3, 53, "Subsection",ExpressionUUID->"52efd50d-d3b0-404b-a241-cca92bb736a8"],
Cell[CellGroupData[{
Cell[7152, 184, 8075, 214, 321, "Code",ExpressionUUID->"156329d6-a802-45ba-8d41-88a09cf47573"],
Cell[15230, 400, 355, 9, 21, "Message",ExpressionUUID->"eda1931d-3ac1-48b7-81b3-b3b7c57e0912"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[15634, 415, 216, 4, 53, "Subsection",ExpressionUUID->"60a5a24f-a48a-4c99-a37f-6939051f60b5"],
Cell[CellGroupData[{
Cell[15875, 423, 279, 6, 44, "Subsubsection",ExpressionUUID->"8b80e998-b0b0-44cd-ae0d-0b38e55984a4"],
Cell[CellGroupData[{
Cell[16179, 433, 3566, 90, 58, "Input",ExpressionUUID->"ad29bcf2-a3e0-4801-aa43-990721a57d45"],
Cell[19748, 525, 3411, 90, 59, "Output",ExpressionUUID->"cb1fd3c3-31f5-41d9-8b43-75e96c3dfd1a"]
}, Open  ]],
Cell[23174, 618, 14896, 345, 1302, "Input",ExpressionUUID->"a802e4cc-9625-48f5-a192-87d6e73bbb32"],
Cell[CellGroupData[{
Cell[38095, 967, 263, 5, 28, "Input",ExpressionUUID->"be2c4161-a709-4d32-96a1-c831d168eac8"],
Cell[38361, 974, 204, 3, 32, "Output",ExpressionUUID->"759db37d-8c32-46c8-929c-0f1a2c5e3896"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38602, 982, 702, 17, 34, "Input",ExpressionUUID->"77c233c2-0dc2-4e3d-96a8-b294010b152e"],
Cell[39307, 1001, 204, 3, 32, "Output",ExpressionUUID->"693c0f25-96c7-4a8f-aaff-9bed4a33840c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39548, 1009, 211, 3, 28, "Input",ExpressionUUID->"0644c9cc-93a0-4c98-8375-a6ac25b7081f"],
Cell[CellGroupData[{
Cell[39784, 1016, 833, 17, 22, "Print",ExpressionUUID->"138959a0-e164-4384-b845-1b90f4464aef"],
Cell[40620, 1035, 5181, 115, 149, "Print",ExpressionUUID->"b92853f4-47df-488d-be4d-2a1521f85ec2"],
Cell[45804, 1152, 835, 17, 22, "Print",ExpressionUUID->"2716b9a9-666d-4944-9350-d757f95d011e"],
Cell[46642, 1171, 4913, 115, 131, "Print",ExpressionUUID->"ddb78399-0ca7-4f8b-bb35-d8fe024d2e83"]
}, Open  ]],
Cell[51570, 1289, 8987, 210, 280, "Output",ExpressionUUID->"377e8687-0f69-4186-9930-dd18f8794cde"]
}, Open  ]],
Cell[60572, 1502, 215, 4, 28, "Input",ExpressionUUID->"9720ce4e-263c-4af3-a0d9-e2624ac3fa8b"],
Cell[CellGroupData[{
Cell[60812, 1510, 474, 9, 28, "Input",ExpressionUUID->"812641f9-a261-4424-ad77-0d5b4bf8c812"],
Cell[61289, 1521, 442, 9, 32, "Output",ExpressionUUID->"a3ed4462-8eab-47fa-add4-1196dde1d26d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61768, 1535, 524, 10, 28, "Input",ExpressionUUID->"994f89a1-efac-4725-a2a9-827d93f52348"],
Cell[62295, 1547, 438, 8, 32, "Output",ExpressionUUID->"81215614-a60b-46ae-aab4-f4a2aac2cbec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62770, 1560, 506, 10, 28, "Input",ExpressionUUID->"defa50fe-5075-4ab8-b24a-bb3ce71ae058"],
Cell[63279, 1572, 473, 9, 32, "Output",ExpressionUUID->"ae8b9975-a1a8-41a9-92f0-10e212934f09"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63789, 1586, 468, 9, 28, "Input",ExpressionUUID->"0f40204e-d207-4033-afbf-2784df0a14ff"],
Cell[64260, 1597, 415, 8, 32, "Output",ExpressionUUID->"7e886991-579d-4fb9-b570-8332f7ec94a4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64712, 1610, 547, 12, 28, "Input",ExpressionUUID->"39f5f864-e400-48ac-92c0-c3855ea463a2"],
Cell[65262, 1624, 566, 11, 32, "Output",ExpressionUUID->"4a655d33-3d5d-4d7d-aee2-9f09ac1ac7af"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65865, 1640, 439, 9, 28, "Input",ExpressionUUID->"da88dffa-3b50-49ea-9dfd-dbce88963141"],
Cell[66307, 1651, 407, 9, 32, "Output",ExpressionUUID->"5fd05dc1-d63e-439c-bed2-517174d1ea7c"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[66763, 1666, 181, 3, 36, "Subsubsection",ExpressionUUID->"b20effb0-845a-41c6-890d-cd197ec1421e"],
Cell[66947, 1671, 19439, 458, 1663, "Input",ExpressionUUID->"9e556019-9ef6-4937-82fd-bd5fdcc6808b"],
Cell[CellGroupData[{
Cell[86411, 2133, 3565, 90, 58, "Input",ExpressionUUID->"c180b566-63b1-4cc4-9379-68bd2c463628"],
Cell[89979, 2225, 3432, 90, 59, "Output",ExpressionUUID->"d6e96c58-bfac-42c9-8dfb-93bd5744baf1"]
}, Open  ]],
Cell[93426, 2318, 299, 6, 28, "Input",ExpressionUUID->"4789b337-adce-4ca7-a7d6-98b03ef54186"],
Cell[CellGroupData[{
Cell[93750, 2328, 529, 10, 28, "Input",ExpressionUUID->"ba8d6a80-e24b-4116-9c86-46bec5012512"],
Cell[94282, 2340, 465, 9, 32, "Output",ExpressionUUID->"c2125519-2b9d-4505-bbe3-9866d45b87dd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[94784, 2354, 478, 9, 28, "Input",ExpressionUUID->"34fc820f-b6d5-4bd2-a019-fb8a6c8273e5"],
Cell[95265, 2365, 418, 8, 32, "Output",ExpressionUUID->"0b055f64-9250-4ef5-82eb-5a16bb36e758"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[95732, 2379, 371, 7, 61, "Subsubsection",ExpressionUUID->"6e5ccadb-139c-4204-9d58-79f0eac40f9f"],
Cell[96106, 2388, 996, 25, 69, "Input",ExpressionUUID->"46efc746-98ba-4fcb-b6e8-a5b51e546c0d"],
Cell[97105, 2415, 40586, 896, 3107, "Input",ExpressionUUID->"6e8a3dc1-2a9b-482f-8b08-7b5f4583493c"]
}, Closed]],
Cell[CellGroupData[{
Cell[137728, 3316, 324, 5, 36, "Subsubsection",ExpressionUUID->"a06b6e7b-04a0-4596-b3bb-9ab6bb6a6b19"],
Cell[138055, 3323, 996, 25, 69, "Input",ExpressionUUID->"30b4ab18-5ae9-4858-b443-07fae342a280"],
Cell[139054, 3350, 33923, 778, 2805, "Input",ExpressionUUID->"978bb3c0-c874-45a0-8263-bbe3e3383f61"]
}, Closed]],
Cell[CellGroupData[{
Cell[173014, 4133, 504, 7, 36, "Subsubsection",ExpressionUUID->"cbf56a28-527a-46e0-ae83-3c4bffb42539"],
Cell[173521, 4142, 1014, 24, 69, "Input",ExpressionUUID->"3e0a2bfe-eaf4-47cb-992d-93ba15fd6e73"],
Cell[174538, 4168, 37234, 853, 3014, "Input",ExpressionUUID->"a3caf81a-13d4-4a05-b7b9-69fecf8d355f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[211821, 5027, 155, 3, 53, "Subsection",ExpressionUUID->"46937f3d-04c3-4b98-acc4-610c2a5edc1d"],
Cell[CellGroupData[{
Cell[212001, 5034, 1209, 30, 34, "Input",ExpressionUUID->"3c6ffe19-4a52-4304-b833-fb0c22d5b515"],
Cell[213213, 5066, 1146, 30, 36, "Output",ExpressionUUID->"68a1671f-d84b-483b-ab43-6f63c7141d81"]
}, Open  ]],
Cell[214374, 5099, 306, 6, 28, "Input",ExpressionUUID->"629bfb4c-703a-44ab-a025-71a2444a2721"],
Cell[CellGroupData[{
Cell[214705, 5109, 1855, 47, 34, "Input",ExpressionUUID->"fa8816ea-fa07-4663-b23d-5b184f37f5fd"],
Cell[216563, 5158, 1726, 46, 36, "Output",ExpressionUUID->"704e34ea-b648-492c-b4be-dafb559ec70d"]
}, Open  ]],
Cell[218304, 5207, 304, 6, 28, "Input",ExpressionUUID->"2b943293-72c5-4bc2-a53b-3b6fdf3fe1ed"],
Cell[CellGroupData[{
Cell[218633, 5217, 157, 3, 44, "Subsubsection",ExpressionUUID->"aa8fe545-d5cd-47fd-9278-760ea408b513"],
Cell[CellGroupData[{
Cell[218815, 5224, 480, 9, 28, "Input",ExpressionUUID->"1a5057b3-9b46-4a32-8e4c-50f9357acd1d"],
Cell[219298, 5235, 442, 9, 32, "Output",ExpressionUUID->"7416c477-a3d7-480b-9526-9c688b287dca"]
}, Open  ]],
Cell[CellGroupData[{
Cell[219777, 5249, 478, 9, 28, "Input",ExpressionUUID->"43f1de2a-df76-47fa-9388-3487d4c61ded"],
Cell[220258, 5260, 417, 8, 32, "Output",ExpressionUUID->"dc7331c6-1f63-4a3b-ad54-1d9b3cf12ffb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[220712, 5273, 534, 10, 28, "Input",ExpressionUUID->"2d93ba95-f252-4794-9680-766895574e47"],
Cell[221249, 5285, 796, 17, 32, "Output",ExpressionUUID->"ecd23d35-54cb-4706-8035-bd74bb725f6e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[222082, 5307, 530, 10, 28, "Input",ExpressionUUID->"70575923-37b1-432b-a157-f12ae26d3e5a"],
Cell[222615, 5319, 772, 16, 32, "Output",ExpressionUUID->"d550105d-5bb8-40fc-b307-ccd3a76b8951"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[223436, 5341, 160, 3, 44, "Subsubsection",ExpressionUUID->"6d4c4fbd-d354-4ac5-aaee-cf879e4fe55a"],
Cell[CellGroupData[{
Cell[223621, 5348, 444, 9, 28, "Input",ExpressionUUID->"e4869842-2ac2-4279-9d61-31a0cce61e5c"],
Cell[224068, 5359, 382, 8, 32, "Output",ExpressionUUID->"3c41f7c5-e879-4f60-8cba-e17f756eeac6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[224487, 5372, 442, 9, 28, "Input",ExpressionUUID->"82a74498-6f7d-4369-8956-d0407dc8a752"],
Cell[224932, 5383, 405, 9, 32, "Output",ExpressionUUID->"b016b509-822e-4f2b-88b1-ba5af65e18bf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[225374, 5397, 442, 9, 28, "Input",ExpressionUUID->"fd89999a-d63e-4cf8-a55b-25e6297a95e1"],
Cell[225819, 5408, 702, 16, 32, "Output",ExpressionUUID->"73cd1466-aa5a-43f2-aeb5-077db41f92d7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[226558, 5429, 446, 9, 28, "Input",ExpressionUUID->"d8168eb0-3a52-47d0-835a-c1f35294085d"],
Cell[227007, 5440, 726, 17, 32, "Output",ExpressionUUID->"ad106dd5-f577-46ea-8052-dcd993e47b35"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[227782, 5463, 219, 4, 44, "Subsubsection",ExpressionUUID->"4f951570-5ba2-4527-88bd-b08a73212f0e"],
Cell[CellGroupData[{
Cell[228026, 5471, 475, 9, 28, "Input",ExpressionUUID->"1bef53f6-6f3f-44b8-864c-d8d14b6bb438"],
Cell[228504, 5482, 436, 8, 32, "Output",ExpressionUUID->"a710c392-5ee3-4e5e-ae55-0fa798f4ce24"]
}, Open  ]],
Cell[CellGroupData[{
Cell[228977, 5495, 525, 10, 28, "Input",ExpressionUUID->"67c5975f-2eed-45c7-bb67-4aa1f4f3fe5d"],
Cell[229505, 5507, 784, 17, 32, "Output",ExpressionUUID->"7bb1277a-69c8-4579-9a66-d23385daf336"]
}, Open  ]],
Cell[CellGroupData[{
Cell[230326, 5529, 476, 9, 28, "Input",ExpressionUUID->"8f2a448c-a61e-45bf-8696-c37010183852"],
Cell[230805, 5540, 439, 8, 32, "Output",ExpressionUUID->"a0891890-dda9-4e99-8d26-1b196f9dcf8f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[231281, 5553, 477, 9, 28, "Input",ExpressionUUID->"d6b8c639-6fa6-483a-b834-2cb42e20d07d"],
Cell[231761, 5564, 762, 16, 32, "Output",ExpressionUUID->"cda882e4-fc07-4bb5-996c-87b5e7f17895"]
}, Open  ]],
Cell[CellGroupData[{
Cell[232560, 5585, 527, 11, 28, "Input",ExpressionUUID->"64f44b4f-5782-4d3a-92fb-8938bce3a1b7"],
Cell[233090, 5598, 483, 10, 32, "Output",ExpressionUUID->"7df5d7ff-f1e1-43eb-827e-6484c2cbb680"]
}, Open  ]],
Cell[CellGroupData[{
Cell[233610, 5613, 525, 11, 28, "Input",ExpressionUUID->"d2a2fab5-105d-4d87-b312-7b75b98b6bbd"],
Cell[234138, 5626, 864, 20, 32, "Output",ExpressionUUID->"6a96b171-fd06-4d5d-bb46-b3e87d3f42ba"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[235051, 5652, 218, 4, 44, "Subsubsection",ExpressionUUID->"251c96f3-3f60-4963-a160-820afe50638b"],
Cell[CellGroupData[{
Cell[235294, 5660, 524, 10, 28, "Input",ExpressionUUID->"7b002d70-2c0c-4e87-8ea3-37ccef368972"],
Cell[235821, 5672, 513, 10, 32, "Output",ExpressionUUID->"d352d85e-0a20-4fe5-85f8-93722e6a7d03"]
}, Open  ]],
Cell[CellGroupData[{
Cell[236371, 5687, 623, 11, 28, "Input",ExpressionUUID->"e175df56-e48f-4a6c-aced-2595c31853c2"],
Cell[236997, 5700, 864, 18, 32, "Output",ExpressionUUID->"83a4f5b4-944c-4f82-aec6-b25b2af80482"]
}, Open  ]],
Cell[CellGroupData[{
Cell[237898, 5723, 525, 10, 28, "Input",ExpressionUUID->"b38f2499-cdf9-4315-8a34-87ec8f5895fb"],
Cell[238426, 5735, 437, 8, 32, "Output",ExpressionUUID->"6210cf01-b783-454d-ab7e-1c5721c585ca"]
}, Open  ]],
Cell[CellGroupData[{
Cell[238900, 5748, 530, 10, 28, "Input",ExpressionUUID->"e666768f-b61a-49b0-ad03-b50d5fbaa616"],
Cell[239433, 5760, 762, 16, 32, "Output",ExpressionUUID->"6c791c94-130a-461a-8fe2-c5e4c41e801a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[240232, 5781, 485, 10, 28, "Input",ExpressionUUID->"85ce0c12-54a4-432a-bd43-34085bc41e02"],
Cell[240720, 5793, 425, 9, 32, "Output",ExpressionUUID->"04779bdc-520f-4d59-9779-7d57b4dc1113"]
}, Open  ]],
Cell[CellGroupData[{
Cell[241182, 5807, 488, 10, 28, "Input",ExpressionUUID->"62c7d708-f797-473b-8b8b-b37b7f91137c"],
Cell[241673, 5819, 765, 18, 32, "Output",ExpressionUUID->"92b957de-2b82-483f-8fa9-d9cc6cd43777"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[242487, 5843, 165, 3, 44, "Subsubsection",ExpressionUUID->"6f184ba9-8487-47a8-a763-24859047fcc7"],
Cell[CellGroupData[{
Cell[242677, 5850, 477, 9, 28, "Input",ExpressionUUID->"d71aa89d-9555-4cbf-bc22-53026f10d163"],
Cell[243157, 5861, 412, 8, 32, "Output",ExpressionUUID->"2b4096d1-e2ff-4de6-8a47-1cdf1be839b4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[243606, 5874, 476, 9, 28, "Input",ExpressionUUID->"5e0e0148-a055-48bb-93d6-31c16e3a1f44"],
Cell[244085, 5885, 1450, 32, 32, "Output",ExpressionUUID->"a4853a99-df12-41ad-8426-b194fde46a03"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[245584, 5923, 173, 3, 44, "Subsubsection",ExpressionUUID->"4a3c4d9b-3317-44bf-9c71-ec979a100418"],
Cell[CellGroupData[{
Cell[245782, 5930, 529, 12, 30, "Input",ExpressionUUID->"600b65f4-e173-46f7-8989-db69573a5aa3"],
Cell[246314, 5944, 1811, 40, 56, "Output",ExpressionUUID->"03c7e32b-b4f3-4b35-b91a-68c656243d0e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[248162, 5989, 714, 17, 28, "Input",ExpressionUUID->"769e2cf5-5ef4-4c7c-8524-6f096ceafe7a"],
Cell[248879, 6008, 1709, 39, 56, "Output",ExpressionUUID->"7da4822d-04e4-4680-bdc1-684ec0ea2b62"]
}, Open  ]],
Cell[CellGroupData[{
Cell[250625, 6052, 707, 17, 28, "Input",ExpressionUUID->"73f9e93f-a783-4f5b-8b6a-18f88f9e75e3"],
Cell[251335, 6071, 1785, 40, 56, "Output",ExpressionUUID->"8886eb47-4ec5-4db6-a9d0-7d773d754672"]
}, Open  ]],
Cell[CellGroupData[{
Cell[253157, 6116, 766, 19, 34, "Input",ExpressionUUID->"e79bce4f-2105-41af-84bb-3481ea9d6103"],
Cell[253926, 6137, 1747, 40, 56, "Output",ExpressionUUID->"b8081898-a366-444e-86b9-f239585c6768"]
}, Open  ]],
Cell[CellGroupData[{
Cell[255710, 6182, 759, 19, 28, "Input",ExpressionUUID->"40899ff8-4f04-493d-a64e-9b90b41372e7"],
Cell[256472, 6203, 1785, 40, 56, "Output",ExpressionUUID->"b3154660-dad5-4b97-bc87-f17e5957599c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[258294, 6248, 1066, 27, 28, "Input",ExpressionUUID->"fa4e07de-35ff-4e17-b69f-44abc642b5ca"],
Cell[259363, 6277, 2521, 57, 56, "Output",ExpressionUUID->"cf4939a7-ba3d-4b3c-b828-21e82375bc64"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[261945, 6341, 182, 3, 37, "Subsection",ExpressionUUID->"fb9bef28-f62d-4b5e-a7ee-6cd7bc118aa1"],
Cell[262130, 6346, 1213, 35, 48, "Input",ExpressionUUID->"2c56949f-5c3d-4926-ad51-9b378b338d1d"],
Cell[CellGroupData[{
Cell[263368, 6385, 3659, 79, 90, "Input",ExpressionUUID->"0916a85f-1a94-4e73-8404-4e766992d4f9"],
Cell[267030, 6466, 2209, 48, 56, "Output",ExpressionUUID->"be198d24-38a7-4b2a-acfe-acb6b5e75273"]
}, Open  ]],
Cell[CellGroupData[{
Cell[269276, 6519, 2275, 55, 48, "Input",ExpressionUUID->"d951df46-3cc5-42d2-b521-b01f666824da"],
Cell[271554, 6576, 2344, 49, 56, "Output",ExpressionUUID->"d76632cd-8522-4445-b9a0-cf3a43f4fee7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[273935, 6630, 2248, 55, 48, "Input",ExpressionUUID->"1fa7e1b1-5f4c-4486-acee-f7f45fa96327"],
Cell[276186, 6687, 2315, 49, 56, "Output",ExpressionUUID->"15702290-ab6a-490a-bd89-c0f211b3b7ff"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[278550, 6742, 156, 3, 37, "Subsection",ExpressionUUID->"156dc702-72f2-4233-8f6a-5bc1948b0e64"],
Cell[278709, 6747, 187, 3, 28, "Input",ExpressionUUID->"256d8cc9-b4db-497e-a01a-5e1dd490eba7"],
Cell[278899, 6752, 279, 6, 28, "Input",ExpressionUUID->"b15787af-aca2-4b4c-b8e9-a932b1d3b4e6"],
Cell[279181, 6760, 215, 4, 28, "Input",ExpressionUUID->"c1668be0-9fd1-4929-89bd-a17394e4c908"],
Cell[CellGroupData[{
Cell[279421, 6768, 1203, 35, 67, "Input",ExpressionUUID->"8c47f618-aa87-4290-bc5c-390762ba5729"],
Cell[280627, 6805, 9143, 237, 90, "Output",ExpressionUUID->"9a2171e5-b02c-4f33-9580-ce2893e7a15b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[289807, 7047, 589, 16, 28, "Input",ExpressionUUID->"573876a3-4a3a-4f4e-802a-d6708c116a7a"],
Cell[290399, 7065, 1197, 29, 32, "Output",ExpressionUUID->"1e7a68c8-2079-4c26-86d8-e331537393ba"]
}, Open  ]],
Cell[291611, 7097, 504, 12, 48, "Input",ExpressionUUID->"01670609-9628-46b0-aec2-755904b10b73"],
Cell[CellGroupData[{
Cell[292140, 7113, 3758, 94, 48, "Input",ExpressionUUID->"9c6b8fe6-a7c1-4631-bff3-5ead20011d1e"],
Cell[295901, 7209, 1330, 32, 32, "Output",ExpressionUUID->"ff72dea1-bbfe-4fb1-9714-817f23d5ab92"]
}, Open  ]],
Cell[297246, 7244, 523, 13, 48, "Input",ExpressionUUID->"c678ae43-d625-48e6-8624-9f35d0bffc66"],
Cell[297772, 7259, 9022, 220, 241, "Input",ExpressionUUID->"ef565b54-226b-429c-b07a-2cb067f1522e"],
Cell[CellGroupData[{
Cell[306819, 7483, 219, 4, 28, "Input",ExpressionUUID->"7725d7c4-0058-4788-9d70-9c24574a6f3f"],
Cell[307041, 7489, 203, 4, 32, "Output",ExpressionUUID->"9348626f-e007-4b58-b6a1-2f173cef662e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[307281, 7498, 2362, 59, 54, "Input",ExpressionUUID->"905605ff-1461-442b-a209-de0fdbfb07d2"],
Cell[309646, 7559, 6872, 156, 99, "Output",ExpressionUUID->"41987327-575a-4705-a689-5417888e58bc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[316555, 7720, 2339, 59, 54, "Input",ExpressionUUID->"224c7179-d472-4f27-95f7-80b6f1fcde49"],
Cell[318897, 7781, 6851, 156, 99, "Output",ExpressionUUID->"66db0fb2-9e2a-4dd5-9bf7-3895ed122066"]
}, Open  ]],
Cell[325763, 7940, 827, 17, 86, "Input",ExpressionUUID->"f880c812-6dc9-44ae-9c40-54bcbfbb309f"],
Cell[326593, 7959, 403, 11, 28, "Input",ExpressionUUID->"3ed7bbfd-7d87-499d-a017-b9f28ce31774"],
Cell[CellGroupData[{
Cell[327021, 7974, 2565, 63, 73, "Input",ExpressionUUID->"956bf133-9a63-457b-bd0a-fb89c561c3ed"],
Cell[329589, 8039, 243, 5, 32, "Output",ExpressionUUID->"fb1afc4e-12f6-4d25-982d-ba1601f97383"]
}, Open  ]],
Cell[CellGroupData[{
Cell[329869, 8049, 2543, 63, 73, "Input",ExpressionUUID->"d3c69e87-a625-47c0-8175-9bd4a6aa286c"],
Cell[332415, 8114, 187, 3, 32, "Output",ExpressionUUID->"06df4d53-413b-4c7f-b012-4a167640a133"]
}, Open  ]],
Cell[332617, 8120, 454, 11, 28, "Input",ExpressionUUID->"ec6019f3-af70-4650-870a-4bfb353f3211"],
Cell[CellGroupData[{
Cell[333096, 8135, 2591, 63, 73, "Input",ExpressionUUID->"efa2d832-b3e3-4190-9206-dddaf0612b27"],
Cell[335690, 8200, 268, 5, 32, "Output",ExpressionUUID->"a06190c0-6b5f-4577-abbe-6bc594b27aea"]
}, Open  ]],
Cell[CellGroupData[{
Cell[335995, 8210, 2572, 64, 78, "Input",ExpressionUUID->"f223d375-a940-40ca-965c-7d41ae256608"],
Cell[338570, 8276, 215, 4, 32, "Output",ExpressionUUID->"26b6d206-4b7d-4004-8c46-f78fe0fd731d"]
}, Open  ]],
Cell[338800, 8283, 393, 8, 48, "Input",ExpressionUUID->"d159b5d2-110f-4a01-bd05-f55d3d1b6259"]
}, Closed]],
Cell[CellGroupData[{
Cell[339230, 8296, 221, 4, 37, "Subsection",ExpressionUUID->"9aec7acf-fa32-4847-b205-cce18bf563e2"],
Cell[CellGroupData[{
Cell[339476, 8304, 1208, 30, 34, "Input",ExpressionUUID->"103c83cd-b78e-407c-9156-1ccd287c20e4"],
Cell[340687, 8336, 1196, 31, 36, "Output",ExpressionUUID->"312145da-309c-42f8-8c1b-6a65b9487089"]
}, Open  ]],
Cell[341898, 8370, 305, 6, 28, "Input",ExpressionUUID->"b003e034-0194-4f5c-9daa-7e812614290d"],
Cell[CellGroupData[{
Cell[342228, 8380, 1880, 47, 34, "Input",ExpressionUUID->"468094c1-819b-45ed-89ff-84ce7554cfda"],
Cell[344111, 8429, 1776, 47, 36, "Output",ExpressionUUID->"056057f3-4ce0-4fcb-a572-8695a91c3963"]
}, Open  ]],
Cell[345902, 8479, 330, 7, 28, "Input",ExpressionUUID->"bee66237-b52c-4913-84ff-d08bb810eca2"],
Cell[CellGroupData[{
Cell[346257, 8490, 157, 3, 44, "Subsubsection",ExpressionUUID->"8994a5cf-289d-47ae-a7aa-46939e1503e0"],
Cell[CellGroupData[{
Cell[346439, 8497, 480, 9, 28, "Input",ExpressionUUID->"f70ccb1c-81bb-4d60-88de-d9506522744c"],
Cell[346922, 8508, 493, 10, 32, "Output",ExpressionUUID->"cf237b61-b67e-4934-87f6-f7d2acd8ae8a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[347452, 8523, 478, 9, 28, "Input",ExpressionUUID->"d897b425-be07-408a-8ed7-dfe8a61f246e"],
Cell[347933, 8534, 464, 9, 32, "Output",ExpressionUUID->"242f6404-7bc7-4b9c-bb1b-99b434502fe4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[348434, 8548, 534, 10, 28, "Input",ExpressionUUID->"edecdf92-0627-4777-ac4a-7d5599152dd1"],
Cell[348971, 8560, 847, 18, 32, "Output",ExpressionUUID->"e2718f32-2050-437e-a56d-df1be8593adf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[349855, 8583, 530, 10, 28, "Input",ExpressionUUID->"daaae3be-a1d2-4ac6-b11d-194584ac0d8d"],
Cell[350388, 8595, 823, 17, 32, "Output",ExpressionUUID->"b6cf71b6-fd2b-4cf6-848e-ff232860bea7"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[351260, 8618, 160, 3, 36, "Subsubsection",ExpressionUUID->"0337dbcf-93ab-45a6-a863-07faf887d50b"],
Cell[CellGroupData[{
Cell[351445, 8625, 444, 9, 28, "Input",ExpressionUUID->"a31f0336-0aaa-401e-9deb-0a798007acb7"],
Cell[351892, 8636, 433, 9, 32, "Output",ExpressionUUID->"d55a749d-f1a4-4cfe-b7af-e071bfbcba53"]
}, Open  ]],
Cell[CellGroupData[{
Cell[352362, 8650, 442, 9, 28, "Input",ExpressionUUID->"7fb13f5e-7fb3-4fa4-a5e9-5a0e60b02c1f"],
Cell[352807, 8661, 454, 10, 32, "Output",ExpressionUUID->"1c368ff3-338f-41af-b3af-c876d3d078d2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[353298, 8676, 442, 9, 28, "Input",ExpressionUUID->"4d2fa448-41ab-4e3a-85d4-2c0933981fac"],
Cell[353743, 8687, 753, 17, 32, "Output",ExpressionUUID->"f5e516c5-ec30-4eef-9e32-862c6ade72b3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[354533, 8709, 446, 9, 28, "Input",ExpressionUUID->"ff3681a3-8fc2-4088-b681-9981a61eb46c"],
Cell[354982, 8720, 776, 18, 32, "Output",ExpressionUUID->"5aac1f14-9fe5-400b-ba84-de94f075c619"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[355807, 8744, 219, 4, 36, "Subsubsection",ExpressionUUID->"fedd52a8-741b-4b95-932d-3f06e9f944dc"],
Cell[CellGroupData[{
Cell[356051, 8752, 475, 9, 28, "Input",ExpressionUUID->"19151209-b398-406b-9a48-7ed987fb8fe1"],
Cell[356529, 8763, 536, 10, 32, "Output",ExpressionUUID->"08bedfb7-9cf0-4ad8-a57e-78c26f033477"]
}, Open  ]],
Cell[CellGroupData[{
Cell[357102, 8778, 525, 10, 28, "Input",ExpressionUUID->"9262be44-eac3-4487-81ff-a928fac0256d"],
Cell[357630, 8790, 912, 19, 32, "Output",ExpressionUUID->"943e0028-0028-4036-9419-51386a9a19bf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[358579, 8814, 476, 9, 28, "Input",ExpressionUUID->"8b2ccaf0-9062-4dae-9d13-e9f6672f8182"],
Cell[359058, 8825, 507, 9, 32, "Output",ExpressionUUID->"007069b5-6c16-4ecc-b275-c72d3145d7eb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[359602, 8839, 477, 9, 28, "Input",ExpressionUUID->"039507ce-e8aa-49c0-851d-75a9b249d28a"],
Cell[360082, 8850, 835, 17, 32, "Output",ExpressionUUID->"d13e5b24-6770-455f-b634-c72aace777c4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[360954, 8872, 527, 11, 28, "Input",ExpressionUUID->"fbc99ad5-5b06-47a7-b43f-1a73a6e4b8b5"],
Cell[361484, 8885, 556, 11, 32, "Output",ExpressionUUID->"99638bc9-aac8-4f6a-9673-7e1b083f546d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[362077, 8901, 525, 11, 28, "Input",ExpressionUUID->"feb7f886-615e-4826-b7c6-bcd93314e047"],
Cell[362605, 8914, 935, 21, 32, "Output",ExpressionUUID->"efc12d42-1898-45b0-a4c2-2f0b3af60ee4"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[363589, 8941, 218, 4, 36, "Subsubsection",ExpressionUUID->"b6dcd010-e466-437e-8c35-6dba312f5ac6"],
Cell[CellGroupData[{
Cell[363832, 8949, 524, 10, 28, "Input",ExpressionUUID->"d22d256c-afa2-4afc-8d21-7e3ffc903c18"],
Cell[364359, 8961, 563, 11, 32, "Output",ExpressionUUID->"e108e7d0-9e2c-4dbc-a4ba-52b759a24055"]
}, Open  ]],
Cell[CellGroupData[{
Cell[364959, 8977, 623, 11, 28, "Input",ExpressionUUID->"fc4eee4f-0490-4470-a84d-7fdbc9dfd97d"],
Cell[365585, 8990, 914, 19, 32, "Output",ExpressionUUID->"e06da208-9bba-4fde-919c-e56dd572db41"]
}, Open  ]],
Cell[CellGroupData[{
Cell[366536, 9014, 525, 10, 28, "Input",ExpressionUUID->"a68aa795-fd96-48e3-8a28-d900f8e48d56"],
Cell[367064, 9026, 488, 9, 32, "Output",ExpressionUUID->"7aac3945-30b7-41a6-a9f6-70deef115caa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[367589, 9040, 530, 10, 28, "Input",ExpressionUUID->"b5940af9-58f8-477a-86b4-a919142eb327"],
Cell[368122, 9052, 809, 17, 32, "Output",ExpressionUUID->"a24fcbba-9aed-481e-9248-85f37a5fae9e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[368968, 9074, 485, 10, 28, "Input",ExpressionUUID->"84b52462-464f-41c4-9528-8fe5c2474b2a"],
Cell[369456, 9086, 474, 10, 32, "Output",ExpressionUUID->"0607bff0-d8b3-42dd-a2a1-24ede2e3c850"]
}, Open  ]],
Cell[CellGroupData[{
Cell[369967, 9101, 488, 10, 28, "Input",ExpressionUUID->"79d7055e-e813-4a21-820a-c532df214f09"],
Cell[370458, 9113, 814, 19, 32, "Output",ExpressionUUID->"3db6782c-7d02-4508-ba88-cb09b8927f0b"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[371321, 9138, 165, 3, 36, "Subsubsection",ExpressionUUID->"e2ef3fc6-8845-47d0-9af3-f731b76040b3"],
Cell[CellGroupData[{
Cell[371511, 9145, 477, 9, 28, "Input",ExpressionUUID->"9d74c30a-c001-4bc1-9dfe-aa4df2e96254"],
Cell[371991, 9156, 459, 9, 32, "Output",ExpressionUUID->"db35b864-8444-41a3-8930-2c3c48ff2316"]
}, Open  ]],
Cell[CellGroupData[{
Cell[372487, 9170, 476, 9, 28, "Input",ExpressionUUID->"a706f324-ca4d-4067-8f80-3b2f791c40c8"],
Cell[372966, 9181, 1450, 32, 32, "Output",ExpressionUUID->"bcf59044-36e4-48bd-9a89-51a7e28b06eb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[374453, 9218, 408, 8, 28, "Input",ExpressionUUID->"6e6547b4-7b60-43f3-aa44-272849aa2823"],
Cell[374864, 9228, 1405, 31, 32, "Output",ExpressionUUID->"03825c59-f07b-46e4-824f-b734f06b42da"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[376318, 9265, 173, 3, 36, "Subsubsection",ExpressionUUID->"e16af162-a18f-4aab-950a-56969467069a"],
Cell[CellGroupData[{
Cell[376516, 9272, 529, 12, 30, "Input",ExpressionUUID->"f0dc91b6-25b0-48fa-8a77-4fea14761fd3"],
Cell[377048, 9286, 1863, 41, 56, "Output",ExpressionUUID->"1dacbf30-b536-47e6-92a6-33e4011a405e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[378948, 9332, 714, 17, 28, "Input",ExpressionUUID->"58d54392-38d4-4731-89cd-60aabfe3c688"],
Cell[379665, 9351, 1760, 40, 56, "Output",ExpressionUUID->"8dcef396-ec9c-4494-8e5a-52c02b10df56"]
}, Open  ]],
Cell[CellGroupData[{
Cell[381462, 9396, 707, 17, 28, "Input",ExpressionUUID->"4510bae9-ba88-4da6-a390-766b60fd00e4"],
Cell[382172, 9415, 1832, 41, 56, "Output",ExpressionUUID->"5e04de3e-a655-4ce8-b473-aa85a4a42d31"]
}, Open  ]],
Cell[CellGroupData[{
Cell[384041, 9461, 766, 19, 34, "Input",ExpressionUUID->"663f1e4c-80b3-45b6-86d0-e9f6a0985e7a"],
Cell[384810, 9482, 1793, 41, 56, "Output",ExpressionUUID->"51dd4128-40d6-48d6-b2e7-d3e45e0b8c25"]
}, Open  ]],
Cell[CellGroupData[{
Cell[386640, 9528, 759, 19, 28, "Input",ExpressionUUID->"f625becd-615e-4b3e-9718-378508c5b2bf"],
Cell[387402, 9549, 1836, 41, 56, "Output",ExpressionUUID->"fdaf33b1-1f32-42d6-9f97-68c891eb719a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[389275, 9595, 1066, 27, 28, "Input",ExpressionUUID->"4ddeb916-5c9a-4405-9afc-b825a6626cfd"],
Cell[390344, 9624, 2573, 58, 56, "Output",ExpressionUUID->"a0b5df47-1165-450b-8ca2-730f39f08b34"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[392966, 9688, 166, 3, 36, "Subsubsection",ExpressionUUID->"b16ea7a0-adb7-4321-b3c0-7ce115b6ed4a"],
Cell[393135, 9693, 263, 7, 28, "Input",ExpressionUUID->"97818e72-4254-4869-a9c7-87aab2eccace"],
Cell[CellGroupData[{
Cell[393423, 9704, 1870, 46, 34, "Input",ExpressionUUID->"74a5e26a-539f-4f81-8cb9-a74a3792ca39"],
Cell[395296, 9752, 1738, 45, 36, "Output",ExpressionUUID->"ac38dc84-d8c1-4d94-8604-76dd93b0afdd"]
}, Open  ]],
Cell[397049, 9800, 379, 7, 28, "Input",ExpressionUUID->"1470780f-96a1-4c43-94af-1371bee6af75"]
}, Closed]],
Cell[CellGroupData[{
Cell[397465, 9812, 157, 3, 36, "Subsubsection",ExpressionUUID->"0f03a802-a37f-4789-83e7-78c2438ce9f1"],
Cell[CellGroupData[{
Cell[397647, 9819, 534, 10, 28, "Input",ExpressionUUID->"fde28cf3-a011-4998-8ec9-ef42759d0fbe"],
Cell[398184, 9831, 842, 17, 32, "Output",ExpressionUUID->"eb0743f6-e8b8-4c8c-af5a-690c9b611e2b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[399063, 9853, 530, 10, 28, "Input",ExpressionUUID->"9359d288-7c96-452e-b3ca-cc867b975db7"],
Cell[399596, 9865, 818, 16, 32, "Output",ExpressionUUID->"f7547648-d4f5-4e91-9d2c-5ac5befa7405"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[400463, 9887, 160, 3, 36, "Subsubsection",ExpressionUUID->"54653ef5-40ab-423e-8143-6cd58494c103"],
Cell[CellGroupData[{
Cell[400648, 9894, 442, 9, 28, "Input",ExpressionUUID->"488bd412-8317-41c9-865d-07d1bcb01f83"],
Cell[401093, 9905, 746, 16, 32, "Output",ExpressionUUID->"933b1c42-6bb8-4f2b-abb1-c8e990a5c9ae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[401876, 9926, 446, 9, 28, "Input",ExpressionUUID->"7a30de50-ad03-45ca-aaa5-eb9e6ed6a679"],
Cell[402325, 9937, 771, 17, 32, "Output",ExpressionUUID->"ad2640b0-c57e-472b-9abe-be08ba4e1915"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[403145, 9960, 219, 4, 36, "Subsubsection",ExpressionUUID->"b9adf893-a65f-424c-a71b-bccc95cdd666"],
Cell[CellGroupData[{
Cell[403389, 9968, 525, 10, 28, "Input",ExpressionUUID->"46a1f76f-fff8-4942-8f69-bdbb0bb8e5db"],
Cell[403917, 9980, 907, 18, 32, "Output",ExpressionUUID->"ce7563bf-4bdc-4458-a384-73c1f510a684"]
}, Open  ]],
Cell[CellGroupData[{
Cell[404861, 10003, 477, 9, 28, "Input",ExpressionUUID->"96865545-ef28-4d58-b87b-9f786f0ac19e"],
Cell[405341, 10014, 831, 17, 32, "Output",ExpressionUUID->"9bdeaa2b-5174-4d94-a937-d935ba4b7023"]
}, Open  ]],
Cell[CellGroupData[{
Cell[406209, 10036, 525, 11, 28, "Input",ExpressionUUID->"4637daaf-a675-4251-a6de-a271b3f0fe7a"],
Cell[406737, 10049, 931, 21, 32, "Output",ExpressionUUID->"68cdc766-fff9-4c5e-b69c-4c90f3c003e9"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[407717, 10076, 218, 4, 36, "Subsubsection",ExpressionUUID->"c112bc90-4e00-4a1b-b421-db827079b9a0"],
Cell[CellGroupData[{
Cell[407960, 10084, 623, 11, 28, "Input",ExpressionUUID->"bdeec0c1-2945-4678-9486-42ae06d43fda"],
Cell[408586, 10097, 906, 18, 32, "Output",ExpressionUUID->"8df52f2d-1a66-49d8-8589-256d6a359263"]
}, Open  ]],
Cell[CellGroupData[{
Cell[409529, 10120, 530, 10, 28, "Input",ExpressionUUID->"8a3bbccb-f7e7-42a5-967b-bc528c07fe31"],
Cell[410062, 10132, 804, 16, 32, "Output",ExpressionUUID->"acdab2d0-e7ed-43a2-855e-78416e4dd391"]
}, Open  ]],
Cell[CellGroupData[{
Cell[410903, 10153, 488, 10, 28, "Input",ExpressionUUID->"d0d284f4-b1c7-41e3-9b3a-8a1be85e5672"],
Cell[411394, 10165, 808, 18, 32, "Output",ExpressionUUID->"e015c807-89b0-44a6-a637-45e7ebd09fd8"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[412251, 10189, 165, 3, 36, "Subsubsection",ExpressionUUID->"0f397946-ec81-4f2c-83cd-6d984718766e"],
Cell[CellGroupData[{
Cell[412441, 10196, 408, 8, 28, "Input",ExpressionUUID->"8bc24fa8-3bd9-4320-9586-864957cc9e2c"],
Cell[412852, 10206, 1347, 29, 32, "Output",ExpressionUUID->"648c185b-bdce-4781-b575-034b4eaae3b0"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[414248, 10241, 173, 3, 36, "Subsubsection",ExpressionUUID->"36b59e0e-0712-485e-8355-c2441c8f05f7"],
Cell[CellGroupData[{
Cell[414446, 10248, 529, 12, 30, "Input",ExpressionUUID->"3f9a3107-1ad0-49bc-a109-da0557940c61"],
Cell[414978, 10262, 1863, 41, 56, "Output",ExpressionUUID->"44885802-6690-4115-9230-e545315429e5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[416878, 10308, 1086, 27, 28, "Input",ExpressionUUID->"70e4f3d2-d61d-4dd4-9607-a7a00c08b063"],
Cell[417967, 10337, 2531, 56, 56, "Output",ExpressionUUID->"64932cc6-024d-48dd-ad42-6578416024ec"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[420547, 10399, 231, 4, 36, "Subsubsection",ExpressionUUID->"7a68bfed-f239-4de1-8b75-4b67010eb4dd"],
Cell[CellGroupData[{
Cell[420803, 10407, 1369, 35, 34, "Input",ExpressionUUID->"88117158-326d-4874-9dec-23c67e6279aa"],
Cell[422175, 10444, 1302, 33, 36, "Output",ExpressionUUID->"b4c1a5db-4df8-4898-983f-e5c213476bc3"]
}, Open  ]],
Cell[423492, 10480, 335, 7, 28, "Input",ExpressionUUID->"a098c6cb-3fa2-4108-8750-fd1df3d4822b"],
Cell[CellGroupData[{
Cell[423852, 10491, 2057, 52, 34, "Input",ExpressionUUID->"acc59b5a-5fac-4d2a-ba30-ce6645f437b2"],
Cell[425912, 10545, 1885, 49, 36, "Output",ExpressionUUID->"9cfb1815-5d31-4187-bbbf-564a8fc6dcbe"]
}, Open  ]],
Cell[427812, 10597, 379, 7, 28, "Input",ExpressionUUID->"28feceae-2a0d-45ec-9334-365b52bec383"]
}, Closed]],
Cell[CellGroupData[{
Cell[428228, 10609, 157, 3, 36, "Subsubsection",ExpressionUUID->"cff4619d-8a12-4a07-ba75-ff6e7a9fa876"],
Cell[CellGroupData[{
Cell[428410, 10616, 480, 9, 28, "Input",ExpressionUUID->"b8dd8160-602f-47ac-8366-adbc2931152d"],
Cell[428893, 10627, 512, 10, 32, "Output",ExpressionUUID->"704d4d55-c255-4320-b81b-2267b43ab06d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[429442, 10642, 478, 9, 28, "Input",ExpressionUUID->"69a82831-d2b9-4ca9-921e-bf0767b05868"],
Cell[429923, 10653, 482, 9, 32, "Output",ExpressionUUID->"0224d57a-0a54-4047-a8be-87ec40205916"]
}, Open  ]],
Cell[CellGroupData[{
Cell[430442, 10667, 534, 10, 28, "Input",ExpressionUUID->"38494be4-c0a9-4ea7-a205-864dfeead489"],
Cell[430979, 10679, 864, 18, 32, "Output",ExpressionUUID->"e6c433f9-467e-4e2a-a2ce-fe824aeaf539"]
}, Open  ]],
Cell[CellGroupData[{
Cell[431880, 10702, 530, 10, 28, "Input",ExpressionUUID->"ee17a68e-0560-4f58-ba65-f114251832e9"],
Cell[432413, 10714, 839, 17, 32, "Output",ExpressionUUID->"43dbf391-553d-4849-a3e6-61ce82d021e6"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[433301, 10737, 160, 3, 36, "Subsubsection",ExpressionUUID->"cb5a8270-a076-49f4-aa0b-6b6d880c37b1"],
Cell[CellGroupData[{
Cell[433486, 10744, 444, 9, 28, "Input",ExpressionUUID->"4d3dea7e-48f5-494e-9fb3-fa4d727c9f02"],
Cell[433933, 10755, 485, 9, 32, "Output",ExpressionUUID->"06ea403c-9ab9-43ab-9386-775ce546a1e3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[434455, 10769, 442, 9, 28, "Input",ExpressionUUID->"30e774b7-dd3b-4178-ad14-2fb748931756"],
Cell[434900, 10780, 507, 10, 32, "Output",ExpressionUUID->"4eb53729-5920-4c2f-9f15-99bde9dd4b08"]
}, Open  ]],
Cell[CellGroupData[{
Cell[435444, 10795, 442, 9, 28, "Input",ExpressionUUID->"b49dcb1e-358e-4ef9-85c7-2a8fbbe88385"],
Cell[435889, 10806, 805, 17, 32, "Output",ExpressionUUID->"10e228dd-35d9-44df-b843-d97973809c51"]
}, Open  ]],
Cell[CellGroupData[{
Cell[436731, 10828, 446, 9, 28, "Input",ExpressionUUID->"47799dd1-e58b-4e92-b1aa-a5d6b8ac14fc"],
Cell[437180, 10839, 827, 18, 32, "Output",ExpressionUUID->"1dc7d46d-eb1e-40f8-8049-23fce055f66f"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[438056, 10863, 219, 4, 36, "Subsubsection",ExpressionUUID->"6460402a-1319-4e89-ad34-9112e2dc8191"],
Cell[CellGroupData[{
Cell[438300, 10871, 475, 9, 28, "Input",ExpressionUUID->"d2afaed2-7844-4998-9cd3-065c0e3679a5"],
Cell[438778, 10882, 592, 12, 32, "Output",ExpressionUUID->"8b6d822f-c0ed-415c-a658-f33a61140477"]
}, Open  ]],
Cell[CellGroupData[{
Cell[439407, 10899, 525, 10, 28, "Input",ExpressionUUID->"79bb6b38-a2f3-47fb-a592-c1ada0fdd993"],
Cell[439935, 10911, 944, 20, 32, "Output",ExpressionUUID->"3dc987f9-155c-40c7-acf5-32137f8ae228"]
}, Open  ]],
Cell[CellGroupData[{
Cell[440916, 10936, 476, 9, 28, "Input",ExpressionUUID->"f9394d02-4d0e-4ed8-b477-bf2bbb2f35e0"],
Cell[441395, 10947, 543, 11, 32, "Output",ExpressionUUID->"8c375f12-18cd-485d-929f-728fe2686af9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[441975, 10963, 477, 9, 28, "Input",ExpressionUUID->"434d28a7-f422-4c9e-86da-bcff487361ff"],
Cell[442455, 10974, 870, 19, 32, "Output",ExpressionUUID->"fa56a3b3-78a7-4aa0-9908-82609697e994"]
}, Open  ]],
Cell[CellGroupData[{
Cell[443362, 10998, 527, 11, 28, "Input",ExpressionUUID->"808ed795-bc64-40b0-a422-86664f49615c"],
Cell[443892, 11011, 597, 12, 32, "Output",ExpressionUUID->"bea9eb65-6017-4142-b4ff-875d5c1723c3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[444526, 11028, 525, 11, 28, "Input",ExpressionUUID->"fa027e7c-c8f3-481d-a151-0e62d0cd71f9"],
Cell[445054, 11041, 949, 21, 32, "Output",ExpressionUUID->"b9e0fc5a-c3bb-44de-97c3-5a0f408abd48"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[446052, 11068, 218, 4, 36, "Subsubsection",ExpressionUUID->"c2b86f4a-2fc6-43ee-8d4d-7639d3e54e8b"],
Cell[CellGroupData[{
Cell[446295, 11076, 524, 10, 28, "Input",ExpressionUUID->"818614c8-009a-4e79-9a7a-795b1aef6aff"],
Cell[446822, 11088, 658, 13, 32, "Output",ExpressionUUID->"51d70d58-9336-4e8c-8440-a2204203a027"]
}, Open  ]],
Cell[CellGroupData[{
Cell[447517, 11106, 623, 11, 28, "Input",ExpressionUUID->"e90709cf-e304-4981-b454-425c2f830d57"],
Cell[448143, 11119, 1034, 23, 32, "Output",ExpressionUUID->"549f7915-9d9f-4e61-91cc-674fbaad4295"]
}, Open  ]],
Cell[CellGroupData[{
Cell[449214, 11147, 525, 10, 28, "Input",ExpressionUUID->"82f5c9f7-c66c-4df2-94ff-85c340ac1ae0"],
Cell[449742, 11159, 581, 12, 32, "Output",ExpressionUUID->"ae98a42f-3ae1-4b88-9a98-780d969914b1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[450360, 11176, 530, 10, 28, "Input",ExpressionUUID->"b36a2e58-fb02-49e4-91e9-ae449dc0c038"],
Cell[450893, 11188, 907, 20, 32, "Output",ExpressionUUID->"d1d30752-0535-4775-9138-fae7fb8696df"]
}, Open  ]],
Cell[CellGroupData[{
Cell[451837, 11213, 485, 10, 28, "Input",ExpressionUUID->"f5d841b4-4fd6-4ca9-98a2-061c10da1c52"],
Cell[452325, 11225, 548, 11, 32, "Output",ExpressionUUID->"c2e7959c-bb64-4a4c-97ac-17aadb177f28"]
}, Open  ]],
Cell[CellGroupData[{
Cell[452910, 11241, 488, 10, 28, "Input",ExpressionUUID->"1804f1df-c9ec-42d1-be15-4dc0587e5e43"],
Cell[453401, 11253, 889, 20, 32, "Output",ExpressionUUID->"c4e31506-14bb-44a6-8395-2f8c22e4573c"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[454339, 11279, 165, 3, 36, "Subsubsection",ExpressionUUID->"a640b0be-6519-4e7a-826e-cab5774d41bb"],
Cell[CellGroupData[{
Cell[454529, 11286, 477, 9, 28, "Input",ExpressionUUID->"19be47f4-d412-4cee-980d-945e16d64f5b"],
Cell[455009, 11297, 542, 11, 32, "Output",ExpressionUUID->"7bc974a2-3fb5-42b2-b858-c79cdf5e5ad2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[455588, 11313, 476, 9, 28, "Input",ExpressionUUID->"6aeda1ee-1572-4f7c-928a-d039ff6b31c7"],
Cell[456067, 11324, 1552, 37, 32, "Output",ExpressionUUID->"84a8311c-16f2-4ab8-b8e1-5d9eadbfda1a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[457656, 11366, 408, 8, 28, "Input",ExpressionUUID->"d0b174d9-fdf3-4ba5-96ae-f05a9ac6aedb"],
Cell[458067, 11376, 1553, 37, 32, "Output",ExpressionUUID->"bc2497d5-e61a-407c-bd9f-a66ec368eafc"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[459669, 11419, 173, 3, 36, "Subsubsection",ExpressionUUID->"2c6e396a-1793-437f-bdd8-e6308a68299f"],
Cell[CellGroupData[{
Cell[459867, 11426, 529, 12, 30, "Input",ExpressionUUID->"7e1b5186-1c85-4ebb-9a34-4bc895f87ec5"],
Cell[460399, 11440, 1885, 41, 56, "Output",ExpressionUUID->"8437ac92-9f78-42bd-9d72-3fb64e117974"]
}, Open  ]],
Cell[CellGroupData[{
Cell[462321, 11486, 885, 22, 34, "Input",ExpressionUUID->"c9ce71a8-79b8-4d33-9aee-cb2585830203"],
Cell[463209, 11510, 1860, 42, 56, "Output",ExpressionUUID->"7473c62f-b7c2-48b6-a1a7-293b7f80914c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[465106, 11557, 759, 19, 28, "Input",ExpressionUUID->"38e0157d-8a9a-4fee-b069-84f2f78dc9a1"],
Cell[465868, 11578, 1836, 41, 56, "Output",ExpressionUUID->"089aa89b-7772-4be1-8e07-9ad6422b4693"]
}, Open  ]],
Cell[CellGroupData[{
Cell[467741, 11624, 1066, 27, 28, "Input",ExpressionUUID->"d1cdbd57-5532-4d2d-8a0f-ba8680b20d77"],
Cell[468810, 11653, 2573, 58, 56, "Output",ExpressionUUID->"d26781b0-6ff2-47f9-9c6f-6420a20d9d15"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[471432, 11717, 279, 4, 36, "Subsubsection",ExpressionUUID->"b59d2331-cc7d-4ec3-8f37-8d65207efcbf"],
Cell[CellGroupData[{
Cell[471736, 11725, 1444, 37, 34, "Input",ExpressionUUID->"7ee686d7-29de-40fb-b711-30fff0877646"],
Cell[473183, 11764, 1351, 35, 36, "Output",ExpressionUUID->"c66a43ea-ea83-4124-ad35-1f4b2e686724"]
}, Open  ]],
Cell[474549, 11802, 389, 8, 28, "Input",ExpressionUUID->"8fc34850-5823-4796-b127-e1ef93af0b33"],
Cell[CellGroupData[{
Cell[474963, 11814, 2127, 53, 34, "Input",ExpressionUUID->"955a330b-6e01-4f8b-afd4-cc5665df94ec"],
Cell[477093, 11869, 1936, 51, 36, "Output",ExpressionUUID->"0d115d6b-2e14-4b00-a131-f2558a8a7461"]
}, Open  ]],
Cell[479044, 11923, 435, 9, 28, "Input",ExpressionUUID->"0d253cdb-e9ae-4cd0-b9e0-3689271c9c2d"]
}, Closed]],
Cell[CellGroupData[{
Cell[479516, 11937, 157, 3, 36, "Subsubsection",ExpressionUUID->"b7318a16-c4ba-4f2e-ac01-8b723887c33b"],
Cell[CellGroupData[{
Cell[479698, 11944, 484, 10, 28, "Input",ExpressionUUID->"5e1b1afa-de3c-4d91-a0a7-5238c53ef07e"],
Cell[480185, 11956, 563, 12, 32, "Output",ExpressionUUID->"2849e6eb-00aa-490c-97d1-46ca21509c66"]
}, Open  ]],
Cell[CellGroupData[{
Cell[480785, 11973, 482, 10, 28, "Input",ExpressionUUID->"25003584-f456-437e-a16c-86d444b720a2"],
Cell[481270, 11985, 557, 12, 32, "Output",ExpressionUUID->"d68c07b9-ca6e-476f-8262-bbe685cb0321"]
}, Open  ]],
Cell[CellGroupData[{
Cell[481864, 12002, 538, 11, 28, "Input",ExpressionUUID->"84e7431c-3861-42b9-8116-bb4026124ada"],
Cell[482405, 12015, 917, 21, 32, "Output",ExpressionUUID->"dcc4fdac-47cd-416b-8484-9cbfea357621"]
}, Open  ]],
Cell[CellGroupData[{
Cell[483359, 12041, 534, 11, 28, "Input",ExpressionUUID->"8967b8bf-f061-4c6d-bbf0-b651f0258a8e"],
Cell[483896, 12054, 917, 21, 32, "Output",ExpressionUUID->"289c9e6e-be22-42d5-85d2-3262979f8ef8"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[484862, 12081, 160, 3, 36, "Subsubsection",ExpressionUUID->"90724ebb-a5a7-41c8-a128-eb990ac9e1b8"],
Cell[CellGroupData[{
Cell[485047, 12088, 448, 10, 28, "Input",ExpressionUUID->"437d616b-5a58-4ee8-a414-5e91d60fc784"],
Cell[485498, 12100, 522, 11, 32, "Output",ExpressionUUID->"e32d3d06-eed6-465b-a0d7-70ab4391741c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[486057, 12116, 446, 10, 28, "Input",ExpressionUUID->"b8aaa9d3-16b7-43ec-bea3-0aa4018f21b6"],
Cell[486506, 12128, 522, 11, 32, "Output",ExpressionUUID->"a57207ff-4877-4b67-9db3-e07e6058bc6c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[487065, 12144, 446, 10, 28, "Input",ExpressionUUID->"319477f6-cd4d-491a-b077-bf95ae2527e8"],
Cell[487514, 12156, 846, 20, 32, "Output",ExpressionUUID->"c9fe4dd0-06ba-45ef-ad4d-f79a8f79362c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[488397, 12181, 450, 10, 28, "Input",ExpressionUUID->"bc1997c0-c5b9-4bb7-a36e-df01994a67f5"],
Cell[488850, 12193, 844, 20, 32, "Output",ExpressionUUID->"ecd33bcb-1197-4332-9184-3a875213f39a"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[489743, 12219, 219, 4, 36, "Subsubsection",ExpressionUUID->"105a0d1f-907a-4782-8511-e6d760f59dbf"],
Cell[CellGroupData[{
Cell[489987, 12227, 479, 10, 28, "Input",ExpressionUUID->"5a59a0c7-2028-4f02-aa8f-9a879807ad0e"],
Cell[490469, 12239, 622, 12, 32, "Output",ExpressionUUID->"93d470ae-afe1-4ae6-bcf1-a7516122b98e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[491128, 12256, 529, 11, 28, "Input",ExpressionUUID->"cfd65849-9a84-4371-994a-6adc42e1b391"],
Cell[491660, 12269, 1000, 22, 32, "Output",ExpressionUUID->"c93cd738-eac8-44b8-a0fb-73e66883c655"]
}, Open  ]],
Cell[CellGroupData[{
Cell[492697, 12296, 480, 10, 28, "Input",ExpressionUUID->"38de4e48-5bf9-4d21-89f5-d9acca4c122f"],
Cell[493180, 12308, 596, 12, 32, "Output",ExpressionUUID->"126d4455-fe93-405c-932b-baeea1550f85"]
}, Open  ]],
Cell[CellGroupData[{
Cell[493813, 12325, 481, 10, 28, "Input",ExpressionUUID->"9df131f5-7ae8-4a4b-9419-967be5c1bf05"],
Cell[494297, 12337, 923, 20, 32, "Output",ExpressionUUID->"e01a23d3-14c9-42b4-864c-bb3ec6ec1ba3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[495257, 12362, 531, 12, 28, "Input",ExpressionUUID->"1f4976f8-7a86-41ff-810d-25c9f96383b4"],
Cell[495791, 12376, 629, 13, 32, "Output",ExpressionUUID->"b98dc581-b712-43a2-921b-4a42c2b3d727"]
}, Open  ]],
Cell[CellGroupData[{
Cell[496457, 12394, 529, 12, 28, "Input",ExpressionUUID->"274369c3-0d1d-41aa-9ce5-5d134d17386a"],
Cell[496989, 12408, 1008, 23, 32, "Output",ExpressionUUID->"ec253355-5004-4245-b8d3-193c4c598135"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[498046, 12437, 218, 4, 36, "Subsubsection",ExpressionUUID->"c3782e84-8432-4444-9c91-a4536e95b4fd"],
Cell[CellGroupData[{
Cell[498289, 12445, 528, 11, 28, "Input",ExpressionUUID->"cadb0c34-8682-4149-b21b-e8fce316533e"],
Cell[498820, 12458, 677, 14, 32, "Output",ExpressionUUID->"121807a2-0f2c-4609-bb94-621867d00228"]
}, Open  ]],
Cell[CellGroupData[{
Cell[499534, 12477, 627, 12, 28, "Input",ExpressionUUID->"7e91b411-9a81-49c8-9c18-06a3c89f22f0"],
Cell[500164, 12491, 1048, 23, 32, "Output",ExpressionUUID->"682fabcf-cc50-47d9-b7a5-08085c4ddcd8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[501249, 12519, 529, 11, 28, "Input",ExpressionUUID->"eccacae5-291a-4c27-acd5-aa8cbedb4ec4"],
Cell[501781, 12532, 577, 12, 32, "Output",ExpressionUUID->"55fb6249-468b-4964-a13a-65864c415d2c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[502395, 12549, 534, 11, 28, "Input",ExpressionUUID->"6df30190-52a1-47e8-af46-f0e20605a074"],
Cell[502932, 12562, 899, 20, 32, "Output",ExpressionUUID->"d70724ce-e2e6-4c58-9517-26f99a76cdcc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[503868, 12587, 489, 11, 28, "Input",ExpressionUUID->"2252d356-b6d9-4fd1-8551-0b83b44f5b37"],
Cell[504360, 12600, 544, 11, 32, "Output",ExpressionUUID->"0b20e322-7970-4db4-8058-ea2fba696156"]
}, Open  ]],
Cell[CellGroupData[{
Cell[504941, 12616, 492, 11, 28, "Input",ExpressionUUID->"091ddaf3-a291-44a7-bdcd-d1af35fdd94a"],
Cell[505436, 12629, 886, 20, 32, "Output",ExpressionUUID->"0586d1f5-919a-4ecb-af00-2e46e0b81efa"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[506371, 12655, 165, 3, 36, "Subsubsection",ExpressionUUID->"84f224ed-1571-40ea-acb4-4f8e7fb1fc4a"],
Cell[CellGroupData[{
Cell[506561, 12662, 481, 10, 28, "Input",ExpressionUUID->"2dc3b8ba-0d36-4ae7-bd8a-0df8f0646dcb"],
Cell[507045, 12674, 565, 11, 32, "Output",ExpressionUUID->"0ffa9396-746b-4db0-990f-0a67b6b33f4a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[507647, 12690, 480, 10, 28, "Input",ExpressionUUID->"58d32128-873c-4fcd-94b3-ce0c9a9594db"],
Cell[508130, 12702, 1611, 37, 32, "Output",ExpressionUUID->"c9988141-35ef-419a-8924-863149dc5431"]
}, Open  ]],
Cell[CellGroupData[{
Cell[509778, 12744, 412, 9, 28, "Input",ExpressionUUID->"721290d6-c34b-4029-a8c8-e7032961fb36"],
Cell[510193, 12755, 1610, 37, 32, "Output",ExpressionUUID->"48420d30-198e-4831-a11e-dc1a705f63dc"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[511852, 12798, 199, 3, 36, "Subsubsection",ExpressionUUID->"d3a98fa4-a5aa-4f9b-9b16-8bd39c9c8e7d"],
Cell[512054, 12803, 249, 5, 28, "Input",ExpressionUUID->"35b3f027-4df5-4c6e-a8a0-db48308cc7dc"],
Cell[CellGroupData[{
Cell[512328, 12812, 1021, 24, 28, "Input",ExpressionUUID->"52c55f05-6c69-4a57-b6cb-78afa9c4b0c5"],
Cell[513352, 12838, 466, 9, 32, "Output",ExpressionUUID->"fc2e432f-c3f7-4304-9afa-bb98ccc3815a"]
}, Open  ]],
Cell[513833, 12850, 250, 5, 28, "Input",ExpressionUUID->"52613d44-33ea-4961-be5e-97ac1660ef42"],
Cell[CellGroupData[{
Cell[514108, 12859, 1025, 24, 28, "Input",ExpressionUUID->"9d710631-89fd-45d1-a28a-7d008f133c31"],
Cell[515136, 12885, 749, 16, 32, "Output",ExpressionUUID->"b3be4d6e-816f-4972-87ce-48bcb082d8c5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[515922, 12906, 1069, 27, 34, "Input",ExpressionUUID->"7ced2e1a-7a44-4c23-a6a1-ee7cecb9d9fb"],
Cell[516994, 12935, 684, 17, 32, "Output",ExpressionUUID->"4e0fc6f5-9a56-42e5-9710-42690d952224"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[517739, 12959, 182, 3, 53, "Subsection",ExpressionUUID->"59065a1a-718f-480b-999a-e92bb1cbd3bb"],
Cell[517924, 12964, 1217, 36, 48, "Input",ExpressionUUID->"88224eeb-19a8-4f25-ad58-b6d4478a83b9"],
Cell[CellGroupData[{
Cell[519166, 13004, 3663, 80, 90, "Input",ExpressionUUID->"180fb7c7-5929-418e-a37d-ec2b7eb1a656"],
Cell[522832, 13086, 2237, 49, 56, "Output",ExpressionUUID->"ff23ff0c-69ea-40d5-a89d-a1c7852a61e1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[525106, 13140, 2333, 57, 48, "Input",ExpressionUUID->"f735bbbb-ba29-4fd8-af45-fc3471bce4ab"],
Cell[527442, 13199, 2375, 51, 56, "Output",ExpressionUUID->"9fc127f9-a3ae-4877-a541-b1f685dc28ea"]
}, Open  ]],
Cell[CellGroupData[{
Cell[529854, 13255, 2252, 56, 48, "Input",ExpressionUUID->"816d2e3b-4b12-4e1b-8b55-fa263fe02fc5"],
Cell[532109, 13313, 2371, 51, 56, "Output",ExpressionUUID->"122b7aa4-8707-4699-aef1-5bef1849fcf0"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[534529, 13370, 156, 3, 37, "Subsection",ExpressionUUID->"484b548e-67b6-49f1-9740-3e623782c0e6"],
Cell[534688, 13375, 187, 3, 28, "Input",ExpressionUUID->"cb29454b-e4bb-4853-bcda-941963393cab"],
Cell[534878, 13380, 279, 6, 28, "Input",ExpressionUUID->"30e0924c-9157-46e9-8fde-edcb76f5db58"],
Cell[535160, 13388, 215, 4, 28, "Input",ExpressionUUID->"9022d303-d85e-44d6-ab64-cad111fc18dd"],
Cell[535378, 13394, 504, 12, 48, "Input",ExpressionUUID->"3e116113-055f-4270-9902-66d5811a35e8"],
Cell[CellGroupData[{
Cell[535907, 13410, 3758, 94, 48, "Input",ExpressionUUID->"3bfc0fcc-978a-41ba-b5f8-3d539708404a"],
Cell[539668, 13506, 1354, 32, 32, "Output",ExpressionUUID->"9d549501-d000-41d5-9f24-6690e477daaf"]
}, Open  ]],
Cell[541037, 13541, 523, 13, 48, "Input",ExpressionUUID->"2ceea2fb-3fad-4b39-855e-d2207549afef"],
Cell[541563, 13556, 9022, 220, 241, "Input",ExpressionUUID->"b8aa7cba-b359-4508-94c5-392b11faeba9"],
Cell[CellGroupData[{
Cell[550610, 13780, 219, 4, 28, "Input",ExpressionUUID->"19a76aa5-3a6d-4f7f-b7d5-b53cdb906922"],
Cell[550832, 13786, 227, 4, 32, "Output",ExpressionUUID->"99b22e1f-6716-4a6c-b7b5-22016bd63656"]
}, Open  ]],
Cell[CellGroupData[{
Cell[551096, 13795, 2416, 60, 58, "Input",ExpressionUUID->"2b038bf5-e7ab-4c8c-b583-b0e98dab6e14"],
Cell[553515, 13857, 6928, 158, 99, "Output",ExpressionUUID->"16979328-5ca9-4db0-8ff3-3a63d85a5c4e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[560480, 14020, 2339, 59, 54, "Input",ExpressionUUID->"2fc97d5f-8b15-4dde-be17-baa9413b69e7"],
Cell[562822, 14081, 6904, 157, 132, "Output",ExpressionUUID->"0437429b-bfcd-4ff7-97d0-efbe31d476f9"]
}, Open  ]],
Cell[569741, 14241, 403, 11, 28, "Input",ExpressionUUID->"3b64e086-f3b4-4664-baa4-aba7bab45d27"],
Cell[CellGroupData[{
Cell[570169, 14256, 2621, 64, 78, "Input",ExpressionUUID->"3fd2fd8d-9e19-46e2-aa66-eed102a95330"],
Cell[572793, 14322, 265, 5, 32, "Output",ExpressionUUID->"7a053e22-6592-41cc-8465-6157919275eb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[573095, 14332, 2543, 63, 73, "Input",ExpressionUUID->"3123835b-75b5-4516-b247-9d0847f02861"],
Cell[575641, 14397, 215, 4, 32, "Output",ExpressionUUID->"a2cb3c11-8343-44bb-a8d7-164718b62c89"]
}, Open  ]],
Cell[575871, 14404, 458, 12, 28, "Input",ExpressionUUID->"7edc580f-46f4-4121-b058-5aae859237bd"],
Cell[CellGroupData[{
Cell[576354, 14420, 2670, 64, 78, "Input",ExpressionUUID->"86bbdc21-8bf7-4bbf-9b8a-c4dc5301b0f2"],
Cell[579027, 14486, 289, 5, 32, "Output",ExpressionUUID->"6bccc68d-4501-4a4b-a73b-6864186f0a9e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[579353, 14496, 2572, 64, 78, "Input",ExpressionUUID->"bdcd432c-6598-438a-9e07-c7018944acab"],
Cell[581928, 14562, 237, 4, 32, "Output",ExpressionUUID->"897282d6-3239-4197-8425-b64929c4d312"]
}, Open  ]],
Cell[582180, 14569, 393, 8, 48, "Input",ExpressionUUID->"18c10813-df87-4003-a920-d11c695fdc10"]
}, Closed]]
}
]
*)

