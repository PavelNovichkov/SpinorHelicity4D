(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    357046,       8832]
NotebookOptionsPosition[    320829,       8165]
NotebookOutlinePosition[    334206,       8437]
CellTagsIndexPosition[    334163,       8434]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"<<", "SpinorHelicity6D`"}]], "Input",
 CellChangeTimes->{{3.794301185980788*^9, 3.7943011984537044`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"52feb9eb-7be1-4eed-9dff-4e70cda36ab2"],

Cell[CellGroupData[{

Cell[BoxData["\<\"===============SpinorHelicity6D================\"\>"], \
"Print",
 CellChangeTimes->{3.7943119021673164`*^9, 3.7943121073974676`*^9, 
  3.794312170582461*^9, 3.802070814808277*^9, 3.802070891465285*^9, 
  3.802071261425398*^9, 3.80207885977134*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"5fb5e056-d0e7-4cca-b9d5-f8c988a9e08e"],

Cell[BoxData["\<\"Authors: Manuel Accettulli Huber (QMUL)\"\>"], "Print",
 CellChangeTimes->{3.7943119021673164`*^9, 3.7943121073974676`*^9, 
  3.794312170582461*^9, 3.802070814808277*^9, 3.802070891465285*^9, 
  3.802071261425398*^9, 3.8020788597902875`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"05d25ad6-f03f-42e8-81be-b5db9773de48"],

Cell[BoxData["\<\"Please report any bug to:\"\>"], "Print",
 CellChangeTimes->{3.7943119021673164`*^9, 3.7943121073974676`*^9, 
  3.794312170582461*^9, 3.802070814808277*^9, 3.802070891465285*^9, 
  3.802071261425398*^9, 3.802078859799297*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"9efb671b-94b2-4cc6-8d28-69a3f2f73ae2"],

Cell[BoxData["\<\"m.accettullihuber@qmul.ac.uk\"\>"], "Print",
 CellChangeTimes->{3.7943119021673164`*^9, 3.7943121073974676`*^9, 
  3.794312170582461*^9, 3.802070814808277*^9, 3.802070891465285*^9, 
  3.802071261425398*^9, 3.802078859801259*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"09b38330-0393-4c60-b5f6-8838304d6e7a"],

Cell[BoxData["\<\"Version 1.2 , last update 05/06/2020\"\>"], "Print",
 CellChangeTimes->{3.7943119021673164`*^9, 3.7943121073974676`*^9, 
  3.794312170582461*^9, 3.802070814808277*^9, 3.802070891465285*^9, 
  3.802071261425398*^9, 3.8020788598042555`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"67683e7f-4a88-474d-baf6-56ec80a8ef0f"],

Cell[BoxData["\<\"=============================================\"\>"], "Print",
 CellChangeTimes->{3.7943119021673164`*^9, 3.7943121073974676`*^9, 
  3.794312170582461*^9, 3.802070814808277*^9, 3.802070891465285*^9, 
  3.802071261425398*^9, 3.802078859813455*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"135153b1-95da-4929-bdad-bcc01c8e762c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Helicity weight, not working properly...", "Section",
 CellChangeTimes->{{3.794301249080035*^9, 3.794301252181885*^9}, {
  3.802067346905409*^9, 
  3.8020673529183054`*^9}},ExpressionUUID->"a4c21f51-06aa-48ae-9617-\
a92d3dd7d1c6"],

Cell[CellGroupData[{

Cell["Defining the function", "Subsection",
 CellChangeTimes->{{3.7943012085807943`*^9, 
  3.794301213019704*^9}},ExpressionUUID->"d5575354-e02a-434d-bbc5-\
7bb14aac5a0e"],

Cell[CellGroupData[{

Cell["Version1, does not work with weight 0", "Subsubsection",
 CellChangeTimes->{{3.7947281223358865`*^9, 
  3.7947281324537888`*^9}},ExpressionUUID->"62266147-4a7c-4b44-abaf-\
e1d7e74bb522"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Options", "[", "HelicityWeight", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"TestOnly", "\[Rule]", "False"}], "}"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7943013316894965`*^9, 3.7943013772694273`*^9}, 
   3.79431495187481*^9},ExpressionUUID->"b2694dc0-1ee8-4bc8-80b5-\
041ee38c75ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"HelicityWeight", "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"locexp", ",", "pow", ",", "weight"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Replace", " ", "every", " ", "function", " ", "with", " ", "itself", 
       " ", "times", " ", "a", " ", "weight", " ", "function"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"locexp", "=", 
       RowBox[{"exp", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"SpinorAngleBracket", "[", 
            RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"pow", "[", "x", "]"}], 
               RowBox[{"pow", "[", "y", "]"}]}], ")"}]}], 
            RowBox[{"SpinorAngleBracket", "[", 
             RowBox[{"x", ",", "y"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"SpinorSquareBracket", "[", 
            RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"pow", "[", "x", "]"}], 
            RowBox[{"pow", "[", "y", "]"}], 
            RowBox[{"SpinorSquareBracket", "[", 
             RowBox[{"x", ",", "y"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"Chain", "[", 
            RowBox[{"$angle", ",", "x_", ",", 
             RowBox[{"{", "k__", "}"}], ",", "y_", ",", "$angle"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"pow", "[", "x", "]"}]}], "*", 
            RowBox[{"1", "/", 
             RowBox[{"pow", "[", "y", "]"}]}], "*", 
            RowBox[{"Chain", "[", 
             RowBox[{"$angle", ",", "x", ",", 
              RowBox[{"{", "k", "}"}], ",", "y", ",", "$angle"}], "]"}]}]}], 
          ",", 
          RowBox[{
           RowBox[{"Chain", "[", 
            RowBox[{"$square", ",", "x_", ",", 
             RowBox[{"{", "k__", "}"}], ",", "y_", ",", "$square"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"pow", "[", "x", "]"}], 
            RowBox[{"pow", "[", "y", "]"}], 
            RowBox[{"Chain", "[", 
             RowBox[{"$square", ",", "x", ",", 
              RowBox[{"{", "k", "}"}], ",", "y", ",", "$square"}], "]"}]}]}], 
          ",", 
          RowBox[{
           RowBox[{"Chain", "[", 
            RowBox[{"$angle", ",", "x_", ",", 
             RowBox[{"{", "k__", "}"}], ",", "y_", ",", "$square"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"pow", "[", "x", "]"}]}], "*", 
            RowBox[{"pow", "[", "y", "]"}], 
            RowBox[{"Chain", "[", 
             RowBox[{"$angle", ",", "x", ",", 
              RowBox[{"{", "k", "}"}], ",", "y", ",", "$square"}], "]"}]}]}], 
          ",", 
          RowBox[{
           RowBox[{"Chain", "[", 
            RowBox[{"$square", ",", "x_", ",", 
             RowBox[{"{", "k__", "}"}], ",", "y_", ",", "$angle"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"pow", "[", "x", "]"}], 
            RowBox[{"1", "/", 
             RowBox[{"pow", "[", "y", "]"}]}], 
            RowBox[{"Chain", "[", 
             RowBox[{"$square", ",", "x", ",", 
              RowBox[{"{", "k", "}"}], ",", "y", ",", "$angle"}], "]"}]}]}]}],
          "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Collect", " ", "the", " ", "weights"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"locexp", "=", 
       RowBox[{"Expand", "[", 
        RowBox[{"locexp", ",", "pow"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"locexp", "=", 
       RowBox[{"locexp", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"pow", "[", "x_", "]"}], ",", "n_"}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{"pow", "[", 
           RowBox[{"{", 
            RowBox[{"x", ",", "n"}], "}"}], "]"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"locexp", "=", 
       RowBox[{"locexp", "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"pow", "[", "x_List", "]"}], "*", 
           RowBox[{"pow", "[", "y_List", "]"}]}], "\[RuleDelayed]", 
          RowBox[{"pow", "[", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], "]"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"locexp", "=", 
       RowBox[{"Collect", "[", 
        RowBox[{"locexp", ",", 
         RowBox[{"pow", "[", "_", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"locexp", "=", 
       RowBox[{
        RowBox[{"locexp", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"A_", "*", 
            RowBox[{"pow", "[", "x_List", "]"}]}], "\[RuleDelayed]", 
           RowBox[{"weight", "[", 
            RowBox[{"A", ",", "x"}], "]"}]}], "}"}]}], "//", "Expand"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"locexp", "=", 
       RowBox[{"locexp", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"A_", "*", 
           RowBox[{"weight", "[", 
            RowBox[{"B_", ",", "x_"}], "]"}]}], "\[RuleDelayed]", 
          RowBox[{"weight", "[", 
           RowBox[{
            RowBox[{"A", "*", "B"}], ",", "x"}], "]"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"locexp", "=", 
       RowBox[{"locexp", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"weight", "[", 
           RowBox[{"A_", ",", "x_List"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"weight", "[", 
           RowBox[{"A", ",", 
            RowBox[{"Partition", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", "x", "]"}], ",", "2"}], "]"}]}], 
           "]"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "locexp", "]"}], "===", "weight"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"locexp", "=", 
         RowBox[{"{", "locexp", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"locexp", "=", 
          RowBox[{"List", "@@", "locexp"}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"locexp", "=", 
       RowBox[{"locexp", "/.", 
        RowBox[{"weight", "\[Rule]", "List"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "locexp", "]"}], "\[Equal]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"locexp", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<The terms have unequal weights, please check input.\>\"", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "locexp", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.79430127910153*^9, 3.7943013208216133`*^9}, {
   3.794301380249501*^9, 3.7943013923765993`*^9}, {3.7943015706208973`*^9, 
   3.794301594705285*^9}, {3.7943016726449957`*^9, 3.794301771655351*^9}, {
   3.794301821463398*^9, 3.7943019208536325`*^9}, {3.7943019562210836`*^9, 
   3.794302100645192*^9}, {3.7943021794352684`*^9, 3.7943022191692314`*^9}, 
   3.7943123926007977`*^9, {3.794312468382801*^9, 3.794312512818348*^9}, {
   3.794312871456957*^9, 3.794312993069166*^9}, {3.7943130539062133`*^9, 
   3.7943130690393925`*^9}, {3.7943136696599684`*^9, 
   3.7943137182743316`*^9}, {3.7943138544319787`*^9, 
   3.7943139458224316`*^9}, {3.7943139934901285`*^9, 3.794314133407717*^9}, {
   3.794314182919891*^9, 3.794314340587125*^9}, {3.7943143999130125`*^9, 
   3.7943144044474134`*^9}, {3.7943144467453175`*^9, 
   3.7943144478164215`*^9}, {3.794314486107679*^9, 3.794314547154628*^9}, 
   3.7943149113580227`*^9, 3.7943149560621543`*^9, {3.7947275751935525`*^9, 
   3.794727607575047*^9}},ExpressionUUID->"ee2b2d6e-2bcc-4010-b446-\
ffa6ab6f61ca"]
}, Closed]],

Cell[CellGroupData[{

Cell["Version 2", "Subsubsection",
 CellChangeTimes->{{3.794728115574911*^9, 
  3.7947281178677754`*^9}},ExpressionUUID->"3ab05721-cdc7-42e3-8001-\
1d2160162969"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"HelicityWeight", "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"locexp", ",", "pow", ",", "weight"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Replace", " ", "every", " ", "function", " ", "with", " ", "itself", 
       " ", "times", " ", "a", " ", "weight", " ", "function"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"locexp", "=", 
       RowBox[{"exp", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"SpinorAngleBracket", "[", 
            RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"pow", "[", "x", "]"}], 
               RowBox[{"pow", "[", "y", "]"}]}], ")"}]}], 
            RowBox[{"SpinorAngleBracket", "[", 
             RowBox[{"x", ",", "y"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"SpinorSquareBracket", "[", 
            RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"pow", "[", "x", "]"}], 
            RowBox[{"pow", "[", "y", "]"}], 
            RowBox[{"SpinorSquareBracket", "[", 
             RowBox[{"x", ",", "y"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"Chain", "[", 
            RowBox[{"$angle", ",", "x_", ",", 
             RowBox[{"{", "k__", "}"}], ",", "y_", ",", "$angle"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"pow", "[", "x", "]"}]}], "*", 
            RowBox[{"1", "/", 
             RowBox[{"pow", "[", "y", "]"}]}], "*", 
            RowBox[{"Chain", "[", 
             RowBox[{"$angle", ",", "x", ",", 
              RowBox[{"{", "k", "}"}], ",", "y", ",", "$angle"}], "]"}]}]}], 
          ",", 
          RowBox[{
           RowBox[{"Chain", "[", 
            RowBox[{"$square", ",", "x_", ",", 
             RowBox[{"{", "k__", "}"}], ",", "y_", ",", "$square"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"pow", "[", "x", "]"}], 
            RowBox[{"pow", "[", "y", "]"}], 
            RowBox[{"Chain", "[", 
             RowBox[{"$square", ",", "x", ",", 
              RowBox[{"{", "k", "}"}], ",", "y", ",", "$square"}], "]"}]}]}], 
          ",", 
          RowBox[{
           RowBox[{"Chain", "[", 
            RowBox[{"$angle", ",", "x_", ",", 
             RowBox[{"{", "k__", "}"}], ",", "y_", ",", "$square"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"pow", "[", "x", "]"}]}], "*", 
            RowBox[{"pow", "[", "y", "]"}], 
            RowBox[{"Chain", "[", 
             RowBox[{"$angle", ",", "x", ",", 
              RowBox[{"{", "k", "}"}], ",", "y", ",", "$square"}], "]"}]}]}], 
          ",", 
          RowBox[{
           RowBox[{"Chain", "[", 
            RowBox[{"$square", ",", "x_", ",", 
             RowBox[{"{", "k__", "}"}], ",", "y_", ",", "$angle"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"pow", "[", "x", "]"}], 
            RowBox[{"1", "/", 
             RowBox[{"pow", "[", "y", "]"}]}], 
            RowBox[{"Chain", "[", 
             RowBox[{"$square", ",", "x", ",", 
              RowBox[{"{", "k", "}"}], ",", "y", ",", "$angle"}], "]"}]}]}]}],
          "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Collect", " ", "the", " ", "weights"}], ",", " ", 
        RowBox[{
        "taking", " ", "into", " ", "account", " ", "the", " ", "weight", " ",
          "0", " ", "possibility", " ", "which", " ", "is", " ", 
         "special"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"locexp", "=", 
       RowBox[{"Expand", "[", 
        RowBox[{"locexp", ",", "pow"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{"locexp", ",", "pow"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"locexp", "=", 
         RowBox[{"weight", "[", 
          RowBox[{"locexp", ",", "\"\<weight 0 in all spinors\>\""}], "]"}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"locexp", "=", 
          RowBox[{"locexp", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Power", "[", 
              RowBox[{
               RowBox[{"pow", "[", "x_", "]"}], ",", "n_"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"pow", "[", 
              RowBox[{"{", 
               RowBox[{"x", ",", "n"}], "}"}], "]"}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"locexp", "=", 
          RowBox[{"locexp", "//.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"pow", "[", "x_List", "]"}], "*", 
              RowBox[{"pow", "[", "y_List", "]"}]}], "\[RuleDelayed]", 
             RowBox[{"pow", "[", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "]"}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"locexp", "=", 
          RowBox[{"Collect", "[", 
           RowBox[{"locexp", ",", 
            RowBox[{"pow", "[", "_", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"locexp", "=", 
          RowBox[{
           RowBox[{"locexp", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"A_", "*", 
               RowBox[{"pow", "[", "x_List", "]"}]}], "\[RuleDelayed]", 
              RowBox[{"weight", "[", 
               RowBox[{"A", ",", "x"}], "]"}]}], "}"}]}], "//", "Expand"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"locexp", "=", 
          RowBox[{"locexp", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"A_", "*", 
              RowBox[{"weight", "[", 
               RowBox[{"B_", ",", "x_"}], "]"}]}], "\[RuleDelayed]", 
             RowBox[{"weight", "[", 
              RowBox[{
               RowBox[{"A", "*", "B"}], ",", "x"}], "]"}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"locexp", "=", 
          RowBox[{"locexp", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"A_", "+", 
               RowBox[{"weight", "[", "x__", "]"}]}], "/;", 
              RowBox[{"FreeQ", "[", 
               RowBox[{"A", ",", "weight"}], "]"}]}], "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"weight", "[", 
               RowBox[{"A", ",", "\"\<weight 0 in all spinors\>\""}], "]"}], 
              "+", 
              RowBox[{"weight", "[", "x", "]"}]}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"locexp", "=", 
          RowBox[{"locexp", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"weight", "[", 
              RowBox[{"A_", ",", "x_List"}], "]"}], "\[RuleDelayed]", 
             RowBox[{"weight", "[", 
              RowBox[{"A", ",", 
               RowBox[{"Partition", "[", 
                RowBox[{
                 RowBox[{"Flatten", "[", "x", "]"}], ",", "2"}], "]"}]}], 
              "]"}]}], "}"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "locexp", "]"}], "===", "weight"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"locexp", "=", 
         RowBox[{"{", "locexp", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"locexp", "=", 
          RowBox[{"List", "@@", "locexp"}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"locexp", "=", 
       RowBox[{"locexp", "/.", 
        RowBox[{"weight", "\[Rule]", "List"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "locexp", "]"}], "\[Equal]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"locexp", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<The terms have unequal weights, please check input.\>\"", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "locexp", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.79430127910153*^9, 3.7943013208216133`*^9}, {
   3.794301380249501*^9, 3.7943013923765993`*^9}, {3.7943015706208973`*^9, 
   3.794301594705285*^9}, {3.7943016726449957`*^9, 3.794301771655351*^9}, {
   3.794301821463398*^9, 3.7943019208536325`*^9}, {3.7943019562210836`*^9, 
   3.794302100645192*^9}, {3.7943021794352684`*^9, 3.7943022191692314`*^9}, 
   3.7943123926007977`*^9, {3.794312468382801*^9, 3.794312512818348*^9}, {
   3.794312871456957*^9, 3.794312993069166*^9}, {3.7943130539062133`*^9, 
   3.7943130690393925`*^9}, {3.7943136696599684`*^9, 
   3.7943137182743316`*^9}, {3.7943138544319787`*^9, 
   3.7943139458224316`*^9}, {3.7943139934901285`*^9, 3.794314133407717*^9}, {
   3.794314182919891*^9, 3.794314340587125*^9}, {3.7943143999130125`*^9, 
   3.7943144044474134`*^9}, {3.7943144467453175`*^9, 
   3.7943144478164215`*^9}, {3.794314486107679*^9, 3.794314547154628*^9}, 
   3.7943149113580227`*^9, 3.7943149560621543`*^9, {3.7947275751935525`*^9, 
   3.794727705419565*^9}, {3.7947277634304457`*^9, 3.7947277705653734`*^9}, {
   3.794727850627779*^9, 3.794728027245332*^9}, {3.794728071801486*^9, 
   3.794728073957716*^9}},
 CellLabel->
  "In[449]:=",ExpressionUUID->"fca877f5-86e2-406d-9593-0fd4d06a4f16"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test", "Subsection",
 CellChangeTimes->{{3.794301260030877*^9, 
  3.7943012605981913`*^9}},ExpressionUUID->"77337c2b-bfe5-4b94-9c68-\
faa5bc3582e9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test", "=", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[Kappa]", "4"], " ", 
      SuperscriptBox[
       TemplateBox[{"l1",RowBox[{"{", "p1", "}"}],"l2"},
        "AngleSquareChain",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
           "$square", "]"}]& )], "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"p3",RowBox[{"{", 
           RowBox[{"-", "l2"}], "}"}],"p4"},
        "AngleSquareChain",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
           "$square", "]"}]& )], "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"l2","p3"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"l1","p4"},
        "SpinorSquareBracket",
        DisplayFunction->(RowBox[{"[", 
           RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
        InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
      SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
     RowBox[{"128", " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", 
        RowBox[{"-", "l2"}]}], "]"}], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["m", "2"], " ", 
         SuperscriptBox["\[Kappa]", "2"], " ", 
         SuperscriptBox[
          TemplateBox[{"p3",RowBox[{"{", 
              RowBox[{"-", "l1"}], "}"}],"p4"},
           "AngleSquareChain",
           
           DisplayFunction->(
            RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
              "$square", "]"}]& )], "4"], " ", 
         SuperscriptBox[
          TemplateBox[{"l1","l2"},
           "SpinorAngleBracket",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
           InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
         SuperscriptBox[
          TemplateBox[{"l1","l2"},
           "SpinorSquareBracket",
           DisplayFunction->(RowBox[{"[", 
              RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
           InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
         SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
        RowBox[{"64", " ", "s", " ", 
         TemplateBox[{
          TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
           TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
          "ScalarProduct",
          DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
          InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
         " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l1"}], ",", 
           RowBox[{"-", "l2"}]}], "]"}], " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["m", "2"], " ", 
        SuperscriptBox["\[Kappa]", "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"p3",RowBox[{"{", 
             RowBox[{"-", "l2"}], "}"}],"p4"},
          "AngleSquareChain",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
          
          InterpretationFunction->(
           RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
             "$square", "]"}]& )], "4"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1","l2"},
          "SpinorAngleBracket",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
             RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
          InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1","l2"},
          "SpinorSquareBracket",
          DisplayFunction->(RowBox[{"[", 
             RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
          InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
       RowBox[{"64", " ", "s", " ", 
        TemplateBox[{
         TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
          TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
         "ScalarProduct",
         DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
         InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
        " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", 
          RowBox[{"-", "l2"}]}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l2"}], ",", "p3"}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l2"}], ",", "p4"}], "]"}]}]]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.794301262803868*^9, 3.7943012704525943`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"40e1bf16-232c-4be9-b234-c46e72c5ff02"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[Kappa]", "4"], " ", 
     SuperscriptBox[
      TemplateBox[{"l1",RowBox[{"{", "p1", "}"}],"l2"},
       "AngleSquareChain",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
          "$square", "]"}]& )], "2"], " ", 
     SuperscriptBox[
      TemplateBox[{"p3",RowBox[{"{", 
          RowBox[{"-", "l2"}], "}"}],"p4"},
       "AngleSquareChain",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
          "$square", "]"}]& )], "2"], " ", 
     SuperscriptBox[
      TemplateBox[{"l2","p3"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
     SuperscriptBox[
      TemplateBox[{"l1","p4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
     SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
    RowBox[{"128", " ", 
     RowBox[{"S4", "[", 
      RowBox[{
       RowBox[{"-", "l1"}], ",", 
       RowBox[{"-", "l2"}]}], "]"}], " ", 
     RowBox[{"S4", "[", 
      RowBox[{
       RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
     RowBox[{"S4", "[", 
      RowBox[{
       RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["m", "2"], " ", 
        SuperscriptBox["\[Kappa]", "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"p3",RowBox[{"{", 
             RowBox[{"-", "l1"}], "}"}],"p4"},
          "AngleSquareChain",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
          
          InterpretationFunction->(
           RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
             "$square", "]"}]& )], "4"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1","l2"},
          "SpinorAngleBracket",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
             RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
          InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1","l2"},
          "SpinorSquareBracket",
          DisplayFunction->(RowBox[{"[", 
             RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
          InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
       RowBox[{"64", " ", "s", " ", 
        TemplateBox[{
         TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
          TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
         "ScalarProduct",
         DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
         InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
        " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", 
          RowBox[{"-", "l2"}]}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["m", "2"], " ", 
       SuperscriptBox["\[Kappa]", "2"], " ", 
       SuperscriptBox[
        TemplateBox[{"p3",RowBox[{"{", 
            RowBox[{"-", "l2"}], "}"}],"p4"},
         "AngleSquareChain",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
            "$square", "]"}]& )], "4"], " ", 
       SuperscriptBox[
        TemplateBox[{"l1","l2"},
         "SpinorAngleBracket",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
            RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
         InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
            RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
       SuperscriptBox[
        TemplateBox[{"l1","l2"},
         "SpinorSquareBracket",
         DisplayFunction->(RowBox[{"[", 
            RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
         InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
            RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
       SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
      RowBox[{"64", " ", "s", " ", 
       TemplateBox[{
        TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
          InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
         TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
          InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
        "ScalarProduct",
        DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
        InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
       " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l1"}], ",", 
         RowBox[{"-", "l2"}]}], "]"}], " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l2"}], ",", "p3"}], "]"}], " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l2"}], ",", "p4"}], "]"}]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.79430126426431*^9, 3.7943012711177635`*^9}, 
   3.794314357615675*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"8f76097d-96f3-4e8c-8db6-b7506e5926fa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight", "[", "test", "]"}]], "Input",
 CellChangeTimes->{{3.7943143507942367`*^9, 3.79431435439968*^9}, {
  3.7943146389741993`*^9, 3.794314647210569*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"81b12154-4c43-426c-b284-d0f5908e8b64"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p3", ",", 
     RowBox[{"-", "4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p4", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.794314360249627*^9, 3.794314422010434*^9, 3.794314455352127*^9, {
   3.7943145353981967`*^9, 3.7943145559306154`*^9}, {3.7943146410513*^9, 
   3.794314647909994*^9}, 3.7943149778387184`*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"534d180d-f69d-4d75-910b-3619253df804"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test2", "=", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[Kappa]", "4"], " ", 
      SuperscriptBox[
       TemplateBox[{"l1",RowBox[{"{", "p1", "}"}],"l3"},
        "AngleSquareChain",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
           "$square", "]"}]& )], "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"p3",RowBox[{"{", 
           RowBox[{"-", "l2"}], "}"}],"p4"},
        "AngleSquareChain",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
           "$square", "]"}]& )], "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"l2","p3"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"l1","p4"},
        "SpinorSquareBracket",
        DisplayFunction->(RowBox[{"[", 
           RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
        InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
      SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
     RowBox[{"128", " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", 
        RowBox[{"-", "l2"}]}], "]"}], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["m", "2"], " ", 
         SuperscriptBox["\[Kappa]", "2"], " ", 
         SuperscriptBox[
          TemplateBox[{"p3",RowBox[{"{", 
              RowBox[{"-", "l1"}], "}"}],"p4"},
           "AngleSquareChain",
           
           DisplayFunction->(
            RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
              "$square", "]"}]& )], "4"], " ", 
         SuperscriptBox[
          TemplateBox[{"l1","l2"},
           "SpinorAngleBracket",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
           InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
         SuperscriptBox[
          TemplateBox[{"l1","l2"},
           "SpinorSquareBracket",
           DisplayFunction->(RowBox[{"[", 
              RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
           InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
         SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
        RowBox[{"64", " ", "s", " ", 
         TemplateBox[{
          TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
           TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
          "ScalarProduct",
          DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
          InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
         " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l1"}], ",", 
           RowBox[{"-", "l2"}]}], "]"}], " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["m", "2"], " ", 
        SuperscriptBox["\[Kappa]", "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"p3",RowBox[{"{", 
             RowBox[{"-", "l2"}], "}"}],"p4"},
          "AngleSquareChain",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
          
          InterpretationFunction->(
           RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
             "$square", "]"}]& )], "4"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1","l2"},
          "SpinorAngleBracket",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
             RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
          InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1","l2"},
          "SpinorSquareBracket",
          DisplayFunction->(RowBox[{"[", 
             RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
          InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
       RowBox[{"64", " ", "s", " ", 
        TemplateBox[{
         TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
          TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
         "ScalarProduct",
         DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
         InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
        " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", 
          RowBox[{"-", "l2"}]}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l2"}], ",", "p3"}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l2"}], ",", "p4"}], "]"}]}]]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7943145697369833`*^9, 3.7943145891220655`*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"7de306a9-6477-4576-af4e-1da3e2ff5ba1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[Kappa]", "4"], " ", 
     SuperscriptBox[
      TemplateBox[{"l1",RowBox[{"{", "p1", "}"}],"l3"},
       "AngleSquareChain",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
          "$square", "]"}]& )], "2"], " ", 
     SuperscriptBox[
      TemplateBox[{"p3",RowBox[{"{", 
          RowBox[{"-", "l2"}], "}"}],"p4"},
       "AngleSquareChain",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
          "$square", "]"}]& )], "2"], " ", 
     SuperscriptBox[
      TemplateBox[{"l2","p3"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
     SuperscriptBox[
      TemplateBox[{"l1","p4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
     SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
    RowBox[{"128", " ", 
     RowBox[{"S4", "[", 
      RowBox[{
       RowBox[{"-", "l1"}], ",", 
       RowBox[{"-", "l2"}]}], "]"}], " ", 
     RowBox[{"S4", "[", 
      RowBox[{
       RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
     RowBox[{"S4", "[", 
      RowBox[{
       RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["m", "2"], " ", 
        SuperscriptBox["\[Kappa]", "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"p3",RowBox[{"{", 
             RowBox[{"-", "l1"}], "}"}],"p4"},
          "AngleSquareChain",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
          
          InterpretationFunction->(
           RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
             "$square", "]"}]& )], "4"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1","l2"},
          "SpinorAngleBracket",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
             RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
          InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1","l2"},
          "SpinorSquareBracket",
          DisplayFunction->(RowBox[{"[", 
             RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
          InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
       RowBox[{"64", " ", "s", " ", 
        TemplateBox[{
         TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
          TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
         "ScalarProduct",
         DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
         InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
        " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", 
          RowBox[{"-", "l2"}]}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["m", "2"], " ", 
       SuperscriptBox["\[Kappa]", "2"], " ", 
       SuperscriptBox[
        TemplateBox[{"p3",RowBox[{"{", 
            RowBox[{"-", "l2"}], "}"}],"p4"},
         "AngleSquareChain",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
            "$square", "]"}]& )], "4"], " ", 
       SuperscriptBox[
        TemplateBox[{"l1","l2"},
         "SpinorAngleBracket",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
            RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
         InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
            RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
       SuperscriptBox[
        TemplateBox[{"l1","l2"},
         "SpinorSquareBracket",
         DisplayFunction->(RowBox[{"[", 
            RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
         InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
            RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
       SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
      RowBox[{"64", " ", "s", " ", 
       TemplateBox[{
        TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
          InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
         TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
          InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
        "ScalarProduct",
        DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
        InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
       " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l1"}], ",", 
         RowBox[{"-", "l2"}]}], "]"}], " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l2"}], ",", "p3"}], "]"}], " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l2"}], ",", "p4"}], "]"}]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.794314590953373*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"14f6382c-411f-4d16-af05-1afe0464432a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test2", "//", "HelicityWeight"}]], "Input",
 CellChangeTimes->{{3.794314592789912*^9, 3.7943145966657677`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"f5864cde-2401-47f4-a654-961e4678b799"],

Cell[BoxData["\<\"The terms have unequal weights, please check input.\"\>"], \
"Print",
 CellChangeTimes->{3.7943145971341143`*^9, 3.794314982710046*^9},
 CellLabel->
  "During evaluation of \
In[39]:=",ExpressionUUID->"86091c14-9644-4b77-a415-abdf968c079e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Kappa]", "4"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1",RowBox[{"{", "p1", "}"}],"l3"},
          "AngleSquareChain",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
          
          InterpretationFunction->(
           RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
             "$square", "]"}]& )], "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"p3",RowBox[{"{", 
             RowBox[{"-", "l2"}], "}"}],"p4"},
          "AngleSquareChain",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
          
          InterpretationFunction->(
           RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
             "$square", "]"}]& )], "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"l2","p3"},
          "SpinorAngleBracket",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
             RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
          InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1","p4"},
          "SpinorSquareBracket",
          DisplayFunction->(RowBox[{"[", 
             RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
          InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
       RowBox[{"128", " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", 
          RowBox[{"-", "l2"}]}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"l2", ",", 
         RowBox[{"-", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l3", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p3", ",", 
         RowBox[{"-", "4"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p4", ",", "4"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["m", "2"], " ", 
         SuperscriptBox["\[Kappa]", "2"], " ", 
         SuperscriptBox[
          TemplateBox[{"p3",RowBox[{"{", 
              RowBox[{"-", "l1"}], "}"}],"p4"},
           "AngleSquareChain",
           
           DisplayFunction->(
            RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
              "$square", "]"}]& )], "4"], " ", 
         SuperscriptBox[
          TemplateBox[{"l1","l2"},
           "SpinorAngleBracket",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
           InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
         SuperscriptBox[
          TemplateBox[{"l1","l2"},
           "SpinorSquareBracket",
           DisplayFunction->(RowBox[{"[", 
              RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
           InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
         SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
        RowBox[{"128", " ", "s", " ", 
         TemplateBox[{
          TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
           TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
          "ScalarProduct",
          DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
          InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
         " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l1"}], ",", 
           RowBox[{"-", "l2"}]}], "]"}], " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["m", "2"], " ", 
        SuperscriptBox["\[Kappa]", "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"p3",RowBox[{"{", 
             RowBox[{"-", "l2"}], "}"}],"p4"},
          "AngleSquareChain",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
          
          InterpretationFunction->(
           RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
             "$square", "]"}]& )], "4"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1","l2"},
          "SpinorAngleBracket",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
             RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
          InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1","l2"},
          "SpinorSquareBracket",
          DisplayFunction->(RowBox[{"[", 
             RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
          InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
       RowBox[{"128", " ", "s", " ", 
        TemplateBox[{
         TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
          TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
         "ScalarProduct",
         DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
         InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
        " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", 
          RowBox[{"-", "l2"}]}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l2"}], ",", "p3"}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l2"}], ",", "p4"}], "]"}]}]]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p3", ",", 
         RowBox[{"-", "4"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p4", ",", "4"}], "}"}]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7943145971520257`*^9, 3.7943149827340207`*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"67517285-f55f-406d-b53c-8d499de42dcf"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Helicity weight again, still not working in all cases", "Section",
 CellChangeTimes->{{3.8020673572763844`*^9, 3.8020673614829655`*^9}, {
  3.802080289643543*^9, 
  3.802080297451686*^9}},ExpressionUUID->"b7f166ca-0107-4476-9a19-\
a7e83d898c8e"],

Cell[CellGroupData[{

Cell["Function definition", "Subsection",
 CellChangeTimes->{{3.80206736977641*^9, 
  3.8020673736277757`*^9}},ExpressionUUID->"7d83feb4-d7e7-4c1e-a000-\
7d34676689d4"],

Cell[CellGroupData[{

Cell["For a single term, does not work with powers...", "Subsubsection",
 CellChangeTimes->{{3.8020694554645815`*^9, 3.802069459020146*^9}, {
  3.802079634005885*^9, 
  3.802079641911733*^9}},ExpressionUUID->"df7bb581-7ec9-48bf-ba2e-\
24864bb44b18"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HelicityWeight2", "[", "exp_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "weightplus", ",", "weightminus", ",", "pow", ",", "pow2", ",", "out"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "pow", " ", "is", " ", "the", " ", "helicity", " ", "power", " ", "of", 
      " ", "a", " ", "given", " ", "x"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"pow", "[", "x_", "]"}], ":=", "0"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Define", " ", "two", " ", "functions", " ", "which", " ", "raise", " ",
        "and", " ", "lower", " ", "the", " ", "helicity", " ", "power"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"weightplus", "[", "x_", "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"pow", "[", "x", "]"}], "++"}], ";", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"weightminus", "[", "x_", "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"pow", "[", "x", "]"}], "--"}], ";", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Perform", " ", "selected", " ", "replacements", " ", "in", " ", 
       RowBox[{"exp", ".", " ", "We"}], " ", "do", " ", "not", " ", "care", 
       " ", "what", " ", "exp", " ", "becomes", " ", "but", " ", "just", " ", 
       "that", " ", 
       RowBox[{"weightplus", "/", "minus"}], " ", "are", " ", 
       RowBox[{"applied", "."}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"exp", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"SpinorAngleBracket", "[", 
          RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"weightminus", "[", "x", "]"}], ",", 
           RowBox[{"weightminus", "[", "y", "]"}]}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"SpinorSquareBracket", "[", 
          RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"weightplus", "[", "x", "]"}], ",", 
           RowBox[{"weightplus", "[", "y", "]"}]}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"Chain", "[", 
          RowBox[{"$angle", ",", "x_", ",", 
           RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$angle"}], "]"}], 
         "\[RuleDelayed]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"weightminus", "[", "x", "]"}], ",", 
           RowBox[{"weightminus", "[", "z", "]"}]}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"Chain", "[", 
          RowBox[{"$angle", ",", "x_", ",", 
           RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$square"}], "]"}], 
         "\[RuleDelayed]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"weightminus", "[", "x", "]"}], ",", 
           RowBox[{"weightplus", "[", "z", "]"}]}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"Chain", "[", 
          RowBox[{"$square", ",", "x_", ",", 
           RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$angle"}], "]"}], 
         "\[RuleDelayed]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"weightplus", "[", "x", "]"}], ",", 
           RowBox[{"weightminus", "[", "z", "]"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Chain", "[", 
          RowBox[{"$square", ",", "x_", ",", 
           RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$square"}], "]"}], 
         "\[RuleDelayed]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"weightplus", "[", "x", "]"}], ",", 
           RowBox[{"weightplus", "[", "z", "]"}]}], "}"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Extract", " ", "weights", " ", "from", " ", "DownValues", " ", "of", 
       " ", 
       RowBox[{"pow", ".", " ", "This"}], " ", "is", " ", "not", " ", "as", 
       " ", "straight", " ", "forward", " ", "as", " ", "I", " ", "would", 
       " ", "like", " ", "it", " ", "to", " ", "be"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"out", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"DownValues", "[", "pow", "]"}], ",", 
        RowBox[{
         RowBox[{"FreeQ", "[", 
          RowBox[{"#", ",", "Pattern"}], "]"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out", "=", 
      RowBox[{
       RowBox[{"out", "/.", 
        RowBox[{"{", 
         RowBox[{"pow", "\[Rule]", "pow2"}], "}"}]}], "//", "ReleaseHold"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"out", "=", 
      RowBox[{"out", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"pow2", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], ",", 
         RowBox[{"RuleDelayed", "\[Rule]", "List"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Return", " ", "a", " ", "list", " ", "of", " ", "pairs", " ", "where", 
       " ", "the", " ", "firt", " ", "is", " ", "the", " ", "label", " ", 
       "and", " ", "the", " ", "second", " ", "the", " ", "associated", " ", 
       "helicity"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "out", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8020674023793197`*^9, 3.802067408814971*^9}, {
  3.802067453839579*^9, 3.8020675571933393`*^9}, {3.8020676975782537`*^9, 
  3.8020679397460575`*^9}, {3.8020680350249214`*^9, 3.8020682443739433`*^9}, {
  3.8020688478390775`*^9, 3.8020691209179807`*^9}, {3.802069178752232*^9, 
  3.8020691810544963`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"be9157f5-b73e-4d4d-b93b-3e14216c3e65"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tests", "Subsubsection",
 CellChangeTimes->{{3.8020691261921625`*^9, 
  3.8020691273138795`*^9}},ExpressionUUID->"57a55530-1206-496c-b4aa-\
fd87f1311ed2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HelicityWeight2", "[", 
   RowBox[{
    TemplateBox[{"1", "2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], 
    TemplateBox[{"2", "1"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], "]"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.802069146584921*^9, 3.8020691585791397`*^9}, {
  3.8020692179901013`*^9, 3.8020692207240534`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"9599c227-4a78-40ab-a8b8-2fd2cc1d18a2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0002798`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.802069159410637*^9, {3.8020692119938116`*^9, 3.8020692212466507`*^9}, 
   3.8020708998526564`*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"be88035a-62f5-413d-96e8-5cf7d48153e7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight2", "[", 
  TemplateBox[{"p1", 
    RowBox[{"{", "p2", "}"}], "p3"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "]"}]], "Input",
 CellChangeTimes->{{3.8020692284348116`*^9, 3.8020692472097435`*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"84ae124a-ee8d-419a-b697-9769c37f3273"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p1", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p3", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.802069248352642*^9},
 CellLabel->"Out[99]=",ExpressionUUID->"d872bd21-1f83-4acd-beec-a6191482bdfb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight2", "[", 
  TemplateBox[{"p1", 
    RowBox[{"{", "p2", "}"}], "p3"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "]"}]], "Input",
 CellChangeTimes->{{3.802069253802479*^9, 3.802069269037195*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"e0aad559-6187-480d-bb8a-832cce1e7be0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p3", ",", 
     RowBox[{"-", "1"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8020692700493364`*^9},
 CellLabel->
  "Out[100]=",ExpressionUUID->"f7103255-1d9b-4677-a9e2-75448b954a1e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight2", "[", 
  TemplateBox[{"p1", 
    RowBox[{"{", 
      RowBox[{"p2", ",", "p3"}], "}"}], "p4"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "]"}]], "Input",
 CellChangeTimes->{{3.802069279799368*^9, 3.802069300205358*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"5c7440ea-9f66-4411-852c-948462a07753"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p1", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p4", ",", 
     RowBox[{"-", "1"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.802069301427267*^9},
 CellLabel->
  "Out[101]=",ExpressionUUID->"9d492b9c-bcc0-40dc-baa9-cdcbf0579926"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight2", "[", 
  TemplateBox[{"p1", 
    RowBox[{"{", 
      RowBox[{"p2", ",", "p3"}], "}"}], "p4"},
   "SquareSquareChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square",
       "]"}]& )], "]"}]], "Input",
 CellChangeTimes->{{3.8020693035562744`*^9, 3.8020693169416685`*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"0c63fa33-3898-4d72-ac05-497a35c560b4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p4", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.80206931766927*^9},
 CellLabel->
  "Out[102]=",ExpressionUUID->"11c1d585-a0e0-4235-b270-1c296a207561"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
For application to a whole expression, does not work with powers...\
\>", "Subsubsection",
 CellChangeTimes->{{3.8020694554645815`*^9, 3.802069482576867*^9}, {
  3.8020798680425873`*^9, 
  3.8020798742550287`*^9}},ExpressionUUID->"ff0b2f07-d24a-4fcc-a7ee-\
cf97d5c52e81"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HelicityWeight3", "[", "exp_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "locexp", ",", "weightplus", ",", "weightminus", ",", "weightequal", ",",
       "pow", ",", "pow2", ",", "out", ",", "final"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "pow", " ", "is", " ", "the", " ", "helicity", " ", "power", " ", "of", 
      " ", "a", " ", "given", " ", "x"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"pow", "[", "x_", "]"}], ":=", "0"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Define", " ", "two", " ", "functions", " ", "which", " ", "raise", " ",
        "and", " ", "lower", " ", "the", " ", "helicity", " ", "power"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"weightplus", "[", "x_", "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"pow", "[", "x", "]"}], "++"}], ";", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"weightminus", "[", "x_", "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"pow", "[", "x", "]"}], "--"}], ";", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"weightequal", "[", "x_", "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"pow", "[", "x", "]"}], "=", 
         RowBox[{"pow", "[", "x", "]"}]}], ";", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Convert", " ", "expression", " ", "into", " ", "a", " ", "list"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"locexp", "=", 
      RowBox[{"Expand", "[", "exp", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "locexp", "]"}], "===", "Plus"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"locexp", "=", 
        RowBox[{"List", "@@", "locexp"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"locexp", "=", 
         RowBox[{"{", "locexp", "}"}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Perform", " ", "selected", " ", "replacements", " ", "in", " ", "each",
        " ", "term", " ", "of", " ", 
       RowBox[{"exp", ".", " ", "We"}], " ", "do", " ", "not", " ", "care", 
       " ", "what", " ", "exp", " ", "becomes", " ", "but", " ", "just", " ", 
       "that", " ", 
       RowBox[{"weightplus", "/", "minus"}], " ", "are", " ", 
       RowBox[{"applied", "."}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"locexp", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"SpinorAngleBracket", "[", 
             RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"weightminus", "[", "x", "]"}], ",", 
              RowBox[{"weightminus", "[", "y", "]"}]}], "}"}]}], ",", 
           RowBox[{
            RowBox[{"SpinorSquareBracket", "[", 
             RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"weightplus", "[", "x", "]"}], ",", 
              RowBox[{"weightplus", "[", "y", "]"}]}], "}"}]}], ",", 
           RowBox[{
            RowBox[{"Chain", "[", 
             RowBox[{"$angle", ",", "x_", ",", 
              RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$angle"}], "]"}], 
            "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"weightminus", "[", "x", "]"}], ",", 
              RowBox[{"weightminus", "[", "z", "]"}], ",", 
              RowBox[{"weightequal", "/@", 
               RowBox[{"{", "y", "}"}]}]}], "}"}]}], ",", 
           RowBox[{
            RowBox[{"Chain", "[", 
             RowBox[{"$angle", ",", "x_", ",", 
              RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$square"}], "]"}], 
            "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"weightminus", "[", "x", "]"}], ",", 
              RowBox[{"weightplus", "[", "z", "]"}], ",", 
              RowBox[{"weightequal", "/@", 
               RowBox[{"{", "y", "}"}]}]}], "}"}]}], ",", 
           RowBox[{
            RowBox[{"Chain", "[", 
             RowBox[{"$square", ",", "x_", ",", 
              RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$angle"}], "]"}], 
            "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"weightplus", "[", "x", "]"}], ",", 
              RowBox[{"weightminus", "[", "z", "]"}], ",", 
              RowBox[{"weightequal", "/@", 
               RowBox[{"{", "y", "}"}]}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Chain", "[", 
             RowBox[{"$square", ",", "x_", ",", 
              RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$square"}], "]"}], 
            "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"weightplus", "[", "x", "]"}], ",", 
              RowBox[{"weightplus", "[", "z", "]"}], ",", 
              RowBox[{"weightequal", "/@", 
               RowBox[{"{", "y", "}"}]}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"mp", "[", 
             RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"weightequal", "[", "x", "]"}], ",", 
              RowBox[{"weightequal", "[", "y", "]"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"S4", "[", 
             RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"weightequal", "[", "x", "]"}], ",", 
              RowBox[{"weightequal", "[", "y", "]"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"S", "[", 
             RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"weightequal", "[", "x", "]"}], ",", 
              RowBox[{"weightequal", "[", "y", "]"}]}], "}"}]}]}], "}"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Extract", " ", "weights", " ", "from", " ", "DownValues", " ", "of",
           " ", 
          RowBox[{"pow", ".", " ", "This"}], " ", "is", " ", "not", " ", "as",
           " ", "straight", " ", "forward", " ", "as", " ", "I", " ", "would",
           " ", "like", " ", "it", " ", "to", " ", "be"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"out", "[", "i", "]"}], "=", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"DownValues", "[", "pow", "]"}], ",", 
           RowBox[{
            RowBox[{"FreeQ", "[", 
             RowBox[{"#", ",", "Pattern"}], "]"}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"out", "[", "i", "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"out", "[", "i", "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{"pow", "\[Rule]", "pow2"}], "}"}]}], "//", 
          "ReleaseHold"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"out", "[", "i", "]"}], "=", 
         RowBox[{
          RowBox[{"out", "[", "i", "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"pow2", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], ",", 
            RowBox[{"RuleDelayed", "\[Rule]", "List"}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Clear", " ", "downvalues", " ", "of", " ", "pow", " ", "to", " ", 
           "be", " ", "ready", " ", "for", " ", "the", " ", "next", " ", 
           "term"}], ",", " ", 
          RowBox[{
          "but", " ", "it", " ", "is", " ", "probably", " ", "faster", " ", 
           "to", " ", "clear", " ", "the", " ", "whole", " ", "pow", " ", 
           "and", " ", "then", " ", "redefine", " ", "it"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Clear", "[", "pow", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"pow", "[", "x_", "]"}], ":=", "0"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "locexp", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Now", " ", "delete", " ", "the", " ", "duplicates", " ", "in", " ", 
         "the", " ", "list", " ", "of", " ", "helicities", " ", "of", " ", 
         "the", " ", "single", " ", 
         RowBox[{"terms", ".", " ", "If"}], " ", "more", " ", "than", " ", 
         "one", " ", "term", " ", "is", " ", "left", " ", "then", " ", 
         "there", " ", "is", " ", "a", " ", "problem", " ", "with", " ", 
         "the", " ", 
         RowBox[{"input", ".", " ", "You"}], " ", "have", " ", "to", " ", 
         "take", " ", "into", " ", "account", " ", "that", " ", 
         RowBox[{
          RowBox[{"\[LeftAngleBracket]", 
           RowBox[{"1", " ", "2"}], "\[RightAngleBracket]"}], "[", 
          RowBox[{"2", " ", "1"}], "]"}], " ", "and", " ", 
         RowBox[{"\[LeftAngleBracket]", 
          RowBox[{"1", " ", "3", " ", "1"}]}]}], "]"}], " ", "have", " ", 
       "the", " ", "same", " ", "weight", " ", "and", " ", "are", " ", 
       RowBox[{"compatible", "."}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"final", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"out", "[", "i", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "locexp", "]"}]}], "}"}]}], "]"}], ",", 
          "1"}], "]"}], "//", "DeleteDuplicates"}], "//", "Sort"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "final", "]"}], "===", 
        RowBox[{"Length", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"final", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"#1", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "==", 
              RowBox[{"#2", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ")"}]}], "]"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "final", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Return", "[", 
         "\"\<Some terms have unequal weights, please check input.\>\"", 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQnazsY3kv+I2jnYiUFYi+eneXPYi+pr/MB0TzNRrF
gegt98trQLTGmYQOEB3xvXsRiN5589dbEC2ZICtwH0h7CkWIg+j8fQvB9IJ6
B3sQLe58zglET/Uz8wPR354YV4PomgucHSD6pYjlFBB9RmrnTBBtw3QCTAsI
7l8LosXCYteB6B+OyjtB9OzbCftANNekykMg+pLHdjAd7sn/GUTrSIuA6TM7
+sUeAOlN+kclQPQTWXtFEO3fdFUFRP+ZeE4XRO/T+WEAoqe2WZuC6B+tPmYg
+pN3pBNYvbOnM4h20WQPANES8xpDQfQVbeEaEC2lENAKop0e7e8F0UJr7k0G
0XL9B6aDaMW9DHNB9LvLu6+C6DevJa6BaADQ0MuI
  "],
 CellLabel->"In[17]:=",ExpressionUUID->"69a82ac3-e6b3-47cc-a7e4-573a148524f0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HelicityWeight3", "[", 
   RowBox[{
    TemplateBox[{"1", "2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], 
    TemplateBox[{"2", "1"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], "]"}], "//", 
  "RepeatedTiming"}]], "Input",
 CellChangeTimes->{{3.802069146584921*^9, 3.8020691585791397`*^9}, {
  3.8020692179901013`*^9, 3.8020692207240534`*^9}, {3.8020702384677076`*^9, 
  3.802070258386628*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"b696f668-48f7-4231-b950-a93f01092a89"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0002788239631336405`2.", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.802069159410637*^9, {3.8020692119938116`*^9, 3.8020692212466507`*^9}, {
   3.802070240682969*^9, 3.8020702594776697`*^9}, 3.8020713466221733`*^9, {
   3.8020788821507196`*^9, 3.802078892585848*^9}},
 CellLabel->"Out[8]=",ExpressionUUID->"9c50adbf-1fd2-4612-9734-5c6d2584b94f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HelicityWeight2", "[", 
   RowBox[{
    TemplateBox[{"1", "2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], 
    TemplateBox[{"2", "1"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], "]"}], "//", 
  "RepeatedTiming"}]], "Input",
 CellChangeTimes->{{3.802070251115734*^9, 3.802070264577648*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"077bba7e-3bf6-4d36-adfa-ec189703589a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.000150426222826087`2.", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8020702523603625`*^9, 3.802070265776425*^9}, 
   3.80207134875144*^9, {3.802078884042696*^9, 3.8020788943042445`*^9}},
 CellLabel->"Out[9]=",ExpressionUUID->"db1f6d5c-f99b-4b1c-818a-570053b7f4a8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "As", " ", "expected", " ", "the", " ", "last", " ", "version", " ", "is", 
    " ", "slower"}], ",", " ", 
   RowBox[{"but", " ", "no", " ", "surprise", " ", "there"}], ",", " ", 
   RowBox[{
   "since", " ", "it", " ", "is", " ", "able", " ", "to", " ", "handle", " ", 
    "more", " ", "complicated", " ", "expressions"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.802070297097376*^9, 
  3.8020703328749194`*^9}},ExpressionUUID->"7eb4d0a6-8c44-4907-abfd-\
4025a0a178c4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HelicityWeight3", "[", 
   RowBox[{
    RowBox[{
     TemplateBox[{"1", "2"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], 
     TemplateBox[{"2", "1"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
    TemplateBox[{"1", 
      RowBox[{"{", "2", "}"}], "1"},
     "AngleSquareChain",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )]}], "]"}], "//", "RepeatedTiming"}]], "Input",
 CellChangeTimes->{{3.802070345484767*^9, 3.8020703572701817`*^9}, {
  3.8020714843955917`*^9, 3.802071487096366*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"c4dfc5eb-3fc5-4a15-ba4e-816195cd6b5a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.000380188127090301`2.", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.802070358487958*^9, 3.8020703905135417`*^9, 3.8020713572756786`*^9, {
   3.802071422537112*^9, 3.8020714375529346`*^9}, {3.802071478504349*^9, 
   3.8020714879760118`*^9}, {3.8020789060528316`*^9, 3.8020789142439127`*^9}},
 CellLabel->"Out[13]=",ExpressionUUID->"6eba4d8a-4c92-4fae-b450-50c8e0a203e4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight3", "[", 
  RowBox[{
   RowBox[{
    TemplateBox[{"1", "2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], 
    TemplateBox[{"2", "1"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
   TemplateBox[{"1", 
     RowBox[{"{", "3", "}"}], "1"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], "]"}]], "Input",
 CellChangeTimes->{{3.802071509588252*^9, 3.802071510778063*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"359e30d9-3b3b-4f83-9c9c-37467b9ecb54"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.802072793050067*^9, 3.8020789170673633`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"ed92fa06-19b6-4c84-97fd-b904f14304a0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight3", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.8020789788640776`*^9, 3.802078983114698*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"429314fd-05b5-49d2-8f41-86b72f9f2966"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.8020789835575075`*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"e576ace2-8917-41ec-a602-6663d2db637a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight3", "[", 
  RowBox[{
   TemplateBox[{"1", "2"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], 
   TemplateBox[{"2", "1"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], 
   RowBox[{
    TemplateBox[{"2", "3"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "^", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.802079365660952*^9, 3.802079367788262*^9}, {
  3.802079493371108*^9, 3.8020794939485693`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"9178c507-9e44-4ddf-8f68-68421eec5ae4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.802079368706806*^9, 3.8020794946207476`*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"e3a0c1ee-95fa-4462-8c3b-18be2157daa7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight3", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      TemplateBox[{"1", "2"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], 
      TemplateBox[{"2", "4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
     TemplateBox[{"1", 
       RowBox[{"{", "3", "}"}], "4"},
      "AngleSquareChain",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
         "$square", "]"}]& )]}], ")"}], "/", 
   TemplateBox[{"1", 
     RowBox[{"{", "2", "}"}], "4"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], "]"}]], "Input",
 CellChangeTimes->{{3.802080150167597*^9, 3.8020802682627125`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"49abd253-cd93-4228-8dfe-e87cebf552c4"],

Cell[BoxData[
 TemplateBox[{
  "Thread", "tdlen", 
   "\"Objects of unequal length in \\!\\(\\*RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"1\\\", \\\",\\\", \\\"1\\\", \\\",\\\", RowBox[{\\\"{\\\", \
\\\"1\\\", \\\"}\\\"}]}], \\\"}\\\"}], \\\" \\\", RowBox[{\\\"{\\\", RowBox[{\
\\\"1\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\" \\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"1\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}]}]\\) cannot be \
combined.\"", 2, 24, 2, 25105406130839072390, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.8020802419454455`*^9, 3.8020802687404675`*^9}},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"4a65f15e-d793-444b-8014-c70ceb6dc185"],

Cell[BoxData[
 TemplateBox[{
  "Thread", "tdlen", 
   "\"Objects of unequal length in \\!\\(\\*RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"1\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\" \\\", RowBox[{\\\
\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"1\\\", \\\",\\\", \
RowBox[{\\\"{\\\", \\\"1\\\", \\\"}\\\"}]}], \\\"}\\\"}]}]\\) cannot be \
combined.\"", 2, 24, 3, 25105406130839072390, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.8020802419454455`*^9, 3.802080268761406*^9}},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"4a707bbd-9532-413c-bfa2-55d73e4c89ca"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.80208018239359*^9, {3.802080213336822*^9, 3.8020802687922907`*^9}},
 CellLabel->"Out[24]=",ExpressionUUID->"e2e402ff-66a5-4569-983f-e22901ae592a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["For application to a whole expression, with powers", "Subsubsection",
 CellChangeTimes->{{3.8020694554645815`*^9, 3.802069482576867*^9}, {
  3.8020798680425873`*^9, 3.8020798742550287`*^9}, {3.802079959519161*^9, 
  3.802079961329304*^9}},ExpressionUUID->"82141fb2-10b9-4cf3-8dfa-\
a7a519e8233b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HelicityWeight4", "[", "exp_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "locexp", ",", "weightplus", ",", "weightminus", ",", "weightequal", ",",
       "pow", ",", "pow2", ",", "out", ",", "final"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "pow", " ", "is", " ", "the", " ", "helicity", " ", "power", " ", "of", 
      " ", "a", " ", "given", " ", "x"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"pow", "[", "x_", "]"}], ":=", "0"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Define", " ", "two", " ", "functions", " ", "which", " ", "raise", " ",
        "and", " ", "lower", " ", "the", " ", "helicity", " ", "power"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"weightplus", "[", "x_", "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"pow", "[", "x", "]"}], "++"}], ";", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"weightminus", "[", "x_", "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"pow", "[", "x", "]"}], "--"}], ";", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"weightequal", "[", "x_", "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"pow", "[", "x", "]"}], "=", 
         RowBox[{"pow", "[", "x", "]"}]}], ";", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Convert", " ", "expression", " ", "into", " ", "a", " ", "list"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"locexp", "=", 
      RowBox[{"Expand", "[", "exp", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "locexp", "]"}], "===", "Plus"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"locexp", "=", 
        RowBox[{"List", "@@", "locexp"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"locexp", "=", 
         RowBox[{"{", "locexp", "}"}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Perform", " ", "selected", " ", "replacements", " ", "in", " ", "each",
        " ", "term", " ", "of", " ", 
       RowBox[{"exp", ".", " ", "We"}], " ", "do", " ", "not", " ", "care", 
       " ", "what", " ", "exp", " ", "becomes", " ", "but", " ", "just", " ", 
       "that", " ", 
       RowBox[{"weightplus", "/", "minus"}], " ", "are", " ", 
       RowBox[{"applied", "."}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"locexp", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"SpinorAngleBracket", "[", 
             RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"weightminus", "[", "x", "]"}], ",", 
              RowBox[{"weightminus", "[", "y", "]"}]}], "}"}]}], ",", 
           RowBox[{
            RowBox[{"SpinorSquareBracket", "[", 
             RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"weightplus", "[", "x", "]"}], ",", 
              RowBox[{"weightplus", "[", "y", "]"}]}], "}"}]}], ",", 
           RowBox[{
            RowBox[{"Chain", "[", 
             RowBox[{"$angle", ",", "x_", ",", 
              RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$angle"}], "]"}], 
            "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"weightminus", "[", "x", "]"}], ",", 
              RowBox[{"weightminus", "[", "z", "]"}], ",", 
              RowBox[{"weightequal", "/@", 
               RowBox[{"{", "y", "}"}]}]}], "}"}]}], ",", 
           RowBox[{
            RowBox[{"Chain", "[", 
             RowBox[{"$angle", ",", "x_", ",", 
              RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$square"}], "]"}], 
            "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"weightminus", "[", "x", "]"}], ",", 
              RowBox[{"weightplus", "[", "z", "]"}], ",", 
              RowBox[{"weightequal", "/@", 
               RowBox[{"{", "y", "}"}]}]}], "}"}]}], ",", 
           RowBox[{
            RowBox[{"Chain", "[", 
             RowBox[{"$square", ",", "x_", ",", 
              RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$angle"}], "]"}], 
            "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"weightplus", "[", "x", "]"}], ",", 
              RowBox[{"weightminus", "[", "z", "]"}], ",", 
              RowBox[{"weightequal", "/@", 
               RowBox[{"{", "y", "}"}]}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Chain", "[", 
             RowBox[{"$square", ",", "x_", ",", 
              RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$square"}], "]"}], 
            "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"weightplus", "[", "x", "]"}], ",", 
              RowBox[{"weightplus", "[", "z", "]"}], ",", 
              RowBox[{"weightequal", "/@", 
               RowBox[{"{", "y", "}"}]}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"mp", "[", 
             RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"weightequal", "[", "x", "]"}], ",", 
              RowBox[{"weightequal", "[", "y", "]"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"S4", "[", 
             RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"weightequal", "[", "x", "]"}], ",", 
              RowBox[{"weightequal", "[", "y", "]"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"S", "[", 
             RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"weightequal", "[", "x", "]"}], ",", 
              RowBox[{"weightequal", "[", "y", "]"}]}], "}"}]}]}], "}"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Extract", " ", "weights", " ", "from", " ", "DownValues", " ", "of",
           " ", 
          RowBox[{"pow", ".", " ", "This"}], " ", "is", " ", "not", " ", "as",
           " ", "straight", " ", "forward", " ", "as", " ", "I", " ", "would",
           " ", "like", " ", "it", " ", "to", " ", "be"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"out", "[", "i", "]"}], "=", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"DownValues", "[", "pow", "]"}], ",", 
           RowBox[{
            RowBox[{"FreeQ", "[", 
             RowBox[{"#", ",", "Pattern"}], "]"}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"out", "[", "i", "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"out", "[", "i", "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{"pow", "\[Rule]", "pow2"}], "}"}]}], "//", 
          "ReleaseHold"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"out", "[", "i", "]"}], "=", 
         RowBox[{
          RowBox[{"out", "[", "i", "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"pow2", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], ",", 
            RowBox[{"RuleDelayed", "\[Rule]", "List"}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Clear", " ", "downvalues", " ", "of", " ", "pow", " ", "to", " ", 
           "be", " ", "ready", " ", "for", " ", "the", " ", "next", " ", 
           "term"}], ",", " ", 
          RowBox[{
          "but", " ", "it", " ", "is", " ", "probably", " ", "faster", " ", 
           "to", " ", "clear", " ", "the", " ", "whole", " ", "pow", " ", 
           "and", " ", "then", " ", "redefine", " ", "it"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Clear", "[", "pow", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"pow", "[", "x_", "]"}], ":=", "0"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "locexp", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Now", " ", "delete", " ", "the", " ", "duplicates", " ", "in", " ", 
         "the", " ", "list", " ", "of", " ", "helicities", " ", "of", " ", 
         "the", " ", "single", " ", 
         RowBox[{"terms", ".", " ", "If"}], " ", "more", " ", "than", " ", 
         "one", " ", "term", " ", "is", " ", "left", " ", "then", " ", 
         "there", " ", "is", " ", "a", " ", "problem", " ", "with", " ", 
         "the", " ", 
         RowBox[{"input", ".", " ", "You"}], " ", "have", " ", "to", " ", 
         "take", " ", "into", " ", "account", " ", "that", " ", 
         RowBox[{
          RowBox[{"\[LeftAngleBracket]", 
           RowBox[{"1", " ", "2"}], "\[RightAngleBracket]"}], "[", 
          RowBox[{"2", " ", "1"}], "]"}], " ", "and", " ", 
         RowBox[{"\[LeftAngleBracket]", 
          RowBox[{"1", " ", "3", " ", "1"}]}]}], "]"}], " ", "have", " ", 
       "the", " ", "same", " ", "weight", " ", "and", " ", "are", " ", 
       RowBox[{"compatible", "."}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"final", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"out", "[", "i", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "locexp", "]"}]}], "}"}]}], "]"}], ",", 
          "1"}], "]"}], "//", "DeleteDuplicates"}], "//", "Sort"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "final", "]"}], "===", 
        RowBox[{"Length", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"final", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"#1", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "==", 
              RowBox[{"#2", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ")"}]}], "]"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "final", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Return", "[", 
         "\"\<Some terms have unequal weights, please check input.\>\"", 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQnazsY3kv+I2jnYiUFYi+eneXPYi+pr/MB0TzNRrF
gegt98trQLTGmYQOEB3xvXsRiN5589dbEC2ZICtwH0h7CkWIg+j8fQvB9IJ6
B3sQLe58zglET/Uz8wPR354YV4PomgucHSD6pYjlFBB9RmrnTBBtw3QCTAsI
7l8LosXCYteB6B+OyjtB9OzbCftANNekykMg+pLHdjAd7sn/GUTrSIuA6TM7
+sUeAOlN+kclQPQTWXtFEO3fdFUFRP+ZeE4XRO/T+WEAoqe2WZuC6B+tPmYg
+pN3pBNYvbOnM4h20WQPANES8xpDQfQVbeEaEC2lENAKop0e7e8F0UJr7k0G
0XL9B6aDaMW9DHNB9LvLu6+C6DevJa6BaKZrRVFPgDSnBn8CiAYAxyHSlQ==

  "],ExpressionUUID->"26d957d8-91aa-457a-b5fc-5d39f47e76f9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HelicityWeight3", "[", 
   RowBox[{
    TemplateBox[{"1", "2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], 
    TemplateBox[{"2", "1"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], "]"}], "//", 
  "RepeatedTiming"}]], "Input",
 CellChangeTimes->{{3.802069146584921*^9, 3.8020691585791397`*^9}, {
  3.8020692179901013`*^9, 3.8020692207240534`*^9}, {3.8020702384677076`*^9, 
  3.802070258386628*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"bf2c5b4d-1961-4b42-b78e-d96330b5da4b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0002788239631336405`2.", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.802069159410637*^9, {3.8020692119938116`*^9, 3.8020692212466507`*^9}, {
   3.802070240682969*^9, 3.8020702594776697`*^9}, 3.8020713466221733`*^9, {
   3.8020788821507196`*^9, 3.802078892585848*^9}},
 CellLabel->"Out[8]=",ExpressionUUID->"9e5af16d-287b-43f9-8e47-978a9f957485"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HelicityWeight2", "[", 
   RowBox[{
    TemplateBox[{"1", "2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], 
    TemplateBox[{"2", "1"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], "]"}], "//", 
  "RepeatedTiming"}]], "Input",
 CellChangeTimes->{{3.802070251115734*^9, 3.802070264577648*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"a0183b31-49ab-4c5c-b33b-d40c4fee5d78"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.000150426222826087`2.", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8020702523603625`*^9, 3.802070265776425*^9}, 
   3.80207134875144*^9, {3.802078884042696*^9, 3.8020788943042445`*^9}},
 CellLabel->"Out[9]=",ExpressionUUID->"7dd7ea50-db83-4f13-9b1d-acfc7ac12440"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "As", " ", "expected", " ", "the", " ", "last", " ", "version", " ", "is", 
    " ", "slower"}], ",", " ", 
   RowBox[{"but", " ", "no", " ", "surprise", " ", "there"}], ",", " ", 
   RowBox[{
   "since", " ", "it", " ", "is", " ", "able", " ", "to", " ", "handle", " ", 
    "more", " ", "complicated", " ", "expressions"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.802070297097376*^9, 
  3.8020703328749194`*^9}},ExpressionUUID->"991fbf32-5775-489d-bb21-\
c61ab7a01d46"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HelicityWeight3", "[", 
   RowBox[{
    RowBox[{
     TemplateBox[{"1", "2"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], 
     TemplateBox[{"2", "1"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
    TemplateBox[{"1", 
      RowBox[{"{", "2", "}"}], "1"},
     "AngleSquareChain",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )]}], "]"}], "//", "RepeatedTiming"}]], "Input",
 CellChangeTimes->{{3.802070345484767*^9, 3.8020703572701817`*^9}, {
  3.8020714843955917`*^9, 3.802071487096366*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"95a703c1-b35a-4fc9-971d-758e4d19ecd0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.000380188127090301`2.", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.802070358487958*^9, 3.8020703905135417`*^9, 3.8020713572756786`*^9, {
   3.802071422537112*^9, 3.8020714375529346`*^9}, {3.802071478504349*^9, 
   3.8020714879760118`*^9}, {3.8020789060528316`*^9, 3.8020789142439127`*^9}},
 CellLabel->"Out[13]=",ExpressionUUID->"4e6a63b5-c08e-4b65-9428-7d394a07ff85"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight3", "[", 
  RowBox[{
   RowBox[{
    TemplateBox[{"1", "2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], 
    TemplateBox[{"2", "1"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
   TemplateBox[{"1", 
     RowBox[{"{", "3", "}"}], "1"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], "]"}]], "Input",
 CellChangeTimes->{{3.802071509588252*^9, 3.802071510778063*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"20bdea6a-8099-4dcf-9e02-26e9fec1f638"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.802072793050067*^9, 3.8020789170673633`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"d3840013-22d5-4afd-9455-be42e1f42e30"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight3", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.8020789788640776`*^9, 3.802078983114698*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"89aaeb50-6dab-41af-9dcf-b7b29f963a06"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.8020789835575075`*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"ee6ad077-0b58-470c-957f-467e3571341d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight3", "[", 
  RowBox[{
   TemplateBox[{"1", "2"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], 
   TemplateBox[{"2", "1"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], 
   RowBox[{
    TemplateBox[{"2", "3"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "^", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.802079365660952*^9, 3.802079367788262*^9}, {
  3.802079493371108*^9, 3.8020794939485693`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"41f8b073-4649-4d27-a8c6-bd5ea69f630a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.802079368706806*^9, 3.8020794946207476`*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"8086c03c-b35c-42c4-87ee-8822c874af21"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Helicity weight again, still not satisfied", "Section",
 CellChangeTimes->{{3.8020807805127745`*^9, 3.802080785348871*^9}, {
  3.802085240924094*^9, 
  3.802085245237483*^9}},ExpressionUUID->"f885fe27-b543-4c91-adf0-\
4bbfb4ad8326"],

Cell[CellGroupData[{

Cell["The function", "Subsection",
 CellChangeTimes->{{3.8020807892693977`*^9, 
  3.802080791944228*^9}},ExpressionUUID->"940de3d5-9615-4fd7-bac3-\
93ffe6b1bf64"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"HelicityWeight5", "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "weight", ",", "pow", ",", "locexp", ",", "local", ",", "out", ",", 
       "len", ",", "Print"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "If", " ", "input", " ", "is", " ", "a", " ", "sum", " ", "of", " ", 
       "terms", " ", "transform", " ", "it", " ", "in", " ", "a", " ", "list",
        " ", "so", " ", "to", " ", "work", " ", "on", " ", "each", " ", 
       "element", " ", "of", " ", "the", " ", "list", " ", "separately"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"locexp", "=", 
       RowBox[{"exp", "//", "Expand"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "locexp", "]"}], "===", "Plus"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"locexp", "=", 
         RowBox[{"List", "@@", "locexp"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"locexp", "=", 
          RowBox[{"{", "locexp", "}"}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Set", " ", "counter", " ", "to", " ", "zero"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pow", "[", "x_", "]"}], ":=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Replace", " ", "every", " ", "object", " ", "with", " ", "a", " ", 
         "weight", " ", "function", " ", "with", " ", "appropriate", " ", 
         "weight"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"local", "=", 
          RowBox[{
           RowBox[{"locexp", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"SpinorAngleBracket", "[", 
               RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
              RowBox[{
               RowBox[{"weight", "[", 
                RowBox[{"x", ",", 
                 RowBox[{"-", "1"}]}], "]"}], 
               RowBox[{"weight", "[", 
                RowBox[{"y", ",", 
                 RowBox[{"-", "1"}]}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{"SpinorSquareBracket", "[", 
               RowBox[{"x_", ",", "y_"}], "]"}], ":>", 
              RowBox[{
               RowBox[{"weight", "[", 
                RowBox[{"x", ",", "1"}], "]"}], 
               RowBox[{"weight", "[", 
                RowBox[{"y", ",", "1"}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{"Chain", "[", 
               RowBox[{"$angle", ",", "x_", ",", 
                RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$angle"}], "]"}], 
              "\[RuleDelayed]", 
              RowBox[{
               RowBox[{"weight", "[", 
                RowBox[{"x", ",", 
                 RowBox[{"-", "1"}]}], "]"}], 
               RowBox[{"weight", "[", 
                RowBox[{"z", ",", 
                 RowBox[{"-", "1"}]}], "]"}], 
               RowBox[{"Product", "[", 
                RowBox[{
                 RowBox[{"weight", "[", 
                  RowBox[{"j", ",", "0"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", 
                   RowBox[{"{", "y", "}"}]}], "}"}]}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{"Chain", "[", 
               RowBox[{"$angle", ",", "x_", ",", 
                RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$square"}], "]"}],
               "\[RuleDelayed]", 
              RowBox[{
               RowBox[{"weight", "[", 
                RowBox[{"x", ",", 
                 RowBox[{"-", "1"}]}], "]"}], 
               RowBox[{"weight", "[", 
                RowBox[{"z", ",", "1"}], "]"}], 
               RowBox[{"Product", "[", 
                RowBox[{
                 RowBox[{"weight", "[", 
                  RowBox[{"j", ",", "0"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", 
                   RowBox[{"{", "y", "}"}]}], "}"}]}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{"Chain", "[", 
               RowBox[{"$square", ",", "x_", ",", 
                RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$angle"}], "]"}], 
              "\[RuleDelayed]", 
              RowBox[{
               RowBox[{"weight", "[", 
                RowBox[{"x", ",", "1"}], "]"}], 
               RowBox[{"weight", "[", 
                RowBox[{"z", ",", 
                 RowBox[{"-", "1"}]}], "]"}], 
               RowBox[{"Product", "[", 
                RowBox[{
                 RowBox[{"weight", "[", 
                  RowBox[{"j", ",", "0"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", 
                   RowBox[{"{", "y", "}"}]}], "}"}]}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Chain", "[", 
               RowBox[{"$square", ",", "x_", ",", 
                RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$square"}], "]"}],
               "\[RuleDelayed]", 
              RowBox[{
               RowBox[{"weight", "[", 
                RowBox[{"x", ",", "1"}], "]"}], 
               RowBox[{"weight", "[", 
                RowBox[{"z", ",", "1"}], "]"}], 
               RowBox[{"Product", "[", 
                RowBox[{
                 RowBox[{"weight", "[", 
                  RowBox[{"j", ",", "0"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", 
                   RowBox[{"{", "y", "}"}]}], "}"}]}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{"mp", "[", 
               RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
              RowBox[{
               RowBox[{"weight", "[", 
                RowBox[{"x", ",", "0"}], "]"}], 
               RowBox[{"weight", "[", 
                RowBox[{"y", ",", "0"}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{"S", "[", 
               RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
              RowBox[{
               RowBox[{"weight", "[", 
                RowBox[{"x", ",", "0"}], "]"}], 
               RowBox[{"weight", "[", 
                RowBox[{"y", ",", "0"}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{"S4", "[", 
               RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
              RowBox[{
               RowBox[{"weight", "[", 
                RowBox[{"x", ",", "0"}], "]"}], 
               RowBox[{"weight", "[", 
                RowBox[{"y", ",", "0"}], "]"}]}]}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "local", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Remove", " ", "everything", " ", "which", " ", "has", " ", "no", 
           " ", 
           RowBox[{"weight", ":"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"local", "=", 
          RowBox[{"local", "/.", 
           RowBox[{
            RowBox[{
             RowBox[{"Times", "[", 
              RowBox[{"A_", ",", 
               RowBox[{"weight", "[", "x__", "]"}]}], "]"}], "/;", 
             RowBox[{"FreeQ", "[", 
              RowBox[{"A", ",", "weight"}], "]"}]}], "\[RuleDelayed]", 
            RowBox[{"weight", "[", "x", "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "local", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Take", " ", "powers", " ", "into", " ", "account", " ", "and", " ",
            "recollect", " ", "weights"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"local", "=", 
          RowBox[{"local", "//.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"weight", "[", 
                 RowBox[{"x_", ",", "n_"}], "]"}], ",", "m_"}], "]"}], 
              "\[RuleDelayed]", 
              RowBox[{"weight", "[", 
               RowBox[{"x", ",", 
                RowBox[{"n", "*", "m"}]}], "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"weight", "[", 
                RowBox[{"x_", ",", "n_"}], "]"}], "*", 
               RowBox[{"weight", "[", 
                RowBox[{"x_", ",", "m_"}], "]"}]}], "\[RuleDelayed]", 
              RowBox[{"weight", "[", 
               RowBox[{"x", ",", 
                RowBox[{"n", "+", "m"}]}], "]"}]}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "local", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Do", " ", "the", " ", "power", " ", "counting"}], ",", 
           " ", 
           RowBox[{
           "first", " ", "the", " ", "terms", " ", "which", " ", "carry", " ",
             "weight", " ", 
            RowBox[{"zero", ".", " ", "These"}], " ", "must", " ", "be", " ", 
            "stored", " ", "and", " ", "then", " ", "removed", " ", "in", " ",
             "order", " ", "to", " ", "allow", " ", "the", " ", "correct", 
            " ", "counting", " ", "of", " ", "the", " ", "terms", " ", 
            "which", " ", "actually", " ", "have", " ", "weight"}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"local", "=", 
          RowBox[{"local", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"weight", "[", 
              RowBox[{"x_", ",", "0"}], "]"}], "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"pow", "[", "i", "]"}], "=", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"pow", "[", "i", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{"x", ",", "0"}], "}"}], "}"}]}], "]"}]}], ";", 
               "1"}], ")"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Now", " ", "count", " ", "whatever", " ", "has", " ", "actually", 
           " ", "a", " ", "spinor", " ", "power"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"local", "=", 
          RowBox[{"local", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"weight", "[", 
              RowBox[{"x_", ",", "n_"}], "]"}], "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"pow", "[", "i", "]"}], "=", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"pow", "[", "i", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{"x", ",", "n"}], "}"}], "}"}]}], "]"}]}], ";", 
               "1"}], ")"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"len", "=", 
           RowBox[{"Length", "[", "locexp", "]"}]}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"out", "=", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"pow", "[", "i", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "len"}], "}"}]}], "]"}], ",", "1"}], "]"}], "//",
         "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Check", " ", "if", " ", "there", " ", "are", " ", "terms", " ", "in", 
        " ", "the", " ", "expression", " ", "which", " ", "have", " ", "a", 
        " ", "different", " ", "weight"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "out", "]"}], "===", 
         RowBox[{"Length", "[", 
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"out", ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "==", 
               RowBox[{"#2", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ")"}]}], "]"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "out", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Return", "[", 
          "\"\<Some terms have unequal weights, please check input.\>\"", 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8020807931768923`*^9, 3.802081330918426*^9}, {
  3.8020814419095407`*^9, 3.802081502673003*^9}, {3.8020816004574647`*^9, 
  3.8020817211748486`*^9}, {3.802081792333579*^9, 3.8020819431628637`*^9}, {
  3.8020819918649373`*^9, 3.8020820076566715`*^9}, {3.802082202466592*^9, 
  3.8020822117198553`*^9}, {3.8020823086485853`*^9, 3.8020824498900394`*^9}, {
  3.802082499017579*^9, 3.8020825808616605`*^9}, {3.8020826245787783`*^9, 
  3.8020826831590652`*^9}, {3.8020827875579147`*^9, 3.80208292562388*^9}, {
  3.80208304318449*^9, 3.8020830436831565`*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"ce25dea9-2c47-46a5-a1d6-01073b3a9f5c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight5", "[", 
  RowBox[{
   TemplateBox[{"1", "2"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], 
   TemplateBox[{"2", "1"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}], "]"}]], "Input",
 CellChangeTimes->{{3.802082480711585*^9, 3.802082481050644*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"f48e0344-0c8d-44d9-9dd8-a2b7e7c6b127"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "0"}], "}"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.8020824823910847`*^9, 3.8020825825042973`*^9}, {
  3.8020826590495567`*^9, 3.802082688172654*^9}},
 CellLabel->"Out[41]=",ExpressionUUID->"4bc08384-5081-40e1-8368-58378a1b7b00"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HelicityWeight5", "[", 
   RowBox[{
    TemplateBox[{"1", "2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], 
    TemplateBox[{"2", "1"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], "]"}], "//", 
  "RepeatedTiming"}]], "Input",
 CellChangeTimes->{{3.802069146584921*^9, 3.8020691585791397`*^9}, {
  3.8020692179901013`*^9, 3.8020692207240534`*^9}, {3.8020702384677076`*^9, 
  3.802070258386628*^9}, {3.8020826998593636`*^9, 3.8020827002962427`*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"383d996b-e441-42e2-beb9-8356181e337c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0003706331730769232`2.", ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "0"}], "}"}]}], "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.802069159410637*^9, {3.8020692119938116`*^9, 3.8020692212466507`*^9}, {
   3.802070240682969*^9, 3.8020702594776697`*^9}, 3.8020713466221733`*^9, {
   3.8020788821507196`*^9, 3.802078892585848*^9}, {3.8020827020525227`*^9, 
   3.802082709335128*^9}},
 CellLabel->"Out[45]=",ExpressionUUID->"c05f3d21-673e-4fa5-8c29-cfc4af20e732"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "As", " ", "expected", " ", "the", " ", "last", " ", "version", " ", "is", 
    " ", "slower"}], ",", " ", 
   RowBox[{"but", " ", "no", " ", "surprise", " ", "there"}], ",", " ", 
   RowBox[{
   "since", " ", "it", " ", "is", " ", "able", " ", "to", " ", "handle", " ", 
    "more", " ", "complicated", " ", "expressions"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.802070297097376*^9, 
  3.8020703328749194`*^9}},ExpressionUUID->"ba7704af-6471-414f-9e3c-\
cbf9c69b9ff0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight5", "[", 
  RowBox[{
   RowBox[{
    TemplateBox[{"1", "2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], 
    TemplateBox[{"2", "1"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
   TemplateBox[{"1", 
     RowBox[{"{", "2", "}"}], "1"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], "]"}]], "Input",
 CellChangeTimes->{{3.8020827673379526`*^9, 3.802082767687066*^9}, {
  3.8020829376158605`*^9, 3.802082950385661*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"3725f4e0-d37f-442b-af1a-43bfe6bf4cc7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8020827686584144`*^9, 3.802082824384867*^9, {3.802082932331938*^9, 
   3.802082950855406*^9}},
 CellLabel->"Out[52]=",ExpressionUUID->"391c338b-1223-4733-9598-a8c031026822"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HelicityWeight5", "[", 
   RowBox[{
    RowBox[{
     TemplateBox[{"1", "2"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], 
     TemplateBox[{"2", "1"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
    TemplateBox[{"1", 
      RowBox[{"{", "2", "}"}], "1"},
     "AngleSquareChain",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )]}], "]"}], "//", "RepeatedTiming"}]], "Input",
 CellChangeTimes->{{3.802070345484767*^9, 3.8020703572701817`*^9}, {
  3.8020714843955917`*^9, 3.802071487096366*^9}, {3.802082956341777*^9, 
  3.802082956662923*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"8caca1cd-1651-4057-bcf1-e43b2f35942a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.000522214712153518`2.", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.802070358487958*^9, 3.8020703905135417`*^9, 3.8020713572756786`*^9, {
   3.802071422537112*^9, 3.8020714375529346`*^9}, {3.802071478504349*^9, 
   3.8020714879760118`*^9}, {3.8020789060528316`*^9, 
   3.8020789142439127`*^9}, {3.8020829527044907`*^9, 3.8020829697130117`*^9}},
 CellLabel->"Out[58]=",ExpressionUUID->"6c62b531-f2fe-46d5-9b60-38e08783cf59"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight3", "[", 
  RowBox[{
   RowBox[{
    TemplateBox[{"1", "2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], 
    TemplateBox[{"2", "1"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
   TemplateBox[{"1", 
     RowBox[{"{", "3", "}"}], "1"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], "]"}]], "Input",
 CellChangeTimes->{{3.802071509588252*^9, 3.802071510778063*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"9310f95f-88e5-4e45-b298-1603b938ac9e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.802072793050067*^9, 3.8020789170673633`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"bb4dcff7-a696-464e-ac25-2d018579d89b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight5", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.8020789788640776`*^9, 3.802078983114698*^9}, {
  3.802083083884059*^9, 3.8020830842750645`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"3f586213-6693-43f1-953f-b342602baf4a"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.8020789835575075`*^9, 3.8020830855735383`*^9},
 CellLabel->"Out[64]=",ExpressionUUID->"4a276caa-0f9b-4ca0-a31f-2e9fb90f5776"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight5", "[", 
  RowBox[{
   TemplateBox[{"1", "2"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], 
   TemplateBox[{"2", "1"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], 
   RowBox[{
    TemplateBox[{"2", "3"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "^", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.802079365660952*^9, 3.802079367788262*^9}, {
   3.802079493371108*^9, 3.8020794939485693`*^9}, {3.8020829904455395`*^9, 
   3.8020830202927237`*^9}, 3.8020830610581155`*^9},
 CellLabel->"In[63]:=",ExpressionUUID->"77fc2523-3ab5-412a-b343-f04af6978282"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.802079368706806*^9, 3.8020794946207476`*^9, {3.8020829916882153`*^9, 
   3.8020830209250145`*^9}, {3.8020830573090982`*^9, 3.8020830635684333`*^9}},
 CellLabel->"Out[63]=",ExpressionUUID->"a003b919-b9b8-42ad-9b7b-c17d1efe659e"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Failed try...", "Subsection",
 CellChangeTimes->{{3.8020847277108107`*^9, 3.802084735577756*^9}, {
  3.802084975733283*^9, 
  3.8020849786065793`*^9}},ExpressionUUID->"c903ae61-31f5-49e2-a9c4-\
e00b200ff30a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HelicityWeight7", "[", "exp_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"weight", ",", "pow", ",", "local", ",", "len", ",", "test"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pow", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Replace", " ", "every", " ", "object", " ", "with", " ", "a", " ", 
       "weight", " ", "function", " ", "with", " ", "appropriate", " ", 
       "weight"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"local", "=", 
      RowBox[{"exp", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"weight", "[", 
            RowBox[{"x", ",", 
             RowBox[{"-", "1"}]}], "]"}], 
           RowBox[{"weight", "[", 
            RowBox[{"y", ",", 
             RowBox[{"-", "1"}]}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"x_", ",", "y_"}], "]"}], ":>", 
          RowBox[{
           RowBox[{"weight", "[", 
            RowBox[{"x", ",", "1"}], "]"}], 
           RowBox[{"weight", "[", 
            RowBox[{"y", ",", "1"}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Chain", "[", 
           RowBox[{"$angle", ",", "x_", ",", 
            RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$angle"}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"weight", "[", 
            RowBox[{"x", ",", 
             RowBox[{"-", "1"}]}], "]"}], 
           RowBox[{"weight", "[", 
            RowBox[{"z", ",", 
             RowBox[{"-", "1"}]}], "]"}], 
           RowBox[{"Product", "[", 
            RowBox[{
             RowBox[{"weight", "[", 
              RowBox[{"j", ",", "0"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"{", "y", "}"}]}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Chain", "[", 
           RowBox[{"$angle", ",", "x_", ",", 
            RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$square"}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"weight", "[", 
            RowBox[{"x", ",", 
             RowBox[{"-", "1"}]}], "]"}], 
           RowBox[{"weight", "[", 
            RowBox[{"z", ",", "1"}], "]"}], 
           RowBox[{"Product", "[", 
            RowBox[{
             RowBox[{"weight", "[", 
              RowBox[{"j", ",", "0"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"{", "y", "}"}]}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Chain", "[", 
           RowBox[{"$square", ",", "x_", ",", 
            RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$angle"}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"weight", "[", 
            RowBox[{"x", ",", "1"}], "]"}], 
           RowBox[{"weight", "[", 
            RowBox[{"z", ",", 
             RowBox[{"-", "1"}]}], "]"}], 
           RowBox[{"Product", "[", 
            RowBox[{
             RowBox[{"weight", "[", 
              RowBox[{"j", ",", "0"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"{", "y", "}"}]}], "}"}]}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Chain", "[", 
           RowBox[{"$square", ",", "x_", ",", 
            RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$square"}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"weight", "[", 
            RowBox[{"x", ",", "1"}], "]"}], 
           RowBox[{"weight", "[", 
            RowBox[{"z", ",", "1"}], "]"}], 
           RowBox[{"Product", "[", 
            RowBox[{
             RowBox[{"weight", "[", 
              RowBox[{"j", ",", "0"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"{", "y", "}"}]}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"mp", "[", 
           RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"weight", "[", 
            RowBox[{"x", ",", "0"}], "]"}], 
           RowBox[{"weight", "[", 
            RowBox[{"y", ",", "0"}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"weight", "[", 
            RowBox[{"x", ",", "0"}], "]"}], 
           RowBox[{"weight", "[", 
            RowBox[{"y", ",", "0"}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"S4", "[", 
           RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"weight", "[", 
            RowBox[{"x", ",", "0"}], "]"}], 
           RowBox[{"weight", "[", 
            RowBox[{"y", ",", "0"}], "]"}]}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Remove", " ", "everything", " ", "which", " ", "has", " ", "no", " ", 
       RowBox[{"weight", ":"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"local", "=", 
      RowBox[{"local", "/.", 
       RowBox[{
        RowBox[{
         RowBox[{"Times", "[", 
          RowBox[{"A_", ",", 
           RowBox[{"weight", "[", "x__", "]"}]}], "]"}], "/;", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"A", ",", "weight"}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{"weight", "[", "x", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Take", " ", "powers", " ", "into", " ", "account", " ", "and", " ", 
       "recollect", " ", "weights"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"local", "=", 
      RowBox[{"local", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"weight", "[", 
             RowBox[{"x_", ",", "n_"}], "]"}], ",", "m_"}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{"weight", "[", 
           RowBox[{"x", ",", 
            RowBox[{"n", "*", "m"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"weight", "[", 
            RowBox[{"x_", ",", "n_"}], "]"}], "*", 
           RowBox[{"weight", "[", 
            RowBox[{"x_", ",", "m_"}], "]"}]}], "\[RuleDelayed]", 
          RowBox[{"weight", "[", 
           RowBox[{"x", ",", 
            RowBox[{"n", "+", "m"}]}], "]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Do", " ", "the", " ", "power", " ", "counting"}], ",", " ", 
       RowBox[{
       "first", " ", "the", " ", "terms", " ", "which", " ", "carry", " ", 
        "weight", " ", 
        RowBox[{"zero", ".", " ", "These"}], " ", "must", " ", "be", " ", 
        "stored", " ", "and", " ", "then", " ", "removed", " ", "in", " ", 
        "order", " ", "to", " ", "allow", " ", "the", " ", "correct", " ", 
        "counting", " ", "of", " ", "the", " ", "terms", " ", "which", " ", 
        "actually", " ", "have", " ", "weight"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"local", "=", 
      RowBox[{"local", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"weight", "[", 
           RowBox[{"x_", ",", "0"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"pow", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"pow", ",", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "0"}], "}"}], "}"}]}], "]"}]}], ";", "1"}],
            ")"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"weight", "[", 
            RowBox[{"x_", ",", "n_"}], "]"}], "*", 
           RowBox[{"weight", "[", 
            RowBox[{"x_", ",", "m_"}], "]"}]}], "\[RuleDelayed]", 
          RowBox[{"weight", "[", 
           RowBox[{"x", ",", 
            RowBox[{"n", "+", "m"}]}], "]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Now", " ", "count", " ", "whatever", " ", "has", " ", "actually", " ", 
       "a", " ", "spinor", " ", "power"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"local", "=", 
      RowBox[{"local", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"weight", "[", 
          RowBox[{"x_", ",", "n_"}], "]"}], "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pow", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"pow", ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"x", ",", "n"}], "}"}], "}"}]}], "]"}]}], ";", "1"}], 
          ")"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Check", " ", "if", " ", "there", " ", "are", " ", "terms", " ", "in", 
       " ", "the", " ", "expression", " ", "which", " ", "have", " ", "a", 
       " ", "different", " ", "weight"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"test", "=", 
      RowBox[{"local", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Plus", "[", 
           RowBox[{"A_", ",", "B__"}], "]"}], "/;", 
          RowBox[{"!", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"A", ",", "weight"}], "]"}]}]}], "\[RuleDelayed]", 
         "$Failed"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FreeQ", "[", 
        RowBox[{"test", ",", "$Failed"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"pow", "//", "DeleteDuplicates"}], "//", "Sort"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Return", "[", 
         "\"\<Some terms have unequal weights, please check input.\>\"", 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8020831172104325`*^9, 3.802083144977332*^9}, {
   3.802083218312173*^9, 3.8020833180991545`*^9}, {3.802083352078317*^9, 
   3.8020833524901714`*^9}, {3.802083542283578*^9, 3.80208355941571*^9}, {
   3.8020836584837446`*^9, 3.802083666984844*^9}, {3.802083705907749*^9, 
   3.8020837419184275`*^9}, {3.8020838409874344`*^9, 
   3.8020838671391354`*^9}, {3.8020839122135715`*^9, 
   3.8020839201882277`*^9}, {3.8020842027615066`*^9, 3.8020842334753056`*^9}, 
   3.8020843311719823`*^9, {3.802084500156065*^9, 3.802084515057906*^9}, {
   3.8020845464400125`*^9, 3.80208460278893*^9}, {3.8020846340662823`*^9, 
   3.8020846757567644`*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"dba526c9-8a1b-4831-a6db-10ecba4eb03c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Final version (hopefully)", "Subsection",
 CellChangeTimes->{{3.802083104894375*^9, 3.8020831107357526`*^9}, {
  3.8020849961516933`*^9, 
  3.802085003251684*^9}},ExpressionUUID->"cacf0f5d-838b-4698-b043-\
c2a6c4fdcd48"],

Cell[BoxData[
 RowBox[{
  RowBox[{"helicityweightaux", "[", "exp_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"weight", ",", "pow", ",", "local", ",", "len"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pow", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Replace", " ", "every", " ", "object", " ", "with", " ", "a", " ", 
       "weight", " ", "function", " ", "with", " ", "appropriate", " ", 
       "weight"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"local", "=", 
      RowBox[{"exp", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"weight", "[", 
            RowBox[{"x", ",", 
             RowBox[{"-", "1"}]}], "]"}], 
           RowBox[{"weight", "[", 
            RowBox[{"y", ",", 
             RowBox[{"-", "1"}]}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"x_", ",", "y_"}], "]"}], ":>", 
          RowBox[{
           RowBox[{"weight", "[", 
            RowBox[{"x", ",", "1"}], "]"}], 
           RowBox[{"weight", "[", 
            RowBox[{"y", ",", "1"}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Chain", "[", 
           RowBox[{"$angle", ",", "x_", ",", 
            RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$angle"}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"weight", "[", 
            RowBox[{"x", ",", 
             RowBox[{"-", "1"}]}], "]"}], 
           RowBox[{"weight", "[", 
            RowBox[{"z", ",", 
             RowBox[{"-", "1"}]}], "]"}], 
           RowBox[{"Product", "[", 
            RowBox[{
             RowBox[{"weight", "[", 
              RowBox[{"j", ",", "0"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"{", "y", "}"}]}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Chain", "[", 
           RowBox[{"$angle", ",", "x_", ",", 
            RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$square"}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"weight", "[", 
            RowBox[{"x", ",", 
             RowBox[{"-", "1"}]}], "]"}], 
           RowBox[{"weight", "[", 
            RowBox[{"z", ",", "1"}], "]"}], 
           RowBox[{"Product", "[", 
            RowBox[{
             RowBox[{"weight", "[", 
              RowBox[{"j", ",", "0"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"{", "y", "}"}]}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Chain", "[", 
           RowBox[{"$square", ",", "x_", ",", 
            RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$angle"}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"weight", "[", 
            RowBox[{"x", ",", "1"}], "]"}], 
           RowBox[{"weight", "[", 
            RowBox[{"z", ",", 
             RowBox[{"-", "1"}]}], "]"}], 
           RowBox[{"Product", "[", 
            RowBox[{
             RowBox[{"weight", "[", 
              RowBox[{"j", ",", "0"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"{", "y", "}"}]}], "}"}]}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Chain", "[", 
           RowBox[{"$square", ",", "x_", ",", 
            RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$square"}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"weight", "[", 
            RowBox[{"x", ",", "1"}], "]"}], 
           RowBox[{"weight", "[", 
            RowBox[{"z", ",", "1"}], "]"}], 
           RowBox[{"Product", "[", 
            RowBox[{
             RowBox[{"weight", "[", 
              RowBox[{"j", ",", "0"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"{", "y", "}"}]}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"mp", "[", 
           RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"weight", "[", 
            RowBox[{"x", ",", "0"}], "]"}], 
           RowBox[{"weight", "[", 
            RowBox[{"y", ",", "0"}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"weight", "[", 
            RowBox[{"x", ",", "0"}], "]"}], 
           RowBox[{"weight", "[", 
            RowBox[{"y", ",", "0"}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"S4", "[", 
           RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"weight", "[", 
            RowBox[{"x", ",", "0"}], "]"}], 
           RowBox[{"weight", "[", 
            RowBox[{"y", ",", "0"}], "]"}]}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Remove", " ", "everything", " ", "which", " ", "has", " ", "no", " ", 
       RowBox[{"weight", ":"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"local", "=", 
      RowBox[{"local", "/.", 
       RowBox[{
        RowBox[{
         RowBox[{"Times", "[", 
          RowBox[{"A_", ",", 
           RowBox[{"weight", "[", "x__", "]"}]}], "]"}], "/;", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"A", ",", "weight"}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{"weight", "[", "x", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Take", " ", "powers", " ", "into", " ", "account", " ", "and", " ", 
       "recollect", " ", "weights"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"local", "=", 
      RowBox[{"local", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"weight", "[", 
             RowBox[{"x_", ",", "n_"}], "]"}], ",", "m_"}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{"weight", "[", 
           RowBox[{"x", ",", 
            RowBox[{"n", "*", "m"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"weight", "[", 
            RowBox[{"x_", ",", "n_"}], "]"}], "*", 
           RowBox[{"weight", "[", 
            RowBox[{"x_", ",", "m_"}], "]"}]}], "\[RuleDelayed]", 
          RowBox[{"weight", "[", 
           RowBox[{"x", ",", 
            RowBox[{"n", "+", "m"}]}], "]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Do", " ", "the", " ", "power", " ", "counting"}], ",", " ", 
       RowBox[{
       "first", " ", "the", " ", "terms", " ", "which", " ", "carry", " ", 
        "weight", " ", 
        RowBox[{"zero", ".", " ", "These"}], " ", "must", " ", "be", " ", 
        "stored", " ", "and", " ", "then", " ", "removed", " ", "in", " ", 
        "order", " ", "to", " ", "allow", " ", "the", " ", "correct", " ", 
        "counting", " ", "of", " ", "the", " ", "terms", " ", "which", " ", 
        "actually", " ", "have", " ", "weight"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"local", "=", 
      RowBox[{"local", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"weight", "[", 
           RowBox[{"x_", ",", "0"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"pow", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"pow", ",", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "0"}], "}"}], "}"}]}], "]"}]}], ";", "1"}],
            ")"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"weight", "[", 
            RowBox[{"x_", ",", "n_"}], "]"}], "*", 
           RowBox[{"weight", "[", 
            RowBox[{"x_", ",", "m_"}], "]"}]}], "\[RuleDelayed]", 
          RowBox[{"weight", "[", 
           RowBox[{"x", ",", 
            RowBox[{"n", "+", "m"}]}], "]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Now", " ", "count", " ", "whatever", " ", "has", " ", "actually", " ", 
       "a", " ", "spinor", " ", "power"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"local", "=", 
      RowBox[{"local", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"weight", "[", 
          RowBox[{"x_", ",", "n_"}], "]"}], "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pow", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"pow", ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"x", ",", "n"}], "}"}], "}"}]}], "]"}]}], ";", "1"}], 
          ")"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{
       RowBox[{"pow", "//", "DeleteDuplicates"}], "//", "Sort"}], "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8020831172104325`*^9, 3.802083144977332*^9}, {
  3.802083218312173*^9, 3.8020833180991545`*^9}, {3.802083352078317*^9, 
  3.8020833524901714`*^9}, {3.802083542283578*^9, 3.80208355941571*^9}, {
  3.8020836584837446`*^9, 3.802083666984844*^9}, {3.802083705907749*^9, 
  3.8020837419184275`*^9}, {3.8020838409874344`*^9, 3.8020838671391354`*^9}, {
  3.8020839122135715`*^9, 3.8020839201882277`*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"9bf468e6-a9c6-4952-b966-e96645e26fe2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"HelicityWeight6", "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "weight", ",", "pow", ",", "locexp", ",", "local", ",", "out", ",", 
       "len"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "If", " ", "input", " ", "is", " ", "a", " ", "sum", " ", "of", " ", 
       "terms", " ", "transform", " ", "it", " ", "in", " ", "a", " ", "list",
        " ", "so", " ", "to", " ", "work", " ", "on", " ", "each", " ", 
       "element", " ", "of", " ", "the", " ", "list", " ", "separately"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"locexp", "=", 
       RowBox[{"exp", "//", "Expand"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "locexp", "]"}], "===", "Plus"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"locexp", "=", 
         RowBox[{"List", "@@", "locexp"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"locexp", "=", 
          RowBox[{"{", "locexp", "}"}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Apply", " ", "the", " ", "auxiliary", " ", "function", " ", "which", 
        " ", "extracts", " ", "the", " ", "weight", " ", "terms", " ", "by", 
        " ", "term"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"pow", "[", "i", "]"}], "=", 
          RowBox[{"helicityweightaux", "[", 
           RowBox[{"locexp", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"len", "=", 
           RowBox[{"Length", "[", "locexp", "]"}]}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"out", "=", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"pow", "[", "i", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "len"}], "}"}]}], "]"}], ",", "1"}], "]"}], "//",
         "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Check", " ", "if", " ", "there", " ", "are", " ", "terms", " ", "in", 
        " ", "the", " ", "expression", " ", "which", " ", "have", " ", "a", 
        " ", "different", " ", "weight"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "out", "]"}], "===", 
         RowBox[{"Length", "[", 
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"out", ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "==", 
               RowBox[{"#2", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ")"}]}], "]"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "out", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Return", "[", 
          "\"\<Some terms have unequal weights, please check input.\>\"", 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8020807931768923`*^9, 3.802081330918426*^9}, {
   3.8020814419095407`*^9, 3.802081502673003*^9}, {3.8020816004574647`*^9, 
   3.8020817211748486`*^9}, {3.802081792333579*^9, 3.8020819431628637`*^9}, {
   3.8020819918649373`*^9, 3.8020820076566715`*^9}, {3.802082202466592*^9, 
   3.8020822117198553`*^9}, {3.8020823086485853`*^9, 
   3.8020824498900394`*^9}, {3.802082499017579*^9, 3.8020825808616605`*^9}, {
   3.8020826245787783`*^9, 3.8020826831590652`*^9}, {3.8020827875579147`*^9, 
   3.80208292562388*^9}, {3.80208304318449*^9, 3.8020830436831565`*^9}, {
   3.8020831805920672`*^9, 3.8020831884370604`*^9}, 3.8020832380822506`*^9, {
   3.802083341413848*^9, 3.8020833933149896`*^9}, {3.802083943119857*^9, 
   3.8020841090231934`*^9}, {3.8020850925189276`*^9, 3.802085092679453*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"7eaa80ad-e543-404f-89cb-3c806f922c54"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight6", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      TemplateBox[{"1", "2"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], 
      TemplateBox[{"2", "4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
     TemplateBox[{"1", 
       RowBox[{"{", "3", "}"}], "4"},
      "AngleSquareChain",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
         "$square", "]"}]& )]}], ")"}], "/", 
   TemplateBox[{"1", 
     RowBox[{"{", "2", "}"}], "4"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], "]"}]], "Input",
 CellChangeTimes->{{3.802083418321103*^9, 3.802083418803855*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"a5a910b2-66d9-4ab2-b909-0017f639a130"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    TemplateBox[{"1", 
      RowBox[{"{", "3", "}"}], "4"},
     "AngleSquareChain",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], 
    TemplateBox[{"1", 
      RowBox[{"{", "2", "}"}], "4"},
     "AngleSquareChain",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )]], ",", 
   FractionBox[
    RowBox[{
     TemplateBox[{"1", "2"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], " ", 
     TemplateBox[{"2", "4"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], 
    TemplateBox[{"1", 
      RowBox[{"{", "2", "}"}], "4"},
     "AngleSquareChain",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )]]}], "}"}]], "Print",
 CellChangeTimes->{3.8020841107117076`*^9, 3.8020850150949726`*^9},
 CellLabel->
  "During evaluation of \
In[123]:=",ExpressionUUID->"6458d713-8f63-455a-8e8a-1e610983a4d8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.802083419488022*^9, 3.802083770486991*^9, 3.80208390352981*^9, {
   3.802083990668232*^9, 3.8020840722341037`*^9}, {3.802084102597413*^9, 
   3.8020841107196884`*^9}, 3.8020850151009912`*^9},
 CellLabel->
  "Out[123]=",ExpressionUUID->"be5b2ad5-6b40-4029-8613-cbbef04207b6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"helicityweightaux", "[", 
  FractionBox[
   TemplateBox[{"1", 
     RowBox[{"{", "3", "}"}], "4"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )], 
   TemplateBox[{"1", 
     RowBox[{"{", "2", "}"}], "4"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]], "]"}]], "Input",
 CellChangeTimes->{{3.8020835023653426`*^9, 3.8020835050072393`*^9}, 
   3.802084133318263*^9},
 CellLabel->"In[98]:=",ExpressionUUID->"da178a54-b67a-4fca-b88d-69d7879e9ddd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.802083505576747*^9, 3.802083564200902*^9, 3.802083674956522*^9, 
   3.802083751458889*^9, {3.8020838543213253`*^9, 3.8020838716909456`*^9}, 
   3.802083929987027*^9, 3.802084136498724*^9},
 CellLabel->"Out[98]=",ExpressionUUID->"7997ce26-cdc0-4164-bcfd-95694e834797"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tests", "Subsection",
 CellChangeTimes->{{3.8020847418639584`*^9, 
  3.802084742464347*^9}},ExpressionUUID->"244d3448-9be5-48e5-bba6-\
d0c57a3d4f86"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight6", "[", 
  RowBox[{
   TemplateBox[{"1", "2"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], 
   TemplateBox[{"2", "1"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )]}], "]"}]], "Input",
 CellChangeTimes->{{3.802082480711585*^9, 3.802082481050644*^9}, {
  3.802084749935379*^9, 3.8020847501657515`*^9}, {3.8020851781658382`*^9, 
  3.8020851787333183`*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"57e5eaa3-22db-422a-8e5c-f995a955de4b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8020824823910847`*^9, 3.8020825825042973`*^9}, {
   3.8020826590495567`*^9, 3.802082688172654*^9}, 3.802084750642423*^9, 
   3.8020851800826893`*^9},
 CellLabel->
  "Out[126]=",ExpressionUUID->"39da0962-4a85-4a08-bc4e-e9f9daa0cdf8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HelicityWeight6", "[", 
   RowBox[{
    TemplateBox[{"1", "2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], 
    TemplateBox[{"2", "1"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], "]"}], "//", 
  "RepeatedTiming"}]], "Input",
 CellChangeTimes->{{3.802069146584921*^9, 3.8020691585791397`*^9}, {
  3.8020692179901013`*^9, 3.8020692207240534`*^9}, {3.8020702384677076`*^9, 
  3.802070258386628*^9}, {3.8020826998593636`*^9, 3.8020827002962427`*^9}, {
  3.8020847554306684`*^9, 3.8020847556500654`*^9}, {3.8020851821322117`*^9, 
  3.8020851825899544`*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"29b5cd9c-cbcd-4d42-950a-ea3449c15ba9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0003913156146179402`2.", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.802069159410637*^9, {3.8020692119938116`*^9, 3.8020692212466507`*^9}, {
   3.802070240682969*^9, 3.8020702594776697`*^9}, 3.8020713466221733`*^9, {
   3.8020788821507196`*^9, 3.802078892585848*^9}, {3.8020827020525227`*^9, 
   3.802082709335128*^9}, {3.8020847570443296`*^9, 3.8020847599196405`*^9}, 
   3.80208518406304*^9},
 CellLabel->
  "Out[127]=",ExpressionUUID->"91ce55fc-3db6-46c5-8bec-d75105125215"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "As", " ", "expected", " ", "the", " ", "last", " ", "version", " ", "is", 
    " ", "slower"}], ",", " ", 
   RowBox[{"but", " ", "no", " ", "surprise", " ", "there"}], ",", " ", 
   RowBox[{
   "since", " ", "it", " ", "is", " ", "able", " ", "to", " ", "handle", " ", 
    "more", " ", "complicated", " ", "expressions"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.802070297097376*^9, 
  3.8020703328749194`*^9}},ExpressionUUID->"9b37172c-d69c-4261-b80e-\
f34fc6adfeea"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight6", "[", 
  RowBox[{
   RowBox[{
    TemplateBox[{"1", "2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], 
    TemplateBox[{"2", "1"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
   TemplateBox[{"1", 
     RowBox[{"{", "2", "}"}], "1"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], "]"}]], "Input",
 CellChangeTimes->{{3.8020827673379526`*^9, 3.802082767687066*^9}, {
  3.8020829376158605`*^9, 3.802082950385661*^9}, {3.802084763129076*^9, 
  3.802084763353429*^9}, {3.8020851867678127`*^9, 3.802085187302377*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"93702653-db2a-44e5-90f0-c3299d78c6be"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8020827686584144`*^9, 3.802082824384867*^9, {3.802082932331938*^9, 
   3.802082950855406*^9}, 3.802084763827158*^9, 3.8020851878309608`*^9},
 CellLabel->
  "Out[128]=",ExpressionUUID->"df1fe8ce-cee2-43fb-b5dc-130a5082853a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HelicityWeight6", "[", 
   RowBox[{
    RowBox[{
     TemplateBox[{"1", "2"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], 
     TemplateBox[{"2", "1"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
    TemplateBox[{"1", 
      RowBox[{"{", "2", "}"}], "1"},
     "AngleSquareChain",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )]}], "]"}], "//", "RepeatedTiming"}]], "Input",
 CellChangeTimes->{{3.802070345484767*^9, 3.8020703572701817`*^9}, {
  3.8020714843955917`*^9, 3.802071487096366*^9}, {3.802082956341777*^9, 
  3.802082956662923*^9}, {3.802084771169549*^9, 3.802084771409925*^9}, {
  3.802085189849583*^9, 3.8020851903112984`*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"5fa290b3-4cf0-4ae3-a888-0952910d5dd2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.000571639642857143`2.", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.802070358487958*^9, 3.8020703905135417`*^9, 3.8020713572756786`*^9, {
   3.802071422537112*^9, 3.8020714375529346`*^9}, {3.802071478504349*^9, 
   3.8020714879760118`*^9}, {3.8020789060528316`*^9, 
   3.8020789142439127`*^9}, {3.8020829527044907`*^9, 
   3.8020829697130117`*^9}, {3.802084773027544*^9, 3.802084776884261*^9}, 
   3.8020851919619117`*^9},
 CellLabel->
  "Out[129]=",ExpressionUUID->"9c62a59c-d70b-4c89-922b-4acca07ef3f8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight6", "[", 
  RowBox[{
   RowBox[{
    TemplateBox[{"1", "2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], 
    TemplateBox[{"2", "1"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
   TemplateBox[{"1", 
     RowBox[{"{", "3", "}"}], "1"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], "]"}]], "Input",
 CellChangeTimes->{{3.802071509588252*^9, 3.802071510778063*^9}, {
  3.802084780583432*^9, 3.802084782207097*^9}, {3.802085202424947*^9, 
  3.802085203011335*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"5fae32e7-d749-4efb-90cb-ba05a754ba9e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.802072793050067*^9, 3.8020789170673633`*^9, 
  3.8020847831166544`*^9, 3.8020852034661417`*^9},
 CellLabel->
  "Out[130]=",ExpressionUUID->"55aa47c2-6e1b-4035-b8ca-81409fdba930"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight6", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.8020789788640776`*^9, 3.802078983114698*^9}, {
  3.802083083884059*^9, 3.8020830842750645`*^9}, {3.802084785843314*^9, 
  3.8020847860457735`*^9}, {3.802085205981414*^9, 3.8020852065229855`*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"a9131887-92f7-4ac4-bc22-bf9dbfaa9b08"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.8020789835575075`*^9, 3.8020830855735383`*^9, 
  3.80208478699047*^9, 3.8020852070156145`*^9},
 CellLabel->
  "Out[131]=",ExpressionUUID->"30c5bb5a-6f14-4c99-9aa7-e5fe4ea00b8f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight6", "[", 
  RowBox[{
   TemplateBox[{"1", "2"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], 
   TemplateBox[{"2", "1"},
    "SpinorSquareBracket",
    DisplayFunction->(RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
    InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], 
   RowBox[{
    TemplateBox[{"2", "3"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "^", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.802079365660952*^9, 3.802079367788262*^9}, {
   3.802079493371108*^9, 3.8020794939485693`*^9}, {3.8020829904455395`*^9, 
   3.8020830202927237`*^9}, 3.8020830610581155`*^9, {3.8020847908540373`*^9, 
   3.8020847911253166`*^9}, {3.802085208605466*^9, 3.802085209006374*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"42c94ab3-02d2-406b-a824-e778128d3b3f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.802079368706806*^9, 3.8020794946207476`*^9, {3.8020829916882153`*^9, 
   3.8020830209250145`*^9}, {3.8020830573090982`*^9, 3.8020830635684333`*^9}, 
   3.8020847917176723`*^9, 3.802085209549937*^9},
 CellLabel->
  "Out[132]=",ExpressionUUID->"c81febb6-686d-4102-b98f-2e114a30bc41"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight6", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      TemplateBox[{"1", "2"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], 
      TemplateBox[{"2", "4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
     TemplateBox[{"1", 
       RowBox[{"{", "3", "}"}], "4"},
      "AngleSquareChain",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
         "$square", "]"}]& )]}], ")"}], "/", 
   TemplateBox[{"1", 
     RowBox[{"{", "2", "}"}], "4"},
    "AngleSquareChain",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
    InterpretationFunction->(
     RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square",
        "]"}]& )]}], "]"}]], "Input",
 CellChangeTimes->{{3.8020846898410797`*^9, 3.802084690045532*^9}, {
  3.8020852114149523`*^9, 3.8020852119205866`*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"1ac3f5a7-37f8-4fe9-9256-11525d8ad3a8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8020846913660192`*^9, 3.802084798991222*^9, 
  3.80208521237836*^9},
 CellLabel->
  "Out[133]=",ExpressionUUID->"2f9b1bc5-18b9-49af-b34f-f9d2b43bd33d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test", "=", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[Kappa]", "4"], " ", 
      SuperscriptBox[
       TemplateBox[{"l1", 
         RowBox[{"{", "p1", "}"}], "l2"},
        "AngleSquareChain",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
           "$square", "]"}]& )], "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"p3", 
         RowBox[{"{", 
           RowBox[{"-", "l2"}], "}"}], "p4"},
        "AngleSquareChain",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
           "$square", "]"}]& )], "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"l2", "p3"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"l1", "p4"},
        "SpinorSquareBracket",
        DisplayFunction->(RowBox[{"[", 
           RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
        InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
      SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
     RowBox[{"128", " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", 
        RowBox[{"-", "l2"}]}], "]"}], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["m", "2"], " ", 
         SuperscriptBox["\[Kappa]", "2"], " ", 
         SuperscriptBox[
          TemplateBox[{"p3", 
            RowBox[{"{", 
              RowBox[{"-", "l1"}], "}"}], "p4"},
           "AngleSquareChain",
           
           DisplayFunction->(
            RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
              "$square", "]"}]& )], "4"], " ", 
         SuperscriptBox[
          TemplateBox[{"l1", "l2"},
           "SpinorAngleBracket",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
           InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
         SuperscriptBox[
          TemplateBox[{"l1", "l2"},
           "SpinorSquareBracket",
           DisplayFunction->(RowBox[{"[", 
              RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
           InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
         SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
        RowBox[{"64", " ", "s", " ", 
         TemplateBox[{
           
           TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )], 
           
           TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
          "ScalarProduct",
          DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
          InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
         " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l1"}], ",", 
           RowBox[{"-", "l2"}]}], "]"}], " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["m", "2"], " ", 
        SuperscriptBox["\[Kappa]", "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"p3", 
           RowBox[{"{", 
             RowBox[{"-", "l2"}], "}"}], "p4"},
          "AngleSquareChain",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
          
          InterpretationFunction->(
           RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
             "$square", "]"}]& )], "4"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1", "l2"},
          "SpinorAngleBracket",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
             RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
          InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1", "l2"},
          "SpinorSquareBracket",
          DisplayFunction->(RowBox[{"[", 
             RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
          InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
       RowBox[{"64", " ", "s", " ", 
        TemplateBox[{
          
          TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )], 
          TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
         "ScalarProduct",
         DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
         InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
        " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", 
          RowBox[{"-", "l2"}]}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l2"}], ",", "p3"}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l2"}], ",", "p4"}], "]"}]}]]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.794301262803868*^9, 3.7943012704525943`*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"be3755ef-cf4c-45c0-a412-cc4ced9783df"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[Kappa]", "4"], " ", 
     SuperscriptBox[
      TemplateBox[{"l1", 
        RowBox[{"{", "p1", "}"}], "l2"},
       "AngleSquareChain",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
          "$square", "]"}]& )], "2"], " ", 
     SuperscriptBox[
      TemplateBox[{"p3", 
        RowBox[{"{", 
          RowBox[{"-", "l2"}], "}"}], "p4"},
       "AngleSquareChain",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
          "$square", "]"}]& )], "2"], " ", 
     SuperscriptBox[
      TemplateBox[{"l2", "p3"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
     SuperscriptBox[
      TemplateBox[{"l1", "p4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
     SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
    RowBox[{"128", " ", 
     RowBox[{"S4", "[", 
      RowBox[{
       RowBox[{"-", "l1"}], ",", 
       RowBox[{"-", "l2"}]}], "]"}], " ", 
     RowBox[{"S4", "[", 
      RowBox[{
       RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
     RowBox[{"S4", "[", 
      RowBox[{
       RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["m", "2"], " ", 
        SuperscriptBox["\[Kappa]", "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"p3", 
           RowBox[{"{", 
             RowBox[{"-", "l1"}], "}"}], "p4"},
          "AngleSquareChain",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
          
          InterpretationFunction->(
           RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
             "$square", "]"}]& )], "4"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1", "l2"},
          "SpinorAngleBracket",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
             RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
          InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1", "l2"},
          "SpinorSquareBracket",
          DisplayFunction->(RowBox[{"[", 
             RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
          InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
       RowBox[{"64", " ", "s", " ", 
        TemplateBox[{
          
          TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )], 
          
          TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
         "ScalarProduct",
         DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
         InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
        " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", 
          RowBox[{"-", "l2"}]}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["m", "2"], " ", 
       SuperscriptBox["\[Kappa]", "2"], " ", 
       SuperscriptBox[
        TemplateBox[{"p3", 
          RowBox[{"{", 
            RowBox[{"-", "l2"}], "}"}], "p4"},
         "AngleSquareChain",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
            "$square", "]"}]& )], "4"], " ", 
       SuperscriptBox[
        TemplateBox[{"l1", "l2"},
         "SpinorAngleBracket",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
            RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
         InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
            RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
       SuperscriptBox[
        TemplateBox[{"l1", "l2"},
         "SpinorSquareBracket",
         DisplayFunction->(RowBox[{"[", 
            RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
         InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
            RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
       SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
      RowBox[{"64", " ", "s", " ", 
       TemplateBox[{
         TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
          InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )], 
         TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
          InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
        "ScalarProduct",
        DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
        InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
       " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l1"}], ",", 
         RowBox[{"-", "l2"}]}], "]"}], " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l2"}], ",", "p3"}], "]"}], " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l2"}], ",", "p4"}], "]"}]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.79430126426431*^9, 3.7943012711177635`*^9}, 
   3.794314357615675*^9, 3.802084841989863*^9},
 CellLabel->
  "Out[113]=",ExpressionUUID->"f1fe4406-3e36-4443-983b-40dae9b594ab"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight6", "[", "test", "]"}]], "Input",
 CellChangeTimes->{{3.7943143507942367`*^9, 3.79431435439968*^9}, {
   3.7943146389741993`*^9, 3.794314647210569*^9}, 3.802084843996517*^9, {
   3.802085218232664*^9, 3.8020852187982016`*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"447e539f-8049-4147-98e5-fd90365d7016"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "l1"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"l1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "l2"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"l2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p3", ",", 
     RowBox[{"-", "4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"p1"},
      "MomPure",
      DisplayFunction->(RowBox[{#}]& ),
      InterpretationFunction->(RowBox[{"MomPure", "[", #, "]"}]& )], ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p1", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.794314360249627*^9, 3.794314422010434*^9, 3.794314455352127*^9, {
   3.7943145353981967`*^9, 3.7943145559306154`*^9}, {3.7943146410513*^9, 
   3.794314647909994*^9}, 3.7943149778387184`*^9, 3.802084846302327*^9, 
   3.802084893681563*^9, 3.8020852208357306`*^9},
 CellLabel->
  "Out[134]=",ExpressionUUID->"e37cddd4-86ae-4a70-b5a8-04d3970c8214"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test2", "=", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[Kappa]", "4"], " ", 
      SuperscriptBox[
       TemplateBox[{"l1", 
         RowBox[{"{", "p1", "}"}], "l3"},
        "AngleSquareChain",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
           "$square", "]"}]& )], "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"p3", 
         RowBox[{"{", 
           RowBox[{"-", "l2"}], "}"}], "p4"},
        "AngleSquareChain",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
           "$square", "]"}]& )], "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"l2", "p3"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"l1", "p4"},
        "SpinorSquareBracket",
        DisplayFunction->(RowBox[{"[", 
           RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
        InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
      SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
     RowBox[{"128", " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", 
        RowBox[{"-", "l2"}]}], "]"}], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["m", "2"], " ", 
         SuperscriptBox["\[Kappa]", "2"], " ", 
         SuperscriptBox[
          TemplateBox[{"p3", 
            RowBox[{"{", 
              RowBox[{"-", "l1"}], "}"}], "p4"},
           "AngleSquareChain",
           
           DisplayFunction->(
            RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
              "$square", "]"}]& )], "4"], " ", 
         SuperscriptBox[
          TemplateBox[{"l1", "l2"},
           "SpinorAngleBracket",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
           InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
         SuperscriptBox[
          TemplateBox[{"l1", "l2"},
           "SpinorSquareBracket",
           DisplayFunction->(RowBox[{"[", 
              RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
           InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
         SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
        RowBox[{"64", " ", "s", " ", 
         TemplateBox[{
           
           TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )], 
           
           TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
          "ScalarProduct",
          DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
          InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
         " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l1"}], ",", 
           RowBox[{"-", "l2"}]}], "]"}], " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["m", "2"], " ", 
        SuperscriptBox["\[Kappa]", "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"p3", 
           RowBox[{"{", 
             RowBox[{"-", "l2"}], "}"}], "p4"},
          "AngleSquareChain",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
          
          InterpretationFunction->(
           RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
             "$square", "]"}]& )], "4"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1", "l2"},
          "SpinorAngleBracket",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
             RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
          InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1", "l2"},
          "SpinorSquareBracket",
          DisplayFunction->(RowBox[{"[", 
             RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
          InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
       RowBox[{"64", " ", "s", " ", 
        TemplateBox[{
          
          TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )], 
          TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
         "ScalarProduct",
         DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
         InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
        " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", 
          RowBox[{"-", "l2"}]}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l2"}], ",", "p3"}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l2"}], ",", "p4"}], "]"}]}]]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7943145697369833`*^9, 3.7943145891220655`*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"866bd37c-8863-4a6f-b659-a2dedf474ab1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[Kappa]", "4"], " ", 
     SuperscriptBox[
      TemplateBox[{"l1", 
        RowBox[{"{", "p1", "}"}], "l3"},
       "AngleSquareChain",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
          "$square", "]"}]& )], "2"], " ", 
     SuperscriptBox[
      TemplateBox[{"p3", 
        RowBox[{"{", 
          RowBox[{"-", "l2"}], "}"}], "p4"},
       "AngleSquareChain",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
          "$square", "]"}]& )], "2"], " ", 
     SuperscriptBox[
      TemplateBox[{"l2", "p3"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
     SuperscriptBox[
      TemplateBox[{"l1", "p4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
     SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
    RowBox[{"128", " ", 
     RowBox[{"S4", "[", 
      RowBox[{
       RowBox[{"-", "l1"}], ",", 
       RowBox[{"-", "l2"}]}], "]"}], " ", 
     RowBox[{"S4", "[", 
      RowBox[{
       RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
     RowBox[{"S4", "[", 
      RowBox[{
       RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["m", "2"], " ", 
        SuperscriptBox["\[Kappa]", "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"p3", 
           RowBox[{"{", 
             RowBox[{"-", "l1"}], "}"}], "p4"},
          "AngleSquareChain",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
          
          InterpretationFunction->(
           RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
             "$square", "]"}]& )], "4"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1", "l2"},
          "SpinorAngleBracket",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
             RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
          InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1", "l2"},
          "SpinorSquareBracket",
          DisplayFunction->(RowBox[{"[", 
             RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
          InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
       RowBox[{"64", " ", "s", " ", 
        TemplateBox[{
          
          TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )], 
          
          TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
         "ScalarProduct",
         DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
         InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
        " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", 
          RowBox[{"-", "l2"}]}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["m", "2"], " ", 
       SuperscriptBox["\[Kappa]", "2"], " ", 
       SuperscriptBox[
        TemplateBox[{"p3", 
          RowBox[{"{", 
            RowBox[{"-", "l2"}], "}"}], "p4"},
         "AngleSquareChain",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
            "$square", "]"}]& )], "4"], " ", 
       SuperscriptBox[
        TemplateBox[{"l1", "l2"},
         "SpinorAngleBracket",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
            RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
         InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
            RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
       SuperscriptBox[
        TemplateBox[{"l1", "l2"},
         "SpinorSquareBracket",
         DisplayFunction->(RowBox[{"[", 
            RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
         InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
            RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
       SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
      RowBox[{"64", " ", "s", " ", 
       TemplateBox[{
         TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
          InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )], 
         TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
          InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
        "ScalarProduct",
        DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
        InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
       " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l1"}], ",", 
         RowBox[{"-", "l2"}]}], "]"}], " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l2"}], ",", "p3"}], "]"}], " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l2"}], ",", "p4"}], "]"}]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.794314590953373*^9, 3.8020849292839026`*^9},
 CellLabel->
  "Out[118]=",ExpressionUUID->"a9c4f0b0-c3ca-4ba0-8592-776f5a325965"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test2", "//", "HelicityWeight6"}]], "Input",
 CellChangeTimes->{{3.794314592789912*^9, 3.7943145966657677`*^9}, {
  3.8020849337719517`*^9, 3.8020849472673993`*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"acb76a8b-05ac-40f0-a66f-8d7a9f5baaea"],

Cell[BoxData["\<\"Some terms have unequal weights, please check input.\"\>"], \
"Output",
 CellChangeTimes->{
  3.7943145971520257`*^9, 3.7943149827340207`*^9, {3.8020849361505327`*^9, 
   3.802084950227482*^9}, 3.8020850998712463`*^9},
 CellLabel->
  "Out[125]=",ExpressionUUID->"70d1a5a8-753b-4161-83a7-5b21d42c14dd"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Helicity weight again, seems to finally work", "Section",
 CellChangeTimes->{{3.8020673572763844`*^9, 3.8020673614829655`*^9}, {
   3.802080289643543*^9, 3.802080297451686*^9}, 3.802085274325019*^9, {
   3.802091056641184*^9, 
   3.8020910637900596`*^9}},ExpressionUUID->"3d0fd9ca-97f9-4f6c-899e-\
3bdc9389ee37"],

Cell[CellGroupData[{

Cell["Function definition", "Subsection",
 CellChangeTimes->{{3.80206736977641*^9, 
  3.8020673736277757`*^9}},ExpressionUUID->"7c49e90b-e15a-4557-9f4d-\
6d8ddb818125"],

Cell[CellGroupData[{

Cell["For a single term", "Subsubsection",
 CellChangeTimes->{{3.8020694554645815`*^9, 3.802069459020146*^9}, {
   3.802079634005885*^9, 3.802079641911733*^9}, 3.802085369571251*^9, {
   3.8020854475177393`*^9, 
   3.8020854485499887`*^9}},ExpressionUUID->"05b5247e-e804-4e65-9901-\
36da55a11f7a"],

Cell[BoxData[
 RowBox[{"Clear", "[", "HelicityWeight8", "]"}]], "Input",
 CellChangeTimes->{{3.802087958820672*^9, 3.8020879654599123`*^9}, {
  3.8020884450495987`*^9, 3.8020884453946805`*^9}},
 CellLabel->
  "In[213]:=",ExpressionUUID->"303a959b-5daf-4bb1-b63e-c1a366dbbab4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"HelicityWeight", "::", "unequalweight"}], "=", 
   "\"\<Some terms have unequal weights, please check input.\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8020899070648303`*^9, 3.802089912798504*^9}, {
  3.802090028010066*^9, 3.802090039849383*^9}},
 CellLabel->
  "In[214]:=",ExpressionUUID->"e8930aa1-cfbb-48ec-bff7-c3e6c908a7d9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HelicityWeight8", "[", "exp_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"moms", ",", "locexp", ",", "weight", ",", "hel"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Extract", " ", "all", " ", "the", " ", "momenta", " ", "in", " ", "the",
       " ", "expression"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"moms", "=", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "exp", "}"}], ",", 
           RowBox[{
            RowBox[{"HoldPattern", "[", 
             RowBox[{
              RowBox[{"SpinorAngleBracket", "[", 
               RowBox[{"x_", ",", "y_"}], "]"}], "|", 
              RowBox[{"SpinorSquareBracket", "[", 
               RowBox[{"x_", ",", "y_"}], "]"}], "|", 
              RowBox[{"mp", "[", 
               RowBox[{"x_", ",", "y_"}], "]"}], "|", 
              RowBox[{"S", "[", 
               RowBox[{"x_", ",", "y_"}], "]"}], "|", 
              RowBox[{"S4", "[", 
               RowBox[{"x_", ",", "y_"}], "]"}]}], "]"}], "\[RuleDelayed]", 
            RowBox[{"Sequence", "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], ",", "\[Infinity]"}], "]"}], 
         ",", 
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "exp", "}"}], ",", 
           RowBox[{
            RowBox[{"HoldPattern", "[", 
             RowBox[{"Chain", "[", 
              RowBox[{"type1_", ",", "x_", ",", 
               RowBox[{"{", "y__", "}"}], ",", "z_", ",", "type2_"}], "]"}], 
             "]"}], "\[RuleDelayed]", 
            RowBox[{"Sequence", "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ",", "\[Infinity]"}],
           "]"}]}], "]"}], "//", "DeleteDuplicates"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Remove", " ", "form", " ", "the", " ", "expression", " ", 
        "everything", " ", "which", " ", "is", " ", "not", " ", "needed"}], 
       ",", " ", 
       RowBox[{
        RowBox[{"i", ".", "e", ".", " ", "all"}], " ", "multiplicative", " ", 
        "factors", " ", "are", " ", "turned", " ", "into", " ", "1", "s"}], 
       ",", " ", 
       RowBox[{"upon", " ", "expanding"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"locexp", "=", 
      RowBox[{"exp", "//", "Expand"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"locexp", "=", 
      RowBox[{"locexp", "//.", 
       RowBox[{
        RowBox[{
         RowBox[{"Times", "[", 
          RowBox[{"x_", ",", "y_"}], "]"}], "/;", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"x", ",", 
           RowBox[{
           "SpinorAngleBracket", "|", "SpinorSquareBracket", "|", "Chain"}]}],
           "]"}]}], "\[RuleDelayed]", "y"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Do", " ", "the", " ", "power", " ", "counting", " ", "using", " ", 
       "the", " ", "weight", " ", "function"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"locexp", "=", 
      RowBox[{"locexp", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"SpinorAngleBracket", "[", 
           RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"weight", "[", 
            RowBox[{"x", ",", 
             RowBox[{"-", "1"}]}], "]"}], 
           RowBox[{"weight", "[", 
            RowBox[{"y", ",", 
             RowBox[{"-", "1"}]}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"SpinorSquareBracket", "[", 
           RowBox[{"x_", ",", "y_"}], "]"}], ":>", 
          RowBox[{
           RowBox[{"weight", "[", 
            RowBox[{"x", ",", "1"}], "]"}], 
           RowBox[{"weight", "[", 
            RowBox[{"y", ",", "1"}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Chain", "[", 
           RowBox[{"$angle", ",", "x_", ",", 
            RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$angle"}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"weight", "[", 
            RowBox[{"x", ",", 
             RowBox[{"-", "1"}]}], "]"}], 
           RowBox[{"weight", "[", 
            RowBox[{"z", ",", 
             RowBox[{"-", "1"}]}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Chain", "[", 
           RowBox[{"$angle", ",", "x_", ",", 
            RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$square"}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"weight", "[", 
            RowBox[{"x", ",", 
             RowBox[{"-", "1"}]}], "]"}], 
           RowBox[{"weight", "[", 
            RowBox[{"z", ",", "1"}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Chain", "[", 
           RowBox[{"$square", ",", "x_", ",", 
            RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$angle"}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"weight", "[", 
            RowBox[{"x", ",", "1"}], "]"}], 
           RowBox[{"weight", "[", 
            RowBox[{"z", ",", 
             RowBox[{"-", "1"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Chain", "[", 
           RowBox[{"$square", ",", "x_", ",", 
            RowBox[{"{", "y__", "}"}], ",", "z_", ",", "$square"}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"weight", "[", 
            RowBox[{"x", ",", "1"}], "]"}], 
           RowBox[{"weight", "[", 
            RowBox[{"z", ",", "1"}], "]"}]}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Take", " ", "powers", " ", "into", " ", "account", " ", "and", " ", 
       "recollect", " ", "weights"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"locexp", "=", 
      RowBox[{
       RowBox[{"locexp", "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Power", "[", 
            RowBox[{
             RowBox[{"weight", "[", 
              RowBox[{"x_", ",", "n_"}], "]"}], ",", "m_"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{"weight", "[", 
            RowBox[{"x", ",", 
             RowBox[{"n", "*", "m"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"weight", "[", 
             RowBox[{"x_", ",", "n_"}], "]"}], "*", 
            RowBox[{"weight", "[", 
             RowBox[{"x_", ",", "m_"}], "]"}]}], "\[RuleDelayed]", 
           RowBox[{"weight", "[", 
            RowBox[{"x", ",", 
             RowBox[{"n", "+", "m"}]}], "]"}]}]}], "}"}]}], "//", "Echo"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Now", " ", "remove", " ", "the", " ", "scalars"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"hel", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"locexp", "=", 
      RowBox[{
       RowBox[{"locexp", "/.", 
        RowBox[{
         RowBox[{"weight", "[", 
          RowBox[{"x_", ",", "0"}], "]"}], "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"hel", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"hel", ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0"}], "}"}], "}"}]}], "]"}]}], ";", "1"}], 
          ")"}]}]}], "//", "Echo"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "scalars", " ", "might", " ", "appear", " ", "in", " ", "multiple", 
        " ", "terms"}], ",", " ", 
       RowBox[{
       "so", " ", "we", " ", "delete", " ", "the", " ", "duplicates"}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"hel", "=", 
      RowBox[{"hel", "//", "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "If", " ", "locexp", " ", "now", " ", "still", " ", "contains", " ", 
        "a", " ", "sum", " ", "of", " ", "any", " ", "kind", " ", "it", " ", 
        "means", " ", "that", " ", "the", " ", "terms", " ", "are", " ", 
        "not", " ", "uniform", " ", "in", " ", "the", " ", "spinor", " ", 
        RowBox[{"weight", ".", " ", "The"}], " ", "ToString", " ", 
        "replacement", " ", "is", " ", "needed", " ", "so", " ", "that", " ", 
        "spinor", " ", "arguments", " ", "like", " ", "n"}], "+", 
       RowBox[{"1", " ", "are", " ", "still", " ", "allowed"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FreeQ", "[", 
         RowBox[{
          RowBox[{"locexp", "/.", 
           RowBox[{
            RowBox[{"weight", "[", 
             RowBox[{"x_", ",", "n_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"weight", "[", 
             RowBox[{
              RowBox[{"ToString", "[", "x", "]"}], ",", "n"}], "]"}]}]}], ",",
           "Plus"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"HelicityWeight", "::", "unequalweight"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "$Failed", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Putting", " ", "things", " ", "together"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"locexp", "/.", 
      RowBox[{
       RowBox[{"weight", "[", 
        RowBox[{"x_", ",", "n_"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"hel", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"hel", ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"x", ",", "n"}], "}"}], "}"}]}], "]"}]}], ";", "1"}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Append", " ", "the", " ", "missing", " ", "momenta", " ", "with", " ", 
       "weight", " ", "zero"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"FreeQ", "[", 
           RowBox[{"hel", ",", "i"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"hel", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"hel", ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0"}], "}"}], "}"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "moms"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Sort", " ", "and", " ", "return", " ", "output"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"hel", "//", "Sort"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8020872979142237`*^9, 3.8020873160696135`*^9}, {
   3.802087436111477*^9, 3.8020874377581253`*^9}, {3.8020874898438635`*^9, 
   3.802087573902363*^9}, 3.8020876097376256`*^9, {3.8020876422976565`*^9, 
   3.802087750207063*^9}, {3.8020878186425133`*^9, 3.8020879527458715`*^9}, {
   3.8020880573723707`*^9, 3.802088158979127*^9}, {3.802088391994057*^9, 
   3.8020884374908032`*^9}, {3.8020890717325106`*^9, 3.802089139254505*^9}, {
   3.802089190056664*^9, 3.802089305764164*^9}, {3.802089399655994*^9, 
   3.8020895229731083`*^9}, {3.8020896395165243`*^9, 
   3.8020896822092433`*^9}, {3.8020897503021345`*^9, 
   3.8020898340670433`*^9}, {3.8020898751442213`*^9, 3.802089891478509*^9}, {
   3.802090046695079*^9, 3.8020900715905933`*^9}, {3.8020901042193327`*^9, 
   3.8020901704691095`*^9}, {3.8020902054286146`*^9, 3.802090426938077*^9}, {
   3.802090771061139*^9, 3.8020907778932047`*^9}, 3.8020908603308363`*^9, {
   3.8020909519401665`*^9, 3.8020909520608273`*^9}, {3.8025881440890503`*^9, 
   3.80258814626721*^9}, {3.80258823276371*^9, 3.802588394859107*^9}},
 CellLabel->
  "In[225]:=",ExpressionUUID->"0c8d85ac-7a45-4b0c-9d6e-fb6f845ede93"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HelicityWeight8", "[", 
   RowBox[{
    TemplateBox[{"1", 
      RowBox[{"{", "2", "}"}], "3"},
     "AngleSquareChain",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], 
    TemplateBox[{"4", "5"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], "]"}], "//", 
  "RepeatedTiming"}]], "Input",
 CellChangeTimes->{{3.8020877624891095`*^9, 3.802087766896321*^9}, {
  3.802087804752715*^9, 3.8020878260776267`*^9}, {3.802087924423401*^9, 
  3.8020879292487755`*^9}, {3.802087978477083*^9, 3.802088012391802*^9}, {
  3.8020883436741853`*^9, 3.802088343991341*^9}, {3.8020884094075556`*^9, 
  3.8020884487905917`*^9}, {3.802090441118133*^9, 3.802090445175295*^9}},
 CellLabel->
  "In[193]:=",ExpressionUUID->"3f378527-283f-491d-96e6-d4e7a62433d4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0002314958984374999`2.", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.802087767835807*^9, {3.8020878075063534`*^9, 3.8020878382999682`*^9}, {
   3.802087930444522*^9, 3.802088013047043*^9}, {3.8020880738801594`*^9, 
   3.802088154674632*^9}, 3.8020883446734705`*^9, {3.8020883854315977`*^9, 
   3.802088449176509*^9}, {3.8020904120468955`*^9, 3.80209044602796*^9}},
 CellLabel->
  "Out[193]=",ExpressionUUID->"e7d67dc4-6ef9-4e15-bb3e-48638956a2fa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight8", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.8020904628230357`*^9, 3.802090469759484*^9}},
 CellLabel->
  "In[194]:=",ExpressionUUID->"df69f282-6f2b-40c1-be51-e8718751ecd5"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.8020904705883055`*^9},
 CellLabel->
  "Out[194]=",ExpressionUUID->"58678d43-2a4e-4556-8e54-183c8652478f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight8", "[", 
  RowBox[{"1", "/", 
   RowBox[{"(", 
    RowBox[{
     TemplateBox[{"1", "3"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "+", "1"}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8020904763449187`*^9, 3.802090534039543*^9}},
 CellLabel->
  "In[199]:=",ExpressionUUID->"29972f00-3529-4931-b97a-f60eef7ec1a8"],

Cell[BoxData[
 TemplateBox[{
  "HelicityWeight", "unequalweight", 
   "\"Some terms have unequal weights, please check input.\"", 2, 199, 8, 
   25105406130839072390, "Local", "SpinorHelicity6D`HelicityWeight"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.8020905346877546`*^9},
 CellLabel->
  "During evaluation of \
In[199]:=",ExpressionUUID->"4baa59f4-9983-46af-9e58-bfad076cb43a"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{{3.802090486891814*^9, 3.8020905347106953`*^9}},
 CellLabel->
  "Out[199]=",ExpressionUUID->"00b5b06f-ff56-4924-80cb-f75be7ca3e1c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight8", "[", 
  RowBox[{"1", "/", 
   RowBox[{"(", 
    TemplateBox[{
      RowBox[{"n", "+", "1"}], "3"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8020905430543833`*^9, 3.8020905471075687`*^9}},
 CellLabel->
  "In[200]:=",ExpressionUUID->"7af0d2ca-a70a-4931-baab-add396d0260b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "+", "n"}], ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.802090548464905*^9},
 CellLabel->
  "Out[200]=",ExpressionUUID->"2836bb87-f681-4d67-8846-69c2b403b5bb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight8", "[", 
  RowBox[{
   TemplateBox[{"1", "3"},
    "SpinorAngleBracket",
    DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
    InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], "^", "4"}], "]"}]], "Input",
 CellChangeTimes->{{3.80209055678166*^9, 3.802090568699435*^9}},
 CellLabel->
  "In[201]:=",ExpressionUUID->"84af6e92-e4a3-4f6f-a252-16fa591d128b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"-", "4"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8020905691362886`*^9},
 CellLabel->
  "Out[201]=",ExpressionUUID->"7705ead1-6632-4f3b-b078-919aef7c9a4f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tests", "Subsubsection",
 CellChangeTimes->{{3.8020691261921625`*^9, 
  3.8020691273138795`*^9}},ExpressionUUID->"be2fc23b-c5e8-4554-8d81-\
5f5f19fde10e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HelicityWeight8", "[", 
   RowBox[{
    TemplateBox[{"1", "2"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], 
    TemplateBox[{"2", "1"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], "]"}], "//", 
  "RepeatedTiming"}]], "Input",
 CellChangeTimes->{{3.802069146584921*^9, 3.8020691585791397`*^9}, {
  3.8020692179901013`*^9, 3.8020692207240534`*^9}, {3.802090580523813*^9, 
  3.802090594498434*^9}},
 CellLabel->
  "In[204]:=",ExpressionUUID->"7752e91c-9cb3-47d9-b881-b3313fd7e849"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0002236668356997971`2.", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.802069159410637*^9, {3.8020692119938116`*^9, 3.8020692212466507`*^9}, 
   3.8020708998526564`*^9, {3.802090581549065*^9, 3.802090595442935*^9}},
 CellLabel->
  "Out[204]=",ExpressionUUID->"8cb02b51-bf77-4e1b-954b-eae0b6488e2b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight8", "[", 
  TemplateBox[{"p1", 
    RowBox[{"{", "p2", "}"}], "p3"},
   "AngleSquareChain",
   DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$square", 
      "]"}]& )], "]"}]], "Input",
 CellChangeTimes->{{3.8020692284348116`*^9, 3.8020692472097435`*^9}, {
  3.8020905845201244`*^9, 3.802090584882203*^9}},
 CellLabel->
  "In[203]:=",ExpressionUUID->"bcd79505-5702-428c-9a9b-8be916a54c76"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p1", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p3", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.802069248352642*^9, 3.8020905875720034`*^9},
 CellLabel->
  "Out[203]=",ExpressionUUID->"004c5a96-c03f-4fe0-85c2-930810906e51"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight8", "[", 
  TemplateBox[{"p1", 
    RowBox[{"{", "p2", "}"}], "p3"},
   "SquareAngleChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "]"}]], "Input",
 CellChangeTimes->{{3.802069253802479*^9, 3.802069269037195*^9}, {
  3.802090602323499*^9, 3.802090602565855*^9}},
 CellLabel->
  "In[205]:=",ExpressionUUID->"e64ce691-768e-4ae4-bd2e-a00051078563"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p3", ",", 
     RowBox[{"-", "1"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8020692700493364`*^9, 3.802090603904267*^9},
 CellLabel->
  "Out[205]=",ExpressionUUID->"8ae8e3ed-1b71-432d-9e04-85e4983b94e2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight8", "[", 
  TemplateBox[{"p1", 
    RowBox[{"{", 
      RowBox[{"p2", ",", "p3"}], "}"}], "p4"},
   "AngleAngleChain",
   DisplayFunction->(
    RowBox[{"\[LeftAngleBracket]", #, #2, #3, "\[RightAngleBracket]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", "$angle", 
      "]"}]& )], "]"}]], "Input",
 CellChangeTimes->{{3.802069279799368*^9, 3.802069300205358*^9}, {
  3.8020906087552986`*^9, 3.8020906090634713`*^9}},
 CellLabel->
  "In[206]:=",ExpressionUUID->"335c2efc-f601-4687-a154-70b8309be6ca"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p1", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p4", ",", 
     RowBox[{"-", "1"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.802069301427267*^9, 3.8020906098424206`*^9},
 CellLabel->
  "Out[206]=",ExpressionUUID->"3f70e0e1-3f83-4ba9-8325-b6da9039e5be"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight8", "[", 
  TemplateBox[{"p1", 
    RowBox[{"{", 
      RowBox[{"p2", ",", "p3"}], "}"}], "p4"},
   "SquareSquareChain",
   DisplayFunction->(RowBox[{"[", #, #2, #3, "]"}]& ),
   InterpretationFunction->(
    RowBox[{"Chain", "[", "$square", ",", #, ",", #2, ",", #3, ",", "$square",
       "]"}]& )], "]"}]], "Input",
 CellChangeTimes->{{3.8020693035562744`*^9, 3.8020693169416685`*^9}, {
  3.802090612570134*^9, 3.802090612870329*^9}},
 CellLabel->
  "In[207]:=",ExpressionUUID->"377492df-6f5d-4ba9-a31b-8bd41099308d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p4", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.80206931766927*^9, 3.8020906135954313`*^9},
 CellLabel->
  "Out[207]=",ExpressionUUID->"152734cd-6f74-4086-8ebe-79f74d88ffec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Kappa]", "4"], " ", 
       SuperscriptBox[
        TemplateBox[{"l1", 
          RowBox[{"{", "p1", "}"}], "l2"},
         "AngleSquareChain",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
            "$square", "]"}]& )], "2"], " ", 
       SuperscriptBox[
        TemplateBox[{"p3", 
          RowBox[{"{", 
            RowBox[{"-", "l2"}], "}"}], "p4"},
         "AngleSquareChain",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
            "$square", "]"}]& )], "2"], " ", 
       SuperscriptBox[
        TemplateBox[{"l2", "p3"},
         "SpinorAngleBracket",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
            RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
         InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
            RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
       SuperscriptBox[
        TemplateBox[{"l1", "p4"},
         "SpinorSquareBracket",
         DisplayFunction->(RowBox[{"[", 
            RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
         InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
            RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
       SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
      RowBox[{"128", " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l1"}], ",", 
         RowBox[{"-", "l2"}]}], "]"}], " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SuperscriptBox["m", "2"], " ", 
          SuperscriptBox["\[Kappa]", "2"], " ", 
          SuperscriptBox[
           TemplateBox[{"p3", 
             RowBox[{"{", 
               RowBox[{"-", "l1"}], "}"}], "p4"},
            "AngleSquareChain",
            
            DisplayFunction->(
             RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
            
            InterpretationFunction->(
             RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
               "$square", "]"}]& )], "4"], " ", 
          SuperscriptBox[
           TemplateBox[{"l1", "l2"},
            "SpinorAngleBracket",
            DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
               RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
            InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
               RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
          SuperscriptBox[
           TemplateBox[{"l1", "l2"},
            "SpinorSquareBracket",
            DisplayFunction->(RowBox[{"[", 
               RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
            InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
               RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
          SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
         RowBox[{"64", " ", "s", " ", 
          TemplateBox[{
            
            TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ),
              InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )], 
            
            TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ),
              InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
           "ScalarProduct",
           DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
           InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
          " ", 
          RowBox[{"S4", "[", 
           RowBox[{
            RowBox[{"-", "l1"}], ",", 
            RowBox[{"-", "l2"}]}], "]"}], " ", 
          RowBox[{"S4", "[", 
           RowBox[{
            RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
          RowBox[{"S4", "[", 
           RowBox[{
            RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["m", "2"], " ", 
         SuperscriptBox["\[Kappa]", "2"], " ", 
         SuperscriptBox[
          TemplateBox[{"p3", 
            RowBox[{"{", 
              RowBox[{"-", "l2"}], "}"}], "p4"},
           "AngleSquareChain",
           
           DisplayFunction->(
            RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
              "$square", "]"}]& )], "4"], " ", 
         SuperscriptBox[
          TemplateBox[{"l1", "l2"},
           "SpinorAngleBracket",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
           InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
         SuperscriptBox[
          TemplateBox[{"l1", "l2"},
           "SpinorSquareBracket",
           DisplayFunction->(RowBox[{"[", 
              RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
           InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
         SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
        RowBox[{"64", " ", "s", " ", 
         TemplateBox[{
           
           TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )], 
           
           TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
          "ScalarProduct",
          DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
          InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
         " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l1"}], ",", 
           RowBox[{"-", "l2"}]}], "]"}], " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l2"}], ",", "p3"}], "]"}], " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l2"}], ",", "p4"}], "]"}]}]]}], ")"}]}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "l1"}], "\[Rule]", "l1"}], ",", 
     RowBox[{
      RowBox[{"-", "l2"}], "\[Rule]", "l2"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.794301262803868*^9, 3.7943012704525943`*^9}, {
  3.8020908888328776`*^9, 3.8020909009704213`*^9}},
 CellLabel->
  "In[215]:=",ExpressionUUID->"ddfe5b37-110d-432b-bd88-2d3d1ba5965d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[Kappa]", "4"], " ", 
     SuperscriptBox[
      TemplateBox[{"l1", 
        RowBox[{"{", "p1", "}"}], "l2"},
       "AngleSquareChain",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
          "$square", "]"}]& )], "2"], " ", 
     SuperscriptBox[
      TemplateBox[{"p3", 
        RowBox[{"{", "l2", "}"}], "p4"},
       "AngleSquareChain",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
          "$square", "]"}]& )], "2"], " ", 
     SuperscriptBox[
      TemplateBox[{"l2", "p3"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
     SuperscriptBox[
      TemplateBox[{"l1", "p4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
     SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
    RowBox[{"128", " ", 
     RowBox[{"S4", "[", 
      RowBox[{"l1", ",", "l2"}], "]"}], " ", 
     RowBox[{"S4", "[", 
      RowBox[{"l1", ",", "p3"}], "]"}], " ", 
     RowBox[{"S4", "[", 
      RowBox[{"l1", ",", "p4"}], "]"}]}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["m", "2"], " ", 
        SuperscriptBox["\[Kappa]", "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"p3", 
           RowBox[{"{", "l1", "}"}], "p4"},
          "AngleSquareChain",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
          
          InterpretationFunction->(
           RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
             "$square", "]"}]& )], "4"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1", "l2"},
          "SpinorAngleBracket",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
             RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
          InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1", "l2"},
          "SpinorSquareBracket",
          DisplayFunction->(RowBox[{"[", 
             RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
          InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
       RowBox[{"64", " ", "s", " ", 
        TemplateBox[{
          
          TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )], 
          
          TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
         "ScalarProduct",
         DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
         InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
        " ", 
        RowBox[{"S4", "[", 
         RowBox[{"l1", ",", "l2"}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{"l1", ",", "p3"}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{"l1", ",", "p4"}], "]"}]}]]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["m", "2"], " ", 
       SuperscriptBox["\[Kappa]", "2"], " ", 
       SuperscriptBox[
        TemplateBox[{"p3", 
          RowBox[{"{", "l2", "}"}], "p4"},
         "AngleSquareChain",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
            "$square", "]"}]& )], "4"], " ", 
       SuperscriptBox[
        TemplateBox[{"l1", "l2"},
         "SpinorAngleBracket",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
            RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
         InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
            RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
       SuperscriptBox[
        TemplateBox[{"l1", "l2"},
         "SpinorSquareBracket",
         DisplayFunction->(RowBox[{"[", 
            RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
         InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
            RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
       SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
      RowBox[{"64", " ", "s", " ", 
       TemplateBox[{
         TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
          InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )], 
         TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
          InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
        "ScalarProduct",
        DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
        InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
       " ", 
       RowBox[{"S4", "[", 
        RowBox[{"l1", ",", "l2"}], "]"}], " ", 
       RowBox[{"S4", "[", 
        RowBox[{"l2", ",", "p3"}], "]"}], " ", 
       RowBox[{"S4", "[", 
        RowBox[{"l2", ",", "p4"}], "]"}]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.79430126426431*^9, 3.7943012711177635`*^9}, 
   3.794314357615675*^9, 3.802084841989863*^9, 3.80209073812424*^9, 
   3.802090902299865*^9},
 CellLabel->
  "Out[215]=",ExpressionUUID->"17ab985e-1a21-4556-8703-663148022df7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HelicityWeight8", "[", "test", "]"}]], "Input",
 CellChangeTimes->{{3.7943143507942367`*^9, 3.79431435439968*^9}, {
   3.7943146389741993`*^9, 3.794314647210569*^9}, 3.802084843996517*^9, {
   3.802085218232664*^9, 3.8020852187982016`*^9}, {3.8020907411062794`*^9, 
   3.8020907413885236`*^9}},
 CellLabel->
  "In[220]:=",ExpressionUUID->"2b8ba432-8268-4427-ab0f-b57b987f3e2b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"l1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"l2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p3", ",", 
     RowBox[{"-", "4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"l1"},
      "MomPure",
      DisplayFunction->(RowBox[{#}]& ),
      InterpretationFunction->(RowBox[{"MomPure", "[", #, "]"}]& )], ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"p1"},
      "MomPure",
      DisplayFunction->(RowBox[{#}]& ),
      InterpretationFunction->(RowBox[{"MomPure", "[", #, "]"}]& )], ",", 
     "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.794314360249627*^9, 3.794314422010434*^9, 3.794314455352127*^9, {
   3.7943145353981967`*^9, 3.7943145559306154`*^9}, {3.7943146410513*^9, 
   3.794314647909994*^9}, 3.7943149778387184`*^9, 3.802084846302327*^9, 
   3.802084893681563*^9, 3.8020852208357306`*^9, 3.8020907421095734`*^9, {
   3.8020909599926157`*^9, 3.802090970368851*^9}},
 CellLabel->
  "Out[220]=",ExpressionUUID->"884c3438-a543-47b2-aac3-282a9ba4bbb7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test2", "=", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[Kappa]", "4"], " ", 
      SuperscriptBox[
       TemplateBox[{"l1", 
         RowBox[{"{", "p1", "}"}], "l3"},
        "AngleSquareChain",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
           "$square", "]"}]& )], "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"p3", 
         RowBox[{"{", 
           RowBox[{"-", "l2"}], "}"}], "p4"},
        "AngleSquareChain",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
           "$square", "]"}]& )], "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"l2", "p3"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"l1", "p4"},
        "SpinorSquareBracket",
        DisplayFunction->(RowBox[{"[", 
           RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
        InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
      SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
     RowBox[{"128", " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", 
        RowBox[{"-", "l2"}]}], "]"}], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["m", "2"], " ", 
         SuperscriptBox["\[Kappa]", "2"], " ", 
         SuperscriptBox[
          TemplateBox[{"p3", 
            RowBox[{"{", 
              RowBox[{"-", "l1"}], "}"}], "p4"},
           "AngleSquareChain",
           
           DisplayFunction->(
            RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
              "$square", "]"}]& )], "4"], " ", 
         SuperscriptBox[
          TemplateBox[{"l1", "l2"},
           "SpinorAngleBracket",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
           InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
         SuperscriptBox[
          TemplateBox[{"l1", "l2"},
           "SpinorSquareBracket",
           DisplayFunction->(RowBox[{"[", 
              RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
           InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
         SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
        RowBox[{"64", " ", "s", " ", 
         TemplateBox[{
           
           TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )], 
           
           TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
          "ScalarProduct",
          DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
          InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
         " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l1"}], ",", 
           RowBox[{"-", "l2"}]}], "]"}], " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["m", "2"], " ", 
        SuperscriptBox["\[Kappa]", "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"p3", 
           RowBox[{"{", 
             RowBox[{"-", "l2"}], "}"}], "p4"},
          "AngleSquareChain",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
          
          InterpretationFunction->(
           RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
             "$square", "]"}]& )], "4"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1", "l2"},
          "SpinorAngleBracket",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
             RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
          InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1", "l2"},
          "SpinorSquareBracket",
          DisplayFunction->(RowBox[{"[", 
             RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
          InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
       RowBox[{"64", " ", "s", " ", 
        TemplateBox[{
          
          TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )], 
          TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
         "ScalarProduct",
         DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
         InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
        " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", 
          RowBox[{"-", "l2"}]}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l2"}], ",", "p3"}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l2"}], ",", "p4"}], "]"}]}]]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7943145697369833`*^9, 3.7943145891220655`*^9}},
 CellLabel->
  "In[221]:=",ExpressionUUID->"6b3c4865-b001-4db1-a667-1fa20e5af3d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[Kappa]", "4"], " ", 
     SuperscriptBox[
      TemplateBox[{"l1", 
        RowBox[{"{", "p1", "}"}], "l3"},
       "AngleSquareChain",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
          "$square", "]"}]& )], "2"], " ", 
     SuperscriptBox[
      TemplateBox[{"p3", 
        RowBox[{"{", 
          RowBox[{"-", "l2"}], "}"}], "p4"},
       "AngleSquareChain",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
          "$square", "]"}]& )], "2"], " ", 
     SuperscriptBox[
      TemplateBox[{"l2", "p3"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
     SuperscriptBox[
      TemplateBox[{"l1", "p4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
     SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
    RowBox[{"128", " ", 
     RowBox[{"S4", "[", 
      RowBox[{
       RowBox[{"-", "l1"}], ",", 
       RowBox[{"-", "l2"}]}], "]"}], " ", 
     RowBox[{"S4", "[", 
      RowBox[{
       RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
     RowBox[{"S4", "[", 
      RowBox[{
       RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["m", "2"], " ", 
        SuperscriptBox["\[Kappa]", "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"p3", 
           RowBox[{"{", 
             RowBox[{"-", "l1"}], "}"}], "p4"},
          "AngleSquareChain",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
          
          InterpretationFunction->(
           RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
             "$square", "]"}]& )], "4"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1", "l2"},
          "SpinorAngleBracket",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
             RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
          InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1", "l2"},
          "SpinorSquareBracket",
          DisplayFunction->(RowBox[{"[", 
             RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
          InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
       RowBox[{"64", " ", "s", " ", 
        TemplateBox[{
          
          TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )], 
          
          TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
         "ScalarProduct",
         DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
         InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
        " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", 
          RowBox[{"-", "l2"}]}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["m", "2"], " ", 
       SuperscriptBox["\[Kappa]", "2"], " ", 
       SuperscriptBox[
        TemplateBox[{"p3", 
          RowBox[{"{", 
            RowBox[{"-", "l2"}], "}"}], "p4"},
         "AngleSquareChain",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
            "$square", "]"}]& )], "4"], " ", 
       SuperscriptBox[
        TemplateBox[{"l1", "l2"},
         "SpinorAngleBracket",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
            RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
         InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
            RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
       SuperscriptBox[
        TemplateBox[{"l1", "l2"},
         "SpinorSquareBracket",
         DisplayFunction->(RowBox[{"[", 
            RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
         InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
            RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
       SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
      RowBox[{"64", " ", "s", " ", 
       TemplateBox[{
         TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
          InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )], 
         TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
          InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
        "ScalarProduct",
        DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
        InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
       " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l1"}], ",", 
         RowBox[{"-", "l2"}]}], "]"}], " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l2"}], ",", "p3"}], "]"}], " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l2"}], ",", "p4"}], "]"}]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.794314590953373*^9, 3.8020849292839026`*^9, 
  3.8020909775855484`*^9},
 CellLabel->
  "Out[221]=",ExpressionUUID->"9b2ad153-9afe-49ee-8e47-e2cb25be8793"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test2", "//", "HelicityWeight8"}]], "Input",
 CellChangeTimes->{{3.794314592789912*^9, 3.7943145966657677`*^9}, {
  3.8020849337719517`*^9, 3.8020849472673993`*^9}, {3.8020909795054245`*^9, 
  3.802090979918338*^9}},
 CellLabel->
  "In[222]:=",ExpressionUUID->"807b8c4a-4edd-4fa0-b8fa-ba0ff29296f6"],

Cell[BoxData[
 TemplateBox[{
  "HelicityWeight", "unequalweight", 
   "\"Some terms have unequal weights, please check input.\"", 2, 222, 11, 
   25105406130839072390, "Local", "SpinorHelicity6D`HelicityWeight"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.8020909812776833`*^9},
 CellLabel->
  "During evaluation of \
In[222]:=",ExpressionUUID->"433fd6e3-9a68-4c81-85fd-8d3c89714078"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{
  3.7943145971520257`*^9, 3.7943149827340207`*^9, {3.8020849361505327`*^9, 
   3.802084950227482*^9}, 3.8020850998712463`*^9, 3.8020909812946367`*^9},
 CellLabel->
  "Out[222]=",ExpressionUUID->"18e018e7-d353-4acd-b8cb-064bbc4ef7d2"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mass dimension", "Section",
 CellChangeTimes->{{3.7943151128408394`*^9, 
  3.794315116665744*^9}},ExpressionUUID->"e7475660-c38e-42ef-b64d-\
e559e6d317ab"],

Cell[CellGroupData[{

Cell["Defining the function", "Subsection",
 CellChangeTimes->{{3.7947247956493664`*^9, 
  3.794724799437481*^9}},ExpressionUUID->"5a180252-23c5-4547-ae46-\
e0be27d8ef88"],

Cell[CellGroupData[{

Cell["Version 1 does not work with negative powers", "Subsubsection",
 CellChangeTimes->{{3.794728428117255*^9, 
  3.7947284377933893`*^9}},ExpressionUUID->"b304cb17-ebab-437d-87d5-\
25345397dd88"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Options", "[", "MassDimension", "]"}], "=", 
  RowBox[{"{", 
   RowBox[{"SetDimension", "\[Rule]", 
    RowBox[{"{", "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.7943151304067917`*^9, 3.794315158769108*^9}, {
  3.794316356361335*^9, 3.7943163565548058`*^9}, {3.794316485679387*^9, 
  3.794316492243043*^9}},
 CellLabel->
  "In[357]:=",ExpressionUUID->"b28b83b5-895a-4e7e-acbb-d78b3a937434"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"SetDimension", "\[Rule]", 
   RowBox[{"{", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7943162970924387`*^9, 3.794316359094331*^9, 
  3.7943164941496325`*^9, 3.794724802722251*^9},
 CellLabel->
  "Out[357]=",ExpressionUUID->"0b558be6-2951-4506-9072-cb29d80abe9a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MassDimension", "[", 
    RowBox[{"exp_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Catch", "[", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"locexp", ",", "locrep", ",", "pow", ",", "weight"}], "}"}], 
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "replace", " ", "with", " ", "pow", " ", "in", " ", 
         "exp"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"locexp", "=", 
         RowBox[{"exp", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"SpinorAngleBracket", "[", "x__", "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"pow", "*", 
              RowBox[{"SpinorAngleBracket", "[", "x", "]"}]}]}], ",", 
            RowBox[{
             RowBox[{"SpinorSquareBracket", "[", "x__", "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"pow", "*", 
              RowBox[{"SpinorSquareBracket", "[", "x", "]"}]}]}], ",", 
            RowBox[{
             RowBox[{"Chain", "[", 
              RowBox[{"type1_", ",", "x_", ",", 
               RowBox[{"{", "y__", "}"}], ",", "z_", ",", "type2_"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"Chain", "[", 
               RowBox[{"type1", ",", "x", ",", 
                RowBox[{"{", "y", "}"}], ",", "z", ",", "type2"}], "]"}], "*", 
              RowBox[{"pow", "^", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"{", "y", "}"}], "]"}], "+", "1"}], ")"}]}]}]}], 
            ",", 
            RowBox[{
             RowBox[{"S4", "[", "x__", "]"}], "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"pow", "^", "2"}], "*", 
              RowBox[{"S4", "[", "x", "]"}]}]}], ",", 
            RowBox[{
             RowBox[{"S", "[", "x__", "]"}], "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"pow", "^", "2"}], "*", 
              RowBox[{"S", "[", "x", "]"}]}]}], ",", 
            RowBox[{
             RowBox[{"mp", "[", 
              RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"pow", "^", "2"}], "*", 
              RowBox[{"mp", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "locexp", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"locrep", "=", 
              RowBox[{"OptionValue", "[", "SetDimension", "]"}]}], ")"}], "===", 
            RowBox[{"{", "}"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Check", " ", "that", " ", "the", " ", "dimension", " ", "has", 
            " ", "been", " ", "assigned", " ", "consistently"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"AllTrue", "[", 
              RowBox[{"locrep", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Head", "[", "#", "]"}], "===", "Rule"}], "||", 
                  RowBox[{
                   RowBox[{"Head", "[", "#", "]"}], "===", "RuleDelayed"}]}], 
                 ")"}], "&"}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Put", " ", "SetDimension", " ", "in", " ", "a", " ", "form", 
               " ", "which", " ", "we", " ", "like"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"locrep", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"i", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
                  RowBox[{
                   RowBox[{"i", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", 
                   RowBox[{"pow", "^", 
                    RowBox[{"i", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "locrep"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"locexp", "=", 
               RowBox[{"locexp", "/.", "locrep"}]}], ";"}], 
             "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "Throw", "[", 
               "\"\<Dimensions in SetDimension must be given as Rule or \
RuleDelayed, please check the value assigned to this option.\>\"", "]"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Collect", " ", "the", " ", "weights"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"locexp", "=", 
         RowBox[{"CoefficientRules", "[", 
          RowBox[{"locexp", ",", 
           RowBox[{"{", "pow", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "locexp", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "locexp", "]"}], "\[Equal]", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"locexp", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<Terms with different mass dimension appear in expression. \
Check your input\>\"", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"locexp", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"i", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"i", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "locexp"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "locexp", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.794315120169921*^9, 3.794315128050519*^9}, {
   3.7943151630041385`*^9, 3.7943151813748646`*^9}, {3.7943153054312515`*^9, 
   3.7943153379716167`*^9}, {3.7943153752833695`*^9, 3.794315384879012*^9}, {
   3.7943154324931087`*^9, 3.7943157681169424`*^9}, 3.794315814658598*^9, {
   3.794316083896865*^9, 3.794316291532922*^9}, {3.79431633913899*^9, 
   3.7943163438701315`*^9}, {3.7943164126635995`*^9, 3.794316416718504*^9}, {
   3.794316473470642*^9, 3.794316546431591*^9}, {3.7943165802140465`*^9, 
   3.794316626575315*^9}, {3.7943167988725114`*^9, 3.794316955148098*^9}, {
   3.794317113136346*^9, 3.794317115102432*^9}, 3.794317160034893*^9, {
   3.794317235324744*^9, 3.7943172617972536`*^9}, {3.7943173956821184`*^9, 
   3.7943174084072638`*^9}, {3.7943176929967756`*^9, 3.794317694577608*^9}, {
   3.794317823775268*^9, 3.7943178287137775`*^9}, {3.7947251902313037`*^9, 
   3.7947251952717857`*^9}, {3.794725237852524*^9, 3.794725242702606*^9}},
 CellLabel->
  "In[380]:=",ExpressionUUID->"0a34a5fc-fba1-4c43-a89a-4b6557fe33d8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Version 2", "Subsubsection",
 CellChangeTimes->{{3.794728442630424*^9, 
  3.7947284442072487`*^9}},ExpressionUUID->"4ce6f9b5-1bd8-4154-abc0-\
42e12149c8c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Options", "[", "MassDimension", "]"}], "=", 
  RowBox[{"{", 
   RowBox[{"SetDimension", "\[Rule]", 
    RowBox[{"{", "}"}]}], "}"}]}]], "Input",ExpressionUUID->"7cad7572-7dce-\
445c-b284-cc527990a56d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MassDimension", "[", 
    RowBox[{"exp_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Catch", "[", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "locexp", ",", "locrep", ",", "pow", ",", "invpow", ",", "weight"}], 
        "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "replace", " ", "with", " ", "pow", " ", "in", " ", 
         "exp"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"locexp", "=", 
         RowBox[{"exp", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"SpinorAngleBracket", "[", "x__", "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"pow", "*", 
              RowBox[{"SpinorAngleBracket", "[", "x", "]"}]}]}], ",", 
            RowBox[{
             RowBox[{"SpinorSquareBracket", "[", "x__", "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"pow", "*", 
              RowBox[{"SpinorSquareBracket", "[", "x", "]"}]}]}], ",", 
            RowBox[{
             RowBox[{"Chain", "[", 
              RowBox[{"type1_", ",", "x_", ",", 
               RowBox[{"{", "y__", "}"}], ",", "z_", ",", "type2_"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"Chain", "[", 
               RowBox[{"type1", ",", "x", ",", 
                RowBox[{"{", "y", "}"}], ",", "z", ",", "type2"}], "]"}], "*", 
              RowBox[{"pow", "^", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"{", "y", "}"}], "]"}], "+", "1"}], ")"}]}]}]}], 
            ",", 
            RowBox[{
             RowBox[{"S4", "[", "x__", "]"}], "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"pow", "^", "2"}], "*", 
              RowBox[{"S4", "[", "x", "]"}]}]}], ",", 
            RowBox[{
             RowBox[{"S", "[", "x__", "]"}], "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"pow", "^", "2"}], "*", 
              RowBox[{"S", "[", "x", "]"}]}]}], ",", 
            RowBox[{
             RowBox[{"mp", "[", 
              RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"pow", "^", "2"}], "*", 
              RowBox[{"mp", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"locrep", "=", 
              RowBox[{"OptionValue", "[", "SetDimension", "]"}]}], ")"}], "===", 
            RowBox[{"{", "}"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Check", " ", "that", " ", "the", " ", "dimension", " ", "has", 
            " ", "been", " ", "assigned", " ", "consistently"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"AllTrue", "[", 
              RowBox[{"locrep", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Head", "[", "#", "]"}], "===", "Rule"}], "||", 
                  RowBox[{
                   RowBox[{"Head", "[", "#", "]"}], "===", "RuleDelayed"}]}], 
                 ")"}], "&"}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Put", " ", "SetDimension", " ", "in", " ", "a", " ", "form", 
               " ", "which", " ", "we", " ", "like"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"locrep", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"i", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
                  RowBox[{
                   RowBox[{"i", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", 
                   RowBox[{"pow", "^", 
                    RowBox[{"i", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "locrep"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"locexp", "=", 
               RowBox[{"locexp", "/.", "locrep"}]}], ";"}], 
             "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "Throw", "[", 
               "\"\<Dimensions in SetDimension must be given as Rule or \
RuleDelayed, please check the value assigned to this option.\>\"", "]"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Collect", " ", "the", " ", "weights"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"locexp", "=", 
         RowBox[{"locexp", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Power", "[", 
             RowBox[{"pow", ",", 
              RowBox[{"n_", "?", "Negative"}]}], "]"}], "\[RuleDelayed]", 
            RowBox[{"invpow", "^", 
             RowBox[{"(", 
              RowBox[{"-", "n"}], ")"}]}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"locexp", "=", 
         RowBox[{"CoefficientRules", "[", 
          RowBox[{"locexp", ",", 
           RowBox[{"{", 
            RowBox[{"pow", ",", "invpow"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"locexp", "=", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"i", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
              RowBox[{"i", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "\[Rule]", 
             RowBox[{"i", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "locexp"}], "}"}]}], "]"}], "//", "Sort"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"locexp", "=", 
         RowBox[{"Gather", "[", 
          RowBox[{"locexp", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "#1", "]"}], "\[Equal]", 
             RowBox[{"First", "[", "#2", "]"}]}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"locexp", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"i", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Rule]", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"i", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "2"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"Length", "[", "i", "]"}]}], "}"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "locexp"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "locexp", "]"}], "\[Equal]", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"locexp", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<Terms with different mass dimension appear in expression. \
Check your input\>\"", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"locexp", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"i", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"i", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "locexp"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "locexp", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.794315120169921*^9, 3.794315128050519*^9}, {
   3.7943151630041385`*^9, 3.7943151813748646`*^9}, {3.7943153054312515`*^9, 
   3.7943153379716167`*^9}, {3.7943153752833695`*^9, 3.794315384879012*^9}, {
   3.7943154324931087`*^9, 3.7943157681169424`*^9}, 3.794315814658598*^9, {
   3.794316083896865*^9, 3.794316291532922*^9}, {3.79431633913899*^9, 
   3.7943163438701315`*^9}, {3.7943164126635995`*^9, 3.794316416718504*^9}, {
   3.794316473470642*^9, 3.794316546431591*^9}, {3.7943165802140465`*^9, 
   3.794316626575315*^9}, {3.7943167988725114`*^9, 3.794316955148098*^9}, {
   3.794317113136346*^9, 3.794317115102432*^9}, 3.794317160034893*^9, {
   3.794317235324744*^9, 3.7943172617972536`*^9}, {3.7943173956821184`*^9, 
   3.7943174084072638`*^9}, {3.7943176929967756`*^9, 3.794317694577608*^9}, {
   3.794317823775268*^9, 3.7943178287137775`*^9}, {3.7947251902313037`*^9, 
   3.7947251952717857`*^9}, {3.794725237852524*^9, 3.794725242702606*^9}, {
   3.7947253924472313`*^9, 3.7947254348119907`*^9}, {3.7947254698244247`*^9, 
   3.794725507909666*^9}, {3.7947262214578896`*^9, 3.794726276314288*^9}, {
   3.794726456697444*^9, 3.794726462777193*^9}, 3.794726546431301*^9, {
   3.7947269375128303`*^9, 3.7947270373086233`*^9}, {3.7947270905104656`*^9, 
   3.7947272259177003`*^9}, {3.7947273171793795`*^9, 
   3.7947273176610823`*^9}, {3.7947273880459447`*^9, 3.79472738845884*^9}, {
   3.794727447159666*^9, 3.794727458755664*^9}},
 CellLabel->
  "In[421]:=",ExpressionUUID->"6effc86d-dd7a-46bc-8498-9957b211eb17"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test", "Subsection",
 CellChangeTimes->{{3.794316303981124*^9, 
  3.7943163044867916`*^9}},ExpressionUUID->"df39d0a1-b28d-4308-a51a-\
433229c03d3f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test", "=", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[Kappa]", "4"], " ", 
      SuperscriptBox[
       TemplateBox[{"l1",RowBox[{"{", "p1", "}"}],"l2"},
        "AngleSquareChain",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
           "$square", "]"}]& )], "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"p3",RowBox[{"{", 
           RowBox[{"-", "l2"}], "}"}],"p4"},
        "AngleSquareChain",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
        InterpretationFunction->(
         RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
           "$square", "]"}]& )], "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"l2","p3"},
        "SpinorAngleBracket",
        DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
           RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
        InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
      SuperscriptBox[
       TemplateBox[{"l1","p4"},
        "SpinorSquareBracket",
        DisplayFunction->(RowBox[{"[", 
           RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
        InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
      SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
     RowBox[{"128", " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", 
        RowBox[{"-", "l2"}]}], "]"}], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
      RowBox[{"S4", "[", 
       RowBox[{
        RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["m", "2"], " ", 
         SuperscriptBox["\[Kappa]", "2"], " ", 
         SuperscriptBox[
          TemplateBox[{"p3",RowBox[{"{", 
              RowBox[{"-", "l1"}], "}"}],"p4"},
           "AngleSquareChain",
           
           DisplayFunction->(
            RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
              "$square", "]"}]& )], "4"], " ", 
         SuperscriptBox[
          TemplateBox[{"l1","l2"},
           "SpinorAngleBracket",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
           InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
         SuperscriptBox[
          TemplateBox[{"l1","l2"},
           "SpinorSquareBracket",
           DisplayFunction->(RowBox[{"[", 
              RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
           InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
         SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
        RowBox[{"64", " ", "s", " ", 
         TemplateBox[{
          TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
           TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
          "ScalarProduct",
          DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
          InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
         " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l1"}], ",", 
           RowBox[{"-", "l2"}]}], "]"}], " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["m", "2"], " ", 
        SuperscriptBox["\[Kappa]", "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"p3",RowBox[{"{", 
             RowBox[{"-", "l2"}], "}"}],"p4"},
          "AngleSquareChain",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
          
          InterpretationFunction->(
           RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
             "$square", "]"}]& )], "4"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1","l2"},
          "SpinorAngleBracket",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
             RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
          InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1","l2"},
          "SpinorSquareBracket",
          DisplayFunction->(RowBox[{"[", 
             RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
          InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
       RowBox[{"64", " ", "s", " ", 
        TemplateBox[{
         TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
          TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
         "ScalarProduct",
         DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
         InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
        " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", 
          RowBox[{"-", "l2"}]}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l2"}], ",", "p3"}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l2"}], ",", "p4"}], "]"}]}]]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.794301262803868*^9, 3.7943012704525943`*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"3417b43f-6530-428c-b278-13199f5b1a10"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[Kappa]", "4"], " ", 
     SuperscriptBox[
      TemplateBox[{"l1",RowBox[{"{", "p1", "}"}],"l2"},
       "AngleSquareChain",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
          "$square", "]"}]& )], "2"], " ", 
     SuperscriptBox[
      TemplateBox[{"p3",RowBox[{"{", 
          RowBox[{"-", "l2"}], "}"}],"p4"},
       "AngleSquareChain",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
          "$square", "]"}]& )], "2"], " ", 
     SuperscriptBox[
      TemplateBox[{"l2","p3"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
     SuperscriptBox[
      TemplateBox[{"l1","p4"},
       "SpinorSquareBracket",
       DisplayFunction->(RowBox[{"[", 
          RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
       InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
     SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
    RowBox[{"128", " ", 
     RowBox[{"S4", "[", 
      RowBox[{
       RowBox[{"-", "l1"}], ",", 
       RowBox[{"-", "l2"}]}], "]"}], " ", 
     RowBox[{"S4", "[", 
      RowBox[{
       RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
     RowBox[{"S4", "[", 
      RowBox[{
       RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["m", "2"], " ", 
        SuperscriptBox["\[Kappa]", "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"p3",RowBox[{"{", 
             RowBox[{"-", "l1"}], "}"}],"p4"},
          "AngleSquareChain",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
          
          InterpretationFunction->(
           RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
             "$square", "]"}]& )], "4"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1","l2"},
          "SpinorAngleBracket",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
             RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
          InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1","l2"},
          "SpinorSquareBracket",
          DisplayFunction->(RowBox[{"[", 
             RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
          InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
       RowBox[{"64", " ", "s", " ", 
        TemplateBox[{
         TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
          TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
         "ScalarProduct",
         DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
         InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
        " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", 
          RowBox[{"-", "l2"}]}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["m", "2"], " ", 
       SuperscriptBox["\[Kappa]", "2"], " ", 
       SuperscriptBox[
        TemplateBox[{"p3",RowBox[{"{", 
            RowBox[{"-", "l2"}], "}"}],"p4"},
         "AngleSquareChain",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
         InterpretationFunction->(
          RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
            "$square", "]"}]& )], "4"], " ", 
       SuperscriptBox[
        TemplateBox[{"l1","l2"},
         "SpinorAngleBracket",
         DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
            RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
         InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
            RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
       SuperscriptBox[
        TemplateBox[{"l1","l2"},
         "SpinorSquareBracket",
         DisplayFunction->(RowBox[{"[", 
            RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
         InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
            RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
       SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
      RowBox[{"64", " ", "s", " ", 
       TemplateBox[{
        TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
          InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
         TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
          InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
        "ScalarProduct",
        DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
        InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
       " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l1"}], ",", 
         RowBox[{"-", "l2"}]}], "]"}], " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l2"}], ",", "p3"}], "]"}], " ", 
       RowBox[{"S4", "[", 
        RowBox[{
         RowBox[{"-", "l2"}], ",", "p4"}], "]"}]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.79430126426431*^9, 3.7943012711177635`*^9}, 
   3.794314357615675*^9, 3.7943163180820045`*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"1569615c-fce3-4066-8c59-a426e08c0656"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test", "//", "MassDimension"}]], "Input",
 CellChangeTimes->{{3.7943163191756506`*^9, 3.7943163223979664`*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"df5f5af0-5ca8-411b-8ea9-47f7e4aa912d"],

Cell[BoxData["\<\"Terms with different mass dimension appear in expression. \
Check your input\"\>"], "Print",
 CellChangeTimes->{3.794316964899765*^9},
 CellLabel->
  "During evaluation of \
In[59]:=",ExpressionUUID->"3c8c0cbc-aa24-4c33-ac2e-a14862fb13e9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"16", ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["m", "2"], " ", 
         SuperscriptBox["\[Kappa]", "2"], " ", 
         SuperscriptBox[
          TemplateBox[{"p3",RowBox[{"{", 
              RowBox[{"-", "l1"}], "}"}],"p4"},
           "AngleSquareChain",
           
           DisplayFunction->(
            RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
           
           InterpretationFunction->(
            RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
              "$square", "]"}]& )], "4"], " ", 
         SuperscriptBox[
          TemplateBox[{"l1","l2"},
           "SpinorAngleBracket",
           DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
              RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
           InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
         SuperscriptBox[
          TemplateBox[{"l1","l2"},
           "SpinorSquareBracket",
           DisplayFunction->(RowBox[{"[", 
              RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
           InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
              RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
         SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
        RowBox[{"128", " ", "s", " ", 
         TemplateBox[{
          TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
           TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
          "ScalarProduct",
          DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
          InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
         " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l1"}], ",", 
           RowBox[{"-", "l2"}]}], "]"}], " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
         RowBox[{"S4", "[", 
          RowBox[{
           RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["m", "2"], " ", 
        SuperscriptBox["\[Kappa]", "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"p3",RowBox[{"{", 
             RowBox[{"-", "l2"}], "}"}],"p4"},
          "AngleSquareChain",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
          
          InterpretationFunction->(
           RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
             "$square", "]"}]& )], "4"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1","l2"},
          "SpinorAngleBracket",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
             RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
          InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1","l2"},
          "SpinorSquareBracket",
          DisplayFunction->(RowBox[{"[", 
             RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
          InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
       RowBox[{"128", " ", "s", " ", 
        TemplateBox[{
         TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
          TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
         "ScalarProduct",
         DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
         InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )], 
        " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", 
          RowBox[{"-", "l2"}]}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l2"}], ",", "p3"}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l2"}], ",", "p4"}], "]"}]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Kappa]", "4"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1",RowBox[{"{", "p1", "}"}],"l2"},
          "AngleSquareChain",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
          
          InterpretationFunction->(
           RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
             "$square", "]"}]& )], "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"p3",RowBox[{"{", 
             RowBox[{"-", "l2"}], "}"}],"p4"},
          "AngleSquareChain",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
          
          InterpretationFunction->(
           RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
             "$square", "]"}]& )], "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"l2","p3"},
          "SpinorAngleBracket",
          DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
             RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
          InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"l1","p4"},
          "SpinorSquareBracket",
          DisplayFunction->(RowBox[{"[", 
             RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
          InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
        SubscriptBox["\[Alpha]", "\[Gamma]"]}], 
       RowBox[{"128", " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", 
          RowBox[{"-", "l2"}]}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", "p3"}], "]"}], " ", 
        RowBox[{"S4", "[", 
         RowBox[{
          RowBox[{"-", "l1"}], ",", "p4"}], "]"}]}]]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.794316322906223*^9, 3.794316561880324*^9, 
  3.7943169649187136`*^9},
 CellLabel->"Out[59]=",ExpressionUUID->"f55be9cb-d77f-42ac-9c22-ce35c11bc4f7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MassDimension", "[", 
  RowBox[{"test", ",", 
   RowBox[{"{", 
    RowBox[{"SetDimension", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Kappa]", "->", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{"m", "\[Rule]", "1"}], ",", 
       RowBox[{"s", "\[Rule]", "2"}], ",", 
       RowBox[{
        SubscriptBox["\[Alpha]", "\[Gamma]"], "\[Rule]", 
        RowBox[{"-", "2"}]}]}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.794317070449797*^9, 3.794317097288185*^9}, {
  3.794317165486629*^9, 3.794317175389061*^9}, {3.7943204987610297`*^9, 
  3.794320508170924*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"e4fa12af-3551-4334-b321-dfd5bf7daff5"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.794317098354697*^9, 3.7943171241958075`*^9}, {
   3.7943171673474803`*^9, 3.794317175918881*^9}, 3.7943172240097885`*^9, 
   3.7943174177390327`*^9, 3.7943177027388697`*^9, 3.7943178368357534`*^9, 
   3.794320508841117*^9},
 CellLabel->"Out[84]=",ExpressionUUID->"263b09a2-9b9c-4530-9cb9-632b74d846e2"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tests", "Section",
 CellChangeTimes->{{3.794724896739829*^9, 
  3.794724897401064*^9}},ExpressionUUID->"acca3f08-a8eb-444b-bc60-\
23ccf24f2de6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", 
   RowBox[{
    TemplateBox[{"p4",RowBox[{"{", "p2", "}"}],"p3"},
     "AngleSquareChain",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "^", "4"}]}], "//", "MassDimension"}]], "Input",
 CellChangeTimes->{{3.7947251094711823`*^9, 3.7947251575117116`*^9}, {
  3.7947272465565786`*^9, 3.7947272470641923`*^9}},
 CellLabel->
  "In[430]:=",ExpressionUUID->"a7525e04-70ec-4951-b02f-0dfb2e01362e"],

Cell[BoxData[
 RowBox[{"-", "8"}]], "Output",
 CellChangeTimes->{{3.794725113366719*^9, 3.794725158426268*^9}, 
   3.794725205711479*^9, 3.794725248551958*^9, {3.7947271417375097`*^9, 
   3.79472716292356*^9}, {3.79472723488875*^9, 3.7947272475767975`*^9}, 
   3.794727516894232*^9},
 CellLabel->
  "Out[430]=",ExpressionUUID->"0e10cbd0-bcd4-4b11-835a-0eca984fe43c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"test0", "=", 
   FractionBox["1", 
    SuperscriptBox[
     TemplateBox[{"p4",RowBox[{"{", "p2", "}"}],"p3"},
      "AngleSquareChain",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
         "$square", "]"}]& )], "4"]]}], ";"}]], "Input",
 CellChangeTimes->{{3.794725086691074*^9, 3.7947250944941635`*^9}},
 CellLabel->
  "In[371]:=",ExpressionUUID->"e3b54f1a-649d-45dd-84ef-d4d4b44940d7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test0", "//", "HelicityWeight"}]], "Input",
 CellChangeTimes->{{3.7947250968409433`*^9, 3.794725101693925*^9}},
 CellLabel->
  "In[372]:=",ExpressionUUID->"d6812c41-82c4-4369-aa82-c54ce8f6e9d4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p3", ",", 
     RowBox[{"-", "4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p4", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.794725102100835*^9},
 CellLabel->
  "Out[372]=",ExpressionUUID->"cfce253a-bb73-4c62-83c3-a92b19c2a726"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test2", "=", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    SuperscriptBox["\[Kappa]", "4"], " ", 
    SuperscriptBox[
     TemplateBox[{"l1",RowBox[{"{", "p1", "}"}],"l2"},
      "AngleSquareChain",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
         "$square", "]"}]& )], "4"], " ", 
    SuperscriptBox[
     TemplateBox[{"l2",RowBox[{"{", "p3", "}"}],"l1"},
      "AngleSquareChain",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
      InterpretationFunction->(
       RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
         "$square", "]"}]& )], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        TemplateBox[{
         TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
          TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
         "ScalarProduct",
         DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
         InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )]}]],
       "+", 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        TemplateBox[{
         TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
          TemplateBox[{"p2"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
           InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
         "ScalarProduct",
         DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
         InterpretationFunction->(
          RowBox[{"mp", "[", #, ",", #2, "]"}]& )]}]]}], ")"}], " ", 
    SuperscriptBox[
     TemplateBox[{"l2","p3"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
    SuperscriptBox[
     TemplateBox[{"l1","p4"},
      "SpinorSquareBracket",
      DisplayFunction->(RowBox[{"[", 
         RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
      InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "2"]}], 
   RowBox[{"16", " ", 
    RowBox[{"S4", "[", 
     RowBox[{
      RowBox[{"-", "l1"}], ",", "p4"}], "]"}], " ", 
    RowBox[{"S4", "[", 
     RowBox[{
      RowBox[{"-", "l2"}], ",", "p4"}], "]"}], " ", 
    SuperscriptBox[
     RowBox[{"S4", "[", 
      RowBox[{"p1", ",", "p2"}], "]"}], "2"], " ", 
    RowBox[{"S4", "[", 
     RowBox[{"p3", ",", "p4"}], "]"}]}]]}]], "Input",
 CellChangeTimes->{{3.7947249021592975`*^9, 3.7947249037740088`*^9}},
 CellLabel->
  "In[361]:=",ExpressionUUID->"53df8c2c-d192-4dfa-ba9f-806d7e80223c"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", 
   SuperscriptBox["\[Kappa]", "4"], " ", 
   SuperscriptBox[
    TemplateBox[{"l1",RowBox[{"{", "p1", "}"}],"l2"},
     "AngleSquareChain",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "4"], " ", 
   SuperscriptBox[
    TemplateBox[{"l2",RowBox[{"{", "p3", "}"}],"l1"},
     "AngleSquareChain",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
     InterpretationFunction->(
      RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
        "$square", "]"}]& )], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["\[ImaginaryI]", 
      RowBox[{"2", " ", 
       TemplateBox[{
        TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
          InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
         TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
          InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
        "ScalarProduct",
        DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
        InterpretationFunction->(RowBox[{"mp", "[", #, ",", #2, "]"}]& )]}]], 
     "+", 
     FractionBox["\[ImaginaryI]", 
      RowBox[{"2", " ", 
       TemplateBox[{
        TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
          InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
         TemplateBox[{"p2"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
          InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
        "ScalarProduct",
        DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
        InterpretationFunction->(
         RowBox[{"mp", "[", #, ",", #2, "]"}]& )]}]]}], ")"}], " ", 
   SuperscriptBox[
    TemplateBox[{"l2","p3"},
     "SpinorAngleBracket",
     DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
        RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
     InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
   SuperscriptBox[
    TemplateBox[{"l1","p4"},
     "SpinorSquareBracket",
     DisplayFunction->(RowBox[{"[", 
        RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ),
     InterpretationFunction->(RowBox[{"Spinorsquarebracket", "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "2"]}], 
  RowBox[{"16", " ", 
   RowBox[{"S4", "[", 
    RowBox[{
     RowBox[{"-", "l1"}], ",", "p4"}], "]"}], " ", 
   RowBox[{"S4", "[", 
    RowBox[{
     RowBox[{"-", "l2"}], ",", "p4"}], "]"}], " ", 
   SuperscriptBox[
    RowBox[{"S4", "[", 
     RowBox[{"p1", ",", "p2"}], "]"}], "2"], " ", 
   RowBox[{"S4", "[", 
    RowBox[{"p3", ",", "p4"}], "]"}]}]]], "Output",
 CellChangeTimes->{{3.7947249000608997`*^9, 3.79472490438435*^9}},
 CellLabel->
  "Out[361]=",ExpressionUUID->"af107fb6-c40b-4377-9fbf-423f9c85b39d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test2", "//", "HelicityWeight"}]], "Input",
 CellChangeTimes->{{3.7947249058165693`*^9, 3.794724909447807*^9}},
 CellLabel->
  "In[362]:=",ExpressionUUID->"b5f36620-b3f8-4d81-aeb2-3a3926724d8d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p3", ",", 
     RowBox[{"-", "2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p4", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.794724909799904*^9},
 CellLabel->
  "Out[362]=",ExpressionUUID->"bdb2ce97-2b33-449e-a25d-0c8d692207cd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test2", "//", "MassDimension"}]], "Input",
 CellChangeTimes->{{3.7947249173916273`*^9, 3.794724920622943*^9}},
 CellLabel->
  "In[424]:=",ExpressionUUID->"76728784-fb1e-4e76-b83a-522dce71f8cd"],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{
  3.7947249209400883`*^9, 3.794727254711768*^9, 3.794727323804616*^9, 
   3.79472739877226*^9, {3.7947274768133397`*^9, 3.794727493923644*^9}},
 CellLabel->
  "Out[424]=",ExpressionUUID->"fb389cec-c946-42df-9c30-c94427bf4710"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MassDimension", "[", 
  RowBox[{"test2", ",", 
   RowBox[{"{", 
    RowBox[{"SetDimension", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\[Kappa]", "\[Rule]", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.794724933873521*^9, 3.794724956226816*^9}},
 CellLabel->
  "In[425]:=",ExpressionUUID->"8e050390-b214-4cc7-bafc-2848111e37ce"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.7947249518335075`*^9, 3.794724956838173*^9}, 
   3.794727503642627*^9},
 CellLabel->
  "Out[425]=",ExpressionUUID->"98f76e92-5e02-43fe-a05f-d5469d055111"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{"MassDimension", ",", 
   RowBox[{"SetDimension", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\[Kappa]", "\[Rule]", 
      RowBox[{"-", "1"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7947250192812676`*^9, 3.794725040550417*^9}},
 CellLabel->
  "In[426]:=",ExpressionUUID->"35da3baa-8e28-474a-8ef1-86b05f11f1c1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"SetDimension", "\[Rule]", 
   RowBox[{"{", 
    RowBox[{"\[Kappa]", "\[Rule]", 
     RowBox[{"-", "1"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.794725041110861*^9, 3.7947275047446795`*^9},
 CellLabel->
  "Out[426]=",ExpressionUUID->"c2622d97-2d6d-4929-93b5-d09f32c47606"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"test3", "=", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "s", " ", 
     SuperscriptBox["\[Kappa]", "2"], " ", 
     SuperscriptBox[
      TemplateBox[{"l1",RowBox[{"{", "p1", "}"}],"l2"},
       "AngleSquareChain",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", #, #2, #3, "]"}]& ),
       InterpretationFunction->(
        RowBox[{"Chain", "[", "$angle", ",", #, ",", #2, ",", #3, ",", 
          "$square", "]"}]& )], "4"], " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         TemplateBox[{
          TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
           TemplateBox[{"p1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
          "ScalarProduct",
          DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
          
          InterpretationFunction->(
           RowBox[{"mp", "[", #, ",", #2, "]"}]& )]}]], "+", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         TemplateBox[{
          TemplateBox[{"l1"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )],
           TemplateBox[{"p2"}, "MomPure", DisplayFunction -> (RowBox[{#}]& ), 
            InterpretationFunction -> (RowBox[{"MomPure", "[", #, "]"}]& )]},
          "ScalarProduct",
          DisplayFunction->(RowBox[{"(", #, "\[CenterDot]", #2, ")"}]& ),
          
          InterpretationFunction->(
           RowBox[{"mp", "[", #, ",", #2, "]"}]& )]}]]}], ")"}], " ", 
     SuperscriptBox[
      TemplateBox[{"l2","p3"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "7"]}], 
    RowBox[{"4", " ", 
     SuperscriptBox[
      RowBox[{"S4", "[", 
       RowBox[{"p1", ",", "p2"}], "]"}], "2"], " ", 
     SuperscriptBox[
      TemplateBox[{"l1","l2"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "2"], " ", 
     TemplateBox[{"l1","p3"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], " ", 
     TemplateBox[{"l1","p4"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], " ", 
     TemplateBox[{"l2","p4"},
      "SpinorAngleBracket",
      DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
         RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
      InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
         RowBox[{#, ",", #2}], "]"}]& )], " ", 
     SuperscriptBox[
      TemplateBox[{"p3","p4"},
       "SpinorAngleBracket",
       DisplayFunction->(RowBox[{"\[LeftAngleBracket]", 
          RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ),
       InterpretationFunction->(RowBox[{"Spinoranglebracket", "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "2"]}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.794724992146798*^9, 3.794724994846584*^9}},
 CellLabel->
  "In[427]:=",ExpressionUUID->"2fe9ccba-aa8e-4cbd-8169-e29130ed52c0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test3", "//", "HelicityWeight"}]], "Input",
 CellChangeTimes->{{3.7947249974615564`*^9, 3.7947250022118435`*^9}},
 CellLabel->
  "In[428]:=",ExpressionUUID->"42959a51-d448-4913-8fc6-fb7016ff96e6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p3", ",", 
     RowBox[{"-", "4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p4", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.794725002782317*^9, 3.794727510079419*^9},
 CellLabel->
  "Out[428]=",ExpressionUUID->"e5551f39-7530-45ab-893e-d63e88c0cd02"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test3", "//", "MassDimension"}]], "Input",
 CellChangeTimes->{{3.79472500729032*^9, 3.7947250111329975`*^9}},
 CellLabel->
  "In[429]:=",ExpressionUUID->"6567a34c-a1c7-4435-b955-300a1b5e4df0"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.794725011509987*^9, 3.7947250454044347`*^9, 
  3.794727511728051*^9},
 CellLabel->
  "Out[429]=",ExpressionUUID->"36baf9a6-88ac-4d65-99f1-e193ba18ee61"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{759., 576.6},
WindowMargins->{{168.9, Automatic}, {Automatic, 0}},
InputAliases->{"intt" -> RowBox[{"\[Integral]", 
     RowBox[{"\[SelectionPlaceholder]", 
       RowBox[{"\[DifferentialD]", "\[Placeholder]"}]}]}], "dintt" -> RowBox[{
     SubsuperscriptBox[
     "\[Integral]", "\[SelectionPlaceholder]", "\[Placeholder]"], 
     RowBox[{"\[Placeholder]", 
       RowBox[{"\[DifferentialD]", "\[Placeholder]"}]}]}], "rintt" -> RowBox[{
     UnderscriptBox["\[Integral]", 
      RowBox[{"\[SelectionPlaceholder]", "\[Element]", "\[Placeholder]"}]], 
     "\[Placeholder]"}], "sumt" -> RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"\[SelectionPlaceholder]", "=", "\[Placeholder]"}], 
      "\[Placeholder]"], "\[Placeholder]"}], "prodt" -> RowBox[{
     UnderoverscriptBox["\[Product]", 
      RowBox[{"\[SelectionPlaceholder]", "=", "\[Placeholder]"}], 
      "\[Placeholder]"], "\[Placeholder]"}], "dt" -> RowBox[{
     SubscriptBox["\[PartialD]", "\[Placeholder]"], " ", 
     "\[SelectionPlaceholder]"}], "cbrt" -> 
  RadicalBox[
   "\[SelectionPlaceholder]", "3", SurdForm -> True, MultilineFunction -> 
    None], "surd" -> 
  RadicalBox[
   "\[SelectionPlaceholder]", "\[Placeholder]", SurdForm -> True, 
    MultilineFunction -> None], "ket" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "Ket"], "bra" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "Bra"], "braket" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[Placeholder]"}, "BraKet"], 
  "delay" -> TemplateBox[{"\[SelectionPlaceholder]"}, "SystemsModelDelay"], 
  "grad" -> RowBox[{
     SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], "\[Placeholder]"}], 
  "del." -> RowBox[{
     SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], ".", 
     "\[Placeholder]"}], "delx" -> RowBox[{
     SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], "\[Cross]", 
     "\[Placeholder]"}], "del2" -> RowBox[{
     SubsuperscriptBox["\[Del]", "\[SelectionPlaceholder]", 2], 
     "\[Placeholder]"}], "kd" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "KroneckerDeltaSeq"], "algs" -> 
  TemplateBox[{}, "Algebraics"], "bools" -> TemplateBox[{}, "Booleans"], 
  "comps" -> TemplateBox[{}, "Complexes"], "ints" -> 
  TemplateBox[{}, "Integers"], "pris" -> TemplateBox[{}, "Primes"], "rats" -> 
  TemplateBox[{}, "Rationals"], "reals" -> TemplateBox[{}, "Reals"], "dlim" -> 
  RowBox[{
     UnderscriptBox["\[Limit]", 
      RowBox[{"\[SelectionPlaceholder]", 
        UnderscriptBox["\[Rule]", 
         TemplateBox[{}, "Integers"]], "\[Infinity]"}]], "\[Placeholder]"}], 
  "dMlim" -> RowBox[{
     UnderscriptBox["\[MaxLimit]", 
      RowBox[{"\[SelectionPlaceholder]", 
        UnderscriptBox["\[Rule]", 
         TemplateBox[{}, "Integers"]], "\[Infinity]"}]], "\[Placeholder]"}], 
  "dmlim" -> RowBox[{
     UnderscriptBox["\[MinLimit]", 
      RowBox[{"\[SelectionPlaceholder]", 
        UnderscriptBox["\[Rule]", 
         TemplateBox[{}, "Integers"]], "\[Infinity]"}]], "\[Placeholder]"}], 
  "notation" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongLeftRightArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "notation>" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongRightArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "notation<" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongLeftArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "symb" -> RowBox[{"Symbolize", "[", 
     TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], "]"}], 
  "infixnotation" -> RowBox[{"InfixNotation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], ",", 
       "\[Placeholder]"}], "]"}], "addia" -> RowBox[{"AddInputAlias", "[", 
     RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "pattwraper" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "NotationPatternTag"], 
  "madeboxeswraper" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "NotationMadeBoxesTag"], "lu" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorLaUp", DisplayFunction -> (RowBox[{
       SuperscriptBox["\[Lambda]", #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinorundot", "[", #, "]", "[", "$lam", "]", "[", #2, "]", "[", 
       "Null", "]"}]& )], "ld" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorLaDown", DisplayFunction -> (RowBox[{
       SubscriptBox["\[Lambda]", #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinorundot", "[", #, "]", "[", "$lam", "]", "[", "Null", "]", 
       "[", #2, "]"}]& )], "muu" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorMuUp", DisplayFunction -> (RowBox[{
       SuperscriptBox["\[Mu]", #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinorundot", "[", #, "]", "[", "$mu", "]", "[", #2, "]", "[", 
       "Null", "]"}]& )], "mud" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorMuDown", DisplayFunction -> (RowBox[{
       SubscriptBox["\[Mu]", #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinorundot", "[", #, "]", "[", "$mu", "]", "[", "Null", "]", 
       "[", #2, "]"}]& )], "lp" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "SpinorUndotPureL", 
    DisplayFunction -> (RowBox[{"\[Lambda]", "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$lam", "]"}]& )], "mp" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "SpinorUndotPureM", 
    DisplayFunction -> (RowBox[{"\[Mu]", "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"SpinorUndotPure", "[", #, "]", "[", "$mu", "]"}]& )], "Ld" -> 
  TemplateBox[{
    "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]"}, "SpinorUndot6D", DisplayFunction -> (RowBox[{
       SubscriptBox[
        SuperscriptBox["\[CapitalLambda]", #2], #3], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"SpinorUndot6D", "[", #, "]", "[", #2, "]", "[", "Null", "]", 
       "[", #3, "]"}]& )], "ltu" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorLatUp", DisplayFunction -> (RowBox[{
       SuperscriptBox[
        OverscriptBox["\[Lambda]", "~"], #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinordot", "[", #, "]", "[", "$lam", "]", "[", #2, "]", "[", 
       "Null", "]"}]& )], "ltd" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorLatDown", DisplayFunction -> (RowBox[{
       SubscriptBox[
        OverscriptBox["\[Lambda]", "~"], #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinordot", "[", #, "]", "[", "$lam", "]", "[", "Null", "]", 
       "[", #2, "]"}]& )], "mtu" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorMutUp", DisplayFunction -> (RowBox[{
       SuperscriptBox[
        OverscriptBox["\[Mu]", "~"], #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinordot", "[", #, "]", "[", "$mu", "]", "[", #2, "]", "[", 
       "Null", "]"}]& )], "mtd" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "SpinorMutDown", DisplayFunction -> (RowBox[{
       SubscriptBox[
        OverscriptBox["\[Mu]", "~"], #2], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Spinordot", "[", #, "]", "[", "$mu", "]", "[", "Null", "]", 
       "[", #2, "]"}]& )], "ltp" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "SpinorDotPureL", 
    DisplayFunction -> (RowBox[{
       OverscriptBox["\[Lambda]", "~"], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"SpinorDotPure", "[", #, "]", "[", "$lam", "]"}]& )], "mtp" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "SpinorDotPureM", 
    DisplayFunction -> (RowBox[{
       OverscriptBox["\[Mu]", "~"], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"SpinorDotPure", "[", #, "]", "[", "$mu", "]"}]& )], "Ltd" -> 
  TemplateBox[{
    "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]"}, "SpinorDot6D", DisplayFunction -> (RowBox[{
       SubscriptBox[
        SubscriptBox[
         OverscriptBox["\[CapitalLambda]", "~"], #2], #3], "[", #, "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"SpinorDot6D", "[", #, "]", "[", #2, "]", "[", "Null", "]", 
       "[", #3, "]"}]& )], "lcup" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "levicivita2up", DisplayFunction -> (SuperscriptBox["\[Epsilon]", 
      RowBox[{#, #2}]]& ), 
    InterpretationFunction -> (
     RowBox[{"levicivita2up", "[", #, ",", #2, "]"}]& )], "lcd" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, 
    "levicivita2down", DisplayFunction -> (SubscriptBox["\[Epsilon]", 
      RowBox[{#, #2}]]& ), 
    InterpretationFunction -> (
     RowBox[{"levicivita2down", "[", #, ",", #2, "]"}]& )], "ab" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[Placeholder]"}, 
    "SpinorAngleBracket", DisplayFunction -> (RowBox[{"\[LeftAngleBracket]", 
       RowBox[{#, "\[MediumSpace]", #2}], "\[RightAngleBracket]"}]& ), 
    InterpretationFunction -> (RowBox[{"Spinoranglebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], "sb" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[Placeholder]"}, 
    "SpinorSquareBracket", DisplayFunction -> (RowBox[{"[", 
       RowBox[{#, "\[MediumSpace]", #2}], "]"}]& ), 
    InterpretationFunction -> (RowBox[{"Spinorsquarebracket", "[", 
       RowBox[{#, ",", #2}], "]"}]& )], "sai" -> 
  TemplateBox[{
    "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, "SquAngInvariant",
     DisplayFunction -> (RowBox[{"[", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "\[RightAngleBracket]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Squanginvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], "asi" -> 
  TemplateBox[{
    "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, "AngSquInvariant",
     DisplayFunction -> (RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #3], ",", 
       SubscriptBox[#2, #4], "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Angsquinvariant", "[", #, ",", #2, "]", "[", #3, ",", #4, 
       "]"}]& )], "aa" -> 
  TemplateBox[{
    "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, "AngAngInvariant",
     DisplayFunction -> (RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[#, #5], ",", 
       SubscriptBox[#2, #6], ",", 
       SubscriptBox[#3, #7], ",", 
       SubscriptBox[#4, #8], "\[RightAngleBracket]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Anganginvariant", "[", #, ",", #2, ",", #3, ",", #4, "]", 
       "[", #5, ",", #6, ",", #7, ",", #8, "]"}]& )], "bb" -> 
  TemplateBox[{
    "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]"}, "SquSquInvariant",
     DisplayFunction -> (RowBox[{"[", 
       SubscriptBox[#, #5], ",", 
       SubscriptBox[#2, #6], ",", 
       SubscriptBox[#3, #7], ",", 
       SubscriptBox[#4, #8], "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Squsquinvariant", "[", #, ",", #2, ",", #3, ",", #4, "]", 
       "[", #5, ",", #6, ",", #7, ",", #8, "]"}]& )], "fst" -> 
  TemplateBox[{
    "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 
     "\[SelectionPlaceholder]"}, "Fstrength", DisplayFunction -> (RowBox[{
       SubscriptBox[
        SuperscriptBox["F", 
         RowBox[{#2, #3}]], 
        RowBox[{#4, #5}]], "[", 
       SubscriptBox[#, 
        RowBox[{#6, #7}]], "]"}]& ), 
    InterpretationFunction -> (
     RowBox[{"Fstrength[", #, "][", #2, ",", #3, "][", #4, ",", #5, "][", #6, 
       ",", #7, "]"}]& )], "md" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[SelectionPlaceholder]", 4}, 
    "MDelta", DisplayFunction -> (RowBox[{
       SubscriptBox[
        SuperscriptBox["\[Delta]", #], #2]}]& ), 
    InterpretationFunction -> (
     RowBox[{"MDelta", "[", #3, "][", #, "][", #2, "]"}]& )]},
Magnification:>0.9 Inherited,
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"6f95a584-4ff3-4209-8ebd-1ccfdf8ca4c8"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 207, 3, 25, "Input",ExpressionUUID->"52feb9eb-7be1-4eed-9dff-4e70cda36ab2"],
Cell[CellGroupData[{
Cell[812, 29, 370, 7, 19, "Print",ExpressionUUID->"5fb5e056-d0e7-4cca-b9d5-f8c988a9e08e"],
Cell[1185, 38, 363, 6, 19, "Print",ExpressionUUID->"05d25ad6-f03f-42e8-81be-b5db9773de48"],
Cell[1551, 46, 347, 6, 19, "Print",ExpressionUUID->"9efb671b-94b2-4cc6-8d28-69a3f2f73ae2"],
Cell[1901, 54, 350, 6, 19, "Print",ExpressionUUID->"09b38330-0393-4c60-b5f6-8838304d6e7a"],
Cell[2254, 62, 360, 6, 19, "Print",ExpressionUUID->"67683e7f-4a88-474d-baf6-56ec80a8ef0f"],
Cell[2617, 70, 367, 6, 19, "Print",ExpressionUUID->"135153b1-95da-4929-bdad-bcc01c8e762c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[3033, 82, 236, 4, 59, "Section",ExpressionUUID->"a4c21f51-06aa-48ae-9617-a92d3dd7d1c6"],
Cell[CellGroupData[{
Cell[3294, 90, 171, 3, 48, "Subsection",ExpressionUUID->"d5575354-e02a-434d-bbc5-7bb14aac5a0e"],
Cell[CellGroupData[{
Cell[3490, 97, 192, 3, 40, "Subsubsection",ExpressionUUID->"62266147-4a7c-4b44-abaf-e1d7e74bb522"],
Cell[3685, 102, 340, 8, 25, "Input",ExpressionUUID->"b2694dc0-1ee8-4bc8-80b5-041ee38c75ac"],
Cell[4028, 112, 8395, 204, 607, "Input",ExpressionUUID->"ee2b2d6e-2bcc-4010-b446-ffa6ab6f61ca"]
}, Closed]],
Cell[CellGroupData[{
Cell[12460, 321, 162, 3, 33, "Subsubsection",ExpressionUUID->"3ab05721-cdc7-42e3-8001-1d2160162969"],
Cell[12625, 326, 9981, 236, 749, "Input",ExpressionUUID->"fca877f5-86e2-406d-9593-0fd4d06a4f16"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[22655, 568, 154, 3, 34, "Subsection",ExpressionUUID->"77337c2b-bfe5-4b94-9c68-faa5bc3582e9"],
Cell[CellGroupData[{
Cell[22834, 575, 6489, 152, 134, "Input",ExpressionUUID->"40e1bf16-232c-4be9-b234-c46e72c5ff02"],
Cell[29326, 729, 6308, 149, 138, "Output",ExpressionUUID->"8f76097d-96f3-4e8c-8db6-b7506e5926fa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35671, 883, 267, 4, 25, "Input",ExpressionUUID->"81b12154-4c43-426c-b284-d0f5908e8b64"],
Cell[35941, 889, 488, 12, 29, "Output",ExpressionUUID->"534d180d-f69d-4d75-910b-3619253df804"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36466, 906, 6492, 152, 134, "Input",ExpressionUUID->"7de306a9-6477-4576-af4e-1da3e2ff5ba1"],
Cell[42961, 1060, 6257, 148, 138, "Output",ExpressionUUID->"14f6382c-411f-4d16-af05-1afe0464432a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49255, 1213, 214, 3, 25, "Input",ExpressionUUID->"f5864cde-2401-47f4-a654-961e4678b799"],
Cell[49472, 1218, 258, 5, 19, "Print",ExpressionUUID->"86091c14-9644-4b77-a415-abdf968c079e"],
Cell[49733, 1225, 7176, 174, 136, "Output",ExpressionUUID->"67517285-f55f-406d-b53c-8d499de42dcf"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[56970, 1406, 251, 4, 47, "Section",ExpressionUUID->"b7f166ca-0107-4476-9a19-a7e83d898c8e"],
Cell[CellGroupData[{
Cell[57246, 1414, 168, 3, 48, "Subsection",ExpressionUUID->"7d83feb4-d7e7-4c1e-a000-7d34676689d4"],
Cell[CellGroupData[{
Cell[57439, 1421, 249, 4, 40, "Subsubsection",ExpressionUUID->"df7bb581-7ec9-48bf-ba2e-24864bb44b18"],
Cell[57691, 1427, 5784, 141, 405, "Input",ExpressionUUID->"be9157f5-b73e-4d4d-b93b-3e14216c3e65"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63512, 1573, 160, 3, 40, "Subsubsection",ExpressionUUID->"57a55530-1206-496c-b4aa-fd87f1311ed2"],
Cell[CellGroupData[{
Cell[63697, 1580, 861, 19, 25, "Input",ExpressionUUID->"9599c227-4a78-40ab-a8b8-2fd2cc1d18a2"],
Cell[64561, 1601, 438, 12, 29, "Output",ExpressionUUID->"be88035a-62f5-413d-96e8-5cf7d48153e7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65036, 1618, 493, 10, 25, "Input",ExpressionUUID->"84ae124a-ee8d-419a-b697-9769c37f3273"],
Cell[65532, 1630, 315, 9, 29, "Output",ExpressionUUID->"d872bd21-1f83-4acd-beec-a6191482bdfb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65884, 1644, 494, 11, 25, "Input",ExpressionUUID->"e0aad559-6187-480d-bb8a-832cce1e7be0"],
Cell[66381, 1657, 321, 10, 29, "Output",ExpressionUUID->"f7103255-1d9b-4677-a9e2-75448b954a1e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66739, 1672, 543, 13, 25, "Input",ExpressionUUID->"5c7440ea-9f66-4411-852c-948462a07753"],
Cell[67285, 1687, 340, 11, 29, "Output",ExpressionUUID->"9d492b9c-bcc0-40dc-baa9-cdcbf0579926"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67662, 1703, 509, 12, 25, "Input",ExpressionUUID->"0c63fa33-3898-4d72-ac05-497a35c560b4"],
Cell[68174, 1717, 297, 9, 29, "Output",ExpressionUUID->"11c1d585-a0e0-4235-b270-1c296a207561"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[68520, 1732, 281, 6, 40, "Subsubsection",ExpressionUUID->"ff0b2f07-d24a-4fcc-a7ee-cf97d5c52e81"],
Cell[68804, 1740, 11756, 282, 886, "Input",ExpressionUUID->"69a82ac3-e6b3-47cc-a7e4-573a148524f0"],
Cell[CellGroupData[{
Cell[80585, 2026, 912, 20, 25, "Input",ExpressionUUID->"b696f668-48f7-4231-b950-a93f01092a89"],
Cell[81500, 2048, 552, 13, 29, "Output",ExpressionUUID->"9c50adbf-1fd2-4612-9734-5c6d2584b94f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82089, 2066, 806, 18, 25, "Input",ExpressionUUID->"077bba7e-3bf6-4d36-adfa-ec189703589a"],
Cell[82898, 2086, 469, 11, 29, "Output",ExpressionUUID->"db1f6d5c-f99b-4b1c-818a-570053b7f4a8"]
}, Open  ]],
Cell[83382, 2100, 529, 12, 43, "Input",ExpressionUUID->"7eb4d0a6-8c44-4907-abfd-4025a0a178c4"],
Cell[CellGroupData[{
Cell[83936, 2116, 1181, 26, 25, "Input",ExpressionUUID->"c4dfc5eb-3fc5-4a15-ba4e-816195cd6b5a"],
Cell[85120, 2144, 576, 13, 29, "Output",ExpressionUUID->"6eba4d8a-4c92-4fae-b450-50c8e0a203e4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85733, 2162, 1070, 24, 25, "Input",ExpressionUUID->"359e30d9-3b3b-4f83-9c9c-37467b9ecb54"],
Cell[86806, 2188, 375, 10, 29, "Output",ExpressionUUID->"ed92fa06-19b6-4c84-97fd-b904f14304a0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87218, 2203, 215, 3, 25, "Input",ExpressionUUID->"429314fd-05b5-49d2-8f41-86b72f9f2966"],
Cell[87436, 2208, 168, 3, 29, "Output",ExpressionUUID->"e576ace2-8917-41ec-a602-6663d2db637a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87641, 2216, 1084, 24, 25, "Input",ExpressionUUID->"9178c507-9e44-4ddf-8f68-68421eec5ae4"],
Cell[88728, 2242, 375, 10, 29, "Output",ExpressionUUID->"e3a0c1ee-95fa-4462-8c3b-18be2157daa7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89140, 2257, 1441, 33, 25, "Input",ExpressionUUID->"49abd253-cd93-4228-8dfe-e87cebf552c4"],
Cell[90584, 2292, 699, 13, 20, "Message",ExpressionUUID->"4a65f15e-d793-444b-8014-c70ceb6dc185"],
Cell[91286, 2307, 609, 12, 20, "Message",ExpressionUUID->"4a707bbd-9532-413c-bfa2-55d73e4c89ca"],
Cell[91898, 2321, 481, 14, 29, "Output",ExpressionUUID->"e2e402ff-66a5-4569-983f-e22901ae592a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[92428, 2341, 302, 4, 40, "Subsubsection",ExpressionUUID->"82141fb2-10b9-4cf3-8dfa-a7a519e8233b"],
Cell[92733, 2347, 11753, 282, 886, "Input",ExpressionUUID->"26d957d8-91aa-457a-b5fc-5d39f47e76f9"],
Cell[CellGroupData[{
Cell[104511, 2633, 912, 20, 25, "Input",ExpressionUUID->"bf2c5b4d-1961-4b42-b78e-d96330b5da4b"],
Cell[105426, 2655, 552, 13, 29, "Output",ExpressionUUID->"9e5af16d-287b-43f9-8e47-978a9f957485"]
}, Open  ]],
Cell[CellGroupData[{
Cell[106015, 2673, 806, 18, 25, "Input",ExpressionUUID->"a0183b31-49ab-4c5c-b33b-d40c4fee5d78"],
Cell[106824, 2693, 469, 11, 29, "Output",ExpressionUUID->"7dd7ea50-db83-4f13-9b1d-acfc7ac12440"]
}, Open  ]],
Cell[107308, 2707, 529, 12, 43, "Input",ExpressionUUID->"991fbf32-5775-489d-bb21-c61ab7a01d46"],
Cell[CellGroupData[{
Cell[107862, 2723, 1181, 26, 25, "Input",ExpressionUUID->"95a703c1-b35a-4fc9-971d-758e4d19ecd0"],
Cell[109046, 2751, 576, 13, 29, "Output",ExpressionUUID->"4e6a63b5-c08e-4b65-9428-7d394a07ff85"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109659, 2769, 1070, 24, 25, "Input",ExpressionUUID->"20bdea6a-8099-4dcf-9e02-26e9fec1f638"],
Cell[110732, 2795, 375, 10, 29, "Output",ExpressionUUID->"d3840013-22d5-4afd-9455-be42e1f42e30"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111144, 2810, 215, 3, 25, "Input",ExpressionUUID->"89aaeb50-6dab-41af-9dcf-b7b29f963a06"],
Cell[111362, 2815, 168, 3, 29, "Output",ExpressionUUID->"ee6ad077-0b58-470c-957f-467e3571341d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111567, 2823, 1084, 24, 25, "Input",ExpressionUUID->"41f8b073-4649-4d27-a8c6-bd5ea69f630a"],
Cell[112654, 2849, 375, 10, 29, "Output",ExpressionUUID->"8086c03c-b35c-42c4-87ee-8822c874af21"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[113102, 2867, 238, 4, 47, "Section",ExpressionUUID->"f885fe27-b543-4c91-adf0-4bbfb4ad8326"],
Cell[CellGroupData[{
Cell[113365, 2875, 162, 3, 48, "Subsection",ExpressionUUID->"940de3d5-9615-4fd7-bac3-93ffe6b1bf64"],
Cell[113530, 2880, 13465, 316, 835, "Input",ExpressionUUID->"ce25dea9-2c47-46a5-a1d6-01073b3a9f5c"],
Cell[CellGroupData[{
Cell[127020, 3200, 754, 16, 25, "Input",ExpressionUUID->"f48e0344-0c8d-44d9-9dd8-a2b7e7c6b127"],
Cell[127777, 3218, 399, 10, 29, "Output",ExpressionUUID->"4bc08384-5081-40e1-8368-58378a1b7b00"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128213, 3233, 963, 20, 25, "Input",ExpressionUUID->"383d996b-e441-42e2-beb9-8356181e337c"],
Cell[129179, 3255, 635, 15, 29, "Output",ExpressionUUID->"c05f3d21-673e-4fa5-8c29-cfc4af20e732"]
}, Open  ]],
Cell[129829, 3273, 529, 12, 43, "Input",ExpressionUUID->"ba7704af-6471-414f-9e3c-cbf9c69b9ff0"],
Cell[CellGroupData[{
Cell[130383, 3289, 1123, 25, 25, "Input",ExpressionUUID->"3725f4e0-d37f-442b-af1a-43bfe6bf4cc7"],
Cell[131509, 3316, 369, 10, 29, "Output",ExpressionUUID->"391c338b-1223-4733-9598-a8c031026822"]
}, Open  ]],
Cell[CellGroupData[{
Cell[131915, 3331, 1230, 27, 25, "Input",ExpressionUUID->"8caca1cd-1651-4057-bcf1-e43b2f35942a"],
Cell[133148, 3360, 630, 14, 29, "Output",ExpressionUUID->"6c62b531-f2fe-46d5-9b60-38e08783cf59"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133815, 3379, 1070, 24, 25, "Input",ExpressionUUID->"9310f95f-88e5-4e45-b298-1603b938ac9e"],
Cell[134888, 3405, 375, 10, 29, "Output",ExpressionUUID->"bb4dcff7-a696-464e-ac25-2d018579d89b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135300, 3420, 266, 4, 25, "Input",ExpressionUUID->"3f586213-6693-43f1-953f-b342602baf4a"],
Cell[135569, 3426, 192, 3, 29, "Output",ExpressionUUID->"4a276caa-0f9b-4ca0-a31f-2e9fb90f5776"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135798, 3434, 1163, 25, 25, "Input",ExpressionUUID->"77fc2523-3ab5-412a-b343-f04af6978282"],
Cell[136964, 3461, 482, 12, 29, "Output",ExpressionUUID->"a003b919-b9b8-42ad-9b7b-c17d1efe659e"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[137495, 3479, 214, 4, 34, "Subsection",ExpressionUUID->"c903ae61-31f5-49e2-a9c4-e00b200ff30a"],
Cell[137712, 3485, 10848, 276, 595, "Input",ExpressionUUID->"dba526c9-8a1b-4831-a6db-10ecba4eb03c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[148597, 3766, 226, 4, 48, "Subsection",ExpressionUUID->"cacf0f5d-838b-4698-b043-c2a6c4fdcd48"],
Cell[148826, 3772, 9541, 245, 492, "Input",ExpressionUUID->"9bf468e6-a9c6-4952-b966-e96645e26fe2"],
Cell[158370, 4019, 4401, 99, 354, "Input",ExpressionUUID->"7eaa80ad-e543-404f-89cb-3c806f922c54"],
Cell[CellGroupData[{
Cell[162796, 4122, 1443, 34, 25, "Input",ExpressionUUID->"a5a910b2-66d9-4ab2-b909-0017f639a130"],
Cell[164242, 4158, 1723, 42, 37, "Print",ExpressionUUID->"6458d713-8f63-455a-8e8a-1e610983a4d8"],
Cell[165968, 4202, 470, 12, 29, "Output",ExpressionUUID->"be5b2ad5-6b40-4029-8613-cbbef04207b6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[166475, 4219, 826, 19, 43, "Input",ExpressionUUID->"da178a54-b67a-4fca-b88d-69d7879e9ddd"],
Cell[167304, 4240, 463, 11, 29, "Output",ExpressionUUID->"7997ce26-cdc0-4164-bcfd-95694e834797"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[167816, 4257, 155, 3, 48, "Subsection",ExpressionUUID->"244d3448-9be5-48e5-bba6-d0c57a3d4f86"],
Cell[CellGroupData[{
Cell[167996, 4264, 862, 19, 25, "Input",ExpressionUUID->"57e5eaa3-22db-422a-8e5c-f995a955de4b"],
Cell[168861, 4285, 426, 11, 29, "Output",ExpressionUUID->"39da0962-4a85-4a08-bc4e-e9f9daa0cdf8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169324, 4301, 1073, 23, 25, "Input",ExpressionUUID->"29b5cd9c-cbcd-4d42-950a-ea3449c15ba9"],
Cell[170400, 4326, 684, 16, 29, "Output",ExpressionUUID->"91ce55fc-3db6-46c5-8bec-d75105125215"]
}, Open  ]],
Cell[171099, 4345, 529, 12, 43, "Input",ExpressionUUID->"9b37172c-d69c-4261-b80e-f34fc6adfeea"],
Cell[CellGroupData[{
Cell[171653, 4361, 1224, 27, 25, "Input",ExpressionUUID->"93702653-db2a-44e5-90f0-c3299d78c6be"],
Cell[172880, 4390, 419, 11, 29, "Output",ExpressionUUID->"df1fe8ce-cee2-43fb-b5dc-130a5082853a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[173336, 4406, 1331, 29, 25, "Input",ExpressionUUID->"5fa290b3-4cf0-4ae3-a888-0952910d5dd2"],
Cell[174670, 4437, 712, 17, 29, "Output",ExpressionUUID->"9c62a59c-d70b-4c89-922b-4acca07ef3f8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[175419, 4459, 1172, 27, 25, "Input",ExpressionUUID->"5fae32e7-d749-4efb-90cb-ba05a754ba9e"],
Cell[176594, 4488, 430, 12, 29, "Output",ExpressionUUID->"55aa47c2-6e1b-4035-b8ca-81409fdba930"]
}, Open  ]],
Cell[CellGroupData[{
Cell[177061, 4505, 369, 6, 25, "Input",ExpressionUUID->"a9131887-92f7-4ac4-bc22-bf9dbfaa9b08"],
Cell[177433, 4513, 244, 5, 29, "Output",ExpressionUUID->"30c5bb5a-6f14-4c99-9aa7-e5fe4ea00b8f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[177714, 4523, 1267, 27, 25, "Input",ExpressionUUID->"42c94ab3-02d2-406b-a824-e778128d3b3f"],
Cell[178984, 4552, 536, 14, 29, "Output",ExpressionUUID->"c81febb6-686d-4102-b98f-2e114a30bc41"]
}, Open  ]],
Cell[CellGroupData[{
Cell[179557, 4571, 1498, 35, 25, "Input",ExpressionUUID->"1ac3f5a7-37f8-4fe9-9256-11525d8ad3a8"],
Cell[181058, 4608, 344, 10, 29, "Output",ExpressionUUID->"2f9b1bc5-18b9-49af-b34f-f9d2b43bd33d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[181439, 4623, 6591, 160, 134, "Input",ExpressionUUID->"be3755ef-cf4c-45c0-a412-cc4ced9783df"],
Cell[188033, 4785, 6415, 156, 138, "Output",ExpressionUUID->"f1fe4406-3e36-4443-983b-40dae9b594ab"]
}, Open  ]],
Cell[CellGroupData[{
Cell[194485, 4946, 347, 6, 25, "Input",ExpressionUUID->"447e539f-8049-4147-98e5-fd90365d7016"],
Cell[194835, 4954, 1118, 33, 29, "Output",ExpressionUUID->"e37cddd4-86ae-4a70-b5a8-04d3970c8214"]
}, Open  ]],
Cell[CellGroupData[{
Cell[195990, 4992, 6594, 160, 134, "Input",ExpressionUUID->"866bd37c-8863-4a6f-b659-a2dedf474ab1"],
Cell[202587, 5154, 6366, 155, 138, "Output",ExpressionUUID->"a9c4f0b0-c3ca-4ba0-8592-776f5a325965"]
}, Open  ]],
Cell[CellGroupData[{
Cell[208990, 5314, 272, 5, 25, "Input",ExpressionUUID->"acb76a8b-05ac-40f0-a66f-8d7a9f5baaea"],
Cell[209265, 5321, 319, 6, 29, "Output",ExpressionUUID->"70d1a5a8-753b-4161-83a7-5b21d42c14dd"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[209645, 5334, 318, 5, 47, "Section",ExpressionUUID->"3d0fd9ca-97f9-4f6c-899e-3bdc9389ee37"],
Cell[CellGroupData[{
Cell[209988, 5343, 168, 3, 48, "Subsection",ExpressionUUID->"7c49e90b-e15a-4557-9f4d-6d8ddb818125"],
Cell[CellGroupData[{
Cell[210181, 5350, 297, 5, 40, "Subsubsection",ExpressionUUID->"05b5247e-e804-4e65-9901-36da55a11f7a"],
Cell[210481, 5357, 276, 5, 25, "Input",ExpressionUUID->"303a959b-5daf-4bb1-b63e-c1a366dbbab4"],
Cell[210760, 5364, 383, 9, 25, "Input",ExpressionUUID->"e8930aa1-cfbb-48ec-bff7-c3e6c908a7d9"],
Cell[211146, 5375, 12140, 295, 925, "Input",ExpressionUUID->"0c8d85ac-7a45-4b0c-9d6e-fb6f845ede93"],
Cell[CellGroupData[{
Cell[223311, 5674, 1148, 24, 25, "Input",ExpressionUUID->"3f378527-283f-491d-96e6-d4e7a62433d4"],
Cell[224462, 5700, 912, 24, 29, "Output",ExpressionUUID->"e7d67dc4-6ef9-4e15-bb3e-48638956a2fa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[225411, 5729, 219, 4, 25, "Input",ExpressionUUID->"df69f282-6f2b-40c1-be51-e8718751ecd5"],
Cell[225633, 5735, 172, 4, 29, "Output",ExpressionUUID->"58678d43-2a4e-4556-8e54-183c8652478f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[225842, 5744, 582, 13, 25, "Input",ExpressionUUID->"29972f00-3529-4931-b97a-f60eef7ec1a8"],
Cell[226427, 5759, 403, 9, 24, "Message",ExpressionUUID->"4baa59f4-9983-46af-9e58-bfad076cb43a"],
Cell[226833, 5770, 185, 3, 29, "Output",ExpressionUUID->"00b5b06f-ff56-4924-80cb-f75be7ca3e1c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[227055, 5778, 580, 13, 25, "Input",ExpressionUUID->"7af0d2ca-a70a-4931-baab-add396d0260b"],
Cell[227638, 5793, 322, 10, 29, "Output",ExpressionUUID->"2836bb87-f681-4d67-8846-69c2b403b5bb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[227997, 5808, 518, 11, 25, "Input",ExpressionUUID->"84af6e92-e4a3-4f6f-a252-16fa591d128b"],
Cell[228518, 5821, 340, 11, 29, "Output",ExpressionUUID->"7705ead1-6632-4f3b-b078-919aef7c9a4f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[228907, 5838, 160, 3, 40, "Subsubsection",ExpressionUUID->"be2fc23b-c5e8-4554-8d81-5f5f19fde10e"],
Cell[CellGroupData[{
Cell[229092, 5845, 915, 21, 25, "Input",ExpressionUUID->"7752e91c-9cb3-47d9-b881-b3313fd7e849"],
Cell[230010, 5868, 503, 13, 29, "Output",ExpressionUUID->"8cb02b51-bf77-4e1b-954b-eae0b6488e2b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[230550, 5886, 548, 12, 25, "Input",ExpressionUUID->"bcd79505-5702-428c-9a9b-8be916a54c76"],
Cell[231101, 5900, 403, 12, 29, "Output",ExpressionUUID->"004c5a96-c03f-4fe0-85c2-930810906e51"]
}, Open  ]],
Cell[CellGroupData[{
Cell[231541, 5917, 543, 12, 25, "Input",ExpressionUUID->"e64ce691-768e-4ae4-bd2e-a00051078563"],
Cell[232087, 5931, 403, 12, 29, "Output",ExpressionUUID->"8ae8e3ed-1b71-432d-9e04-85e4983b94e2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[232527, 5948, 596, 14, 25, "Input",ExpressionUUID->"335c2efc-f601-4687-a154-70b8309be6ca"],
Cell[233126, 5964, 484, 15, 29, "Output",ExpressionUUID->"3f70e0e1-3f83-4ba9-8325-b6da9039e5be"]
}, Open  ]],
Cell[CellGroupData[{
Cell[233647, 5984, 558, 13, 25, "Input",ExpressionUUID->"377492df-6f5d-4ba9-a31b-8bd41099308d"],
Cell[234208, 5999, 441, 13, 29, "Output",ExpressionUUID->"152734cd-6f74-4086-8ebe-79f74d88ffec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[234686, 6017, 7022, 171, 153, "Input",ExpressionUUID->"ddfe5b37-110d-432b-bd88-2d3d1ba5965d"],
Cell[241711, 6190, 6083, 142, 94, "Output",ExpressionUUID->"17ab985e-1a21-4556-8703-663148022df7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[247831, 6337, 401, 7, 25, "Input",ExpressionUUID->"2b8ba432-8268-4427-ab0f-b57b987f3e2b"],
Cell[248235, 6346, 1184, 33, 29, "Output",ExpressionUUID->"884c3438-a543-47b2-aac3-282a9ba4bbb7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[249456, 6384, 6594, 160, 134, "Input",ExpressionUUID->"6b3c4865-b001-4db1-a667-1fa20e5af3d3"],
Cell[256053, 6546, 6393, 156, 138, "Output",ExpressionUUID->"9b2ad153-9afe-49ee-8e47-e2cb25be8793"]
}, Open  ]],
Cell[CellGroupData[{
Cell[262483, 6707, 323, 6, 25, "Input",ExpressionUUID->"807b8c4a-4edd-4fa0-b8fa-ba0ff29296f6"],
Cell[262809, 6715, 404, 9, 24, "Message",ExpressionUUID->"433fd6e3-9a68-4c81-85fd-8d3c89714078"],
Cell[263216, 6726, 288, 5, 29, "Output",ExpressionUUID->"18e018e7-d353-4acd-b8cb-064bbc4ef7d2"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[263577, 6739, 161, 3, 59, "Section",ExpressionUUID->"e7475660-c38e-42ef-b64d-e559e6d317ab"],
Cell[CellGroupData[{
Cell[263763, 6746, 171, 3, 48, "Subsection",ExpressionUUID->"5a180252-23c5-4547-ae46-e0be27d8ef88"],
Cell[CellGroupData[{
Cell[263959, 6753, 197, 3, 40, "Subsubsection",ExpressionUUID->"b304cb17-ebab-437d-87d5-25345397dd88"],
Cell[CellGroupData[{
Cell[264181, 6760, 430, 10, 25, "Input",ExpressionUUID->"b28b83b5-895a-4e7e-acbb-d78b3a937434"],
Cell[264614, 6772, 307, 7, 29, "Output",ExpressionUUID->"0b558be6-2951-4506-9072-cb29d80abe9a"]
}, Open  ]],
Cell[264936, 6782, 7826, 179, 595, "Input",ExpressionUUID->"0a34a5fc-fba1-4c43-a89a-4b6557fe33d8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[272799, 6966, 162, 3, 40, "Subsubsection",ExpressionUUID->"4ce6f9b5-1bd8-4154-abc0-42e12149c8c8"],
Cell[272964, 6971, 236, 6, 25, "Input",ExpressionUUID->"7cad7572-7dce-445c-b284-cc527990a56d"],
Cell[273203, 6979, 10232, 239, 664, "Input",ExpressionUUID->"6effc86d-dd7a-46bc-8498-9957b211eb17"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[283484, 7224, 154, 3, 48, "Subsection",ExpressionUUID->"df39d0a1-b28d-4308-a51a-433229c03d3f"],
Cell[CellGroupData[{
Cell[283663, 7231, 6489, 152, 128, "Input",ExpressionUUID->"3417b43f-6530-428c-b278-13199f5b1a10"],
Cell[290155, 7385, 6332, 149, 132, "Output",ExpressionUUID->"1569615c-fce3-4066-8c59-a426e08c0656"]
}, Open  ]],
Cell[CellGroupData[{
Cell[296524, 7539, 214, 3, 25, "Input",ExpressionUUID->"df5f5af0-5ca8-411b-8ea9-47f7e4aa912d"],
Cell[296741, 7544, 257, 5, 19, "Print",ExpressionUUID->"3c8c0cbc-aa24-4c33-ac2e-a14862fb13e9"],
Cell[297001, 7551, 6655, 157, 128, "Output",ExpressionUUID->"f55be9cb-d77f-42ac-9c22-ce35c11bc4f7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[303693, 7713, 704, 17, 27, "Input",ExpressionUUID->"e4fa12af-3551-4334-b321-dfd5bf7daff5"],
Cell[304400, 7732, 353, 5, 28, "Output",ExpressionUUID->"263b09a2-9b9c-4530-9cb9-632b74d846e2"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[304814, 7744, 150, 3, 59, "Section",ExpressionUUID->"acca3f08-a8eb-444b-bc60-23ccf24f2de6"],
Cell[CellGroupData[{
Cell[304989, 7751, 596, 13, 25, "Input",ExpressionUUID->"a7525e04-70ec-4951-b02f-0dfb2e01362e"],
Cell[305588, 7766, 366, 7, 29, "Output",ExpressionUUID->"0e10cbd0-bcd4-4b11-835a-0eca984fe43c"]
}, Open  ]],
Cell[305969, 7776, 557, 13, 45, "Input",ExpressionUUID->"e3b54f1a-649d-45dd-84ef-d4d4b44940d7"],
Cell[CellGroupData[{
Cell[306551, 7793, 218, 4, 25, "Input",ExpressionUUID->"d6812c41-82c4-4369-aa82-c54ce8f6e9d4"],
Cell[306772, 7799, 319, 10, 29, "Output",ExpressionUUID->"cfce253a-bb73-4c62-83c3-a92b19c2a726"]
}, Open  ]],
Cell[CellGroupData[{
Cell[307128, 7814, 3137, 71, 56, "Input",ExpressionUUID->"53df8c2c-d192-4dfa-ba9f-806d7e80223c"],
Cell[310268, 7887, 3042, 70, 59, "Output",ExpressionUUID->"af107fb6-c40b-4377-9fbf-423f9c85b39d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[313347, 7962, 218, 4, 25, "Input",ExpressionUUID->"b5f36620-b3f8-4d81-aeb2-3a3926724d8d"],
Cell[313568, 7968, 319, 10, 29, "Output",ExpressionUUID->"bdb2ce97-2b33-449e-a25d-0c8d692207cd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[313924, 7983, 217, 4, 25, "Input",ExpressionUUID->"76728784-fb1e-4e76-b83a-522dce71f8cd"],
Cell[314144, 7989, 275, 5, 29, "Output",ExpressionUUID->"fb389cec-c946-42df-9c30-c94427bf4710"]
}, Open  ]],
Cell[CellGroupData[{
Cell[314456, 7999, 397, 10, 25, "Input",ExpressionUUID->"8e050390-b214-4cc7-bafc-2848111e37ce"],
Cell[314856, 8011, 205, 4, 29, "Output",ExpressionUUID->"98f76e92-5e02-43fe-a05f-d5469d055111"]
}, Open  ]],
Cell[CellGroupData[{
Cell[315098, 8020, 376, 9, 25, "Input",ExpressionUUID->"35da3baa-8e28-474a-8ef1-86b05f11f1c1"],
Cell[315477, 8031, 322, 8, 28, "Output",ExpressionUUID->"c2622d97-2d6d-4929-93b5-d09f32c47606"]
}, Open  ]],
Cell[315814, 8042, 3940, 84, 54, "Input",ExpressionUUID->"2fe9ccba-aa8e-4cbd-8169-e29130ed52c0"],
Cell[CellGroupData[{
Cell[319779, 8130, 220, 4, 25, "Input",ExpressionUUID->"42959a51-d448-4913-8fc6-fb7016ff96e6"],
Cell[320002, 8136, 341, 10, 28, "Output",ExpressionUUID->"e5551f39-7530-45ab-893e-d63e88c0cd02"]
}, Open  ]],
Cell[CellGroupData[{
Cell[320380, 8151, 216, 4, 25, "Input",ExpressionUUID->"6567a34c-a1c7-4435-b955-300a1b5e4df0"],
Cell[320599, 8157, 202, 4, 28, "Output",ExpressionUUID->"36baf9a6-88ac-4d65-99f1-e193ba18ee61"]
}, Open  ]]
}, Open  ]]
}
]
*)

